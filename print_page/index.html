
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Print Site - Genie Tooling Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("/",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#section-1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Genie Tooling Docs" class="md-header__button md-logo" aria-label="Genie Tooling Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Genie Tooling Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/genie-tooling/genie-tooling" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href=".." class="md-tabs__link">
          
  
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../guides/plugin_architecture/" class="md-tabs__link">
          
  
  
  Developer Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../api/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../tutorials/E01_simple_agent_cli/" class="md-tabs__link">
          
  
  
  Tutorials & Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../changelog/" class="md-tabs__link">
        
  
  
    
  
  Changelog

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Genie Tooling Docs" class="md-nav__button md-logo" aria-label="Genie Tooling Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Genie Tooling Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/genie-tooling/genie-tooling" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/simplified_configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simplified Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/using_llm_providers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using LLM Providers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/using_tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Tools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/using_rag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using RAG
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/using_command_processors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Command Processors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/tool_lookup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tool Lookup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/using_prompts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prompt Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/using_conversation_state/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conversation State
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/observability_tracing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Observability & Tracing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/using_human_in_loop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Human-in-the-Loop (HITL)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/token_usage_tracking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Token Usage Tracking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/using_guardrails/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guardrails
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/distributed_tasks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Distributed Tasks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Developer Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Developer Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/plugin_architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plugin Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/creating_plugins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Creating Plugins (Overview)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/creating_tool_plugins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Creating Tool Plugins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/creating_rag_plugins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Creating RAG Plugins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/creating_other_plugins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Creating Other Plugins
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/genie_facade/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Genie Facade & Interfaces
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/decorators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decorators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/core_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/plugin_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plugin Manager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/config_models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MiddlewareConfig
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/config_features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FeatureSettings
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorials & Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials & Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E01_simple_agent_cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simple Agent CLI (E01)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E02_ollama_chat_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ollama Chat (E02)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E03_openai_chat_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenAI Chat (E03)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E04_gemini_chat_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gemini Chat (E04)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E05_rag_pipeline_demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RAG Pipeline Demo (E05)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E06_run_command_simple_keyword_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simple Keyword Command (E06)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E07_run_command_llm_assisted_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LLM-Assisted Command (E07)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E08_decorator_tool_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    @tool Decorator (E08)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E09_web_rag_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Web RAG (E09)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E10_chroma_tool_lookup_showcase/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ChromaDB Tool Lookup (E10)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E11_advanced_showcase_agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Advanced Showcase (E11)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E12_custom_key_provider_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom KeyProvider (E12)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E13_google_search_demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Google Search Tool (E13)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E14_filesystem_tool_demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FileSystem Tool (E14)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E15_prompt_management_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prompt Management (E15)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E16_conversation_state_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conversation State (E16)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E17_observability_tracing_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Observability & Tracing (E17)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E18_human_in_loop_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Human-in-the-Loop (E18)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E19_llm_output_parsing_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LLM Output Parsing (E19)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E20_token_usage_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Token Usage Tracking (E20)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E21_guardrails_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guardrails (E21)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E22_distributed_task_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Distributed Tasks (E22)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E23_local_e2e_llama_cpp_server/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Llama.cpp Server E2E (E23)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E24_local_e2e_llama_cpp_internal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Llama.cpp Internal E2E (E24)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E25_llama_cpp_internal_gbnf_parsing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Llama.cpp Internal GBNF (E25)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E26_deep_research_agent_e2e/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deep Research Agent E2E (E26)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/E27_pyvider_log_adapter_tracing_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pyvider Log Adapter (E27)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#section-1" class="md-nav__link">
    <span class="md-ellipsis">
      1 User Guide
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1 User Guide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 Introduction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-installation" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 Installation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-simplified_configuration" class="md-nav__link">
    <span class="md-ellipsis">
      1.4 Simplified Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-using_llm_providers" class="md-nav__link">
    <span class="md-ellipsis">
      1.5 Using LLM Providers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-using_tools" class="md-nav__link">
    <span class="md-ellipsis">
      1.6 Using Tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-using_rag" class="md-nav__link">
    <span class="md-ellipsis">
      1.7 Using RAG
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-using_command_processors" class="md-nav__link">
    <span class="md-ellipsis">
      1.8 Using Command Processors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-tool_lookup" class="md-nav__link">
    <span class="md-ellipsis">
      1.9 Tool Lookup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-logging" class="md-nav__link">
    <span class="md-ellipsis">
      1.10 Logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-using_prompts" class="md-nav__link">
    <span class="md-ellipsis">
      1.11 Prompt Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-using_conversation_state" class="md-nav__link">
    <span class="md-ellipsis">
      1.12 Conversation State
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-observability_tracing" class="md-nav__link">
    <span class="md-ellipsis">
      1.13 Observability & Tracing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-using_human_in_loop" class="md-nav__link">
    <span class="md-ellipsis">
      1.14 Human-in-the-Loop (HITL)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-token_usage_tracking" class="md-nav__link">
    <span class="md-ellipsis">
      1.15 Token Usage Tracking
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-using_guardrails" class="md-nav__link">
    <span class="md-ellipsis">
      1.16 Guardrails
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-distributed_tasks" class="md-nav__link">
    <span class="md-ellipsis">
      1.17 Distributed Tasks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-2" class="md-nav__link">
    <span class="md-ellipsis">
      2 Developer Guide
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 Developer Guide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#guides-plugin_architecture" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 Plugin Architecture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-creating_plugins" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Creating Plugins (Overview)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-creating_tool_plugins" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 Creating Tool Plugins
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-creating_rag_plugins" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 Creating RAG Plugins
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guides-creating_other_plugins" class="md-nav__link">
    <span class="md-ellipsis">
      2.5 Creating Other Plugins
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-3" class="md-nav__link">
    <span class="md-ellipsis">
      3 API Reference
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3 API Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Overview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-genie_facade" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Genie Facade & Interfaces
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-decorators" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 Decorators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-core_types" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 Core Types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-plugin_manager" class="md-nav__link">
    <span class="md-ellipsis">
      3.5 Plugin Manager
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-config_models" class="md-nav__link">
    <span class="md-ellipsis">
      3.6 MiddlewareConfig
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-config_features" class="md-nav__link">
    <span class="md-ellipsis">
      3.7 FeatureSettings
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-4" class="md-nav__link">
    <span class="md-ellipsis">
      4 Tutorials & Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4 Tutorials &amp; Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tutorials-e01_simple_agent_cli" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Simple Agent CLI (E01)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e02_ollama_chat_example" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Ollama Chat (E02)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e03_openai_chat_example" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 OpenAI Chat (E03)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e04_gemini_chat_example" class="md-nav__link">
    <span class="md-ellipsis">
      4.4 Gemini Chat (E04)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e05_rag_pipeline_demo" class="md-nav__link">
    <span class="md-ellipsis">
      4.5 RAG Pipeline Demo (E05)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e06_run_command_simple_keyword_example" class="md-nav__link">
    <span class="md-ellipsis">
      4.6 Simple Keyword Command (E06)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e07_run_command_llm_assisted_example" class="md-nav__link">
    <span class="md-ellipsis">
      4.7 LLM-Assisted Command (E07)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e08_decorator_tool_example" class="md-nav__link">
    <span class="md-ellipsis">
      4.8 @tool Decorator (E08)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e09_web_rag_example" class="md-nav__link">
    <span class="md-ellipsis">
      4.9 Web RAG (E09)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e10_chroma_tool_lookup_showcase" class="md-nav__link">
    <span class="md-ellipsis">
      4.10 ChromaDB Tool Lookup (E10)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e11_advanced_showcase_agent" class="md-nav__link">
    <span class="md-ellipsis">
      4.11 Advanced Showcase (E11)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e12_custom_key_provider_example" class="md-nav__link">
    <span class="md-ellipsis">
      4.12 Custom KeyProvider (E12)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e13_google_search_demo" class="md-nav__link">
    <span class="md-ellipsis">
      4.13 Google Search Tool (E13)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e14_filesystem_tool_demo" class="md-nav__link">
    <span class="md-ellipsis">
      4.14 FileSystem Tool (E14)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e15_prompt_management_example" class="md-nav__link">
    <span class="md-ellipsis">
      4.15 Prompt Management (E15)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e16_conversation_state_example" class="md-nav__link">
    <span class="md-ellipsis">
      4.16 Conversation State (E16)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e17_observability_tracing_example" class="md-nav__link">
    <span class="md-ellipsis">
      4.17 Observability & Tracing (E17)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e18_human_in_loop_example" class="md-nav__link">
    <span class="md-ellipsis">
      4.18 Human-in-the-Loop (E18)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e19_llm_output_parsing_example" class="md-nav__link">
    <span class="md-ellipsis">
      4.19 LLM Output Parsing (E19)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e20_token_usage_example" class="md-nav__link">
    <span class="md-ellipsis">
      4.20 Token Usage Tracking (E20)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e21_guardrails_example" class="md-nav__link">
    <span class="md-ellipsis">
      4.21 Guardrails (E21)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e22_distributed_task_example" class="md-nav__link">
    <span class="md-ellipsis">
      4.22 Distributed Tasks (E22)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e23_local_e2e_llama_cpp_server" class="md-nav__link">
    <span class="md-ellipsis">
      4.23 Llama.cpp Server E2E (E23)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e24_local_e2e_llama_cpp_internal" class="md-nav__link">
    <span class="md-ellipsis">
      4.24 Llama.cpp Internal E2E (E24)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e25_llama_cpp_internal_gbnf_parsing" class="md-nav__link">
    <span class="md-ellipsis">
      4.25 Llama.cpp Internal GBNF (E25)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e26_deep_research_agent_e2e" class="md-nav__link">
    <span class="md-ellipsis">
      4.26 Deep Research Agent E2E (E26)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorials-e27_pyvider_log_adapter_tracing_example" class="md-nav__link">
    <span class="md-ellipsis">
      4.27 Pyvider Log Adapter (E27)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#changelog" class="md-nav__link">
    <span class="md-ellipsis">
      5 Changelog
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        
                    <section class='print-page md-section' id='section-1' heading-number='1'>
                        <h1>User Guide<a class='headerlink' href='#section-1' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="index" heading-number="1.1"><h1 id="index-welcome-to-genie-tooling">Welcome to Genie Tooling<a class="headerlink" href="#index-welcome-to-genie-tooling" title="Permanent link">&para;</a></h1>
<p>Genie Tooling is a hyper-pluggable Python middleware designed to empower developers in building sophisticated Agentic AI and LLM-powered applications. It provides a modular, async-first framework that emphasizes clear interfaces and interchangeable components, allowing for rapid iteration and customization of agent capabilities.</p>
<h2 id="index-key-features">Key Features<a class="headerlink" href="#index-key-features" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Simplified Development with the <code>Genie</code> Facade</strong>: The primary entry point for most applications, offering a high-level API for common agentic tasks like LLM interaction, Retrieval Augmented Generation (RAG), tool execution, and natural language command processing.</li>
<li><strong>Hyper-Pluggable Architecture</strong>: Almost every piece of functionality—from LLM providers and tools to data loaders and caching mechanisms—is a plugin. This allows you to easily swap, extend, or create custom components.</li>
<li><strong>Simplified Configuration</strong>: Utilize <code>FeatureSettings</code> within <code>MiddlewareConfig</code> for quick setup of common features, with the flexibility for detailed overrides.</li>
<li><strong>Async First</strong>: Built with <code>asyncio</code> for high-performance, I/O-bound operations common in AI applications.</li>
<li><strong><code>@tool</code> Decorator</strong>: Effortlessly convert your existing Python functions into Genie-compatible tools with automatic metadata and schema generation. By default, these tools are automatically enabled upon registration, but it is strongly recommended to explicitly enable them via <code>tool_configurations</code> in production for enhanced security.</li>
</ul>
<h2 id="index-quick-start">Quick Start<a class="headerlink" href="#index-quick-start" title="Permanent link">&para;</a></h2>
<p>Get up and running quickly with the <code>Genie</code> facade:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#index-__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#index-__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#index-__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiddlewareConfig</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#index-__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureSettings</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#index-__codelineno-0-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.genie</span><span class="w"> </span><span class="kn">import</span> <span class="n">Genie</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#index-__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#index-__codelineno-0-7"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#index-__codelineno-0-8"></a>    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#index-__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#index-__codelineno-0-10"></a>    <span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#index-__codelineno-0-11"></a>        <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#index-__codelineno-0-12"></a>            <span class="n">llm</span><span class="o">=</span><span class="s2">&quot;ollama&quot;</span><span class="p">,</span> <span class="c1"># Default: ollama, ensure it&#39;s running</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#index-__codelineno-0-13"></a>            <span class="n">llm_ollama_model_name</span><span class="o">=</span><span class="s2">&quot;mistral:latest&quot;</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#index-__codelineno-0-14"></a>            <span class="n">command_processor</span><span class="o">=</span><span class="s2">&quot;llm_assisted&quot;</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#index-__codelineno-0-15"></a>            <span class="n">tool_lookup</span><span class="o">=</span><span class="s2">&quot;embedding&quot;</span> 
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#index-__codelineno-0-16"></a>        <span class="p">),</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#index-__codelineno-0-17"></a>        <span class="c1"># Explicitly enable the built-in calculator tool.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#index-__codelineno-0-18"></a>        <span class="c1"># If auto_enable_registered_tools=False, any custom @tool</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#index-__codelineno-0-19"></a>        <span class="c1"># would also need to be listed here after registration.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#index-__codelineno-0-20"></a>        <span class="n">tool_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#index-__codelineno-0-21"></a>            <span class="s2">&quot;calculator_tool&quot;</span><span class="p">:</span> <span class="p">{}</span> 
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#index-__codelineno-0-22"></a>        <span class="p">}</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#index-__codelineno-0-23"></a>    <span class="p">)</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#index-__codelineno-0-24"></a>    <span class="n">genie</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Genie</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">app_config</span><span class="p">)</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#index-__codelineno-0-25"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Genie initialized!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#index-__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#index-__codelineno-0-27"></a>    <span class="c1"># LLM Chat</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#index-__codelineno-0-28"></a>    <span class="n">chat_response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">llm</span><span class="o">.</span><span class="n">chat</span><span class="p">([{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Tell me about Genie Tooling.&quot;</span><span class="p">}])</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#index-__codelineno-0-29"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LLM: </span><span class="si">{</span><span class="n">chat_response</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;content&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#index-__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#index-__codelineno-0-31"></a>    <span class="c1"># Command Execution (e.g., calculator tool is built-in)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#index-__codelineno-0-32"></a>    <span class="n">cmd_result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">run_command</span><span class="p">(</span><span class="s2">&quot;What is 5 times 12?&quot;</span><span class="p">)</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#index-__codelineno-0-33"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Command Result: </span><span class="si">{</span><span class="n">cmd_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tool_result&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#index-__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#index-__codelineno-0-35"></a>    <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#index-__codelineno-0-36"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Genie torn down.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#index-__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#index-__codelineno-0-38"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#index-__codelineno-0-39"></a>    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</code></pre></div>
<h2 id="index-dive-deeper">Dive Deeper<a class="headerlink" href="#index-dive-deeper" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>User Guide</strong>: Learn how to install, configure, and use Genie Tooling for your projects.<ul>
<li><a href="#guides-installation">Installation</a></li>
<li><a href="#guides-configuration">Configuration</a> &amp; <a href="#guides-simplified_configuration">Simplified Configuration</a></li>
<li><a href="#guides-using_llm_providers">Using LLM Providers</a></li>
<li><a href="#guides-using_tools">Using Tools</a></li>
<li><a href="#guides-using_rag">Using RAG</a></li>
<li><a href="#guides-using_command_processors">Using Command Processors</a></li>
<li><a href="#guides-tool_lookup">Tool Lookup</a></li>
<li><a href="#guides-logging">Logging</a></li>
<li><a href="#guides-using_prompts">Prompt Management</a></li>
<li><a href="#guides-using_conversation_state">Conversation State</a></li>
<li><a href="#guides-observability_tracing">Observability &amp; Tracing</a></li>
<li><a href="#guides-using_human_in_loop">Human-in-the-Loop (HITL)</a></li>
<li><a href="#guides-token_usage_tracking">Token Usage Tracking</a></li>
<li><a href="#guides-using_guardrails">Guardrails</a></li>
<li><a href="#guides-distributed_tasks">Distributed Tasks</a></li>
</ul>
</li>
<li><strong>Developer Guide</strong>: Understand the plugin architecture and learn how to create your own custom plugins and tools.<ul>
<li><a href="#guides-plugin_architecture">Plugin Architecture</a></li>
<li><a href="#guides-creating_tool_plugins">Creating Tool Plugins</a></li>
<li><a href="#guides-creating_rag_plugins">Creating RAG Plugins</a></li>
<li><a href="#guides-creating_other_plugins">Creating Other Plugins</a></li>
</ul>
</li>
<li><strong>API Reference</strong>: Detailed reference for all public modules and classes.</li>
<li><strong>Tutorials &amp; Examples</strong>: Step-by-step guides and practical examples to get you started.</li>
</ul>
<p>We encourage you to explore the documentation and examples to unlock the full potential of Genie Tooling!</p></section><section class="print-page" id="guides-installation" heading-number="1.2"><h1 id="guides-installation-installation">Installation<a class="headerlink" href="#guides-installation-installation" title="Permanent link">&para;</a></h1>
<p>This guide explains how to install Genie Tooling and its dependencies.</p>
<h2 id="guides-installation-prerequisites">Prerequisites<a class="headerlink" href="#guides-installation-prerequisites" title="Permanent link">&para;</a></h2>
<ul>
<li>Python 3.10 or higher.</li>
<li><a href="https://python-poetry.org/docs/#installation">Poetry</a> for dependency management and packaging.</li>
</ul>
<h2 id="guides-installation-installation-steps">Installation Steps<a class="headerlink" href="#guides-installation-installation-steps" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Clone the Repository (Optional, if contributing or running examples locally):</strong>
    If you want to work with the source code or run the examples directly from the repository:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-installation-__codelineno-0-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/genie-tooling/genie-tooling.git
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-installation-__codelineno-0-2"></a><span class="nb">cd</span><span class="w"> </span>genie-tooling
</code></pre></div></p>
</li>
<li>
<p><strong>Install using Poetry:</strong></p>
<ul>
<li>
<p><strong>To install the core library and all optional dependencies (recommended for full functionality and running all examples):</strong>
    Navigate to the cloned repository directory (if applicable) or where your project that depends on Genie Tooling is located.
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-installation-__codelineno-1-1"></a>poetry<span class="w"> </span>install<span class="w"> </span>--all-extras
</code></pre></div></p>
</li>
<li>
<p><strong>To install only the core library dependencies:</strong>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#guides-installation-__codelineno-2-1"></a>poetry<span class="w"> </span>install
</code></pre></div>
    This will install the essential components of Genie Tooling. Some plugins requiring external libraries (e.g., specific LLM providers, vector stores, or tools) will not be functional unless their respective optional dependencies are installed.</p>
</li>
<li>
<p><strong>To install specific optional dependencies (extras):</strong>
    You can install only the extras you need. Extras are defined in the <code>pyproject.toml</code> file.
    For example, to install support for Ollama, OpenAI, Qdrant, Celery, and the internal Llama.cpp provider:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#guides-installation-__codelineno-3-1"></a>poetry<span class="w"> </span>install<span class="w"> </span>--extras<span class="w"> </span><span class="s2">&quot;ollama openai qdrant celery llama_cpp_internal&quot;</span>
</code></pre></div>
    Common extras include:</p>
<ul>
<li><code>web_tools</code>: For tools that interact with web pages (e.g., <code>WebPageLoader</code>, <code>GoogleSearchTool</code>).</li>
<li><code>openai_services</code>: For the OpenAI LLM provider and embedding generator.</li>
<li><code>local_rag</code>: For local RAG components like Sentence Transformers and FAISS.</li>
<li><code>distributed_rag</code>: For distributed RAG components like ChromaDB and Qdrant clients.</li>
<li><code>ollama</code>: For the Ollama LLM provider.</li>
<li><code>gemini</code>: For the Google Gemini LLM provider.</li>
<li><code>secure_exec</code>: For the <code>SecureDockerExecutor</code>.</li>
<li><code>observability</code>: For OpenTelemetry tracing and metrics.</li>
<li><code>prompts</code>: For advanced prompt templating engines like Jinja2.</li>
<li><code>task_queues</code>: For distributed task queue support (Celery, RQ).</li>
<li><code>llama_cpp_server</code>: For the Llama.cpp server-based LLM provider.</li>
<li><code>llama_cpp_internal</code>: For the Llama.cpp internal (direct library use) LLM provider.</li>
</ul>
</li>
<li>
<p><strong>Adding Genie Tooling as a dependency to your existing project:</strong>
    If you are integrating Genie Tooling into your own Poetry-managed project, you can add it:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#guides-installation-__codelineno-4-1"></a>poetry<span class="w"> </span>add<span class="w"> </span>genie-tooling<span class="w"> </span><span class="c1"># For the core library</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#guides-installation-__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#guides-installation-__codelineno-4-3"></a><span class="c1"># To add with specific extras:</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#guides-installation-__codelineno-4-4"></a>poetry<span class="w"> </span>add<span class="w"> </span>genie-tooling<span class="w"> </span>-E<span class="w"> </span>ollama<span class="w"> </span>-E<span class="w"> </span>local_rag<span class="w"> </span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#guides-installation-__codelineno-4-5"></a><span class="c1"># or</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#guides-installation-__codelineno-4-6"></a>poetry<span class="w"> </span>add<span class="w"> </span>genie-tooling<span class="o">[</span>ollama,local_rag<span class="o">]</span>
</code></pre></div></p>
</li>
</ul>
</li>
</ol>
<h2 id="guides-installation-verifying-installation">Verifying Installation<a class="headerlink" href="#guides-installation-verifying-installation" title="Permanent link">&para;</a></h2>
<p>After installation, you can try running one of the examples, such as the simple Ollama chat example (ensure Ollama is running):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#guides-installation-__codelineno-5-1"></a><span class="c1"># From the root of the genie-tooling repository if cloned:</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#guides-installation-__codelineno-5-2"></a>poetry<span class="w"> </span>run<span class="w"> </span>python<span class="w"> </span>examples/E02_ollama_chat_example.py<span class="w"> </span>
</code></pre></div>
<p>If the example runs without import errors and interacts with Ollama successfully, your basic installation is working.</p></section><section class="print-page" id="guides-configuration" heading-number="1.3"><h1 id="guides-configuration-configuration">Configuration<a class="headerlink" href="#guides-configuration-configuration" title="Permanent link">&para;</a></h1>
<p>Genie Tooling is configured at runtime using a <code>MiddlewareConfig</code> object. For ease of use, especially for common setups, <code>MiddlewareConfig</code> integrates a <code>FeatureSettings</code> model.</p>
<h2 id="guides-configuration-simplified-configuration-with-featuresettings">Simplified Configuration with <code>FeatureSettings</code><a class="headerlink" href="#guides-configuration-simplified-configuration-with-featuresettings" title="Permanent link">&para;</a></h2>
<p>The recommended way to start configuring Genie is by using the <code>features</code> attribute of <code>MiddlewareConfig</code>. <code>FeatureSettings</code> provides high-level toggles and default choices for major components like LLM providers, RAG components, caching, tool lookup, logging adapter, observability, HITL, token usage, guardrails, prompt system, conversation state, and distributed task queues.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-configuration-__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiddlewareConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-configuration-__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureSettings</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#guides-configuration-__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#guides-configuration-__codelineno-0-4"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#guides-configuration-__codelineno-0-5"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#guides-configuration-__codelineno-0-6"></a>        <span class="n">llm</span><span class="o">=</span><span class="s2">&quot;ollama&quot;</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#guides-configuration-__codelineno-0-7"></a>        <span class="n">command_processor</span><span class="o">=</span><span class="s2">&quot;llm_assisted&quot;</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#guides-configuration-__codelineno-0-8"></a>        <span class="c1"># ... other features ...</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#guides-configuration-__codelineno-0-9"></a>    <span class="p">),</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#guides-configuration-__codelineno-0-10"></a>    <span class="c1"># Even in automatic mode, class-based tools often need to be enabled.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#guides-configuration-__codelineno-0-11"></a>    <span class="c1"># Tools requiring specific config must always be listed.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#guides-configuration-__codelineno-0-12"></a>    <span class="n">tool_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#guides-configuration-__codelineno-0-13"></a>        <span class="s2">&quot;sandboxed_fs_tool_v1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;sandbox_base_path&quot;</span><span class="p">:</span> <span class="s2">&quot;./my_agent_workspace&quot;</span><span class="p">}</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#guides-configuration-__codelineno-0-14"></a>    <span class="p">}</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#guides-configuration-__codelineno-0-15"></a><span class="p">)</span>
</code></pre></div>
<h3 id="guides-configuration-how-featuresettings-works">How <code>FeatureSettings</code> Works<a class="headerlink" href="#guides-configuration-how-featuresettings-works" title="Permanent link">&para;</a></h3>
<p>When you initialize <code>Genie</code> with a <code>MiddlewareConfig</code> containing <code>FeatureSettings</code>, an internal <code>ConfigResolver</code> processes these settings. It translates your high-level choices into specific plugin IDs and default configurations for those plugins.</p>
<p>For a full list of available aliases and more details on simplified configuration, please see the <a href="#guides-simplified_configuration">Simplified Configuration Guide</a>.</p>
<h2 id="guides-configuration-explicit-overrides-and-detailed-configuration">Explicit Overrides and Detailed Configuration<a class="headerlink" href="#guides-configuration-explicit-overrides-and-detailed-configuration" title="Permanent link">&para;</a></h2>
<p>While <code>FeatureSettings</code> provides a convenient starting point, you can always provide more detailed, explicit configurations that will override or augment the settings derived from features.</p>
<h3 id="guides-configuration-the-auto_enable_registered_tools-flag">The <code>auto_enable_registered_tools</code> Flag<a class="headerlink" href="#guides-configuration-the-auto_enable_registered_tools-flag" title="Permanent link">&para;</a></h3>
<p><code>MiddlewareConfig</code> includes a crucial flag for managing tool enablement:</p>
<ul>
<li><strong><code>auto_enable_registered_tools: bool</code></strong><ul>
<li><strong>Default</strong>: <code>True</code></li>
<li><strong>Behavior</strong>:<ul>
<li>When <code>True</code>, any tool registered via <code>@tool</code> and <code>genie.register_tool_functions()</code> is <strong>automatically enabled</strong> and ready for use. This is convenient for development and rapid prototyping.</li>
<li>When <code>False</code>, a tool is only active if its identifier is explicitly listed as a key in the <code>tool_configurations</code> dictionary.</li>
</ul>
</li>
<li><strong>Recommendation</strong>: For production environments, it is <strong>strongly recommended to set this to <code>False</code></strong> to maintain a clear, secure manifest of the agent's capabilities.</li>
</ul>
</li>
</ul>
<h3 id="guides-configuration-configuring-specific-plugins">Configuring Specific Plugins<a class="headerlink" href="#guides-configuration-configuring-specific-plugins" title="Permanent link">&para;</a></h3>
<p>You can provide specific configurations for individual plugins using the various <code>*_configurations</code> dictionaries in <code>MiddlewareConfig</code>. These dictionaries are keyed by the <strong>canonical plugin ID</strong> or a recognized alias.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-configuration-__codelineno-1-1"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#guides-configuration-__codelineno-1-2"></a>    <span class="n">auto_enable_registered_tools</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1"># Production-safe setting</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#guides-configuration-__codelineno-1-3"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#guides-configuration-__codelineno-1-4"></a>        <span class="n">llm</span><span class="o">=</span><span class="s2">&quot;openai&quot;</span><span class="p">,</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#guides-configuration-__codelineno-1-5"></a>        <span class="n">llm_openai_model_name</span><span class="o">=</span><span class="s2">&quot;gpt-3.5-turbo&quot;</span><span class="p">,</span> 
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#guides-configuration-__codelineno-1-6"></a>    <span class="p">),</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#guides-configuration-__codelineno-1-7"></a>    <span class="c1"># Override configuration for the OpenAI LLM provider</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#guides-configuration-__codelineno-1-8"></a>    <span class="n">llm_provider_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#guides-configuration-__codelineno-1-9"></a>        <span class="s2">&quot;openai_llm_provider_v1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># Canonical ID</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#guides-configuration-__codelineno-1-10"></a>            <span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="s2">&quot;gpt-4-turbo-preview&quot;</span><span class="p">,</span> 
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#guides-configuration-__codelineno-1-11"></a>            <span class="s2">&quot;request_timeout_seconds&quot;</span><span class="p">:</span> <span class="mi">120</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#guides-configuration-__codelineno-1-12"></a>        <span class="p">}</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#guides-configuration-__codelineno-1-13"></a>    <span class="p">},</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#guides-configuration-__codelineno-1-14"></a>    <span class="c1"># Explicitly enable and configure tools</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#guides-configuration-__codelineno-1-15"></a>    <span class="n">tool_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#guides-configuration-__codelineno-1-16"></a>        <span class="s2">&quot;calculator_tool&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="c1"># Enable calculator</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#guides-configuration-__codelineno-1-17"></a>        <span class="s2">&quot;sandboxed_fs_tool_v1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;sandbox_base_path&quot;</span><span class="p">:</span> <span class="s2">&quot;./agent_workspace&quot;</span><span class="p">}</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#guides-configuration-__codelineno-1-18"></a>    <span class="p">},</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#guides-configuration-__codelineno-1-19"></a>    <span class="c1"># ... other specific configurations ...</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#guides-configuration-__codelineno-1-20"></a><span class="p">)</span>
</code></pre></div>
<p><strong>Key Points for Explicit Configuration:</strong></p>
<ul>
<li><strong>Precedence</strong>: Explicit configurations in <code>default_*_id</code> fields or within the <code>*_configurations</code> dictionaries take precedence over settings derived from <code>FeatureSettings</code>.</li>
<li><strong>Tool Enablement</strong>: A tool plugin's availability is controlled by <code>auto_enable_registered_tools</code> and the <code>tool_configurations</code> dictionary.</li>
<li><strong>Canonical IDs vs. Aliases</strong>: You can use either the canonical plugin ID (e.g., <code>"ollama_llm_provider_v1"</code>) or a recognized alias (e.g., <code>"ollama"</code>) as keys in configuration dictionaries.</li>
</ul>
<h2 id="guides-configuration-plugin-development-directories">Plugin Development Directories<a class="headerlink" href="#guides-configuration-plugin-development-directories" title="Permanent link">&para;</a></h2>
<p>If you have custom plugins located outside your main Python path or not installed as entry points, you can specify their location:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#guides-configuration-__codelineno-2-1"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#guides-configuration-__codelineno-2-2"></a>    <span class="n">plugin_dev_dirs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;/path/to/my/custom_plugins&quot;</span><span class="p">,</span> <span class="s2">&quot;./project_plugins&quot;</span><span class="p">]</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#guides-configuration-__codelineno-2-3"></a><span class="p">)</span>
</code></pre></div>
The <code>PluginManager</code> will scan these directories for valid plugin classes.</p></section><section class="print-page" id="guides-simplified_configuration" heading-number="1.4"><h1 id="guides-simplified_configuration-simplified-configuration-with-featuresettings-and-aliases">Simplified Configuration with FeatureSettings and Aliases<a class="headerlink" href="#guides-simplified_configuration-simplified-configuration-with-featuresettings-and-aliases" title="Permanent link">&para;</a></h1>
<p>Genie Tooling aims to make common configurations straightforward through <code>FeatureSettings</code> and a system of plugin ID aliases. This guide explains these concepts in detail.</p>
<h2 id="guides-simplified_configuration-featuresettings"><code>FeatureSettings</code><a class="headerlink" href="#guides-simplified_configuration-featuresettings" title="Permanent link">&para;</a></h2>
<p>The <code>FeatureSettings</code> model, part of <code>MiddlewareConfig</code>, provides high-level toggles for major functionalities. When you use <code>Genie.create(config=MiddlewareConfig(features=...))</code>, the internal <code>ConfigResolver</code> uses these settings to:</p>
<ol>
<li>Set default plugin IDs for various components (e.g., <code>default_llm_provider_id</code>, <code>default_rag_embedder_id</code>, <code>default_log_adapter_id</code>).</li>
<li>Populate basic configurations for these default plugins in the respective <code>*_configurations</code> dictionaries (e.g., setting the model name for the chosen LLM provider, or service name for Pyvider log adapter).</li>
</ol>
<p><strong>Example of <code>FeatureSettings</code>:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-simplified_configuration-__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureSettings</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-simplified_configuration-__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#guides-simplified_configuration-__codelineno-0-3"></a><span class="n">features</span> <span class="o">=</span> <span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#guides-simplified_configuration-__codelineno-0-4"></a>    <span class="c1"># LLM Provider</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#guides-simplified_configuration-__codelineno-0-5"></a>    <span class="n">llm</span><span class="o">=</span><span class="s2">&quot;ollama&quot;</span><span class="p">,</span>                             <span class="c1"># Chooses OllamaLLMProviderPlugin</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#guides-simplified_configuration-__codelineno-0-6"></a>    <span class="n">llm_ollama_model_name</span><span class="o">=</span><span class="s2">&quot;mistral:7b-instruct-q4_K_M&quot;</span><span class="p">,</span> <span class="c1"># Sets model for Ollama</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#guides-simplified_configuration-__codelineno-0-7"></a>    <span class="c1"># Or for Llama.cpp Internal:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#guides-simplified_configuration-__codelineno-0-8"></a>    <span class="c1"># llm=&quot;llama_cpp_internal&quot;,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#guides-simplified_configuration-__codelineno-0-9"></a>    <span class="c1"># llm_llama_cpp_internal_model_path=&quot;/path/to/your/model.gguf&quot;,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#guides-simplified_configuration-__codelineno-0-10"></a>    <span class="c1"># llm_llama_cpp_internal_n_gpu_layers=-1,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#guides-simplified_configuration-__codelineno-0-11"></a>    <span class="c1"># llm_llama_cpp_internal_chat_format=&quot;mistral&quot;,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#guides-simplified_configuration-__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#guides-simplified_configuration-__codelineno-0-13"></a>    <span class="c1"># Command Processing</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#guides-simplified_configuration-__codelineno-0-14"></a>    <span class="n">command_processor</span><span class="o">=</span><span class="s2">&quot;llm_assisted&quot;</span><span class="p">,</span>         <span class="c1"># Chooses LLMAssistedToolSelectionProcessorPlugin</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#guides-simplified_configuration-__codelineno-0-15"></a>    <span class="n">command_processor_formatter_id_alias</span><span class="o">=</span><span class="s2">&quot;compact_text_formatter&quot;</span><span class="p">,</span> <span class="c1"># Formatter for LLM prompt</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#guides-simplified_configuration-__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#guides-simplified_configuration-__codelineno-0-17"></a>    <span class="c1"># Tool Lookup</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#guides-simplified_configuration-__codelineno-0-18"></a>    <span class="n">tool_lookup</span><span class="o">=</span><span class="s2">&quot;hybrid&quot;</span><span class="p">,</span>                  <span class="c1"># Uses HybridSearchLookupProvider (Recommended)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#guides-simplified_configuration-__codelineno-0-19"></a>    <span class="n">tool_lookup_embedder_id_alias</span><span class="o">=</span><span class="s2">&quot;st_embedder&quot;</span><span class="p">,</span> <span class="c1"># Embedder for tool lookup</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#guides-simplified_configuration-__codelineno-0-20"></a>    <span class="n">tool_lookup_formatter_id_alias</span><span class="o">=</span><span class="s2">&quot;compact_text_formatter&quot;</span><span class="p">,</span> <span class="c1"># Formatter for tool indexing</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#guides-simplified_configuration-__codelineno-0-21"></a>    <span class="c1"># tool_lookup_chroma_path=&quot;./my_tool_lookup_db&quot;, # Optional: Use ChromaDB for tool lookup embeddings</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#guides-simplified_configuration-__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#guides-simplified_configuration-__codelineno-0-23"></a>    <span class="c1"># RAG</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#guides-simplified_configuration-__codelineno-0-24"></a>    <span class="n">rag_embedder</span><span class="o">=</span><span class="s2">&quot;openai&quot;</span><span class="p">,</span>                    <span class="c1"># Uses OpenAIEmbeddingGenerator for RAG</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#guides-simplified_configuration-__codelineno-0-25"></a>    <span class="n">rag_vector_store</span><span class="o">=</span><span class="s2">&quot;chroma&quot;</span><span class="p">,</span>                <span class="c1"># Uses ChromaDBVectorStore for RAG</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#guides-simplified_configuration-__codelineno-0-26"></a>    <span class="n">rag_vector_store_chroma_path</span><span class="o">=</span><span class="s2">&quot;./my_rag_vector_db&quot;</span><span class="p">,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#guides-simplified_configuration-__codelineno-0-27"></a>    <span class="n">rag_vector_store_chroma_collection_name</span><span class="o">=</span><span class="s2">&quot;main_rag_docs&quot;</span><span class="p">,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#guides-simplified_configuration-__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#guides-simplified_configuration-__codelineno-0-29"></a>    <span class="c1"># Caching</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#guides-simplified_configuration-__codelineno-0-30"></a>    <span class="n">cache</span><span class="o">=</span><span class="s2">&quot;redis&quot;</span><span class="p">,</span>                            <span class="c1"># Uses RedisCacheProvider</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#guides-simplified_configuration-__codelineno-0-31"></a>    <span class="n">cache_redis_url</span><span class="o">=</span><span class="s2">&quot;redis://localhost:6379/1&quot;</span><span class="p">,</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#guides-simplified_configuration-__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#guides-simplified_configuration-__codelineno-0-33"></a>    <span class="c1"># Logging Adapter (NEW)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#guides-simplified_configuration-__codelineno-0-34"></a>    <span class="n">logging_adapter</span><span class="o">=</span><span class="s2">&quot;pyvider_log_adapter&quot;</span><span class="p">,</span>      <span class="c1"># Use Pyvider Telemetry</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#guides-simplified_configuration-__codelineno-0-35"></a>    <span class="n">logging_pyvider_service_name</span><span class="o">=</span><span class="s2">&quot;my-genie-service&quot;</span><span class="p">,</span> <span class="c1"># Service name for Pyvider</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#guides-simplified_configuration-__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#guides-simplified_configuration-__codelineno-0-37"></a>    <span class="c1"># Observability &amp; Monitoring</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#guides-simplified_configuration-__codelineno-0-38"></a>    <span class="n">observability_tracer</span><span class="o">=</span><span class="s2">&quot;otel_tracer&quot;</span><span class="p">,</span>       <span class="c1"># Use OpenTelemetry for traces</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#guides-simplified_configuration-__codelineno-0-39"></a>    <span class="n">observability_otel_endpoint</span><span class="o">=</span><span class="s2">&quot;http://localhost:4318/v1/traces&quot;</span><span class="p">,</span> <span class="c1"># OTLP/HTTP endpoint</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#guides-simplified_configuration-__codelineno-0-40"></a>    <span class="n">token_usage_recorder</span><span class="o">=</span><span class="s2">&quot;otel_metrics_recorder&quot;</span><span class="p">,</span> <span class="c1"># Use OpenTelemetry for token metrics</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#guides-simplified_configuration-__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#guides-simplified_configuration-__codelineno-0-42"></a>    <span class="c1"># Human-in-the-Loop</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#guides-simplified_configuration-__codelineno-0-43"></a>    <span class="n">hitl_approver</span><span class="o">=</span><span class="s2">&quot;cli_hitl_approver&quot;</span><span class="p">,</span>        <span class="c1"># Use CLI for approvals</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#guides-simplified_configuration-__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#guides-simplified_configuration-__codelineno-0-45"></a>    <span class="c1"># Guardrails</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#guides-simplified_configuration-__codelineno-0-46"></a>    <span class="n">input_guardrails</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;keyword_blocklist_guardrail&quot;</span><span class="p">],</span> <span class="c1"># List of guardrail aliases/IDs</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#guides-simplified_configuration-__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#guides-simplified_configuration-__codelineno-0-48"></a>    <span class="c1"># Prompt System &amp; Conversation</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#guides-simplified_configuration-__codelineno-0-49"></a>    <span class="n">prompt_registry</span><span class="o">=</span><span class="s2">&quot;file_system_prompt_registry&quot;</span><span class="p">,</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#guides-simplified_configuration-__codelineno-0-50"></a>    <span class="n">prompt_template_engine</span><span class="o">=</span><span class="s2">&quot;jinja2_chat_formatter&quot;</span><span class="p">,</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#guides-simplified_configuration-__codelineno-0-51"></a>    <span class="n">conversation_state_provider</span><span class="o">=</span><span class="s2">&quot;in_memory_convo_provider&quot;</span><span class="p">,</span>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#guides-simplified_configuration-__codelineno-0-52"></a>    <span class="n">default_llm_output_parser</span><span class="o">=</span><span class="s2">&quot;pydantic_output_parser&quot;</span><span class="p">,</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#guides-simplified_configuration-__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#guides-simplified_configuration-__codelineno-0-54"></a>    <span class="c1"># Distributed Tasks</span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#guides-simplified_configuration-__codelineno-0-55"></a>    <span class="n">task_queue</span><span class="o">=</span><span class="s2">&quot;celery&quot;</span><span class="p">,</span>                      <span class="c1"># Use Celery</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#guides-simplified_configuration-__codelineno-0-56"></a>    <span class="n">task_queue_celery_broker_url</span><span class="o">=</span><span class="s2">&quot;redis://localhost:6379/3&quot;</span><span class="p">,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#guides-simplified_configuration-__codelineno-0-57"></a>    <span class="n">task_queue_celery_backend_url</span><span class="o">=</span><span class="s2">&quot;redis://localhost:6379/4&quot;</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#guides-simplified_configuration-__codelineno-0-58"></a>    <span class="c1"># Or for RQ:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#guides-simplified_configuration-__codelineno-0-59"></a>    <span class="c1"># task_queue=&quot;rq&quot;,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#guides-simplified_configuration-__codelineno-0-60"></a>    <span class="c1"># (RQ typically uses the same Redis for broker/backend, configured via redis_url in its plugin config)</span>
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#guides-simplified_configuration-__codelineno-0-61"></a><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62" href="#guides-simplified_configuration-__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63" href="#guides-simplified_configuration-__codelineno-0-63"></a><span class="c1"># This &#39;features&#39; object would be passed to MiddlewareConfig:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64" href="#guides-simplified_configuration-__codelineno-0-64"></a><span class="c1"># from genie_tooling.config.models import MiddlewareConfig</span>
<a id="__codelineno-0-65" name="__codelineno-0-65" href="#guides-simplified_configuration-__codelineno-0-65"></a><span class="c1"># app_config = MiddlewareConfig(features=features)</span>
</code></pre></div>
<h2 id="guides-simplified_configuration-plugin-id-aliases">Plugin ID Aliases<a class="headerlink" href="#guides-simplified_configuration-plugin-id-aliases" title="Permanent link">&para;</a></h2>
<p>To make <code>FeatureSettings</code> and explicit configurations more readable, Genie uses a system of aliases. The <code>ConfigResolver</code> maps these short aliases to their full, canonical plugin IDs.</p>
<p><strong>Commonly Used Aliases (Examples):</strong></p>
<ul>
<li><strong>LLM Providers:</strong><ul>
<li><code>"ollama"</code>: <code>"ollama_llm_provider_v1"</code></li>
<li><code>"openai"</code>: <code>"openai_llm_provider_v1"</code></li>
<li><code>"gemini"</code>: <code>"gemini_llm_provider_v1"</code></li>
<li><code>"llama_cpp"</code>: <code>"llama_cpp_llm_provider_v1"</code> (for server)</li>
<li><code>"llama_cpp_internal"</code>: <code>"llama_cpp_internal_llm_provider_v1"</code></li>
</ul>
</li>
<li><strong>Key Provider:</strong><ul>
<li><code>"env_keys"</code>: <code>"environment_key_provider_v1"</code> (Default if no KeyProvider instance/ID is given)</li>
</ul>
</li>
<li><strong>Caching Providers:</strong><ul>
<li><code>"in_memory_cache"</code>: <code>"in_memory_cache_provider_v1"</code></li>
<li><code>"redis_cache"</code>: <code>"redis_cache_provider_v1"</code></li>
</ul>
</li>
<li><strong>Embedding Generators (Embedders):</strong><ul>
<li><code>"st_embedder"</code>: <code>"sentence_transformer_embedder_v1"</code></li>
<li><code>"openai_embedder"</code>: <code>"openai_embedding_generator_v1"</code></li>
</ul>
</li>
<li><strong>Vector Stores:</strong><ul>
<li><code>"faiss_vs"</code>: <code>"faiss_vector_store_v1"</code></li>
<li><code>"chroma_vs"</code>: <code>"chromadb_vector_store_v1"</code></li>
<li><code>"qdrant_vs"</code>: <code>"qdrant_vector_store_v1"</code></li>
</ul>
</li>
<li><strong>Tool Lookup Providers:</strong><ul>
<li><code>"embedding_lookup"</code>: <code>"embedding_similarity_lookup_v1"</code></li>
<li><code>"keyword_lookup"</code>: <code>"keyword_match_lookup_v1"</code></li>
<li><code>"hybrid_lookup"</code>: <code>"hybrid_search_lookup_v1"</code></li>
</ul>
</li>
<li><strong>Definition Formatters:</strong><ul>
<li><code>"compact_text_formatter"</code>: <code>"compact_text_formatter_plugin_v1"</code></li>
<li><code>"openai_func_formatter"</code>: <code>"openai_function_formatter_plugin_v1"</code></li>
<li><code>"hr_json_formatter"</code>: <code>"human_readable_json_formatter_plugin_v1"</code></li>
</ul>
</li>
<li><strong>Command Processors:</strong><ul>
<li><code>"llm_assisted_cmd_proc"</code>: <code>"llm_assisted_tool_selection_processor_v1"</code></li>
<li><code>"simple_keyword_cmd_proc"</code>: <code>"simple_keyword_processor_v1"</code></li>
</ul>
</li>
<li><strong>Log Adapters (NEW):</strong><ul>
<li><code>"default_log_adapter"</code>: <code>"default_log_adapter_v1"</code></li>
<li><code>"pyvider_log_adapter"</code>: <code>"pyvider_telemetry_log_adapter_v1"</code></li>
</ul>
</li>
<li><strong>Observability &amp; Monitoring:</strong><ul>
<li><code>"console_tracer"</code>: <code>"console_tracer_plugin_v1"</code></li>
<li><code>"otel_tracer"</code>: <code>"otel_tracer_plugin_v1"</code></li>
<li><code>"in_memory_token_recorder"</code>: <code>"in_memory_token_usage_recorder_v1"</code></li>
<li><code>"otel_metrics_recorder"</code>: <code>"otel_metrics_token_recorder_v1"</code></li>
</ul>
</li>
<li><strong>HITL &amp; Guardrails:</strong><ul>
<li><code>"cli_hitl_approver"</code>: <code>"cli_approval_plugin_v1"</code></li>
<li><code>"keyword_blocklist_guardrail"</code>: <code>"keyword_blocklist_guardrail_v1"</code></li>
</ul>
</li>
<li><strong>Prompt System &amp; Conversation:</strong><ul>
<li><code>"file_system_prompt_registry"</code>: <code>"file_system_prompt_registry_v1"</code></li>
<li><code>"basic_string_formatter"</code>: <code>"basic_string_format_template_v1"</code></li>
<li><code>"jinja2_chat_formatter"</code>: <code>"jinja2_chat_template_v1"</code></li>
<li><code>"in_memory_convo_provider"</code>: <code>"in_memory_conversation_state_v1"</code></li>
<li><code>"redis_convo_provider"</code>: <code>"redis_conversation_state_v1"</code></li>
</ul>
</li>
<li><strong>LLM Output Parsers:</strong><ul>
<li><code>"json_output_parser"</code>: <code>"json_output_parser_v1"</code></li>
<li><code>"pydantic_output_parser"</code>: <code>"pydantic_output_parser_v1"</code></li>
</ul>
</li>
<li><strong>Task Queues:</strong><ul>
<li><code>"celery_task_queue"</code>: <code>"celery_task_queue_v1"</code></li>
<li><code>"rq_task_queue"</code>: <code>"redis_queue_task_plugin_v1"</code></li>
</ul>
</li>
</ul>
<p><em>(This list is not exhaustive. Refer to <code>src/genie_tooling/config/resolver.py</code> for the complete <code>PLUGIN_ID_ALIASES</code> dictionary.)</em></p>
<h2 id="guides-simplified_configuration-overriding-feature-derived-settings">Overriding Feature-Derived Settings<a class="headerlink" href="#guides-simplified_configuration-overriding-feature-derived-settings" title="Permanent link">&para;</a></h2>
<p>You can always provide more specific configurations that will take precedence over what <code>FeatureSettings</code> implies.</p>
<p><strong>1. Overriding Default Plugin IDs:</strong></p>
<p>If a feature sets a default (e.g., <code>features.llm = "openai"</code> sets <code>default_llm_provider_id</code> to <code>"openai_llm_provider_v1"</code>), you can override this directly:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-simplified_configuration-__codelineno-1-1"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#guides-simplified_configuration-__codelineno-1-2"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span><span class="n">llm</span><span class="o">=</span><span class="s2">&quot;openai&quot;</span><span class="p">,</span> <span class="n">logging_adapter</span><span class="o">=</span><span class="s2">&quot;default_log_adapter&quot;</span><span class="p">),</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#guides-simplified_configuration-__codelineno-1-3"></a>    <span class="n">default_llm_provider_id</span><span class="o">=</span><span class="s2">&quot;my_special_openai_provider_v3&quot;</span><span class="p">,</span> <span class="c1"># Explicit override</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#guides-simplified_configuration-__codelineno-1-4"></a>    <span class="n">default_log_adapter_id</span><span class="o">=</span><span class="s2">&quot;pyvider_telemetry_log_adapter_v1&quot;</span> <span class="c1"># Explicit override</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#guides-simplified_configuration-__codelineno-1-5"></a><span class="p">)</span>
</code></pre></div>
<p><strong>2. Overriding Plugin Configurations:</strong></p>
<p>Use the <code>*_configurations</code> dictionaries in <code>MiddlewareConfig</code> to provide settings for specific plugins. You can use either the canonical ID or an alias as the key.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#guides-simplified_configuration-__codelineno-2-1"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#guides-simplified_configuration-__codelineno-2-2"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#guides-simplified_configuration-__codelineno-2-3"></a>        <span class="n">llm</span><span class="o">=</span><span class="s2">&quot;ollama&quot;</span><span class="p">,</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#guides-simplified_configuration-__codelineno-2-4"></a>        <span class="n">llm_ollama_model_name</span><span class="o">=</span><span class="s2">&quot;mistral:latest&quot;</span><span class="p">,</span> <span class="c1"># Feature sets this model</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#guides-simplified_configuration-__codelineno-2-5"></a>        <span class="n">logging_adapter</span><span class="o">=</span><span class="s2">&quot;pyvider_log_adapter&quot;</span><span class="p">,</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#guides-simplified_configuration-__codelineno-2-6"></a>        <span class="n">logging_pyvider_service_name</span><span class="o">=</span><span class="s2">&quot;FeatureServiceName&quot;</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#guides-simplified_configuration-__codelineno-2-7"></a>    <span class="p">),</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#guides-simplified_configuration-__codelineno-2-8"></a>    <span class="n">llm_provider_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#guides-simplified_configuration-__codelineno-2-9"></a>        <span class="s2">&quot;ollama&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># Using alias &#39;ollama&#39;</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#guides-simplified_configuration-__codelineno-2-10"></a>            <span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="s2">&quot;llama3:8b-instruct-fp16&quot;</span><span class="p">,</span> <span class="c1"># Override the model</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#guides-simplified_configuration-__codelineno-2-11"></a>            <span class="s2">&quot;request_timeout_seconds&quot;</span><span class="p">:</span> <span class="mf">300.0</span><span class="p">,</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#guides-simplified_configuration-__codelineno-2-12"></a>            <span class="c1"># Other Ollama-specific settings</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#guides-simplified_configuration-__codelineno-2-13"></a>        <span class="p">}</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#guides-simplified_configuration-__codelineno-2-14"></a>    <span class="p">},</span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#guides-simplified_configuration-__codelineno-2-15"></a>    <span class="n">log_adapter_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#guides-simplified_configuration-__codelineno-2-16"></a>        <span class="s2">&quot;pyvider_telemetry_log_adapter_v1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># Using canonical ID</span>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#guides-simplified_configuration-__codelineno-2-17"></a>            <span class="s2">&quot;service_name&quot;</span><span class="p">:</span> <span class="s2">&quot;ExplicitPyviderServiceName&quot;</span><span class="p">,</span> <span class="c1"># Overrides feature setting</span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#guides-simplified_configuration-__codelineno-2-18"></a>            <span class="s2">&quot;default_level&quot;</span><span class="p">:</span> <span class="s2">&quot;DEBUG&quot;</span>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#guides-simplified_configuration-__codelineno-2-19"></a>        <span class="p">}</span>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#guides-simplified_configuration-__codelineno-2-20"></a>    <span class="p">}</span>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#guides-simplified_configuration-__codelineno-2-21"></a><span class="p">)</span>
</code></pre></div>
<p>In this example:
*   The default LLM is Ollama.
*   The <code>mistral:latest</code> model set by <code>FeatureSettings</code> for Ollama is overridden by <code>llama3:8b-instruct-fp16</code>.
*   The default Log Adapter is Pyvider.
*   The <code>service_name</code> for Pyvider set by <code>FeatureSettings</code> is overridden by the explicit configuration.</p>
<p>This layered approach (Features -&gt; Explicit Defaults -&gt; Explicit Plugin Configs) provides both ease of use for common cases and fine-grained control when needed.</p></section><section class="print-page" id="guides-using_llm_providers" heading-number="1.5"><h1 id="guides-using_llm_providers-using-llm-providers">Using LLM Providers<a class="headerlink" href="#guides-using_llm_providers-using-llm-providers" title="Permanent link">&para;</a></h1>
<p>Genie Tooling allows you to easily interact with various Large Language Models (LLMs) through a unified interface: <code>genie.llm</code>. This interface abstracts the specifics of different LLM provider APIs.</p>
<h2 id="guides-using_llm_providers-the-geniellm-interface">The <code>genie.llm</code> Interface<a class="headerlink" href="#guides-using_llm_providers-the-geniellm-interface" title="Permanent link">&para;</a></h2>
<p>Once you have a <code>Genie</code> instance, you can access LLM functionalities:</p>
<ul>
<li><strong><code>async genie.llm.generate(prompt: str, provider_id: Optional[str] = None, stream: bool = False, **kwargs) -&gt; Union[LLMCompletionResponse, AsyncIterable[LLMCompletionChunk]]</code></strong>:
    For text completion or generation tasks.<ul>
<li><code>prompt</code>: The input prompt string.</li>
<li><code>provider_id</code>: Optional. The ID of the LLM provider plugin to use. If <code>None</code>, the default LLM provider configured in <code>MiddlewareConfig</code> (via <code>features.llm</code> or <code>default_llm_provider_id</code>) is used.</li>
<li><code>stream</code>: Optional (default <code>False</code>). If <code>True</code>, returns an async iterable of <code>LLMCompletionChunk</code> objects.</li>
<li><code>**kwargs</code>: Additional provider-specific parameters (e.g., <code>temperature</code>, <code>max_tokens</code>, <code>model</code> to override the default for that provider, <code>output_schema</code> for structured output).</li>
</ul>
</li>
<li><strong><code>async genie.llm.chat(messages: List[ChatMessage], provider_id: Optional[str] = None, stream: bool = False, **kwargs) -&gt; Union[LLMChatResponse, AsyncIterable[LLMChatChunk]]</code></strong>:
    For conversational interactions.<ul>
<li><code>messages</code>: A list of <code>ChatMessage</code> dictionaries (see <a href="#guides-using_llm_providers-chatmessage-type">Types</a>).</li>
<li><code>provider_id</code>: Optional. The ID of the LLM provider plugin to use.</li>
<li><code>stream</code>: Optional (default <code>False</code>). If <code>True</code>, returns an async iterable of <code>LLMChatChunk</code> objects.</li>
<li><code>**kwargs</code>: Additional provider-specific parameters (e.g., <code>temperature</code>, <code>tools</code>, <code>tool_choice</code>, <code>output_schema</code> for structured output).</li>
</ul>
</li>
<li><strong><code>async genie.llm.parse_output(response: Union[LLMChatResponse, LLMCompletionResponse], parser_id: Optional[str] = None, schema: Optional[Any] = None) -&gt; ParsedOutput</code></strong>:
    Parses the text content from an LLM response (either <code>LLMChatResponse</code> or <code>LLMCompletionResponse</code>) using a configured <code>LLMOutputParserPlugin</code>.<ul>
<li><code>response</code>: The LLM response object.</li>
<li><code>parser_id</code>: Optional. The ID of the <code>LLMOutputParserPlugin</code> to use. If <code>None</code>, the default configured parser is used.</li>
<li><code>schema</code>: Optional. A schema (e.g., Pydantic model class, JSON schema dict) to guide parsing, if supported by the parser.</li>
<li>Returns the parsed data (e.g., a dictionary, a Pydantic model instance).</li>
<li>Raises <code>ValueError</code> if parsing fails or content cannot be extracted.</li>
</ul>
</li>
</ul>
<h2 id="guides-using_llm_providers-configuring-llm-providers">Configuring LLM Providers<a class="headerlink" href="#guides-using_llm_providers-configuring-llm-providers" title="Permanent link">&para;</a></h2>
<p>LLM providers are primarily configured using <code>FeatureSettings</code> in your <code>MiddlewareConfig</code>.</p>
<h3 id="guides-using_llm_providers-example-using-ollama">Example: Using Ollama<a class="headerlink" href="#guides-using_llm_providers-example-using-ollama" title="Permanent link">&para;</a></h3>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-using_llm_providers-__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiddlewareConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-using_llm_providers-__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureSettings</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#guides-using_llm_providers-__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.genie</span><span class="w"> </span><span class="kn">import</span> <span class="n">Genie</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#guides-using_llm_providers-__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.llm_providers.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChatMessage</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#guides-using_llm_providers-__codelineno-0-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#guides-using_llm_providers-__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#guides-using_llm_providers-__codelineno-0-7"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#guides-using_llm_providers-__codelineno-0-8"></a>    <span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#guides-using_llm_providers-__codelineno-0-9"></a>        <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#guides-using_llm_providers-__codelineno-0-10"></a>            <span class="n">llm</span><span class="o">=</span><span class="s2">&quot;ollama&quot;</span><span class="p">,</span>  <span class="c1"># Select Ollama as the default</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#guides-using_llm_providers-__codelineno-0-11"></a>            <span class="n">llm_ollama_model_name</span><span class="o">=</span><span class="s2">&quot;mistral:latest&quot;</span> <span class="c1"># Specify the model for Ollama</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#guides-using_llm_providers-__codelineno-0-12"></a>        <span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#guides-using_llm_providers-__codelineno-0-13"></a>    <span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#guides-using_llm_providers-__codelineno-0-14"></a>    <span class="n">genie</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Genie</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">app_config</span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#guides-using_llm_providers-__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#guides-using_llm_providers-__codelineno-0-16"></a>    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">llm</span><span class="o">.</span><span class="n">chat</span><span class="p">([{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Hi from Genie!&quot;</span><span class="p">}])</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#guides-using_llm_providers-__codelineno-0-17"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">][</span><span class="s1">&#39;content&#39;</span><span class="p">])</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#guides-using_llm_providers-__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#guides-using_llm_providers-__codelineno-0-19"></a>    <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#guides-using_llm_providers-__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#guides-using_llm_providers-__codelineno-0-21"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#guides-using_llm_providers-__codelineno-0-22"></a>    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</code></pre></div>
Ensure Ollama is running (<code>ollama serve</code>) and the specified model (<code>mistral:latest</code>) is pulled (<code>ollama pull mistral</code>).</p>
<h3 id="guides-using_llm_providers-example-using-openai">Example: Using OpenAI<a class="headerlink" href="#guides-using_llm_providers-example-using-openai" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-using_llm_providers-__codelineno-1-1"></a><span class="c1"># Requires OPENAI_API_KEY environment variable to be set.</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#guides-using_llm_providers-__codelineno-1-2"></a><span class="c1"># Genie&#39;s default EnvironmentKeyProvider will pick it up.</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#guides-using_llm_providers-__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#guides-using_llm_providers-__codelineno-1-4"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#guides-using_llm_providers-__codelineno-1-5"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#guides-using_llm_providers-__codelineno-1-6"></a>        <span class="n">llm</span><span class="o">=</span><span class="s2">&quot;openai&quot;</span><span class="p">,</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#guides-using_llm_providers-__codelineno-1-7"></a>        <span class="n">llm_openai_model_name</span><span class="o">=</span><span class="s2">&quot;gpt-3.5-turbo&quot;</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#guides-using_llm_providers-__codelineno-1-8"></a>    <span class="p">)</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#guides-using_llm_providers-__codelineno-1-9"></a><span class="p">)</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#guides-using_llm_providers-__codelineno-1-10"></a><span class="c1"># genie = await Genie.create(config=app_config)</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#guides-using_llm_providers-__codelineno-1-11"></a><span class="c1"># ... use genie.llm.chat or genie.llm.generate ...</span>
</code></pre></div>
<h3 id="guides-using_llm_providers-example-using-gemini">Example: Using Gemini<a class="headerlink" href="#guides-using_llm_providers-example-using-gemini" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#guides-using_llm_providers-__codelineno-2-1"></a><span class="c1"># Requires GOOGLE_API_KEY environment variable to be set.</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#guides-using_llm_providers-__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#guides-using_llm_providers-__codelineno-2-3"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#guides-using_llm_providers-__codelineno-2-4"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#guides-using_llm_providers-__codelineno-2-5"></a>        <span class="n">llm</span><span class="o">=</span><span class="s2">&quot;gemini&quot;</span><span class="p">,</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#guides-using_llm_providers-__codelineno-2-6"></a>        <span class="n">llm_gemini_model_name</span><span class="o">=</span><span class="s2">&quot;gemini-1.5-flash-latest&quot;</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#guides-using_llm_providers-__codelineno-2-7"></a>    <span class="p">)</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#guides-using_llm_providers-__codelineno-2-8"></a><span class="p">)</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#guides-using_llm_providers-__codelineno-2-9"></a><span class="c1"># genie = await Genie.create(config=app_config)</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#guides-using_llm_providers-__codelineno-2-10"></a><span class="c1"># ... use genie.llm.chat or genie.llm.generate ...</span>
</code></pre></div>
<h3 id="guides-using_llm_providers-example-using-llamacpp-server-mode">Example: Using Llama.cpp (Server Mode)<a class="headerlink" href="#guides-using_llm_providers-example-using-llamacpp-server-mode" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#guides-using_llm_providers-__codelineno-3-1"></a><span class="c1"># Assumes a Llama.cpp server is running at the specified URL.</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#guides-using_llm_providers-__codelineno-3-2"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#guides-using_llm_providers-__codelineno-3-3"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#guides-using_llm_providers-__codelineno-3-4"></a>        <span class="n">llm</span><span class="o">=</span><span class="s2">&quot;llama_cpp&quot;</span><span class="p">,</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#guides-using_llm_providers-__codelineno-3-5"></a>        <span class="n">llm_llama_cpp_model_name</span><span class="o">=</span><span class="s2">&quot;your-model-alias-on-server&quot;</span><span class="p">,</span> <span class="c1"># Alias/model server uses</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#guides-using_llm_providers-__codelineno-3-6"></a>        <span class="n">llm_llama_cpp_base_url</span><span class="o">=</span><span class="s2">&quot;http://localhost:8080&quot;</span> <span class="c1"># Default, adjust if needed</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#guides-using_llm_providers-__codelineno-3-7"></a>        <span class="c1"># llm_llama_cpp_api_key_name=&quot;MY_LLAMA_SERVER_KEY&quot; # If server requires API key</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#guides-using_llm_providers-__codelineno-3-8"></a>    <span class="p">)</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#guides-using_llm_providers-__codelineno-3-9"></a><span class="p">)</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#guides-using_llm_providers-__codelineno-3-10"></a><span class="c1"># genie = await Genie.create(config=app_config)</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#guides-using_llm_providers-__codelineno-3-11"></a><span class="c1"># ... use genie.llm.chat or genie.llm.generate ...</span>
</code></pre></div>
<h3 id="guides-using_llm_providers-example-using-llamacpp-internal-mode">Example: Using Llama.cpp (Internal Mode)<a class="headerlink" href="#guides-using_llm_providers-example-using-llamacpp-internal-mode" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#guides-using_llm_providers-__codelineno-4-1"></a><span class="c1"># Requires llama-cpp-python library and a GGUF model file.</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#guides-using_llm_providers-__codelineno-4-2"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#guides-using_llm_providers-__codelineno-4-3"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#guides-using_llm_providers-__codelineno-4-4"></a>        <span class="n">llm</span><span class="o">=</span><span class="s2">&quot;llama_cpp_internal&quot;</span><span class="p">,</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#guides-using_llm_providers-__codelineno-4-5"></a>        <span class="n">llm_llama_cpp_internal_model_path</span><span class="o">=</span><span class="s2">&quot;/path/to/your/model.gguf&quot;</span><span class="p">,</span> <span class="c1"># IMPORTANT: Set this path</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#guides-using_llm_providers-__codelineno-4-6"></a>        <span class="n">llm_llama_cpp_internal_n_gpu_layers</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># Offload all possible layers to GPU</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#guides-using_llm_providers-__codelineno-4-7"></a>        <span class="n">llm_llama_cpp_internal_n_ctx</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span>      <span class="c1"># Example context size</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#guides-using_llm_providers-__codelineno-4-8"></a>        <span class="n">llm_llama_cpp_internal_chat_format</span><span class="o">=</span><span class="s2">&quot;mistral&quot;</span> <span class="c1"># Or &quot;llama-2&quot;, &quot;chatml&quot;, etc.</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#guides-using_llm_providers-__codelineno-4-9"></a>    <span class="p">)</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#guides-using_llm_providers-__codelineno-4-10"></a><span class="p">)</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#guides-using_llm_providers-__codelineno-4-11"></a><span class="c1"># genie = await Genie.create(config=app_config)</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#guides-using_llm_providers-__codelineno-4-12"></a><span class="c1"># ... use genie.llm.chat or genie.llm.generate ...</span>
</code></pre></div>
<h3 id="guides-using_llm_providers-overriding-provider-settings">Overriding Provider Settings<a class="headerlink" href="#guides-using_llm_providers-overriding-provider-settings" title="Permanent link">&para;</a></h3>
<p>You can override settings for specific LLM providers using the <code>llm_provider_configurations</code> dictionary in <code>MiddlewareConfig</code>. Keys can be the canonical plugin ID or a recognized alias.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#guides-using_llm_providers-__codelineno-5-1"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#guides-using_llm_providers-__codelineno-5-2"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#guides-using_llm_providers-__codelineno-5-3"></a>        <span class="n">llm</span><span class="o">=</span><span class="s2">&quot;openai&quot;</span><span class="p">,</span> <span class="c1"># Default is OpenAI</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#guides-using_llm_providers-__codelineno-5-4"></a>        <span class="n">llm_openai_model_name</span><span class="o">=</span><span class="s2">&quot;gpt-3.5-turbo&quot;</span> <span class="c1"># Default model for OpenAI</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#guides-using_llm_providers-__codelineno-5-5"></a>    <span class="p">),</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#guides-using_llm_providers-__codelineno-5-6"></a>    <span class="n">llm_provider_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#guides-using_llm_providers-__codelineno-5-7"></a>        <span class="s2">&quot;openai_llm_provider_v1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># Canonical ID for OpenAI provider</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#guides-using_llm_providers-__codelineno-5-8"></a>            <span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="s2">&quot;gpt-4-turbo-preview&quot;</span><span class="p">,</span> <span class="c1"># Override the model for OpenAI</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#guides-using_llm_providers-__codelineno-5-9"></a>            <span class="s2">&quot;request_timeout_seconds&quot;</span><span class="p">:</span> <span class="mi">180</span> 
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#guides-using_llm_providers-__codelineno-5-10"></a>        <span class="p">},</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#guides-using_llm_providers-__codelineno-5-11"></a>        <span class="s2">&quot;ollama&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># Alias for Ollama provider</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#guides-using_llm_providers-__codelineno-5-12"></a>            <span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="s2">&quot;llama3:latest&quot;</span><span class="p">,</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#guides-using_llm_providers-__codelineno-5-13"></a>            <span class="s2">&quot;request_timeout_seconds&quot;</span><span class="p">:</span> <span class="mi">240</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#guides-using_llm_providers-__codelineno-5-14"></a>        <span class="p">},</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#guides-using_llm_providers-__codelineno-5-15"></a>        <span class="s2">&quot;llama_cpp_internal_llm_provider_v1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># Canonical ID for internal Llama.cpp</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#guides-using_llm_providers-__codelineno-5-16"></a>            <span class="s2">&quot;model_path&quot;</span><span class="p">:</span> <span class="s2">&quot;/another/model.gguf&quot;</span><span class="p">,</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#guides-using_llm_providers-__codelineno-5-17"></a>            <span class="s2">&quot;n_gpu_layers&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="c1"># CPU only for this specific override</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#guides-using_llm_providers-__codelineno-5-18"></a>            <span class="s2">&quot;chat_format&quot;</span><span class="p">:</span> <span class="s2">&quot;chatml&quot;</span><span class="p">,</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#guides-using_llm_providers-__codelineno-5-19"></a>            <span class="s2">&quot;model_name_for_logging&quot;</span><span class="p">:</span> <span class="s2">&quot;custom_internal_llama&quot;</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#guides-using_llm_providers-__codelineno-5-20"></a>        <span class="p">}</span>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#guides-using_llm_providers-__codelineno-5-21"></a>    <span class="p">}</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#guides-using_llm_providers-__codelineno-5-22"></a><span class="p">)</span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#guides-using_llm_providers-__codelineno-5-23"></a><span class="c1"># genie = await Genie.create(config=app_config)</span>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#guides-using_llm_providers-__codelineno-5-24"></a>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#guides-using_llm_providers-__codelineno-5-25"></a><span class="c1"># This will use OpenAI with gpt-4-turbo-preview</span>
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#guides-using_llm_providers-__codelineno-5-26"></a><span class="c1"># await genie.llm.chat([{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Hello OpenAI!&quot;}])</span>
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#guides-using_llm_providers-__codelineno-5-27"></a>
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#guides-using_llm_providers-__codelineno-5-28"></a><span class="c1"># This will use Ollama with llama3:latest</span>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#guides-using_llm_providers-__codelineno-5-29"></a><span class="c1"># await genie.llm.chat([{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Hello Ollama!&quot;}], provider_id=&quot;ollama&quot;)</span>
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#guides-using_llm_providers-__codelineno-5-30"></a>
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#guides-using_llm_providers-__codelineno-5-31"></a><span class="c1"># This will use the internal Llama.cpp provider with /another/model.gguf</span>
<a id="__codelineno-5-32" name="__codelineno-5-32" href="#guides-using_llm_providers-__codelineno-5-32"></a><span class="c1"># await genie.llm.generate(&quot;Test internal Llama.cpp&quot;, provider_id=&quot;llama_cpp_internal&quot;)</span>
</code></pre></div>
<h3 id="guides-using_llm_providers-api-keys-and-keyprovider">API Keys and <code>KeyProvider</code><a class="headerlink" href="#guides-using_llm_providers-api-keys-and-keyprovider" title="Permanent link">&para;</a></h3>
<p>LLM providers that require API keys (like OpenAI, Gemini, or a secured Llama.cpp server) will attempt to fetch them using the configured <code>KeyProvider</code>. By default, Genie uses <code>EnvironmentKeyProvider</code>, which reads keys from environment variables (e.g., <code>OPENAI_API_KEY</code>, <code>GOOGLE_API_KEY</code>). You can provide a custom <code>KeyProvider</code> instance to <code>Genie.create()</code> for more sophisticated key management. See the <a href="#guides-configuration">Configuration Guide</a> for details. The internal Llama.cpp provider does not use API keys managed via <code>KeyProvider</code>.</p>
<h2 id="guides-using_llm_providers-structured-output-gbnf-with-llamacpp-providers">Structured Output (GBNF with Llama.cpp Providers)<a class="headerlink" href="#guides-using_llm_providers-structured-output-gbnf-with-llamacpp-providers" title="Permanent link">&para;</a></h2>
<p>Both the Llama.cpp server provider (<code>llama_cpp_llm_provider_v1</code>) and the internal Llama.cpp provider (<code>llama_cpp_internal_llm_provider_v1</code>) support GBNF grammar for constrained, structured output. You can pass a Pydantic model class or a JSON schema dictionary to the <code>output_schema</code> parameter of <code>genie.llm.generate()</code> or <code>genie.llm.chat()</code>.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#guides-using_llm_providers-__codelineno-6-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#guides-using_llm_providers-__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#guides-using_llm_providers-__codelineno-6-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyData</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#guides-using_llm_providers-__codelineno-6-4"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#guides-using_llm_providers-__codelineno-6-5"></a>    <span class="n">value</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#guides-using_llm_providers-__codelineno-6-6"></a>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#guides-using_llm_providers-__codelineno-6-7"></a><span class="c1"># Assuming &#39;genie&#39; is configured with a Llama.cpp provider (server or internal)</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#guides-using_llm_providers-__codelineno-6-8"></a><span class="c1"># For Llama.cpp server, ensure it&#39;s started with GBNF support enabled.</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#guides-using_llm_providers-__codelineno-6-9"></a><span class="c1"># For Llama.cpp internal, ensure the model is GBNF-compatible.</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#guides-using_llm_providers-__codelineno-6-10"></a>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#guides-using_llm_providers-__codelineno-6-11"></a><span class="c1"># Using with generate:</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#guides-using_llm_providers-__codelineno-6-12"></a><span class="c1"># response_gen = await genie.llm.generate(</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#guides-using_llm_providers-__codelineno-6-13"></a><span class="c1">#     prompt=&quot;Extract name and value: Name is Alpha, Value is 10. Output JSON.&quot;,</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#guides-using_llm_providers-__codelineno-6-14"></a><span class="c1">#     output_schema=MyData,</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#guides-using_llm_providers-__codelineno-6-15"></a><span class="c1">#     # Llama.cpp server might need n_predict for GBNF with /v1/completions</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#guides-using_llm_providers-__codelineno-6-16"></a><span class="c1">#     # n_predict=256 </span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#guides-using_llm_providers-__codelineno-6-17"></a><span class="c1"># )</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#guides-using_llm_providers-__codelineno-6-18"></a><span class="c1"># if response_gen[&#39;text&#39;]:</span>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#guides-using_llm_providers-__codelineno-6-19"></a><span class="c1">#     parsed_gen = await genie.llm.parse_output(response_gen, schema=MyData)</span>
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#guides-using_llm_providers-__codelineno-6-20"></a>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#guides-using_llm_providers-__codelineno-6-21"></a><span class="c1"># Using with chat:</span>
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#guides-using_llm_providers-__codelineno-6-22"></a><span class="c1"># response_chat = await genie.llm.chat(</span>
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#guides-using_llm_providers-__codelineno-6-23"></a><span class="c1">#     messages=[{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;User: Name is Beta, Value is 20. Output JSON.&quot;}],</span>
<a id="__codelineno-6-24" name="__codelineno-6-24" href="#guides-using_llm_providers-__codelineno-6-24"></a><span class="c1">#     output_schema=MyData</span>
<a id="__codelineno-6-25" name="__codelineno-6-25" href="#guides-using_llm_providers-__codelineno-6-25"></a><span class="c1"># )</span>
<a id="__codelineno-6-26" name="__codelineno-6-26" href="#guides-using_llm_providers-__codelineno-6-26"></a><span class="c1"># if response_chat[&#39;message&#39;][&#39;content&#39;]:</span>
<a id="__codelineno-6-27" name="__codelineno-6-27" href="#guides-using_llm_providers-__codelineno-6-27"></a><span class="c1">#     parsed_chat = await genie.llm.parse_output(response_chat, schema=MyData)</span>
</code></pre></div>
The provider will attempt to convert the Pydantic model/JSON schema into a GBNF grammar string and pass it to the Llama.cpp backend. Ensure your prompt instructs the LLM to output JSON matching the schema.</p>
<h2 id="guides-using_llm_providers-parsing-llm-output">Parsing LLM Output<a class="headerlink" href="#guides-using_llm_providers-parsing-llm-output" title="Permanent link">&para;</a></h2>
<p>Often, you'll want an LLM to produce structured output (e.g., JSON). The <code>genie.llm.parse_output()</code> method helps with this.</p>
<p><strong>Example: Parsing JSON output</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#guides-using_llm_providers-__codelineno-7-1"></a><span class="c1"># Assuming &#39;genie&#39; is initialized and an LLM provider is configured.</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#guides-using_llm_providers-__codelineno-7-2"></a><span class="c1"># And a JSONOutputParserPlugin (json_output_parser_v1) is available.</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#guides-using_llm_providers-__codelineno-7-3"></a>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#guides-using_llm_providers-__codelineno-7-4"></a><span class="c1"># Configure default output parser (optional, can also specify per call)</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#guides-using_llm_providers-__codelineno-7-5"></a><span class="c1"># app_config = MiddlewareConfig(</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#guides-using_llm_providers-__codelineno-7-6"></a><span class="c1">#     features=FeatureSettings(llm=&quot;ollama&quot;, default_llm_output_parser=&quot;json_output_parser&quot;)</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#guides-using_llm_providers-__codelineno-7-7"></a><span class="c1"># )</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#guides-using_llm_providers-__codelineno-7-8"></a><span class="c1"># genie = await Genie.create(config=app_config)</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#guides-using_llm_providers-__codelineno-7-9"></a>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#guides-using_llm_providers-__codelineno-7-10"></a>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#guides-using_llm_providers-__codelineno-7-11"></a><span class="n">prompt_for_json</span> <span class="o">=</span> <span class="s2">&quot;Generate a JSON object with keys &#39;name&#39; and &#39;city&#39;.&quot;</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#guides-using_llm_providers-__codelineno-7-12"></a><span class="n">llm_response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">llm</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">prompt_for_json</span><span class="p">)</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#guides-using_llm_providers-__codelineno-7-13"></a><span class="c1"># llm_response[&#39;text&#39;] might be: &#39;Sure, here is the JSON: {&quot;name&quot;: &quot;Test User&quot;, &quot;city&quot;: &quot;Genieville&quot;}&#39;</span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#guides-using_llm_providers-__codelineno-7-14"></a>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#guides-using_llm_providers-__codelineno-7-15"></a><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#guides-using_llm_providers-__codelineno-7-16"></a>    <span class="c1"># Uses default parser if configured, or specify with parser_id=&quot;json_output_parser_v1&quot;</span>
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#guides-using_llm_providers-__codelineno-7-17"></a>    <span class="n">parsed_data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">llm</span><span class="o">.</span><span class="n">parse_output</span><span class="p">(</span><span class="n">llm_response</span><span class="p">)</span> 
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#guides-using_llm_providers-__codelineno-7-18"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parsed data: </span><span class="si">{</span><span class="n">parsed_data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#guides-using_llm_providers-__codelineno-7-19"></a>    <span class="c1"># Output: Parsed data: {&#39;name&#39;: &#39;Test User&#39;, &#39;city&#39;: &#39;Genieville&#39;}</span>
<a id="__codelineno-7-20" name="__codelineno-7-20" href="#guides-using_llm_providers-__codelineno-7-20"></a><span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-7-21" name="__codelineno-7-21" href="#guides-using_llm_providers-__codelineno-7-21"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to parse LLM output: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></p>
<p><strong>Example: Parsing into a Pydantic model</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#guides-using_llm_providers-__codelineno-8-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#guides-using_llm_providers-__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#guides-using_llm_providers-__codelineno-8-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">UserInfo</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#guides-using_llm_providers-__codelineno-8-4"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#guides-using_llm_providers-__codelineno-8-5"></a>    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#guides-using_llm_providers-__codelineno-8-6"></a>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#guides-using_llm_providers-__codelineno-8-7"></a><span class="c1"># Configure Pydantic parser (pydantic_output_parser_v1)</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#guides-using_llm_providers-__codelineno-8-8"></a><span class="c1"># app_config = MiddlewareConfig(</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#guides-using_llm_providers-__codelineno-8-9"></a><span class="c1">#     features=FeatureSettings(llm=&quot;ollama&quot;, default_llm_output_parser=&quot;pydantic_output_parser&quot;)</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#guides-using_llm_providers-__codelineno-8-10"></a><span class="c1"># )</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#guides-using_llm_providers-__codelineno-8-11"></a><span class="c1"># genie = await Genie.create(config=app_config)</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#guides-using_llm_providers-__codelineno-8-12"></a>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#guides-using_llm_providers-__codelineno-8-13"></a><span class="n">prompt_for_pydantic</span> <span class="o">=</span> <span class="s2">&quot;Create a JSON for a user named Bob, age 42.&quot;</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#guides-using_llm_providers-__codelineno-8-14"></a><span class="n">llm_response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">llm</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">prompt_for_pydantic</span><span class="p">)</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#guides-using_llm_providers-__codelineno-8-15"></a><span class="c1"># llm_response[&#39;text&#39;] might be: &#39;```json\n{&quot;name&quot;: &quot;Bob&quot;, &quot;age&quot;: 42}\n```&#39;</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#guides-using_llm_providers-__codelineno-8-16"></a>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#guides-using_llm_providers-__codelineno-8-17"></a><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#guides-using_llm_providers-__codelineno-8-18"></a>    <span class="n">user_instance</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">llm</span><span class="o">.</span><span class="n">parse_output</span><span class="p">(</span><span class="n">llm_response</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">UserInfo</span><span class="p">)</span>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#guides-using_llm_providers-__codelineno-8-19"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">user_instance</span><span class="p">,</span> <span class="n">UserInfo</span><span class="p">):</span>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#guides-using_llm_providers-__codelineno-8-20"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;User: </span><span class="si">{</span><span class="n">user_instance</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, Age: </span><span class="si">{</span><span class="n">user_instance</span><span class="o">.</span><span class="n">age</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#guides-using_llm_providers-__codelineno-8-21"></a><span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#guides-using_llm_providers-__codelineno-8-22"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to parse into Pydantic model: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
See the specific <code>LLMOutputParserPlugin</code> documentation for details on their capabilities and configuration (e.g., <code>JSONOutputParserPlugin</code>, <code>PydanticOutputParserPlugin</code>).</p>
<h2 id="guides-using_llm_providers-chatmessage-type"><code>ChatMessage</code> Type<a class="headerlink" href="#guides-using_llm_providers-chatmessage-type" title="Permanent link">&para;</a></h2>
<p>The <code>messages</code> parameter for <code>genie.llm.chat()</code> expects a list of <code>ChatMessage</code> dictionaries:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#guides-using_llm_providers-__codelineno-9-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.llm_providers.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChatMessage</span><span class="p">,</span> <span class="n">ToolCall</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#guides-using_llm_providers-__codelineno-9-2"></a>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#guides-using_llm_providers-__codelineno-9-3"></a><span class="c1"># User message</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#guides-using_llm_providers-__codelineno-9-4"></a><span class="n">user_message</span><span class="p">:</span> <span class="n">ChatMessage</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;What&#39;s the weather in London?&quot;</span><span class="p">}</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#guides-using_llm_providers-__codelineno-9-5"></a>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#guides-using_llm_providers-__codelineno-9-6"></a><span class="c1"># Assistant message (simple text response)</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#guides-using_llm_providers-__codelineno-9-7"></a><span class="n">assistant_text_response</span><span class="p">:</span> <span class="n">ChatMessage</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;assistant&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;The weather in London is pleasant.&quot;</span><span class="p">}</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#guides-using_llm_providers-__codelineno-9-8"></a>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#guides-using_llm_providers-__codelineno-9-9"></a><span class="c1"># Assistant message requesting a tool call</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#guides-using_llm_providers-__codelineno-9-10"></a><span class="n">assistant_tool_call_request</span><span class="p">:</span> <span class="n">ChatMessage</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#guides-using_llm_providers-__codelineno-9-11"></a>    <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;assistant&quot;</span><span class="p">,</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#guides-using_llm_providers-__codelineno-9-12"></a>    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="c1"># Content can be None if only tool_calls are present</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#guides-using_llm_providers-__codelineno-9-13"></a>    <span class="s2">&quot;tool_calls&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#guides-using_llm_providers-__codelineno-9-14"></a>        <span class="p">{</span>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#guides-using_llm_providers-__codelineno-9-15"></a>            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;call_weather_london_123&quot;</span><span class="p">,</span>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#guides-using_llm_providers-__codelineno-9-16"></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;function&quot;</span><span class="p">,</span>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#guides-using_llm_providers-__codelineno-9-17"></a>            <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;get_weather&quot;</span><span class="p">,</span> <span class="s2">&quot;arguments&quot;</span><span class="p">:</span> <span class="s1">&#39;{&quot;city&quot;: &quot;London&quot;, &quot;units&quot;: &quot;celsius&quot;}&#39;</span><span class="p">}</span>
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#guides-using_llm_providers-__codelineno-9-18"></a>        <span class="p">}</span>
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#guides-using_llm_providers-__codelineno-9-19"></a>    <span class="p">]</span>
<a id="__codelineno-9-20" name="__codelineno-9-20" href="#guides-using_llm_providers-__codelineno-9-20"></a><span class="p">}</span>
<a id="__codelineno-9-21" name="__codelineno-9-21" href="#guides-using_llm_providers-__codelineno-9-21"></a>
<a id="__codelineno-9-22" name="__codelineno-9-22" href="#guides-using_llm_providers-__codelineno-9-22"></a><span class="c1"># Tool message (response from executing a tool)</span>
<a id="__codelineno-9-23" name="__codelineno-9-23" href="#guides-using_llm_providers-__codelineno-9-23"></a><span class="n">tool_response_message</span><span class="p">:</span> <span class="n">ChatMessage</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-9-24" name="__codelineno-9-24" href="#guides-using_llm_providers-__codelineno-9-24"></a>    <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;tool&quot;</span><span class="p">,</span>
<a id="__codelineno-9-25" name="__codelineno-9-25" href="#guides-using_llm_providers-__codelineno-9-25"></a>    <span class="s2">&quot;tool_call_id&quot;</span><span class="p">:</span> <span class="s2">&quot;call_weather_london_123&quot;</span><span class="p">,</span> <span class="c1"># Matches the ID from assistant&#39;s request</span>
<a id="__codelineno-9-26" name="__codelineno-9-26" href="#guides-using_llm_providers-__codelineno-9-26"></a>    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;get_weather&quot;</span><span class="p">,</span> <span class="c1"># Name of the function that was called</span>
<a id="__codelineno-9-27" name="__codelineno-9-27" href="#guides-using_llm_providers-__codelineno-9-27"></a>    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s1">&#39;{&quot;temperature&quot;: 15, &quot;condition&quot;: &quot;Cloudy&quot;}&#39;</span> <span class="c1"># JSON string of the tool&#39;s output</span>
<a id="__codelineno-9-28" name="__codelineno-9-28" href="#guides-using_llm_providers-__codelineno-9-28"></a><span class="p">}</span>
</code></pre></div>
<p>The <code>LLMChatResponse</code> from <code>genie.llm.chat()</code> will contain an assistant's message in this format.</p></section><section class="print-page" id="guides-using_tools" heading-number="1.6"><h1 id="guides-using_tools-using-tools">Using Tools<a class="headerlink" href="#guides-using_tools-using-tools" title="Permanent link">&para;</a></h1>
<p>Genie Tooling provides robust mechanisms for defining, discovering, and executing tools. Tools represent discrete actions an AI agent can perform.</p>
<p>The primary way to interact with tools is through the <code>Genie</code> facade.</p>
<h2 id="guides-using_tools-enabling-tools-automatic-vs-explicit">Enabling Tools: Automatic vs. Explicit<a class="headerlink" href="#guides-using_tools-enabling-tools-automatic-vs-explicit" title="Permanent link">&para;</a></h2>
<p>Genie supports two modes for enabling tools, controlled by the <code>auto_enable_registered_tools</code> flag in <code>MiddlewareConfig</code>. This is a critical security and configuration concept.</p>
<h3 id="guides-using_tools-automatic-mode-default-for-development">Automatic Mode (Default for Development)<a class="headerlink" href="#guides-using_tools-automatic-mode-default-for-development" title="Permanent link">&para;</a></h3>
<p>By default, <code>auto_enable_registered_tools</code> is <code>True</code>. This is designed for a frictionless developer experience, especially during prototyping.</p>
<ul>
<li><strong>How it works</strong>: Any function decorated with <code>@tool</code> and registered via <code>await genie.register_tool_functions([...])</code> is <strong>automatically enabled</strong> and available for use by <code>genie.execute_tool</code> and <code>genie.run_command</code>.</li>
<li><strong>Configuration</strong>: You only need to add an entry to <code>tool_configurations</code> if a tool requires specific settings for its <code>setup()</code> method. Class-based tools (like the built-in <code>calculator_tool</code>) generally still need to be listed to be enabled.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-using_tools-__codelineno-0-1"></a><span class="c1"># In your main application file:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-using_tools-__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling</span><span class="w"> </span><span class="kn">import</span> <span class="n">tool</span><span class="p">,</span> <span class="n">Genie</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#guides-using_tools-__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiddlewareConfig</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#guides-using_tools-__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#guides-using_tools-__codelineno-0-5"></a><span class="nd">@tool</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#guides-using_tools-__codelineno-0-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">my_simple_tool</span><span class="p">():</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#guides-using_tools-__codelineno-0-7"></a>    <span class="k">return</span> <span class="s2">&quot;It works!&quot;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#guides-using_tools-__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#guides-using_tools-__codelineno-0-9"></a><span class="nd">@tool</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#guides-using_tools-__codelineno-0-10"></a><span class="k">def</span><span class="w"> </span><span class="nf">my_configurable_tool</span><span class="p">(</span><span class="n">api_endpoint</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#guides-using_tools-__codelineno-0-11"></a>    <span class="c1"># ... uses api_endpoint ...</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#guides-using_tools-__codelineno-0-12"></a>    <span class="k">return</span> <span class="s2">&quot;Configured tool works!&quot;</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#guides-using_tools-__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#guides-using_tools-__codelineno-0-14"></a><span class="c1"># Development configuration</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#guides-using_tools-__codelineno-0-15"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#guides-using_tools-__codelineno-0-16"></a>    <span class="n">auto_enable_registered_tools</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># This is the default</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#guides-using_tools-__codelineno-0-17"></a>    <span class="n">tool_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#guides-using_tools-__codelineno-0-18"></a>        <span class="c1"># Only tools needing specific config are listed here</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#guides-using_tools-__codelineno-0-19"></a>        <span class="s2">&quot;my_configurable_tool&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;api_endpoint&quot;</span><span class="p">:</span> <span class="s2">&quot;https://api.example.com&quot;</span><span class="p">},</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#guides-using_tools-__codelineno-0-20"></a>        <span class="c1"># Built-in class-based tools still need to be listed to be enabled</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#guides-using_tools-__codelineno-0-21"></a>        <span class="s2">&quot;calculator_tool&quot;</span><span class="p">:</span> <span class="p">{},</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#guides-using_tools-__codelineno-0-22"></a>    <span class="p">}</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#guides-using_tools-__codelineno-0-23"></a><span class="p">)</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#guides-using_tools-__codelineno-0-24"></a><span class="c1"># genie = await Genie.create(config=app_config)</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#guides-using_tools-__codelineno-0-25"></a><span class="c1"># await genie.register_tool_functions([my_simple_tool, my_configurable_tool])</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#guides-using_tools-__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#guides-using_tools-__codelineno-0-27"></a><span class="c1"># All three tools are now active:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#guides-using_tools-__codelineno-0-28"></a><span class="c1"># await genie.execute_tool(&quot;my_simple_tool&quot;)</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#guides-using_tools-__codelineno-0-29"></a><span class="c1"># await genie.execute_tool(&quot;my_configurable_tool&quot;)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#guides-using_tools-__codelineno-0-30"></a><span class="c1"># await genie.execute_tool(&quot;calculator_tool&quot;, ...)</span>
</code></pre></div>
<h3 id="guides-using_tools-explicit-mode-recommended-for-production">Explicit Mode (Recommended for Production)<a class="headerlink" href="#guides-using_tools-explicit-mode-recommended-for-production" title="Permanent link">&para;</a></h3>
<p>For production environments, it is <strong>strongly recommended</strong> to set <code>auto_enable_registered_tools=False</code>. This provides a clear, secure, and auditable manifest of the agent's capabilities.</p>
<ul>
<li><strong>How it works</strong>: A tool is only active if its identifier is present as a key in the <code>tool_configurations</code> dictionary. This applies to <strong>both</strong> class-based plugins and <code>@tool</code> decorated functions.</li>
<li><strong>Security</strong>: This prevents accidental exposure of development or debugging tools in a production setting. It enforces the principle of least privilege.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-using_tools-__codelineno-1-1"></a><span class="c1"># In your production configuration:</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#guides-using_tools-__codelineno-1-2"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#guides-using_tools-__codelineno-1-3"></a>    <span class="n">auto_enable_registered_tools</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1"># Explicitly disable auto-enablement</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#guides-using_tools-__codelineno-1-4"></a>    <span class="n">tool_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#guides-using_tools-__codelineno-1-5"></a>        <span class="c1"># Only tools listed here will be active, regardless of what&#39;s registered.</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#guides-using_tools-__codelineno-1-6"></a>        <span class="s2">&quot;my_simple_tool&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="c1"># Enable with no config</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#guides-using_tools-__codelineno-1-7"></a>        <span class="s2">&quot;my_configurable_tool&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;api_endpoint&quot;</span><span class="p">:</span> <span class="s2">&quot;https://api.example.com&quot;</span><span class="p">},</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#guides-using_tools-__codelineno-1-8"></a>        <span class="s2">&quot;calculator_tool&quot;</span><span class="p">:</span> <span class="p">{}</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#guides-using_tools-__codelineno-1-9"></a>        <span class="c1"># A hypothetical &#39;dev_debug_tool&#39; would NOT be active even if registered.</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#guides-using_tools-__codelineno-1-10"></a>    <span class="p">}</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#guides-using_tools-__codelineno-1-11"></a><span class="p">)</span>
</code></pre></div>
<h2 id="guides-using_tools-executing-tools-directly-with-genieexecute_tool">Executing Tools Directly with <code>genie.execute_tool()</code><a class="headerlink" href="#guides-using_tools-executing-tools-directly-with-genieexecute_tool" title="Permanent link">&para;</a></h2>
<p>If you know which tool you want to use and have its parameters, you can execute it directly:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#guides-using_tools-__codelineno-2-1"></a><span class="c1"># Assuming &#39;genie&#39; is initialized and &#39;calculator_tool&#39; is enabled.</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#guides-using_tools-__codelineno-2-2"></a><span class="n">calc_result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">execute_tool</span><span class="p">(</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#guides-using_tools-__codelineno-2-3"></a>    <span class="s2">&quot;calculator_tool&quot;</span><span class="p">,</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#guides-using_tools-__codelineno-2-4"></a>    <span class="n">num1</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#guides-using_tools-__codelineno-2-5"></a>    <span class="n">num2</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#guides-using_tools-__codelineno-2-6"></a>    <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;multiply&quot;</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#guides-using_tools-__codelineno-2-7"></a><span class="p">)</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#guides-using_tools-__codelineno-2-8"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calculator Result: </span><span class="si">{</span><span class="n">calc_result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#guides-using_tools-__codelineno-2-9"></a><span class="c1"># Output: Calculator Result: {&#39;result&#39;: 50.0, &#39;error_message&#39;: None}</span>
</code></pre></div>
<h2 id="guides-using_tools-processing-natural-language-commands-with-genierun_command">Processing Natural Language Commands with <code>genie.run_command()</code><a class="headerlink" href="#guides-using_tools-processing-natural-language-commands-with-genierun_command" title="Permanent link">&para;</a></h2>
<p>For more agentic behavior, where the system needs to interpret a natural language command to select and parameterize an enabled tool, use <code>genie.run_command()</code>. This method leverages a configured <strong>Command Processor</strong> plugin.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#guides-using_tools-__codelineno-3-1"></a><span class="c1"># Assuming &#39;genie&#39; is initialized with an LLM-assisted command processor</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#guides-using_tools-__codelineno-3-2"></a><span class="c1"># and &#39;calculator_tool&#39; is enabled.</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#guides-using_tools-__codelineno-3-3"></a><span class="n">command_text</span> <span class="o">=</span> <span class="s2">&quot;What is the result of 75 divided by 3?&quot;</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#guides-using_tools-__codelineno-3-4"></a><span class="n">command_output</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">run_command</span><span class="p">(</span><span class="n">command_text</span><span class="p">)</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#guides-using_tools-__codelineno-3-5"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Command Output: </span><span class="si">{</span><span class="n">command_output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
Refer to the <a href="#guides-using_command_processors">Using Command Processors</a> guide for more details.</p>
<h2 id="guides-using_tools-defining-tools">Defining Tools<a class="headerlink" href="#guides-using_tools-defining-tools" title="Permanent link">&para;</a></h2>
<p>Genie supports two main ways to define tools:</p>
<ol>
<li><strong>Plugin-based Tools</strong>: Create a class that inherits from <code>genie_tooling.tools.abc.Tool</code>. See <a href="#guides-creating_tool_plugins">Creating Tool Plugins</a>.</li>
<li><strong>Decorator-based Tools</strong>: Use the <code>@genie_tooling.tool</code> decorator on your Python functions.</li>
</ol>
<p>Remember that regardless of how a tool is defined, its enablement is controlled by the <code>auto_enable_registered_tools</code> flag and the <code>tool_configurations</code> dictionary.</p></section><section class="print-page" id="guides-using_rag" heading-number="1.7"><h1 id="guides-using_rag-using-retrieval-augmented-generation-rag">Using Retrieval Augmented Generation (RAG)<a class="headerlink" href="#guides-using_rag-using-retrieval-augmented-generation-rag" title="Permanent link">&para;</a></h1>
<p>Genie Tooling provides a flexible RAG system through the <code>genie.rag</code> interface, allowing you to index data from various sources and perform semantic searches.</p>
<h2 id="guides-using_rag-core-rag-operations-via-genierag">Core RAG Operations via <code>genie.rag</code><a class="headerlink" href="#guides-using_rag-core-rag-operations-via-genierag" title="Permanent link">&para;</a></h2>
<p>The <code>genie.rag</code> interface simplifies common RAG tasks:</p>
<ul>
<li><strong><code>genie.rag.index_directory(path, collection_name, ...)</code></strong>: Indexes all supported files within a local directory.</li>
<li><strong><code>genie.rag.index_web_page(url, collection_name, ...)</code></strong>: Fetches content from a web URL, extracts text, and indexes it.</li>
<li><strong><code>genie.rag.search(query, collection_name, top_k, ...)</code></strong>: Performs a semantic search against an indexed collection.</li>
</ul>
<h2 id="guides-using_rag-configuring-rag-components">Configuring RAG Components<a class="headerlink" href="#guides-using_rag-configuring-rag-components" title="Permanent link">&para;</a></h2>
<p>RAG components (Document Loaders, Text Splitters, Embedding Generators, Vector Stores, Retrievers) are configured primarily using <code>FeatureSettings</code> within your <code>MiddlewareConfig</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-using_rag-__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-using_rag-__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#guides-using_rag-__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiddlewareConfig</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#guides-using_rag-__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureSettings</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#guides-using_rag-__codelineno-0-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.genie</span><span class="w"> </span><span class="kn">import</span> <span class="n">Genie</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#guides-using_rag-__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#guides-using_rag-__codelineno-0-7"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#guides-using_rag-__codelineno-0-8"></a>    <span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#guides-using_rag-__codelineno-0-9"></a>        <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#guides-using_rag-__codelineno-0-10"></a>            <span class="c1"># RAG Embedder (e.g., for creating embeddings of your documents)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#guides-using_rag-__codelineno-0-11"></a>            <span class="n">rag_embedder</span><span class="o">=</span><span class="s2">&quot;sentence_transformer&quot;</span><span class="p">,</span> <span class="c1"># Alias for &quot;sentence_transformer_embedder_v1&quot;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#guides-using_rag-__codelineno-0-12"></a>            <span class="c1"># rag_embedder_st_model_name=&quot;all-MiniLM-L6-v2&quot;, # Default ST model</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#guides-using_rag-__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#guides-using_rag-__codelineno-0-14"></a>            <span class="c1"># RAG Vector Store (e.g., for storing and searching embeddings)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#guides-using_rag-__codelineno-0-15"></a>            <span class="n">rag_vector_store</span><span class="o">=</span><span class="s2">&quot;faiss&quot;</span><span class="p">,</span> <span class="c1"># Alias for &quot;faiss_vector_store_v1&quot; (in-memory)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#guides-using_rag-__codelineno-0-16"></a>            <span class="c1"># Or for persistent ChromaDB:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#guides-using_rag-__codelineno-0-17"></a>            <span class="c1"># rag_vector_store=&quot;chroma&quot;,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#guides-using_rag-__codelineno-0-18"></a>            <span class="c1"># rag_vector_store_chroma_path=&quot;./my_rag_db&quot;,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#guides-using_rag-__codelineno-0-19"></a>            <span class="c1"># rag_vector_store_chroma_collection_name=&quot;my_documents&quot;,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#guides-using_rag-__codelineno-0-20"></a>            <span class="c1"># Or for Qdrant:</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#guides-using_rag-__codelineno-0-21"></a>            <span class="c1"># rag_vector_store=&quot;qdrant&quot;, # Example using Qdrant</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#guides-using_rag-__codelineno-0-22"></a>            <span class="c1"># rag_vector_store_qdrant_url=&quot;http://localhost:6333&quot;, # Or path for local Qdrant</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#guides-using_rag-__codelineno-0-23"></a>            <span class="c1"># rag_vector_store_qdrant_collection_name=&quot;my_qdrant_docs&quot;,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#guides-using_rag-__codelineno-0-24"></a>            <span class="c1"># rag_vector_store_qdrant_embedding_dim=384, # Set to your embedder&#39;s dimension (e.g., 384 for all-MiniLM-L6-v2)</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#guides-using_rag-__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#guides-using_rag-__codelineno-0-26"></a>            <span class="c1"># Default RAG Loader (used by index_directory if not specified)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#guides-using_rag-__codelineno-0-27"></a>            <span class="n">rag_loader</span><span class="o">=</span><span class="s2">&quot;file_system&quot;</span><span class="p">,</span> <span class="c1"># Alias for &quot;file_system_loader_v1&quot; (default for index_directory)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#guides-using_rag-__codelineno-0-28"></a>            <span class="c1"># For index_web_page, it defaults to &quot;web_page_loader_v1&quot; internally if rag_loader is &quot;web_page&quot; or not set.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#guides-using_rag-__codelineno-0-29"></a>        <span class="p">)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#guides-using_rag-__codelineno-0-30"></a>    <span class="p">)</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#guides-using_rag-__codelineno-0-31"></a>    <span class="n">genie</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Genie</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">app_config</span><span class="p">)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#guides-using_rag-__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#guides-using_rag-__codelineno-0-33"></a>    <span class="c1"># Create a dummy directory and file for indexing</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#guides-using_rag-__codelineno-0-34"></a>    <span class="n">data_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./rag_data_example&quot;</span><span class="p">)</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#guides-using_rag-__codelineno-0-35"></a>    <span class="n">data_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#guides-using_rag-__codelineno-0-36"></a>    <span class="p">(</span><span class="n">data_path</span> <span class="o">/</span> <span class="s2">&quot;sample.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="s2">&quot;Genie makes RAG easy and configurable.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#guides-using_rag-__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#guides-using_rag-__codelineno-0-38"></a>    <span class="c1"># Index the directory</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#guides-using_rag-__codelineno-0-39"></a>    <span class="n">collection</span> <span class="o">=</span> <span class="s2">&quot;my_sample_collection&quot;</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#guides-using_rag-__codelineno-0-40"></a>    <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">rag</span><span class="o">.</span><span class="n">index_directory</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_path</span><span class="p">),</span> <span class="n">collection_name</span><span class="o">=</span><span class="n">collection</span><span class="p">)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#guides-using_rag-__codelineno-0-41"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Indexed documents from &#39;</span><span class="si">{</span><span class="n">data_path</span><span class="si">}</span><span class="s2">&#39; into &#39;</span><span class="si">{</span><span class="n">collection</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#guides-using_rag-__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#guides-using_rag-__codelineno-0-43"></a>    <span class="c1"># Search the collection</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#guides-using_rag-__codelineno-0-44"></a>    <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;How is RAG with Genie?&quot;</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#guides-using_rag-__codelineno-0-45"></a>    <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">rag</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">collection_name</span><span class="o">=</span><span class="n">collection</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#guides-using_rag-__codelineno-0-46"></a>    <span class="k">if</span> <span class="n">results</span><span class="p">:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#guides-using_rag-__codelineno-0-47"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Search for &#39;</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">&#39;:&quot;</span><span class="p">)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#guides-using_rag-__codelineno-0-48"></a>        <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#guides-using_rag-__codelineno-0-49"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - Score: </span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, Content: </span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">content</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#guides-using_rag-__codelineno-0-50"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#guides-using_rag-__codelineno-0-51"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No results found for &#39;</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#guides-using_rag-__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#guides-using_rag-__codelineno-0-53"></a>    <span class="c1"># Clean up dummy data</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#guides-using_rag-__codelineno-0-54"></a>    <span class="p">(</span><span class="n">data_path</span> <span class="o">/</span> <span class="s2">&quot;sample.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">missing_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Added missing_ok=True</span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#guides-using_rag-__codelineno-0-55"></a>    <span class="k">if</span> <span class="n">data_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span> <span class="n">data_path</span><span class="o">.</span><span class="n">rmdir</span><span class="p">()</span> <span class="c1"># Only rmdir if it&#39;s empty and exists</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#guides-using_rag-__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#guides-using_rag-__codelineno-0-57"></a>    <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#guides-using_rag-__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#guides-using_rag-__codelineno-0-59"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#guides-using_rag-__codelineno-0-60"></a>    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</code></pre></div>
<h3 id="guides-using_rag-overriding-rag-component-configurations">Overriding RAG Component Configurations<a class="headerlink" href="#guides-using_rag-overriding-rag-component-configurations" title="Permanent link">&para;</a></h3>
<p>You can override configurations for specific RAG component plugins (Document Loaders, Text Splitters, Embedding Generators, Vector Stores, Retrievers) using their respective <code>*_configurations</code> dictionaries in <code>MiddlewareConfig</code>.</p>
<p>For example, to configure the <code>WebPageLoader</code> to use Trafilatura for better content extraction when <code>genie.rag.index_web_page()</code> is called (and <code>rag_loader</code> feature is set to <code>"web_page"</code> or not set, allowing the default):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-using_rag-__codelineno-1-1"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#guides-using_rag-__codelineno-1-2"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#guides-using_rag-__codelineno-1-3"></a>        <span class="n">rag_loader</span><span class="o">=</span><span class="s2">&quot;web_page&quot;</span><span class="p">,</span> <span class="c1"># Explicitly or implicitly uses web_page_loader_v1</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#guides-using_rag-__codelineno-1-4"></a>        <span class="n">rag_embedder</span><span class="o">=</span><span class="s2">&quot;sentence_transformer&quot;</span><span class="p">,</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#guides-using_rag-__codelineno-1-5"></a>        <span class="n">rag_vector_store</span><span class="o">=</span><span class="s2">&quot;faiss&quot;</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#guides-using_rag-__codelineno-1-6"></a>    <span class="p">),</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#guides-using_rag-__codelineno-1-7"></a>    <span class="n">document_loader_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#guides-using_rag-__codelineno-1-8"></a>        <span class="s2">&quot;web_page_loader_v1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># Canonical ID of the WebPageLoader</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#guides-using_rag-__codelineno-1-9"></a>            <span class="s2">&quot;use_trafilatura&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#guides-using_rag-__codelineno-1-10"></a>            <span class="c1"># &quot;trafilatura_include_comments&quot;: False # Other loader-specific settings</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#guides-using_rag-__codelineno-1-11"></a>        <span class="p">}</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#guides-using_rag-__codelineno-1-12"></a>    <span class="p">},</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#guides-using_rag-__codelineno-1-13"></a>    <span class="n">embedding_generator_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#guides-using_rag-__codelineno-1-14"></a>        <span class="s2">&quot;sentence_transformer_embedder_v1&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#guides-using_rag-__codelineno-1-15"></a>            <span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="s2">&quot;paraphrase-multilingual-MiniLM-L12-v2&quot;</span> <span class="c1"># Use a different ST model</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#guides-using_rag-__codelineno-1-16"></a>        <span class="p">}</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#guides-using_rag-__codelineno-1-17"></a>    <span class="p">}</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#guides-using_rag-__codelineno-1-18"></a><span class="p">)</span>
</code></pre></div>
<p>When calling <code>genie.rag.index_directory()</code> or <code>genie.rag.search()</code>, you can also pass <code>loader_id</code>, <code>splitter_id</code>, <code>embedder_id</code>, <code>vector_store_id</code>, <code>retriever_id</code>, and their corresponding <code>*_config</code> dictionaries to override the defaults for that specific call.</p>
<h2 id="guides-using_rag-advanced-usage">Advanced Usage<a class="headerlink" href="#guides-using_rag-advanced-usage" title="Permanent link">&para;</a></h2>
<p>The <code>genie.rag</code> interface internally uses the <code>RAGManager</code>. For advanced scenarios requiring direct interaction with the <code>RAGManager</code> or individual RAG component plugins, you can access it via <code>genie._rag_manager</code> (though this is generally not needed for typical use cases).</p>
<p>Refer to <a href="#guides-creating_rag_plugins">Creating RAG Plugins</a> for information on developing your own RAG components.</p></section><section class="print-page" id="guides-using_command_processors" heading-number="1.8"><h1 id="guides-using_command_processors-using-command-processors">Using Command Processors<a class="headerlink" href="#guides-using_command_processors-using-command-processors" title="Permanent link">&para;</a></h1>
<p>Command Processors in Genie Tooling are responsible for interpreting a user's natural language command, selecting an appropriate tool, and extracting the necessary parameters for that tool. The primary way to use a command processor is via the <code>genie.run_command()</code> method.</p>
<h2 id="guides-using_command_processors-genierun_command"><code>genie.run_command()</code><a class="headerlink" href="#guides-using_command_processors-genierun_command" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-using_command_processors-__codelineno-0-1"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run_command</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-using_command_processors-__codelineno-0-2"></a>    <span class="bp">self</span><span class="p">,</span> 
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#guides-using_command_processors-__codelineno-0-3"></a>    <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#guides-using_command_processors-__codelineno-0-4"></a>    <span class="n">processor_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#guides-using_command_processors-__codelineno-0-5"></a>    <span class="n">conversation_history</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">ChatMessage</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#guides-using_command_processors-__codelineno-0-6"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
</code></pre></div>
<ul>
<li><code>command</code>: The natural language command string from the user.</li>
<li><code>processor_id</code>: Optional. The ID of the <code>CommandProcessorPlugin</code> to use. If <code>None</code>, the default command processor configured in <code>MiddlewareConfig</code> (via <code>features.command_processor</code> or <code>default_command_processor_id</code>) is used.</li>
<li><code>conversation_history</code>: Optional list of previous <code>ChatMessage</code> dictionaries to provide context.</li>
</ul>
<p>The method returns a dictionary, typically including:
*   <code>tool_result</code>: The result from the executed tool, if a tool was chosen and run successfully.
*   <code>thought_process</code>: An explanation from the processor (especially LLM-based ones).
*   <code>error</code>: An error message if processing or tool execution failed.
*   <code>message</code>: A message if, for example, no tool was selected.
*   <code>hitl_decision</code>: If HITL was triggered, this contains the approval response.</p>
<p><strong>Important</strong>: Any tool that a command processor might select must be enabled in <code>MiddlewareConfig.tool_configurations</code>.</p>
<h2 id="guides-using_command_processors-configuring-command-processors">Configuring Command Processors<a class="headerlink" href="#guides-using_command_processors-configuring-command-processors" title="Permanent link">&para;</a></h2>
<p>You select and configure command processors using <code>FeatureSettings</code> or explicit configurations in <code>MiddlewareConfig</code>.</p>
<h3 id="guides-using_command_processors-1-simple-keyword-processor-simple_keyword">1. Simple Keyword Processor (<code>simple_keyword</code>)<a class="headerlink" href="#guides-using_command_processors-1-simple-keyword-processor-simple_keyword" title="Permanent link">&para;</a></h3>
<p>This processor matches keywords in the user's command against a predefined map to select a tool. It then prompts the user for parameters if the selected tool requires them.</p>
<p><strong>Configuration via <code>FeatureSettings</code>:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-using_command_processors-__codelineno-1-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiddlewareConfig</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#guides-using_command_processors-__codelineno-1-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureSettings</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#guides-using_command_processors-__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#guides-using_command_processors-__codelineno-1-4"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#guides-using_command_processors-__codelineno-1-5"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#guides-using_command_processors-__codelineno-1-6"></a>        <span class="n">command_processor</span><span class="o">=</span><span class="s2">&quot;simple_keyword&quot;</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#guides-using_command_processors-__codelineno-1-7"></a>    <span class="p">),</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#guides-using_command_processors-__codelineno-1-8"></a>    <span class="c1"># Explicit configuration for the simple_keyword_processor_v1</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#guides-using_command_processors-__codelineno-1-9"></a>    <span class="n">command_processor_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#guides-using_command_processors-__codelineno-1-10"></a>        <span class="s2">&quot;simple_keyword_processor_v1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># Canonical ID</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#guides-using_command_processors-__codelineno-1-11"></a>            <span class="s2">&quot;keyword_map&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#guides-using_command_processors-__codelineno-1-12"></a>                <span class="s2">&quot;calculate&quot;</span><span class="p">:</span> <span class="s2">&quot;calculator_tool&quot;</span><span class="p">,</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#guides-using_command_processors-__codelineno-1-13"></a>                <span class="s2">&quot;math&quot;</span><span class="p">:</span> <span class="s2">&quot;calculator_tool&quot;</span><span class="p">,</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#guides-using_command_processors-__codelineno-1-14"></a>                <span class="s2">&quot;weather&quot;</span><span class="p">:</span> <span class="s2">&quot;open_weather_map_tool&quot;</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#guides-using_command_processors-__codelineno-1-15"></a>            <span class="p">},</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#guides-using_command_processors-__codelineno-1-16"></a>            <span class="s2">&quot;keyword_priority&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;calculate&quot;</span><span class="p">,</span> <span class="s2">&quot;math&quot;</span><span class="p">,</span> <span class="s2">&quot;weather&quot;</span><span class="p">]</span> <span class="c1"># Order for matching</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#guides-using_command_processors-__codelineno-1-17"></a>        <span class="p">}</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#guides-using_command_processors-__codelineno-1-18"></a>    <span class="p">},</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#guides-using_command_processors-__codelineno-1-19"></a>    <span class="n">tool_configurations</span><span class="o">=</span><span class="p">{</span> <span class="c1"># Tools must be enabled</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#guides-using_command_processors-__codelineno-1-20"></a>        <span class="s2">&quot;calculator_tool&quot;</span><span class="p">:</span> <span class="p">{},</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#guides-using_command_processors-__codelineno-1-21"></a>        <span class="s2">&quot;open_weather_map_tool&quot;</span><span class="p">:</span> <span class="p">{}</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#guides-using_command_processors-__codelineno-1-22"></a>    <span class="p">}</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#guides-using_command_processors-__codelineno-1-23"></a><span class="p">)</span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#guides-using_command_processors-__codelineno-1-24"></a><span class="c1"># genie = await Genie.create(config=app_config)</span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#guides-using_command_processors-__codelineno-1-25"></a><span class="c1"># result = await genie.run_command(&quot;calculate 10 + 5&quot;) </span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#guides-using_command_processors-__codelineno-1-26"></a><span class="c1"># The processor will prompt for num1, num2, operation for calculator_tool.</span>
</code></pre></div>
<h3 id="guides-using_command_processors-2-llm-assisted-processor-llm_assisted">2. LLM-Assisted Processor (<code>llm_assisted</code>)<a class="headerlink" href="#guides-using_command_processors-2-llm-assisted-processor-llm_assisted" title="Permanent link">&para;</a></h3>
<p>This processor uses an LLM to understand the command, select the most appropriate tool from a list of available tools, and extract its parameters.</p>
<p><strong>Configuration via <code>FeatureSettings</code>:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#guides-using_command_processors-__codelineno-2-1"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#guides-using_command_processors-__codelineno-2-2"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#guides-using_command_processors-__codelineno-2-3"></a>        <span class="n">llm</span><span class="o">=</span><span class="s2">&quot;ollama&quot;</span><span class="p">,</span> <span class="c1"># The LLM to be used by the processor</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#guides-using_command_processors-__codelineno-2-4"></a>        <span class="n">llm_ollama_model_name</span><span class="o">=</span><span class="s2">&quot;mistral:latest&quot;</span><span class="p">,</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#guides-using_command_processors-__codelineno-2-5"></a>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#guides-using_command_processors-__codelineno-2-6"></a>        <span class="n">command_processor</span><span class="o">=</span><span class="s2">&quot;llm_assisted&quot;</span><span class="p">,</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#guides-using_command_processors-__codelineno-2-7"></a>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#guides-using_command_processors-__codelineno-2-8"></a>        <span class="c1"># Configure how tools are presented to the LLM</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#guides-using_command_processors-__codelineno-2-9"></a>        <span class="n">command_processor_formatter_id_alias</span><span class="o">=</span><span class="s2">&quot;compact_text_formatter&quot;</span><span class="p">,</span> 
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#guides-using_command_processors-__codelineno-2-10"></a>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#guides-using_command_processors-__codelineno-2-11"></a>        <span class="c1"># Configure tool lookup to help the LLM (optional but recommended)</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#guides-using_command_processors-__codelineno-2-12"></a>        <span class="n">tool_lookup</span><span class="o">=</span><span class="s2">&quot;embedding&quot;</span><span class="p">,</span> <span class="c1"># Use embedding-based lookup</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#guides-using_command_processors-__codelineno-2-13"></a>        <span class="n">tool_lookup_formatter_id_alias</span><span class="o">=</span><span class="s2">&quot;compact_text_formatter&quot;</span><span class="p">,</span> <span class="c1"># Formatter for indexing tools</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#guides-using_command_processors-__codelineno-2-14"></a>        <span class="n">tool_lookup_embedder_id_alias</span><span class="o">=</span><span class="s2">&quot;st_embedder&quot;</span> <span class="c1"># Embedder for tool descriptions</span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#guides-using_command_processors-__codelineno-2-15"></a>    <span class="p">),</span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#guides-using_command_processors-__codelineno-2-16"></a>    <span class="c1"># Optionally, provide specific settings for the LLM-assisted processor</span>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#guides-using_command_processors-__codelineno-2-17"></a>    <span class="n">command_processor_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#guides-using_command_processors-__codelineno-2-18"></a>        <span class="s2">&quot;llm_assisted_tool_selection_processor_v1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># Canonical ID</span>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#guides-using_command_processors-__codelineno-2-19"></a>            <span class="s2">&quot;tool_lookup_top_k&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="c1"># Show top 3 tools from lookup to the LLM</span>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#guides-using_command_processors-__codelineno-2-20"></a>            <span class="c1"># &quot;system_prompt_template&quot;: &quot;Your custom system prompt...&quot; # Override default prompt</span>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#guides-using_command_processors-__codelineno-2-21"></a>        <span class="p">}</span>
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#guides-using_command_processors-__codelineno-2-22"></a>    <span class="p">},</span>
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#guides-using_command_processors-__codelineno-2-23"></a>    <span class="n">tool_configurations</span><span class="o">=</span><span class="p">{</span> <span class="c1"># Any tool the LLM might pick must be enabled</span>
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#guides-using_command_processors-__codelineno-2-24"></a>        <span class="s2">&quot;calculator_tool&quot;</span><span class="p">:</span> <span class="p">{},</span>
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#guides-using_command_processors-__codelineno-2-25"></a>        <span class="s2">&quot;open_weather_map_tool&quot;</span><span class="p">:</span> <span class="p">{}</span> 
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#guides-using_command_processors-__codelineno-2-26"></a>        <span class="c1"># Add other tools the LLM might be expected to use</span>
<a id="__codelineno-2-27" name="__codelineno-2-27" href="#guides-using_command_processors-__codelineno-2-27"></a>    <span class="p">}</span>
<a id="__codelineno-2-28" name="__codelineno-2-28" href="#guides-using_command_processors-__codelineno-2-28"></a><span class="p">)</span>
<a id="__codelineno-2-29" name="__codelineno-2-29" href="#guides-using_command_processors-__codelineno-2-29"></a><span class="c1"># genie = await Genie.create(config=app_config)</span>
<a id="__codelineno-2-30" name="__codelineno-2-30" href="#guides-using_command_processors-__codelineno-2-30"></a><span class="c1"># result = await genie.run_command(&quot;What&#39;s the weather like in Berlin tomorrow?&quot;)</span>
</code></pre></div>
<p><strong>Key aspects for <code>llm_assisted</code> processor:</strong>
*   <strong>LLM Dependency</strong>: It requires a configured LLM provider (<code>features.llm</code>).
*   <strong>Tool Formatting</strong>: It uses a <code>DefinitionFormatterPlugin</code> (specified by <code>command_processor_formatter_id_alias</code> or an explicit <code>tool_formatter_id</code> in its configuration) to format tool definitions for the LLM prompt.
*   <strong>Tool Lookup (Optional but Recommended)</strong>: If <code>features.tool_lookup</code> is enabled (e.g., <code>"embedding"</code> or <code>"keyword"</code>), the processor first uses the <code>ToolLookupService</code> to find a smaller set of relevant tools. Only these candidate tools are then presented to the LLM. This improves efficiency and accuracy. The <code>tool_lookup_top_k</code> parameter in its configuration controls how many tools from the lookup are passed to the LLM.</p>
<p>See the <a href="#guides-tool_lookup">Tool Lookup Guide</a> for more on configuring tool lookup.</p></section><section class="print-page" id="guides-tool_lookup" heading-number="1.9"><h1 id="guides-tool_lookup-tool-lookup">Tool Lookup<a class="headerlink" href="#guides-tool_lookup-tool-lookup" title="Permanent link">&para;</a></h1>
<p>Genie Tooling refers to the process of finding relevant tools based on a natural language query. This is primarily used by the <code>LLMAssistedToolSelectionProcessorPlugin</code> to narrow down the list of tools presented to the LLM, making the LLM's selection task more efficient and accurate.</p>
<h2 id="guides-tool_lookup-how-tool-lookup-is-used">How Tool Lookup is Used<a class="headerlink" href="#guides-tool_lookup-how-tool-lookup-is-used" title="Permanent link">&para;</a></h2>
<p>When you configure the <code>Genie</code> facade to use the <code>llm_assisted</code> command processor, you can also enable and configure tool lookup:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-tool_lookup-__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiddlewareConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-tool_lookup-__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureSettings</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#guides-tool_lookup-__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#guides-tool_lookup-__codelineno-0-4"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#guides-tool_lookup-__codelineno-0-5"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#guides-tool_lookup-__codelineno-0-6"></a>        <span class="n">llm</span><span class="o">=</span><span class="s2">&quot;ollama&quot;</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#guides-tool_lookup-__codelineno-0-7"></a>        <span class="n">command_processor</span><span class="o">=</span><span class="s2">&quot;llm_assisted&quot;</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#guides-tool_lookup-__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#guides-tool_lookup-__codelineno-0-9"></a>        <span class="c1"># Tool Lookup Configuration</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#guides-tool_lookup-__codelineno-0-10"></a>        <span class="n">tool_lookup</span><span class="o">=</span><span class="s2">&quot;hybrid&quot;</span><span class="p">,</span> <span class="c1"># Enable hybrid (embedding + keyword) search</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#guides-tool_lookup-__codelineno-0-11"></a>        <span class="n">tool_lookup_top_k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>  <span class="c1"># How many tools to show the LLM</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#guides-tool_lookup-__codelineno-0-12"></a>    <span class="p">),</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#guides-tool_lookup-__codelineno-0-13"></a>    <span class="n">tool_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#guides-tool_lookup-__codelineno-0-14"></a>        <span class="s2">&quot;calculator_tool&quot;</span><span class="p">:</span> <span class="p">{},</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#guides-tool_lookup-__codelineno-0-15"></a>        <span class="s2">&quot;open_weather_map_tool&quot;</span><span class="p">:</span> <span class="p">{}</span> 
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#guides-tool_lookup-__codelineno-0-16"></a>    <span class="p">}</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#guides-tool_lookup-__codelineno-0-17"></a><span class="p">)</span>
</code></pre></div>
<p>The <code>LLMAssistedToolSelectionProcessorPlugin</code> internally uses the <code>ToolLookupService</code> to:
1.  <strong>Index Tools</strong>: When first needed, it takes all enabled tools, formats their definitions, and indexes them using the configured <code>ToolLookupProvider</code>. This now happens incrementally when new tools are registered.
2.  <strong>Find Tools</strong>: When processing a user command, it queries the <code>ToolLookupService</code> with the command. The service returns a ranked list of potentially relevant tools.
3.  <strong>Filter Tools</strong>: The processor then takes the top N tools (defined by <code>tool_lookup_top_k</code>) from this list and presents only their definitions to the LLM for final selection.</p>
<h2 id="guides-tool_lookup-available-tool-lookup-providers">Available Tool Lookup Providers<a class="headerlink" href="#guides-tool_lookup-available-tool-lookup-providers" title="Permanent link">&para;</a></h2>
<p>Genie Tooling includes built-in providers:</p>
<ul>
<li><strong><code>EmbeddingSimilarityLookupProvider</code> (alias: <code>"embedding"</code>)</strong>:<ul>
<li>Embeds tool definitions and queries for semantic search.</li>
<li>Can use an in-memory NumPy index or a persistent <code>VectorStorePlugin</code>.</li>
</ul>
</li>
<li><strong><code>KeywordMatchLookupProvider</code> (alias: <code>"keyword"</code>)</strong>:<ul>
<li>Performs simple keyword matching. Stateless and fast.</li>
</ul>
</li>
<li><strong><code>HybridSearchLookupProvider</code> (alias: <code>"hybrid"</code>)</strong>:<ul>
<li><strong>Recommended</strong>: Combines the results of both embedding and keyword search using Reciprocal Rank Fusion (RRF).</li>
<li>This provides a powerful balance of semantic understanding (from embeddings) and lexical precision (from keywords), often yielding the most relevant results.</li>
</ul>
</li>
</ul>
<h2 id="guides-tool_lookup-incremental-indexing">Incremental Indexing<a class="headerlink" href="#guides-tool_lookup-incremental-indexing" title="Permanent link">&para;</a></h2>
<p>The <code>ToolLookupService</code> now supports incremental indexing. When you register new tools at runtime with <code>await genie.register_tool_functions(...)</code>, the service will automatically add or update just those tools in the index, rather than rebuilding the entire index from scratch. This is crucial for performance in dynamic environments.</p>
<h2 id="guides-tool_lookup-debugging-tool-discoverability">Debugging Tool Discoverability<a class="headerlink" href="#guides-tool_lookup-debugging-tool-discoverability" title="Permanent link">&para;</a></h2>
<p>It can sometimes be challenging to understand why a specific tool was or was not selected for a query. To aid in this, Genie Tooling provides a developer utility.</p>
<p><strong><code>scripts/debug_tool_lookup.py</code></strong></p>
<p>This command-line script allows you to test queries directly against the <code>ToolLookupService</code> and see the ranked results.</p>
<p><strong>Usage:</strong></p>
<ol>
<li>
<p>(Optional) Create a simple config file, e.g., <code>debug_config.yaml</code>, especially if you use <code>plugin_dev_dirs</code>:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-tool_lookup-__codelineno-1-1"></a><span class="nt">plugin_dev_dirs</span><span class="p">:</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#guides-tool_lookup-__codelineno-1-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./src/my_project/custom_plugins</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#guides-tool_lookup-__codelineno-1-3"></a><span class="nt">features</span><span class="p">:</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#guides-tool_lookup-__codelineno-1-4"></a><span class="w">  </span><span class="nt">tool_lookup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hybrid</span><span class="w"> </span><span class="c1"># Or &#39;embedding&#39;, &#39;keyword&#39;</span>
</code></pre></div></p>
</li>
<li>
<p>Run the script from your project's root directory:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#guides-tool_lookup-__codelineno-2-1"></a>poetry<span class="w"> </span>run<span class="w"> </span>python<span class="w"> </span>scripts/debug_tool_lookup.py<span class="w"> </span>--query<span class="w"> </span><span class="s2">&quot;what is the weather in Paris&quot;</span><span class="w"> </span>--config-path<span class="w"> </span>debug_config.yaml
</code></pre></div></p>
</li>
</ol>
<p><strong>Output:</strong></p>
<p>The script will print a ranked list of tools, including their scores and any matched keywords or similarity details, helping you refine your tool descriptions for better discoverability.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#guides-tool_lookup-__codelineno-3-1"></a>--- Tool Lookup Debugger ---
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#guides-tool_lookup-__codelineno-3-2"></a>Query: &#39;what is the weather in Paris&#39;
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#guides-tool_lookup-__codelineno-3-3"></a>Top K: 5
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#guides-tool_lookup-__codelineno-3-4"></a>...
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#guides-tool_lookup-__codelineno-3-5"></a>--- Lookup Results ---
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#guides-tool_lookup-__codelineno-3-6"></a>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#guides-tool_lookup-__codelineno-3-7"></a>1. Tool: open_weather_map_tool (Score: 1.6541)
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#guides-tool_lookup-__codelineno-3-8"></a>   Matched Keywords: weather
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#guides-tool_lookup-__codelineno-3-9"></a>   Similarity Details: {&#39;cosine_similarity&#39;: 0.85}
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#guides-tool_lookup-__codelineno-3-10"></a>   Snippet/Reason: WeatherInfo: Get current weather for a city...
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#guides-tool_lookup-__codelineno-3-11"></a>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#guides-tool_lookup-__codelineno-3-12"></a>2. Tool: some_other_tool (Score: 0.0164)
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#guides-tool_lookup-__codelineno-3-13"></a>   ...
</code></pre></div>
This allows you to iterate quickly on your tool's <code>description_llm</code> and <code>tags</code> to improve its ranking for relevant queries.</p></section><section class="print-page" id="guides-logging" heading-number="1.10"><h1 id="guides-logging-logging">Logging<a class="headerlink" href="#guides-logging-logging" title="Permanent link">&para;</a></h1>
<p>Genie Tooling uses a pluggable <code>LogAdapterPlugin</code> system for its internal structured event logging. This allows application developers to integrate Genie's detailed operational events into their existing logging infrastructure or use specialized logging libraries. The <code>InteractionTracingManager</code> (and by extension, tracers like <code>ConsoleTracerPlugin</code>) relies on the configured <code>LogAdapterPlugin</code> to process and output trace events.</p>
<h2 id="guides-logging-core-concepts">Core Concepts<a class="headerlink" href="#guides-logging-core-concepts" title="Permanent link">&para;</a></h2>
<ul>
<li><strong><code>LogAdapterPlugin</code> (<code>genie_tooling.log_adapters.abc.LogAdapter</code>)</strong>: The protocol for plugins that handle structured log events. They are responsible for final formatting, redaction, and output.</li>
<li><strong><code>DefaultLogAdapter</code> (alias: <code>default_log_adapter</code>)</strong>: The standard built-in adapter. It uses Python's <code>logging</code> module and can integrate a <code>RedactorPlugin</code> for sanitizing data.</li>
<li><strong><code>PyviderTelemetryLogAdapter</code> (alias: <code>pyvider_log_adapter</code>)</strong>: An adapter that integrates with the <code>pyvider-telemetry</code> library for advanced structured logging, including emoji-based DAS (Domain-Action-Status) logging.</li>
<li><strong>Library Logger Name</strong>: The root logger name for messages originating directly from Genie Tooling library components (when not processed through a <code>LogAdapterPlugin</code>) is <code>genie_tooling</code>.</li>
</ul>
<h2 id="guides-logging-configuring-the-log-adapter">Configuring the Log Adapter<a class="headerlink" href="#guides-logging-configuring-the-log-adapter" title="Permanent link">&para;</a></h2>
<p>You select and configure the primary <code>LogAdapterPlugin</code> using <code>FeatureSettings</code> or explicit configurations in <code>MiddlewareConfig</code>.</p>
<p><strong>1. Via <code>FeatureSettings</code>:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-logging-__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiddlewareConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-logging-__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureSettings</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#guides-logging-__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#guides-logging-__codelineno-0-4"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#guides-logging-__codelineno-0-5"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#guides-logging-__codelineno-0-6"></a>        <span class="c1"># ... other features ...</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#guides-logging-__codelineno-0-7"></a>        <span class="n">logging_adapter</span><span class="o">=</span><span class="s2">&quot;default_log_adapter&quot;</span><span class="p">,</span> <span class="c1"># Default</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#guides-logging-__codelineno-0-8"></a>        <span class="c1"># OR</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#guides-logging-__codelineno-0-9"></a>        <span class="c1"># logging_adapter=&quot;pyvider_log_adapter&quot;,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#guides-logging-__codelineno-0-10"></a>        <span class="c1"># logging_pyvider_service_name=&quot;my-genie-app-with-pyvider&quot; # Optional for Pyvider</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#guides-logging-__codelineno-0-11"></a>    <span class="p">),</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#guides-logging-__codelineno-0-12"></a>    <span class="c1"># Configuration for the chosen adapter goes into log_adapter_configurations</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#guides-logging-__codelineno-0-13"></a>    <span class="n">log_adapter_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#guides-logging-__codelineno-0-14"></a>        <span class="s2">&quot;default_log_adapter_v1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># If default_log_adapter is chosen</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#guides-logging-__codelineno-0-15"></a>            <span class="s2">&quot;log_level&quot;</span><span class="p">:</span> <span class="s2">&quot;DEBUG&quot;</span><span class="p">,</span> <span class="c1"># For the &#39;genie_tooling&#39; logger</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#guides-logging-__codelineno-0-16"></a>            <span class="s2">&quot;library_logger_name&quot;</span><span class="p">:</span> <span class="s2">&quot;genie_tooling_app_logs&quot;</span><span class="p">,</span> <span class="c1"># Custom name for library logs</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#guides-logging-__codelineno-0-17"></a>            <span class="s2">&quot;redactor_plugin_id&quot;</span><span class="p">:</span> <span class="s2">&quot;schema_aware_redactor_v1&quot;</span><span class="p">,</span> <span class="c1"># Example custom redactor</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#guides-logging-__codelineno-0-18"></a>            <span class="s2">&quot;enable_schema_redaction&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#guides-logging-__codelineno-0-19"></a>            <span class="s2">&quot;enable_key_name_redaction&quot;</span><span class="p">:</span> <span class="kc">True</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#guides-logging-__codelineno-0-20"></a>        <span class="p">},</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#guides-logging-__codelineno-0-21"></a>        <span class="s2">&quot;pyvider_telemetry_log_adapter_v1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># If pyvider_log_adapter is chosen</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#guides-logging-__codelineno-0-22"></a>            <span class="s2">&quot;service_name&quot;</span><span class="p">:</span> <span class="s2">&quot;MyGenieService&quot;</span><span class="p">,</span> <span class="c1"># Overrides feature setting if both present</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#guides-logging-__codelineno-0-23"></a>            <span class="s2">&quot;default_level&quot;</span><span class="p">:</span> <span class="s2">&quot;INFO&quot;</span><span class="p">,</span> <span class="c1"># For Pyvider&#39;s default logger</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#guides-logging-__codelineno-0-24"></a>            <span class="s2">&quot;module_levels&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;genie_tooling.llm_providers&quot;</span><span class="p">:</span> <span class="s2">&quot;DEBUG&quot;</span><span class="p">},</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#guides-logging-__codelineno-0-25"></a>            <span class="s2">&quot;console_formatter&quot;</span><span class="p">:</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#guides-logging-__codelineno-0-26"></a>            <span class="s2">&quot;redactor_plugin_id&quot;</span><span class="p">:</span> <span class="s2">&quot;noop_redactor_v1&quot;</span> <span class="c1"># Pyvider might have its own redaction</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#guides-logging-__codelineno-0-27"></a>        <span class="p">}</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#guides-logging-__codelineno-0-28"></a>    <span class="p">}</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#guides-logging-__codelineno-0-29"></a><span class="p">)</span>
</code></pre></div>
<p><strong>2. Explicit Configuration:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-logging-__codelineno-1-1"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#guides-logging-__codelineno-1-2"></a>    <span class="n">default_log_adapter_id</span><span class="o">=</span><span class="s2">&quot;pyvider_telemetry_log_adapter_v1&quot;</span><span class="p">,</span> <span class="c1"># Explicitly set</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#guides-logging-__codelineno-1-3"></a>    <span class="n">log_adapter_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#guides-logging-__codelineno-1-4"></a>        <span class="s2">&quot;pyvider_telemetry_log_adapter_v1&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#guides-logging-__codelineno-1-5"></a>            <span class="s2">&quot;service_name&quot;</span><span class="p">:</span> <span class="s2">&quot;MyExplicitPyviderServiceName&quot;</span><span class="p">,</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#guides-logging-__codelineno-1-6"></a>            <span class="s2">&quot;default_level&quot;</span><span class="p">:</span> <span class="s2">&quot;TRACE&quot;</span><span class="p">,</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#guides-logging-__codelineno-1-7"></a>            <span class="c1"># ... other Pyvider specific settings ...</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#guides-logging-__codelineno-1-8"></a>            <span class="c1"># &quot;redactor_plugin_id&quot;: &quot;my_custom_redactor_for_pyvider_v1&quot;</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#guides-logging-__codelineno-1-9"></a>        <span class="p">}</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#guides-logging-__codelineno-1-10"></a>    <span class="p">}</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#guides-logging-__codelineno-1-11"></a><span class="p">)</span>
</code></pre></div>
<p>The <code>Genie.create()</code> method will instantiate the configured <code>LogAdapterPlugin</code> (passing the main <code>PluginManager</code> in its configuration, allowing it to load its own redactor) and then pass this <code>LogAdapterPlugin</code> instance to the <code>InteractionTracingManager</code>. Tracers like <code>ConsoleTracerPlugin</code> will then use this central <code>LogAdapterPlugin</code> to process their trace events.</p>
<h2 id="guides-logging-redaction">Redaction<a class="headerlink" href="#guides-logging-redaction" title="Permanent link">&para;</a></h2>
<p>Both <code>DefaultLogAdapter</code> and the new <code>PyviderTelemetryLogAdapter</code> (as per the plan) will integrate with a <code>RedactorPlugin</code> to sanitize sensitive data before logging.
*   The <code>DefaultLogAdapter</code> has built-in schema-aware redaction which can be toggled, and it also uses the configured <code>RedactorPlugin</code>.
*   The <code>PyviderTelemetryLogAdapter</code> will also use a configured <code>RedactorPlugin</code> for a first pass of redaction before handing data to Pyvider's logging methods.</p>
<h2 id="guides-logging-standard-python-logging">Standard Python Logging<a class="headerlink" href="#guides-logging-standard-python-logging" title="Permanent link">&para;</a></h2>
<p>If you need to configure logging for Genie Tooling library modules that log <em>directly</em> (not through the <code>LogAdapterPlugin</code> event system), you can still use the standard Python <code>logging</code> module:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#guides-logging-__codelineno-2-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#guides-logging-__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#guides-logging-__codelineno-2-3"></a><span class="c1"># Get the Genie Tooling library logger</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#guides-logging-__codelineno-2-4"></a><span class="n">library_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;genie_tooling&quot;</span><span class="p">)</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#guides-logging-__codelineno-2-5"></a><span class="n">library_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span> 
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#guides-logging-__codelineno-2-6"></a><span class="n">console_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#guides-logging-__codelineno-2-7"></a><span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(name)s</span><span class="s1"> - [</span><span class="si">%(levelname)s</span><span class="s1">] - </span><span class="si">%(message)s</span><span class="s1"> (</span><span class="si">%(module)s</span><span class="s1">:</span><span class="si">%(lineno)d</span><span class="s1">)&#39;</span><span class="p">)</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#guides-logging-__codelineno-2-8"></a><span class="n">console_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#guides-logging-__codelineno-2-9"></a><span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">library_logger</span><span class="o">.</span><span class="n">handlers</span><span class="p">):</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#guides-logging-__codelineno-2-10"></a>    <span class="n">library_logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">console_handler</span><span class="p">)</span>
</code></pre></div>
This standard setup is separate from the <code>LogAdapterPlugin</code> system, which is for structured event processing. The <code>DefaultLogAdapter</code> bridges these by configuring the <code>genie_tooling</code> logger as part of its setup.</p></section><section class="print-page" id="guides-using_prompts" heading-number="1.11"><h1 id="guides-using_prompts-using-the-prompt-management-system-genieprompts">Using the Prompt Management System (<code>genie.prompts</code>)<a class="headerlink" href="#guides-using_prompts-using-the-prompt-management-system-genieprompts" title="Permanent link">&para;</a></h1>
<p>Genie Tooling provides a flexible prompt management system accessible via <code>genie.prompts</code>. This allows you to register, retrieve, and render prompt templates, separating prompt engineering concerns from your application logic.</p>
<h2 id="guides-using_prompts-core-concepts">Core Concepts<a class="headerlink" href="#guides-using_prompts-core-concepts" title="Permanent link">&para;</a></h2>
<ul>
<li><strong><code>PromptInterface</code> (<code>genie.prompts</code>)</strong>: The facade interface for all prompt-related operations.</li>
<li><strong><code>PromptRegistryPlugin</code></strong>: Responsible for storing and retrieving raw prompt template content (e.g., from a file system, database).<ul>
<li>Built-in: <code>FileSystemPromptRegistryPlugin</code> (alias: <code>file_system_prompt_registry</code>).</li>
</ul>
</li>
<li><strong><code>PromptTemplatePlugin</code></strong>: Responsible for rendering a raw template string with provided data.<ul>
<li>Built-in: <code>BasicStringFormatTemplatePlugin</code> (alias: <code>basic_string_formatter</code>), <code>Jinja2ChatTemplatePlugin</code> (alias: <code>jinja2_chat_formatter</code>).</li>
</ul>
</li>
</ul>
<h2 id="guides-using_prompts-configuration">Configuration<a class="headerlink" href="#guides-using_prompts-configuration" title="Permanent link">&para;</a></h2>
<p>You configure the default prompt registry and template engine via <code>FeatureSettings</code> or explicit <code>MiddlewareConfig</code> settings.</p>
<p><strong>Via <code>FeatureSettings</code>:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-using_prompts-__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiddlewareConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-using_prompts-__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureSettings</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#guides-using_prompts-__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#guides-using_prompts-__codelineno-0-4"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#guides-using_prompts-__codelineno-0-5"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#guides-using_prompts-__codelineno-0-6"></a>        <span class="c1"># ... other features ...</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#guides-using_prompts-__codelineno-0-7"></a>        <span class="n">prompt_registry</span><span class="o">=</span><span class="s2">&quot;file_system_prompt_registry&quot;</span><span class="p">,</span> <span class="c1"># Default</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#guides-using_prompts-__codelineno-0-8"></a>        <span class="n">prompt_template_engine</span><span class="o">=</span><span class="s2">&quot;jinja2_chat_formatter&quot;</span>   <span class="c1"># Default</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#guides-using_prompts-__codelineno-0-9"></a>    <span class="p">),</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#guides-using_prompts-__codelineno-0-10"></a>    <span class="c1"># Configure the FileSystemPromptRegistryPlugin</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#guides-using_prompts-__codelineno-0-11"></a>    <span class="n">prompt_registry_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#guides-using_prompts-__codelineno-0-12"></a>        <span class="s2">&quot;file_system_prompt_registry_v1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># Canonical ID</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#guides-using_prompts-__codelineno-0-13"></a>            <span class="s2">&quot;base_path&quot;</span><span class="p">:</span> <span class="s2">&quot;./my_application_prompts&quot;</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#guides-using_prompts-__codelineno-0-14"></a>            <span class="s2">&quot;template_suffix&quot;</span><span class="p">:</span> <span class="s2">&quot;.j2&quot;</span> <span class="c1"># If using Jinja2 templates</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#guides-using_prompts-__codelineno-0-15"></a>        <span class="p">}</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#guides-using_prompts-__codelineno-0-16"></a>    <span class="p">}</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#guides-using_prompts-__codelineno-0-17"></a>    <span class="c1"># No specific config needed for Jinja2ChatTemplatePlugin by default</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#guides-using_prompts-__codelineno-0-18"></a><span class="p">)</span>
</code></pre></div>
<p><strong>Explicit Configuration:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-using_prompts-__codelineno-1-1"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#guides-using_prompts-__codelineno-1-2"></a>    <span class="n">default_prompt_registry_id</span><span class="o">=</span><span class="s2">&quot;file_system_prompt_registry_v1&quot;</span><span class="p">,</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#guides-using_prompts-__codelineno-1-3"></a>    <span class="n">default_prompt_template_plugin_id</span><span class="o">=</span><span class="s2">&quot;jinja2_chat_template_v1&quot;</span><span class="p">,</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#guides-using_prompts-__codelineno-1-4"></a>    <span class="n">prompt_registry_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#guides-using_prompts-__codelineno-1-5"></a>        <span class="s2">&quot;file_system_prompt_registry_v1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;base_path&quot;</span><span class="p">:</span> <span class="s2">&quot;prompts&quot;</span><span class="p">}</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#guides-using_prompts-__codelineno-1-6"></a>    <span class="p">}</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#guides-using_prompts-__codelineno-1-7"></a><span class="p">)</span>
</code></pre></div>
<h2 id="guides-using_prompts-using-genieprompts">Using <code>genie.prompts</code><a class="headerlink" href="#guides-using_prompts-using-genieprompts" title="Permanent link">&para;</a></h2>
<h3 id="guides-using_prompts-1-getting-raw-template-content">1. Getting Raw Template Content<a class="headerlink" href="#guides-using_prompts-1-getting-raw-template-content" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#guides-using_prompts-__codelineno-2-1"></a><span class="c1"># Assuming &#39;my_application_prompts/my_task.j2&#39; exists</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#guides-using_prompts-__codelineno-2-2"></a><span class="n">template_content</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">prompts</span><span class="o">.</span><span class="n">get_prompt_template_content</span><span class="p">(</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#guides-using_prompts-__codelineno-2-3"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_task&quot;</span><span class="p">,</span> 
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#guides-using_prompts-__codelineno-2-4"></a>    <span class="c1"># version=&quot;v1&quot;, # Optional version</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#guides-using_prompts-__codelineno-2-5"></a>    <span class="c1"># registry_id=&quot;custom_registry&quot; # Optional, if not using default</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#guides-using_prompts-__codelineno-2-6"></a><span class="p">)</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#guides-using_prompts-__codelineno-2-7"></a><span class="k">if</span> <span class="n">template_content</span><span class="p">:</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#guides-using_prompts-__codelineno-2-8"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Raw template: </span><span class="si">{</span><span class="n">template_content</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="guides-using_prompts-2-rendering-a-string-prompt">2. Rendering a String Prompt<a class="headerlink" href="#guides-using_prompts-2-rendering-a-string-prompt" title="Permanent link">&para;</a></h3>
<p>This is useful for prompts that result in a single string, often for completion LLMs.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#guides-using_prompts-__codelineno-3-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.prompts.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">PromptData</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#guides-using_prompts-__codelineno-3-2"></a>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#guides-using_prompts-__codelineno-3-3"></a><span class="n">prompt_data</span><span class="p">:</span> <span class="n">PromptData</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;topic&quot;</span><span class="p">:</span> <span class="s2">&quot;AI ethics&quot;</span><span class="p">,</span> <span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="s2">&quot;short&quot;</span><span class="p">}</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#guides-using_prompts-__codelineno-3-4"></a>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#guides-using_prompts-__codelineno-3-5"></a><span class="c1"># Uses default registry and default template engine</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#guides-using_prompts-__codelineno-3-6"></a><span class="n">rendered_string</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">prompts</span><span class="o">.</span><span class="n">render_prompt</span><span class="p">(</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#guides-using_prompts-__codelineno-3-7"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;summarization_prompt&quot;</span><span class="p">,</span> <span class="c1"># e.g., &#39;my_application_prompts/summarization_prompt.txt&#39;</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#guides-using_prompts-__codelineno-3-8"></a>    <span class="n">data</span><span class="o">=</span><span class="n">prompt_data</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#guides-using_prompts-__codelineno-3-9"></a><span class="p">)</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#guides-using_prompts-__codelineno-3-10"></a><span class="k">if</span> <span class="n">rendered_string</span><span class="p">:</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#guides-using_prompts-__codelineno-3-11"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rendered string prompt: </span><span class="si">{</span><span class="n">rendered_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#guides-using_prompts-__codelineno-3-12"></a>    <span class="c1"># Example: &quot;Summarize AI ethics in a short paragraph.&quot;</span>
</code></pre></div>
<h3 id="guides-using_prompts-3-rendering-a-chat-prompt">3. Rendering a Chat Prompt<a class="headerlink" href="#guides-using_prompts-3-rendering-a-chat-prompt" title="Permanent link">&para;</a></h3>
<p>This is used for prompts that result in a list of <code>ChatMessage</code> dictionaries, suitable for chat-based LLMs. The <code>Jinja2ChatTemplatePlugin</code> is particularly useful here as Jinja2 can easily render structured JSON/YAML.</p>
<p><strong>Example Jinja2 template (<code>my_application_prompts/chat_style_prompt.j2</code>):</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#guides-using_prompts-__codelineno-4-1"></a>[
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#guides-using_prompts-__codelineno-4-2"></a>    {&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: &quot;You are a helpful {{ persona }}.&quot;},
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#guides-using_prompts-__codelineno-4-3"></a>    {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Tell me about {{ subject }}.&quot;}
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#guides-using_prompts-__codelineno-4-4"></a>]
</code></pre></div></p>
<p><strong>Python code:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#guides-using_prompts-__codelineno-5-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.prompts.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">PromptData</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#guides-using_prompts-__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#guides-using_prompts-__codelineno-5-3"></a><span class="n">chat_data</span><span class="p">:</span> <span class="n">PromptData</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;persona&quot;</span><span class="p">:</span> <span class="s2">&quot;historian&quot;</span><span class="p">,</span> <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;the Roman Empire&quot;</span><span class="p">}</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#guides-using_prompts-__codelineno-5-4"></a>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#guides-using_prompts-__codelineno-5-5"></a><span class="c1"># Uses default registry and default template engine (configured to jinja2_chat_formatter)</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#guides-using_prompts-__codelineno-5-6"></a><span class="n">chat_messages</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">prompts</span><span class="o">.</span><span class="n">render_chat_prompt</span><span class="p">(</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#guides-using_prompts-__codelineno-5-7"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;chat_style_prompt&quot;</span><span class="p">,</span> 
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#guides-using_prompts-__codelineno-5-8"></a>    <span class="n">data</span><span class="o">=</span><span class="n">chat_data</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#guides-using_prompts-__codelineno-5-9"></a><span class="p">)</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#guides-using_prompts-__codelineno-5-10"></a><span class="k">if</span> <span class="n">chat_messages</span><span class="p">:</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#guides-using_prompts-__codelineno-5-11"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rendered chat messages: </span><span class="si">{</span><span class="n">chat_messages</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#guides-using_prompts-__codelineno-5-12"></a>    <span class="c1"># Output:</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#guides-using_prompts-__codelineno-5-13"></a>    <span class="c1"># [</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#guides-using_prompts-__codelineno-5-14"></a>    <span class="c1">#   {&#39;role&#39;: &#39;system&#39;, &#39;content&#39;: &#39;You are a helpful historian.&#39;},</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#guides-using_prompts-__codelineno-5-15"></a>    <span class="c1">#   {&#39;role&#39;: &#39;user&#39;, &#39;content&#39;: &#39;Tell me about the Roman Empire.&#39;}</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#guides-using_prompts-__codelineno-5-16"></a>    <span class="c1"># ]</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#guides-using_prompts-__codelineno-5-17"></a>    <span class="c1"># response = await genie.llm.chat(chat_messages)</span>
</code></pre></div></p>
<h3 id="guides-using_prompts-4-listing-available-templates">4. Listing Available Templates<a class="headerlink" href="#guides-using_prompts-4-listing-available-templates" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#guides-using_prompts-__codelineno-6-1"></a><span class="n">available_templates</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">prompts</span><span class="o">.</span><span class="n">list_templates</span><span class="p">()</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#guides-using_prompts-__codelineno-6-2"></a><span class="c1"># Or for a specific registry:</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#guides-using_prompts-__codelineno-6-3"></a><span class="c1"># available_templates = await genie.prompts.list_templates(registry_id=&quot;my_other_registry&quot;)</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#guides-using_prompts-__codelineno-6-4"></a>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#guides-using_prompts-__codelineno-6-5"></a><span class="k">for</span> <span class="n">template_id</span> <span class="ow">in</span> <span class="n">available_templates</span><span class="p">:</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#guides-using_prompts-__codelineno-6-6"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Name: </span><span class="si">{</span><span class="n">template_id</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, Version: </span><span class="si">{</span><span class="n">template_id</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;version&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">, Desc: </span><span class="si">{</span><span class="n">template_id</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="guides-using_prompts-creating-custom-prompt-plugins">Creating Custom Prompt Plugins<a class="headerlink" href="#guides-using_prompts-creating-custom-prompt-plugins" title="Permanent link">&para;</a></h2>
<ul>
<li><strong><code>PromptRegistryPlugin</code></strong>: Implement <code>get_template_content</code> and <code>list_available_templates</code>.</li>
<li><strong><code>PromptTemplatePlugin</code></strong>: Implement <code>render</code> (for string output) and <code>render_chat_messages</code> (for <code>List[ChatMessage]</code> output).</li>
</ul>
<p>Register your custom plugins via entry points in <code>pyproject.toml</code> or ensure they are discoverable via <code>plugin_dev_dirs</code>.</p></section><section class="print-page" id="guides-using_conversation_state" heading-number="1.12"><h1 id="guides-using_conversation_state-managing-conversation-state-genieconversation">Managing Conversation State (<code>genie.conversation</code>)<a class="headerlink" href="#guides-using_conversation_state-managing-conversation-state-genieconversation" title="Permanent link">&para;</a></h1>
<p>Genie Tooling provides an interface for managing conversation state, primarily the history of messages in a chat interaction. This is accessible via <code>genie.conversation</code>.</p>
<h2 id="guides-using_conversation_state-core-concepts">Core Concepts<a class="headerlink" href="#guides-using_conversation_state-core-concepts" title="Permanent link">&para;</a></h2>
<ul>
<li><strong><code>ConversationInterface</code> (<code>genie.conversation</code>)</strong>: The facade interface for all conversation state operations.</li>
<li><strong><code>ConversationStateProviderPlugin</code></strong>: Responsible for storing, retrieving, and deleting conversation states. Each state is typically identified by a unique <code>session_id</code>.<ul>
<li>Built-in: <code>InMemoryStateProviderPlugin</code> (alias: <code>in_memory_convo_provider</code>), <code>RedisStateProviderPlugin</code> (alias: <code>redis_convo_provider</code>).</li>
</ul>
</li>
<li><strong><code>ConversationState</code> (TypedDict)</strong>: The structure for conversation data:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-using_conversation_state-__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Any</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-using_conversation_state-__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.llm_providers.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChatMessage</span> <span class="c1"># Assuming ChatMessage is defined</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#guides-using_conversation_state-__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#guides-using_conversation_state-__codelineno-0-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">ConversationState</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#guides-using_conversation_state-__codelineno-0-5"></a>    <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#guides-using_conversation_state-__codelineno-0-6"></a>    <span class="n">history</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ChatMessage</span><span class="p">]</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#guides-using_conversation_state-__codelineno-0-7"></a>    <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> 
</code></pre></div></li>
</ul>
<h2 id="guides-using_conversation_state-configuration">Configuration<a class="headerlink" href="#guides-using_conversation_state-configuration" title="Permanent link">&para;</a></h2>
<p>You configure the default conversation state provider via <code>FeatureSettings</code> or explicit <code>MiddlewareConfig</code> settings.</p>
<p><strong>Via <code>FeatureSettings</code>:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-using_conversation_state-__codelineno-1-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiddlewareConfig</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#guides-using_conversation_state-__codelineno-1-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureSettings</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#guides-using_conversation_state-__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#guides-using_conversation_state-__codelineno-1-4"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#guides-using_conversation_state-__codelineno-1-5"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#guides-using_conversation_state-__codelineno-1-6"></a>        <span class="c1"># ... other features ...</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#guides-using_conversation_state-__codelineno-1-7"></a>        <span class="n">conversation_state_provider</span><span class="o">=</span><span class="s2">&quot;in_memory_convo_provider&quot;</span> <span class="c1"># Default</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#guides-using_conversation_state-__codelineno-1-8"></a>        <span class="c1"># OR for Redis:</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#guides-using_conversation_state-__codelineno-1-9"></a>        <span class="c1"># conversation_state_provider=&quot;redis_convo_provider&quot; </span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#guides-using_conversation_state-__codelineno-1-10"></a>    <span class="p">),</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#guides-using_conversation_state-__codelineno-1-11"></a>    <span class="c1"># Example: Configure the RedisStateProviderPlugin if chosen</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#guides-using_conversation_state-__codelineno-1-12"></a>    <span class="c1"># conversation_state_provider_configurations={</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#guides-using_conversation_state-__codelineno-1-13"></a>    <span class="c1">#     &quot;redis_conversation_state_v1&quot;: { # Canonical ID</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#guides-using_conversation_state-__codelineno-1-14"></a>    <span class="c1">#         &quot;redis_url&quot;: &quot;redis://localhost:6379/2&quot;,</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#guides-using_conversation_state-__codelineno-1-15"></a>    <span class="c1">#         &quot;key_prefix&quot;: &quot;my_app_cs:&quot;,</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#guides-using_conversation_state-__codelineno-1-16"></a>    <span class="c1">#         &quot;default_ttl_seconds&quot;: 7200 # 2 hours</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#guides-using_conversation_state-__codelineno-1-17"></a>    <span class="c1">#     }</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#guides-using_conversation_state-__codelineno-1-18"></a>    <span class="c1"># }</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#guides-using_conversation_state-__codelineno-1-19"></a><span class="p">)</span>
</code></pre></div>
<p><strong>Explicit Configuration:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#guides-using_conversation_state-__codelineno-2-1"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#guides-using_conversation_state-__codelineno-2-2"></a>    <span class="n">default_conversation_state_provider_id</span><span class="o">=</span><span class="s2">&quot;in_memory_conversation_state_v1&quot;</span><span class="p">,</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#guides-using_conversation_state-__codelineno-2-3"></a>    <span class="c1"># conversation_state_provider_configurations={ ... }</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#guides-using_conversation_state-__codelineno-2-4"></a><span class="p">)</span>
</code></pre></div>
<h2 id="guides-using_conversation_state-using-genieconversation">Using <code>genie.conversation</code><a class="headerlink" href="#guides-using_conversation_state-using-genieconversation" title="Permanent link">&para;</a></h2>
<h3 id="guides-using_conversation_state-1-loading-conversation-state">1. Loading Conversation State<a class="headerlink" href="#guides-using_conversation_state-1-loading-conversation-state" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#guides-using_conversation_state-__codelineno-3-1"></a><span class="c1"># Assuming &#39;genie&#39; is an initialized Genie instance</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#guides-using_conversation_state-__codelineno-3-2"></a><span class="n">session_id</span> <span class="o">=</span> <span class="s2">&quot;user123_chat_abc&quot;</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#guides-using_conversation_state-__codelineno-3-3"></a><span class="n">state</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">conversation</span><span class="o">.</span><span class="n">load_state</span><span class="p">(</span><span class="n">session_id</span><span class="p">)</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#guides-using_conversation_state-__codelineno-3-4"></a><span class="c1"># state = await genie.conversation.load_state(session_id, provider_id=&quot;custom_store&quot;) # Optional</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#guides-using_conversation_state-__codelineno-3-5"></a>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#guides-using_conversation_state-__codelineno-3-6"></a><span class="k">if</span> <span class="n">state</span><span class="p">:</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#guides-using_conversation_state-__codelineno-3-7"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded history for </span><span class="si">{</span><span class="n">session_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;history&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#guides-using_conversation_state-__codelineno-3-8"></a><span class="k">else</span><span class="p">:</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#guides-using_conversation_state-__codelineno-3-9"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No existing state for </span><span class="si">{</span><span class="n">session_id</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="guides-using_conversation_state-2-adding-a-message-to-a-session">2. Adding a Message to a Session<a class="headerlink" href="#guides-using_conversation_state-2-adding-a-message-to-a-session" title="Permanent link">&para;</a></h3>
<p>This method handles loading the existing state (or creating a new one if it doesn't exist), appending the message, and saving the updated state.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#guides-using_conversation_state-__codelineno-4-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.llm_providers.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChatMessage</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#guides-using_conversation_state-__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#guides-using_conversation_state-__codelineno-4-3"></a><span class="n">session_id</span> <span class="o">=</span> <span class="s2">&quot;user123_chat_abc&quot;</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#guides-using_conversation_state-__codelineno-4-4"></a><span class="n">new_user_message</span><span class="p">:</span> <span class="n">ChatMessage</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;What&#39;s new?&quot;</span><span class="p">}</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#guides-using_conversation_state-__codelineno-4-5"></a>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#guides-using_conversation_state-__codelineno-4-6"></a><span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">conversation</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span><span class="n">session_id</span><span class="p">,</span> <span class="n">new_user_message</span><span class="p">)</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#guides-using_conversation_state-__codelineno-4-7"></a><span class="c1"># await genie.conversation.add_message(session_id, new_user_message, provider_id=&quot;custom_store&quot;)</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#guides-using_conversation_state-__codelineno-4-8"></a>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#guides-using_conversation_state-__codelineno-4-9"></a><span class="c1"># If you then get an assistant response:</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#guides-using_conversation_state-__codelineno-4-10"></a><span class="c1"># assistant_response: ChatMessage = {&quot;role&quot;: &quot;assistant&quot;, &quot;content&quot;: &quot;Not much, how about you?&quot;}</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#guides-using_conversation_state-__codelineno-4-11"></a><span class="c1"># await genie.conversation.add_message(session_id, assistant_response)</span>
</code></pre></div>
The <code>add_message</code> method automatically updates a <code>last_updated</code> timestamp in the state's metadata. If it's a new session, it also adds a <code>created_at</code> timestamp.</p>
<h3 id="guides-using_conversation_state-3-saving-conversation-state-explicitly">3. Saving Conversation State (Explicitly)<a class="headerlink" href="#guides-using_conversation_state-3-saving-conversation-state-explicitly" title="Permanent link">&para;</a></h3>
<p>While <code>add_message</code> handles saving, you can explicitly save a state if you've modified it directly (e.g., adding custom metadata).</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#guides-using_conversation_state-__codelineno-5-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.prompts.conversation.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConversationState</span> <span class="c1"># Correct import</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#guides-using_conversation_state-__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#guides-using_conversation_state-__codelineno-5-3"></a><span class="n">session_id</span> <span class="o">=</span> <span class="s2">&quot;user123_chat_abc&quot;</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#guides-using_conversation_state-__codelineno-5-4"></a><span class="n">current_state</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">conversation</span><span class="o">.</span><span class="n">load_state</span><span class="p">(</span><span class="n">session_id</span><span class="p">)</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#guides-using_conversation_state-__codelineno-5-5"></a><span class="k">if</span> <span class="ow">not</span> <span class="n">current_state</span><span class="p">:</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#guides-using_conversation_state-__codelineno-5-6"></a>    <span class="n">current_state</span> <span class="o">=</span> <span class="n">ConversationState</span><span class="p">(</span><span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span> <span class="n">history</span><span class="o">=</span><span class="p">[],</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{})</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#guides-using_conversation_state-__codelineno-5-7"></a>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#guides-using_conversation_state-__codelineno-5-8"></a><span class="c1"># Modify state</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#guides-using_conversation_state-__codelineno-5-9"></a><span class="n">current_state</span><span class="p">[</span><span class="s2">&quot;history&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Context updated.&quot;</span><span class="p">})</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#guides-using_conversation_state-__codelineno-5-10"></a><span class="k">if</span> <span class="n">current_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;metadata&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">current_state</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#guides-using_conversation_state-__codelineno-5-11"></a><span class="n">current_state</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">][</span><span class="s2">&quot;custom_flag&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#guides-using_conversation_state-__codelineno-5-12"></a>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#guides-using_conversation_state-__codelineno-5-13"></a><span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">conversation</span><span class="o">.</span><span class="n">save_state</span><span class="p">(</span><span class="n">current_state</span><span class="p">)</span>
</code></pre></div>
<h3 id="guides-using_conversation_state-4-deleting-conversation-state">4. Deleting Conversation State<a class="headerlink" href="#guides-using_conversation_state-4-deleting-conversation-state" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#guides-using_conversation_state-__codelineno-6-1"></a><span class="n">session_id</span> <span class="o">=</span> <span class="s2">&quot;user123_chat_to_delete&quot;</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#guides-using_conversation_state-__codelineno-6-2"></a><span class="n">was_deleted</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">conversation</span><span class="o">.</span><span class="n">delete_state</span><span class="p">(</span><span class="n">session_id</span><span class="p">)</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#guides-using_conversation_state-__codelineno-6-3"></a><span class="k">if</span> <span class="n">was_deleted</span><span class="p">:</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#guides-using_conversation_state-__codelineno-6-4"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;State for session </span><span class="si">{</span><span class="n">session_id</span><span class="si">}</span><span class="s2"> deleted.&quot;</span><span class="p">)</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#guides-using_conversation_state-__codelineno-6-5"></a><span class="k">else</span><span class="p">:</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#guides-using_conversation_state-__codelineno-6-6"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;State for session </span><span class="si">{</span><span class="n">session_id</span><span class="si">}</span><span class="s2"> not found or delete failed.&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="guides-using_conversation_state-creating-custom-conversation-state-providers">Creating Custom Conversation State Providers<a class="headerlink" href="#guides-using_conversation_state-creating-custom-conversation-state-providers" title="Permanent link">&para;</a></h2>
<p>Implement the <code>ConversationStateProviderPlugin</code> protocol, defining <code>load_state</code>, <code>save_state</code>, and <code>delete_state</code> methods to interact with your chosen backend (database, file, etc.). Register your plugin via entry points or <code>plugin_dev_dirs</code>.</p></section><section class="print-page" id="guides-observability_tracing" heading-number="1.13"><h1 id="guides-observability_tracing-observability-and-interaction-tracing-genieobservability">Observability and Interaction Tracing (<code>genie.observability</code>)<a class="headerlink" href="#guides-observability_tracing-observability-and-interaction-tracing-genieobservability" title="Permanent link">&para;</a></h1>
<p>Genie Tooling is designed for production use, and a key requirement for any production system is deep visibility into its internal workings. The framework is heavily instrumented to provide "zero-effort" observability. By simply enabling a tracer plugin, you can get detailed, correlated traces for the entire lifecycle of an agentic operation, from command processing and tool lookup to LLM calls and tool execution.</p>
<h2 id="guides-observability_tracing-core-concepts">Core Concepts<a class="headerlink" href="#guides-observability_tracing-core-concepts" title="Permanent link">&para;</a></h2>
<ul>
<li><strong><code>ObservabilityInterface</code> (<code>genie.observability</code>)</strong>: The facade interface for tracing events.</li>
<li><strong><code>InteractionTracerPlugin</code></strong>: A plugin responsible for handling trace events.<ul>
<li>Built-in:<ul>
<li><code>ConsoleTracerPlugin</code> (alias: <code>console_tracer</code>): Prints trace events to the console.</li>
<li><code>OpenTelemetryTracerPlugin</code> (alias: <code>otel_tracer</code>): Exports traces using the OpenTelemetry SDK to backends like Jaeger, SigNoz, etc.</li>
</ul>
</li>
</ul>
</li>
<li><strong><code>LogAdapterPlugin</code></strong>: A plugin that formats trace events for output. The <code>ConsoleTracerPlugin</code> delegates its formatting to the configured <code>LogAdapterPlugin</code> (e.g., <code>DefaultLogAdapter</code> or <code>PyviderTelemetryLogAdapter</code>). This decouples tracing from formatting.</li>
<li><strong><code>TraceEvent</code> (TypedDict)</strong>: The raw, structured data for a trace event.</li>
<li><strong>Correlation ID</strong>: A unique ID that links all events within a single top-level operation (e.g., one <code>genie.run_command()</code> call), allowing observability backends to construct a complete trace hierarchy.</li>
</ul>
<h2 id="guides-observability_tracing-automatic-tracing">Automatic Tracing<a class="headerlink" href="#guides-observability_tracing-automatic-tracing" title="Permanent link">&para;</a></h2>
<p>When a tracer is enabled, the framework automatically emits detailed events for:
*   <strong>Facade Calls</strong>: Start and end of <code>genie.run_command</code>, <code>genie.execute_tool</code>, <code>genie.rag.index_*</code>, <code>genie.rag.search</code>, etc.
*   <strong>Command Processing</strong>: The full lifecycle, including which tools were considered (<code>tool_lookup.end</code>), the prompt sent to the LLM (<code>command_processor.llm_assisted.prompt_context_ready</code>), and the LLM's parsed decision (<code>command_processor.llm_assisted.result</code>).
*   <strong>Tool Invocation</strong>: Caching checks (<code>invocation.cache.hit/miss</code>), input validation, the actual tool execution (<code>tool.execute.start/end</code>), and output transformation.
*   <strong>LLM Calls</strong>: All <code>genie.llm.chat/generate</code> calls, including the provider used, all parameters (<code>temperature</code>, <code>model</code>, etc.), and token usage from the response.</p>
<h2 id="guides-observability_tracing-configuration">Configuration<a class="headerlink" href="#guides-observability_tracing-configuration" title="Permanent link">&para;</a></h2>
<p>Configure the default interaction tracer via <code>FeatureSettings</code>.</p>
<h3 id="guides-observability_tracing-example-1-simple-console-tracing">Example 1: Simple Console Tracing<a class="headerlink" href="#guides-observability_tracing-example-1-simple-console-tracing" title="Permanent link">&para;</a></h3>
<p>This is the easiest way to see what's happening during development.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-observability_tracing-__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiddlewareConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-observability_tracing-__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureSettings</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#guides-observability_tracing-__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#guides-observability_tracing-__codelineno-0-4"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#guides-observability_tracing-__codelineno-0-5"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#guides-observability_tracing-__codelineno-0-6"></a>        <span class="c1"># ... other features ...</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#guides-observability_tracing-__codelineno-0-7"></a>        <span class="n">observability_tracer</span><span class="o">=</span><span class="s2">&quot;console_tracer&quot;</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#guides-observability_tracing-__codelineno-0-8"></a>    <span class="p">),</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#guides-observability_tracing-__codelineno-0-9"></a>    <span class="c1"># Optional: Configure the log adapter used by the console tracer</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#guides-observability_tracing-__codelineno-0-10"></a>    <span class="n">log_adapter_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#guides-observability_tracing-__codelineno-0-11"></a>        <span class="s2">&quot;default_log_adapter_v1&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#guides-observability_tracing-__codelineno-0-12"></a>            <span class="s2">&quot;log_level&quot;</span><span class="p">:</span> <span class="s2">&quot;DEBUG&quot;</span> <span class="c1"># Set the level for the &#39;genie_tooling&#39; logger</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#guides-observability_tracing-__codelineno-0-13"></a>        <span class="p">}</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#guides-observability_tracing-__codelineno-0-14"></a>    <span class="p">}</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#guides-observability_tracing-__codelineno-0-15"></a><span class="p">)</span>
</code></pre></div>
<h3 id="guides-observability_tracing-example-2-opentelemetry-tracing-for-jaeger-signoz-etc">Example 2: OpenTelemetry Tracing (for Jaeger, SigNoz, etc.)<a class="headerlink" href="#guides-observability_tracing-example-2-opentelemetry-tracing-for-jaeger-signoz-etc" title="Permanent link">&para;</a></h3>
<p>This configuration exports traces to an OpenTelemetry collector.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-observability_tracing-__codelineno-1-1"></a><span class="c1"># Prerequisite: Start an OTel collector (e.g., Jaeger all-in-one)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#guides-observability_tracing-__codelineno-1-2"></a><span class="c1"># docker run -d --name jaeger -p 16686:16686 -p 4318:4318 jaegertracing/all-in-one:latest</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#guides-observability_tracing-__codelineno-1-3"></a><span class="c1"># With this setup, running your Genie application will send detailed traces to Jaeger, which you can view at `http://localhost:16686`.</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#guides-observability_tracing-__codelineno-1-4"></a>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#guides-observability_tracing-__codelineno-1-5"></a><span class="c1">## Application-Level Tracing</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#guides-observability_tracing-__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#guides-observability_tracing-__codelineno-1-7"></a><span class="n">Beyond</span> <span class="n">the</span> <span class="n">automatic</span> <span class="n">framework</span> <span class="n">traces</span><span class="p">,</span> <span class="n">Genie</span> <span class="n">provides</span> <span class="n">tools</span> <span class="n">to</span> <span class="n">seamlessly</span> <span class="n">integrate</span> <span class="n">your</span> <span class="n">application</span><span class="s1">&#39;s logic into the same trace.</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#guides-observability_tracing-__codelineno-1-8"></a><span class="o">=======</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#guides-observability_tracing-__codelineno-1-9"></a>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#guides-observability_tracing-__codelineno-1-10"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#guides-observability_tracing-__codelineno-1-11"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#guides-observability_tracing-__codelineno-1-12"></a>        <span class="n">observability_tracer</span><span class="o">=</span><span class="s2">&quot;otel_tracer&quot;</span><span class="p">,</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#guides-observability_tracing-__codelineno-1-13"></a>        <span class="c1"># The endpoint for the OTLP/HTTP exporter</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#guides-observability_tracing-__codelineno-1-14"></a>        <span class="n">observability_otel_endpoint</span><span class="o">=</span><span class="s2">&quot;http://localhost:4318/v1/traces&quot;</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#guides-observability_tracing-__codelineno-1-15"></a>    <span class="p">),</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#guides-observability_tracing-__codelineno-1-16"></a>    <span class="n">observability_tracer_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#guides-observability_tracing-__codelineno-1-17"></a>        <span class="s2">&quot;otel_tracer_plugin_v1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># Canonical ID</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#guides-observability_tracing-__codelineno-1-18"></a>            <span class="s2">&quot;otel_service_name&quot;</span><span class="p">:</span> <span class="s2">&quot;my-genie-agent-app&quot;</span><span class="p">,</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#guides-observability_tracing-__codelineno-1-19"></a>            <span class="s2">&quot;otel_service_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.2.3&quot;</span><span class="p">,</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#guides-observability_tracing-__codelineno-1-20"></a>            <span class="s2">&quot;resource_attributes&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;deployment.environment&quot;</span><span class="p">:</span> <span class="s2">&quot;staging&quot;</span><span class="p">}</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#guides-observability_tracing-__codelineno-1-21"></a>        <span class="p">}</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#guides-observability_tracing-__codelineno-1-22"></a>    <span class="p">}</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#guides-observability_tracing-__codelineno-1-23"></a><span class="p">)</span>
</code></pre></div>
<h3 id="guides-observability_tracing-simplified-tracing-with-the-traceable-decorator">Simplified Tracing with the <code>@traceable</code> Decorator<a class="headerlink" href="#guides-observability_tracing-simplified-tracing-with-the-traceable-decorator" title="Permanent link">&para;</a></h3>
<p>For the common case of tracing an entire function call, Genie provides the <code>@traceable</code> decorator. This is the recommended approach for instrumenting functions within your tools.</p>
<p><strong>How it works:</strong>
*   It automatically creates a new OpenTelemetry span when the decorated function is called.
*   It links this new span to the parent span found in the <code>context</code> argument.
*   It records function arguments as span attributes.
*   It automatically records exceptions and sets the span status to <code>ERROR</code>.</p>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#guides-observability_tracing-__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling</span><span class="w"> </span><span class="kn">import</span> <span class="n">tool</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#guides-observability_tracing-__codelineno-2-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.observability</span><span class="w"> </span><span class="kn">import</span> <span class="n">traceable</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#guides-observability_tracing-__codelineno-2-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#guides-observability_tracing-__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#guides-observability_tracing-__codelineno-2-5"></a><span class="nd">@traceable</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#guides-observability_tracing-__codelineno-2-6"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_perform_database_query</span><span class="p">(</span><span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#guides-observability_tracing-__codelineno-2-7"></a>    <span class="c1"># A span for &#39;_perform_database_query&#39; is automatically created</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#guides-observability_tracing-__codelineno-2-8"></a>    <span class="c1"># and linked to the parent &#39;get_user_data.execute&#39; span.</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#guides-observability_tracing-__codelineno-2-9"></a>    <span class="c1"># The &#39;query&#39; argument will be added as an attribute to the span.</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#guides-observability_tracing-__codelineno-2-10"></a>    <span class="c1"># ... database logic ...</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#guides-observability_tracing-__codelineno-2-11"></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;John Doe&quot;</span><span class="p">}</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#guides-observability_tracing-__codelineno-2-12"></a>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#guides-observability_tracing-__codelineno-2-13"></a><span class="nd">@tool</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#guides-observability_tracing-__codelineno-2-14"></a><span class="k">class</span><span class="w"> </span><span class="nc">UserDataTool</span><span class="p">:</span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#guides-observability_tracing-__codelineno-2-15"></a>    <span class="c1"># ... (plugin_id, get_metadata, etc.) ...</span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#guides-observability_tracing-__codelineno-2-16"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">key_provider</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#guides-observability_tracing-__codelineno-2-17"></a>        <span class="n">user_id</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">)</span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#guides-observability_tracing-__codelineno-2-18"></a>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#guides-observability_tracing-__codelineno-2-19"></a>        <span class="c1"># The context dictionary received here contains the OTel context,</span>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#guides-observability_tracing-__codelineno-2-20"></a>        <span class="c1"># which is automatically passed to the @traceable function.</span>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#guides-observability_tracing-__codelineno-2-21"></a>        <span class="n">db_result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">_perform_database_query</span><span class="p">(</span>
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#guides-observability_tracing-__codelineno-2-22"></a>            <span class="n">query</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM users WHERE id=</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#guides-observability_tracing-__codelineno-2-23"></a>            <span class="n">context</span><span class="o">=</span><span class="n">context</span>
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#guides-observability_tracing-__codelineno-2-24"></a>        <span class="p">)</span>
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#guides-observability_tracing-__codelineno-2-25"></a>        <span class="k">return</span> <span class="n">db_result</span>
</code></pre></div>
<h3 id="guides-observability_tracing-context-propagation-and-auto-instrumentation">Context Propagation and Auto-Instrumentation<a class="headerlink" href="#guides-observability_tracing-context-propagation-and-auto-instrumentation" title="Permanent link">&para;</a></h3>
<p>The <code>@traceable</code> decorator works because Genie automatically propagates the OpenTelemetry <code>Context</code> object. When Genie's <code>ToolInvoker</code> calls your tool's <code>execute</code> method, the <code>context</code> dictionary it passes now contains a special key, <code>otel_context</code>.</p>
<p>This seamless context propagation means that standard OpenTelemetry auto-instrumentation libraries (e.g., <code>opentelemetry-instrumentation-httpx</code>, <code>opentelemetry-instrumentation-psycopg2</code>) will work out-of-the-box. If your traceable function makes a call using an instrumented library, that library will automatically create a child span, giving you an incredibly detailed, end-to-end trace with zero extra effort.
While most tracing is automatic, you can add custom events from your own application logic using <code>await genie.observability.trace_event(...)</code>.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#guides-observability_tracing-__codelineno-3-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">uuid</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#guides-observability_tracing-__codelineno-3-2"></a><span class="c1"># correlation_id = str(uuid.uuid4()) # Start a new logical operation</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#guides-observability_tracing-__codelineno-3-3"></a><span class="c1"># await genie.observability.trace_event(</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#guides-observability_tracing-__codelineno-3-4"></a><span class="c1">#     event_name=&quot;my_app.custom_process.start&quot;,</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#guides-observability_tracing-__codelineno-3-5"></a><span class="c1">#     data={&quot;input_id&quot;: &quot;123&quot;, &quot;user_category&quot;: &quot;premium&quot;},</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#guides-observability_tracing-__codelineno-3-6"></a><span class="c1">#     component=&quot;MyCustomModule&quot;,</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#guides-observability_tracing-__codelineno-3-7"></a><span class="c1">#     correlation_id=correlation_id</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#guides-observability_tracing-__codelineno-3-8"></a><span class="c1"># )</span>
</code></pre></div>
This allows your application-specific events to appear within the same trace as the framework's internal events, providing a complete picture.</p></section><section class="print-page" id="guides-using_human_in_loop" heading-number="1.14"><h1 id="guides-using_human_in_loop-human-in-the-loop-hitl-approvals-geniehuman_in_loop">Human-in-the-Loop (HITL) Approvals (<code>genie.human_in_loop</code>)<a class="headerlink" href="#guides-using_human_in_loop-human-in-the-loop-hitl-approvals-geniehuman_in_loop" title="Permanent link">&para;</a></h1>
<p>Genie Tooling supports Human-in-the-Loop (HITL) workflows, allowing critical actions or ambiguous decisions to be paused for human review and approval before proceeding. This is primarily managed via the <code>genie.human_in_loop</code> interface.</p>
<h2 id="guides-using_human_in_loop-core-concepts">Core Concepts<a class="headerlink" href="#guides-using_human_in_loop-core-concepts" title="Permanent link">&para;</a></h2>
<ul>
<li><strong><code>HITLInterface</code> (<code>genie.human_in_loop</code>)</strong>: The facade interface for requesting human approval.</li>
<li><strong><code>HumanApprovalRequestPlugin</code></strong>: A plugin responsible for presenting an approval request to a human and collecting their response.<ul>
<li>Built-in: <code>CliApprovalPlugin</code> (alias: <code>cli_hitl_approver</code>) - Prompts on the command line.</li>
</ul>
</li>
<li><strong><code>ApprovalRequest</code> (TypedDict)</strong>: Data structure for an approval request:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-using_human_in_loop-__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">TypedDict</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-using_human_in_loop-__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#guides-using_human_in_loop-__codelineno-0-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">ApprovalRequest</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#guides-using_human_in_loop-__codelineno-0-4"></a>    <span class="n">request_id</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#guides-using_human_in_loop-__codelineno-0-5"></a>    <span class="n">prompt</span><span class="p">:</span> <span class="nb">str</span> <span class="c1"># Message shown to the human</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#guides-using_human_in_loop-__codelineno-0-6"></a>    <span class="n">data_to_approve</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="c1"># Data needing approval</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#guides-using_human_in_loop-__codelineno-0-7"></a>    <span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#guides-using_human_in_loop-__codelineno-0-8"></a>    <span class="n">timeout_seconds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</code></pre></div></li>
<li><strong><code>ApprovalResponse</code> (TypedDict)</strong>: Data structure for the human's response:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-using_human_in_loop-__codelineno-1-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">ApprovalResponse</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#guides-using_human_in_loop-__codelineno-1-2"></a>    <span class="n">request_id</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#guides-using_human_in_loop-__codelineno-1-3"></a>    <span class="n">status</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;pending&quot;</span><span class="p">,</span> <span class="s2">&quot;approved&quot;</span><span class="p">,</span> <span class="s2">&quot;denied&quot;</span><span class="p">,</span> <span class="s2">&quot;timeout&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">]</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#guides-using_human_in_loop-__codelineno-1-4"></a>    <span class="n">approver_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#guides-using_human_in_loop-__codelineno-1-5"></a>    <span class="n">reason</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="c1"># Reason for denial or comments</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#guides-using_human_in_loop-__codelineno-1-6"></a>    <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</code></pre></div></li>
</ul>
<h2 id="guides-using_human_in_loop-configuration">Configuration<a class="headerlink" href="#guides-using_human_in_loop-configuration" title="Permanent link">&para;</a></h2>
<p>Configure the default HITL approval plugin via <code>FeatureSettings</code> or explicit <code>MiddlewareConfig</code>.</p>
<p><strong>Via <code>FeatureSettings</code>:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#guides-using_human_in_loop-__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiddlewareConfig</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#guides-using_human_in_loop-__codelineno-2-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureSettings</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#guides-using_human_in_loop-__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#guides-using_human_in_loop-__codelineno-2-4"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#guides-using_human_in_loop-__codelineno-2-5"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#guides-using_human_in_loop-__codelineno-2-6"></a>        <span class="c1"># ... other features ...</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#guides-using_human_in_loop-__codelineno-2-7"></a>        <span class="n">hitl_approver</span><span class="o">=</span><span class="s2">&quot;cli_hitl_approver&quot;</span> <span class="c1"># Use CLI for approvals</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#guides-using_human_in_loop-__codelineno-2-8"></a>    <span class="p">),</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#guides-using_human_in_loop-__codelineno-2-9"></a>    <span class="c1"># Example: Configure the CliApprovalPlugin (though it has no specific config by default)</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#guides-using_human_in_loop-__codelineno-2-10"></a>    <span class="c1"># hitl_approver_configurations={</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#guides-using_human_in_loop-__codelineno-2-11"></a>    <span class="c1">#     &quot;cli_approval_plugin_v1&quot;: {} </span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#guides-using_human_in_loop-__codelineno-2-12"></a>    <span class="c1"># }</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#guides-using_human_in_loop-__codelineno-2-13"></a><span class="p">)</span>
</code></pre></div>
<h2 id="guides-using_human_in_loop-integration-with-genierun_command">Integration with <code>genie.run_command()</code><a class="headerlink" href="#guides-using_human_in_loop-integration-with-genierun_command" title="Permanent link">&para;</a></h2>
<p>The most common use case for HITL is to require approval before a tool selected by <code>genie.run_command()</code> is executed. If an <code>HITLManager</code> is active (i.e., <code>features.hitl_approver</code> is not <code>"none"</code>), <code>genie.run_command()</code> will automatically:
1.  Determine the tool and parameters.
2.  Create an <code>ApprovalRequest</code> with the tool ID and parameters.
3.  Call <code>genie.human_in_loop.request_approval()</code>.
4.  If approved, execute the tool. If denied or timed out, return an error/message.</p>
<p><strong>Example:</strong>
If <code>hitl_approver</code> is set to <code>"cli_hitl_approver"</code> in <code>FeatureSettings</code> and <code>calculator_tool</code> is enabled in <code>tool_configurations</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#guides-using_human_in_loop-__codelineno-3-1"></a><span class="c1"># genie = await Genie.create(config=app_config_with_hitl)</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#guides-using_human_in_loop-__codelineno-3-2"></a><span class="c1"># command_result = await genie.run_command(&quot;What is 15 times 7?&quot;) </span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#guides-using_human_in_loop-__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#guides-using_human_in_loop-__codelineno-3-4"></a><span class="c1"># The CLI will prompt:</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#guides-using_human_in_loop-__codelineno-3-5"></a><span class="c1"># --- HUMAN APPROVAL REQUIRED ---</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#guides-using_human_in_loop-__codelineno-3-6"></a><span class="c1"># Request ID: &lt;uuid&gt;</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#guides-using_human_in_loop-__codelineno-3-7"></a><span class="c1"># Prompt: Approve execution of tool &#39;calculator_tool&#39; with params: {&#39;num1&#39;: 15, &#39;num2&#39;: 7, &#39;operation&#39;: &#39;multiply&#39;} for goal &#39;What is 15 times 7?&#39;?</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#guides-using_human_in_loop-__codelineno-3-8"></a><span class="c1"># Data/Action: {&#39;tool_id&#39;: &#39;calculator_tool&#39;, &#39;params&#39;: {&#39;num1&#39;: 15, &#39;num2&#39;: 7, &#39;operation&#39;: &#39;multiply&#39;}, &#39;step_reasoning&#39;: None}</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#guides-using_human_in_loop-__codelineno-3-9"></a><span class="c1"># Approve? (yes/no/y/n): </span>
</code></pre></div>
If the user types "no" and provides a reason, <code>command_result</code> might look like:
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#guides-using_human_in_loop-__codelineno-4-1"></a><span class="p">{</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#guides-using_human_in_loop-__codelineno-4-2"></a><span class="w">  </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Tool execution denied by HITL: User intervention required.&quot;</span><span class="p">,</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#guides-using_human_in_loop-__codelineno-4-3"></a><span class="w">  </span><span class="nt">&quot;thought_process&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;The LLM selected calculator_tool for 15 times 7.&quot;</span><span class="p">,</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#guides-using_human_in_loop-__codelineno-4-4"></a><span class="w">  </span><span class="nt">&quot;hitl_decision&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#guides-using_human_in_loop-__codelineno-4-5"></a><span class="w">    </span><span class="nt">&quot;request_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;denied&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;approver_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cli_user&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#guides-using_human_in_loop-__codelineno-4-6"></a><span class="w">    </span><span class="nt">&quot;reason&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;User intervention required.&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">...</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#guides-using_human_in_loop-__codelineno-4-7"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#guides-using_human_in_loop-__codelineno-4-8"></a><span class="p">}</span>
</code></pre></div></p>
<h2 id="guides-using_human_in_loop-manual-approval-requests-with-geniehuman_in_looprequest_approval">Manual Approval Requests with <code>genie.human_in_loop.request_approval()</code><a class="headerlink" href="#guides-using_human_in_loop-manual-approval-requests-with-geniehuman_in_looprequest_approval" title="Permanent link">&para;</a></h2>
<p>You can also manually trigger an approval request from your custom logic:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#guides-using_human_in_loop-__codelineno-5-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.hitl.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">ApprovalRequest</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#guides-using_human_in_loop-__codelineno-5-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">uuid</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#guides-using_human_in_loop-__codelineno-5-3"></a>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#guides-using_human_in_loop-__codelineno-5-4"></a><span class="n">request_details</span> <span class="o">=</span> <span class="n">ApprovalRequest</span><span class="p">(</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#guides-using_human_in_loop-__codelineno-5-5"></a>    <span class="n">request_id</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#guides-using_human_in_loop-__codelineno-5-6"></a>    <span class="n">prompt</span><span class="o">=</span><span class="s2">&quot;Is it okay to proceed with this sensitive operation on customer data?&quot;</span><span class="p">,</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#guides-using_human_in_loop-__codelineno-5-7"></a>    <span class="n">data_to_approve</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;customer_id&quot;</span><span class="p">:</span> <span class="s2">&quot;cust_789&quot;</span><span class="p">,</span> <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;data_wipe&quot;</span><span class="p">},</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#guides-using_human_in_loop-__codelineno-5-8"></a>    <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">300</span> <span class="c1"># 5 minutes</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#guides-using_human_in_loop-__codelineno-5-9"></a><span class="p">)</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#guides-using_human_in_loop-__codelineno-5-10"></a>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#guides-using_human_in_loop-__codelineno-5-11"></a><span class="n">approval_response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">human_in_loop</span><span class="o">.</span><span class="n">request_approval</span><span class="p">(</span><span class="n">request_details</span><span class="p">)</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#guides-using_human_in_loop-__codelineno-5-12"></a><span class="c1"># approval_response = await genie.human_in_loop.request_approval(request_details, approver_id=&quot;my_specific_hitl_plugin&quot;)</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#guides-using_human_in_loop-__codelineno-5-13"></a>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#guides-using_human_in_loop-__codelineno-5-14"></a>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#guides-using_human_in_loop-__codelineno-5-15"></a><span class="k">if</span> <span class="n">approval_response</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;approved&quot;</span><span class="p">:</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#guides-using_human_in_loop-__codelineno-5-16"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Operation approved by </span><span class="si">{</span><span class="n">approval_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;approver_id&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">. Reason: </span><span class="si">{</span><span class="n">approval_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;reason&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#guides-using_human_in_loop-__codelineno-5-17"></a>    <span class="c1"># ... proceed with sensitive operation ...</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#guides-using_human_in_loop-__codelineno-5-18"></a><span class="k">else</span><span class="p">:</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#guides-using_human_in_loop-__codelineno-5-19"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Operation </span><span class="si">{</span><span class="n">approval_response</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">. Reason: </span><span class="si">{</span><span class="n">approval_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;reason&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="guides-using_human_in_loop-creating-custom-hitl-approval-plugins">Creating Custom HITL Approval Plugins<a class="headerlink" href="#guides-using_human_in_loop-creating-custom-hitl-approval-plugins" title="Permanent link">&para;</a></h2>
<p>Implement the <code>HumanApprovalRequestPlugin</code> protocol, defining the <code>request_approval(request: ApprovalRequest)</code> method. This method should handle the presentation of the request to a human (e.g., via a web UI, messaging platform, ticketing system) and return an <code>ApprovalResponse</code>. Register your plugin via entry points or <code>plugin_dev_dirs</code>.</p></section><section class="print-page" id="guides-token_usage_tracking" heading-number="1.15"><h1 id="guides-token_usage_tracking-token-usage-tracking-genieusage">Token Usage Tracking (<code>genie.usage</code>)<a class="headerlink" href="#guides-token_usage_tracking-token-usage-tracking-genieusage" title="Permanent link">&para;</a></h1>
<p>Genie Tooling provides an interface for tracking token usage by LLM providers, accessible via <code>genie.usage</code>. This helps in monitoring costs and understanding LLM consumption patterns.</p>
<h2 id="guides-token_usage_tracking-core-concepts">Core Concepts<a class="headerlink" href="#guides-token_usage_tracking-core-concepts" title="Permanent link">&para;</a></h2>
<ul>
<li><strong><code>UsageTrackingInterface</code> (<code>genie.usage</code>)</strong>: The facade interface for recording and summarizing token usage.</li>
<li><strong><code>TokenUsageRecorderPlugin</code></strong>: A plugin responsible for storing or exporting token usage records.<ul>
<li>Built-in:<ul>
<li><code>InMemoryTokenUsageRecorderPlugin</code> (alias: <code>in_memory_token_recorder</code>): Stores records in memory. Useful for simple summaries and testing.</li>
<li><code>OpenTelemetryMetricsTokenRecorderPlugin</code> (alias: <code>otel_metrics_recorder</code>): <strong>Recommended for production.</strong> Emits token counts as standard OpenTelemetry metrics, which can be scraped by systems like Prometheus.</li>
</ul>
</li>
</ul>
</li>
<li><strong><code>TokenUsageRecord</code> (TypedDict)</strong>: The structure for a single token usage event.</li>
</ul>
<h2 id="guides-token_usage_tracking-configuration">Configuration<a class="headerlink" href="#guides-token_usage_tracking-configuration" title="Permanent link">&para;</a></h2>
<p>Configure the default token usage recorder via <code>FeatureSettings</code>.</p>
<h3 id="guides-token_usage_tracking-example-1-in-memory-recorder-for-development">Example 1: In-Memory Recorder (for Development)<a class="headerlink" href="#guides-token_usage_tracking-example-1-in-memory-recorder-for-development" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-token_usage_tracking-__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiddlewareConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-token_usage_tracking-__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureSettings</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#guides-token_usage_tracking-__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#guides-token_usage_tracking-__codelineno-0-4"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#guides-token_usage_tracking-__codelineno-0-5"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#guides-token_usage_tracking-__codelineno-0-6"></a>        <span class="c1"># ... other features ...</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#guides-token_usage_tracking-__codelineno-0-7"></a>        <span class="n">token_usage_recorder</span><span class="o">=</span><span class="s2">&quot;in_memory_token_recorder&quot;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#guides-token_usage_tracking-__codelineno-0-8"></a>    <span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#guides-token_usage_tracking-__codelineno-0-9"></a><span class="p">)</span>
</code></pre></div>
<h3 id="guides-token_usage_tracking-example-2-opentelemetry-metrics-recorder-for-production">Example 2: OpenTelemetry Metrics Recorder (for Production)<a class="headerlink" href="#guides-token_usage_tracking-example-2-opentelemetry-metrics-recorder-for-production" title="Permanent link">&para;</a></h3>
<p>This is the recommended approach for production monitoring. It requires an OpenTelemetry collector setup.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-token_usage_tracking-__codelineno-1-1"></a><span class="c1"># Prerequisite: An OTel collector that can scrape Prometheus metrics.</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#guides-token_usage_tracking-__codelineno-1-2"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#guides-token_usage_tracking-__codelineno-1-3"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#guides-token_usage_tracking-__codelineno-1-4"></a>        <span class="c1"># ... other features ...</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#guides-token_usage_tracking-__codelineno-1-5"></a>        <span class="n">token_usage_recorder</span><span class="o">=</span><span class="s2">&quot;otel_metrics_recorder&quot;</span><span class="p">,</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#guides-token_usage_tracking-__codelineno-1-6"></a>        <span class="c1"># The OTel SDK must be initialized, which is done by the OTel tracer.</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#guides-token_usage_tracking-__codelineno-1-7"></a>        <span class="c1"># So, enable the tracer, even if you only care about metrics.</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#guides-token_usage_tracking-__codelineno-1-8"></a>        <span class="n">observability_tracer</span><span class="o">=</span><span class="s2">&quot;otel_tracer&quot;</span><span class="p">,</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#guides-token_usage_tracking-__codelineno-1-9"></a>    <span class="p">),</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#guides-token_usage_tracking-__codelineno-1-10"></a>    <span class="c1"># Configure the OTel tracer to initialize the SDK</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#guides-token_usage_tracking-__codelineno-1-11"></a>    <span class="n">observability_tracer_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#guides-token_usage_tracking-__codelineno-1-12"></a>        <span class="s2">&quot;otel_tracer_plugin_v1&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#guides-token_usage_tracking-__codelineno-1-13"></a>            <span class="s2">&quot;otel_service_name&quot;</span><span class="p">:</span> <span class="s2">&quot;my-app-with-token-metrics&quot;</span><span class="p">,</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#guides-token_usage_tracking-__codelineno-1-14"></a>            <span class="s2">&quot;exporter_type&quot;</span><span class="p">:</span> <span class="s2">&quot;console&quot;</span> <span class="c1"># Or your preferred OTel trace exporter</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#guides-token_usage_tracking-__codelineno-1-15"></a>        <span class="p">}</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#guides-token_usage_tracking-__codelineno-1-16"></a>    <span class="p">}</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#guides-token_usage_tracking-__codelineno-1-17"></a><span class="p">)</span>
</code></pre></div>
<h2 id="guides-token_usage_tracking-how-it-works">How It Works<a class="headerlink" href="#guides-token_usage_tracking-how-it-works" title="Permanent link">&para;</a></h2>
<p>Token usage is <strong>automatically recorded</strong> by <code>genie.llm.chat()</code> and <code>genie.llm.generate()</code> whenever the underlying LLM provider returns usage information.</p>
<h3 id="guides-token_usage_tracking-using-the-in-memory-recorder">Using the In-Memory Recorder<a class="headerlink" href="#guides-token_usage_tracking-using-the-in-memory-recorder" title="Permanent link">&para;</a></h3>
<p>If you use <code>"in_memory_token_recorder"</code>, you can get a simple summary:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#guides-token_usage_tracking-__codelineno-2-1"></a><span class="c1"># Assuming genie is initialized with the in-memory recorder</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#guides-token_usage_tracking-__codelineno-2-2"></a><span class="n">summary</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">usage</span><span class="o">.</span><span class="n">get_summary</span><span class="p">()</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#guides-token_usage_tracking-__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#guides-token_usage_tracking-__codelineno-2-4"></a><span class="c1"># Example output:</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#guides-token_usage_tracking-__codelineno-2-5"></a><span class="c1"># {</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#guides-token_usage_tracking-__codelineno-2-6"></a><span class="c1">#   &quot;in_memory_token_usage_recorder_v1&quot;: {</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#guides-token_usage_tracking-__codelineno-2-7"></a><span class="c1">#     &quot;total_records&quot;: 5,</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#guides-token_usage_tracking-__codelineno-2-8"></a><span class="c1">#     &quot;total_prompt_tokens&quot;: 1234,</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#guides-token_usage_tracking-__codelineno-2-9"></a><span class="c1">#     &quot;total_completion_tokens&quot;: 567,</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#guides-token_usage_tracking-__codelineno-2-10"></a><span class="c1">#     &quot;total_tokens_overall&quot;: 1801,</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#guides-token_usage_tracking-__codelineno-2-11"></a><span class="c1">#     &quot;by_model&quot;: {</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#guides-token_usage_tracking-__codelineno-2-12"></a><span class="c1">#       &quot;mistral:latest&quot;: { &quot;prompt&quot;: 1234, &quot;completion&quot;: 567, &quot;total&quot;: 1801, &quot;count&quot;: 5 }</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#guides-token_usage_tracking-__codelineno-2-13"></a><span class="c1">#     }</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#guides-token_usage_tracking-__codelineno-2-14"></a><span class="c1">#   }</span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#guides-token_usage_tracking-__codelineno-2-15"></a><span class="c1"># }</span>
</code></pre></div>
<h3 id="guides-token_usage_tracking-using-the-opentelemetry-metrics-recorder">Using the OpenTelemetry Metrics Recorder<a class="headerlink" href="#guides-token_usage_tracking-using-the-opentelemetry-metrics-recorder" title="Permanent link">&para;</a></h3>
<p>When <code>token_usage_recorder="otel_metrics_recorder"</code> is configured, this plugin emits the following OTel metrics:
*   <code>llm.request.tokens.prompt</code> (Counter, unit: <code>{token}</code>)
*   <code>llm.request.tokens.completion</code> (Counter, unit: <code>{token}</code>)
*   <code>llm.request.tokens.total</code> (Counter, unit: <code>{token}</code>)</p>
<p>These metrics will have attributes (labels) like <code>llm.provider.id</code>, <code>llm.model.name</code>, and <code>llm.call_type</code>. Configure an OTel collector (e.g., with a Prometheus exporter) to scrape and visualize these metrics in a dashboarding tool like Grafana.</p>
<p><strong>Example PromQL Queries:</strong>
*   Total prompt tokens per model (rate over 5m): <code>sum(rate(llm_request_tokens_prompt_total[5m])) by (llm_model_name)</code>
*   Total completion tokens per provider (rate over 5m): <code>sum(rate(llm_request_tokens_completion_total[5m])) by (llm_provider_id)</code></p></section><section class="print-page" id="guides-using_guardrails" heading-number="1.16"><h1 id="guides-using_guardrails-using-guardrails">Using Guardrails<a class="headerlink" href="#guides-using_guardrails-using-guardrails" title="Permanent link">&para;</a></h1>
<p>Guardrails in Genie Tooling provide a mechanism to enforce policies and safety checks on inputs, outputs, and tool usage attempts. They are implemented as plugins and integrated into the core <code>Genie</code> facade operations.</p>
<h2 id="guides-using_guardrails-core-concepts">Core Concepts<a class="headerlink" href="#guides-using_guardrails-core-concepts" title="Permanent link">&para;</a></h2>
<ul>
<li><strong><code>GuardrailManager</code></strong>: Orchestrates the execution of different types of guardrail plugins.</li>
<li><strong>Guardrail Plugin Types</strong>:<ul>
<li><strong><code>InputGuardrailPlugin</code></strong>: Checks data provided <em>to</em> the system or an LLM (e.g., user prompts, chat messages).</li>
<li><strong><code>OutputGuardrailPlugin</code></strong>: Checks data produced <em>by</em> the system or an LLM (e.g., LLM responses, tool execution results before final output).</li>
<li><strong><code>ToolUsageGuardrailPlugin</code></strong>: Checks if a specific tool usage attempt (tool + parameters) is permissible before execution.</li>
</ul>
</li>
<li><strong><code>GuardrailViolation</code> (TypedDict)</strong>: The result of a guardrail check:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-using_guardrails-__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">TypedDict</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-using_guardrails-__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#guides-using_guardrails-__codelineno-0-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">GuardrailViolation</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#guides-using_guardrails-__codelineno-0-4"></a>    <span class="n">action</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;allow&quot;</span><span class="p">,</span> <span class="s2">&quot;block&quot;</span><span class="p">,</span> <span class="s2">&quot;warn&quot;</span><span class="p">]</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#guides-using_guardrails-__codelineno-0-5"></a>    <span class="n">reason</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#guides-using_guardrails-__codelineno-0-6"></a>    <span class="n">guardrail_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#guides-using_guardrails-__codelineno-0-7"></a>    <span class="n">details</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
</code></pre></div><ul>
<li><code>allow</code>: The check passed.</li>
<li><code>block</code>: The operation should be prevented.</li>
<li><code>warn</code>: The operation can proceed, but a warning should be logged or noted.</li>
</ul>
</li>
</ul>
<h2 id="guides-using_guardrails-configuration">Configuration<a class="headerlink" href="#guides-using_guardrails-configuration" title="Permanent link">&para;</a></h2>
<p>Guardrails are configured in <code>MiddlewareConfig</code>, primarily through <code>FeatureSettings</code> for enabling lists of guardrails, and <code>guardrail_configurations</code> for specific plugin settings.</p>
<p><strong>Via <code>FeatureSettings</code>:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-using_guardrails-__codelineno-1-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiddlewareConfig</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#guides-using_guardrails-__codelineno-1-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureSettings</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#guides-using_guardrails-__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#guides-using_guardrails-__codelineno-1-4"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#guides-using_guardrails-__codelineno-1-5"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#guides-using_guardrails-__codelineno-1-6"></a>        <span class="c1"># ... other features ...</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#guides-using_guardrails-__codelineno-1-7"></a>        <span class="n">input_guardrails</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;keyword_blocklist_guardrail&quot;</span><span class="p">],</span> <span class="c1"># Enable by alias</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#guides-using_guardrails-__codelineno-1-8"></a>        <span class="n">output_guardrails</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;keyword_blocklist_guardrail&quot;</span><span class="p">],</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#guides-using_guardrails-__codelineno-1-9"></a>        <span class="c1"># tool_usage_guardrails=[&quot;my_custom_tool_usage_policy_v1&quot;] # Example</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#guides-using_guardrails-__codelineno-1-10"></a>    <span class="p">),</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#guides-using_guardrails-__codelineno-1-11"></a>    <span class="n">guardrail_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#guides-using_guardrails-__codelineno-1-12"></a>        <span class="s2">&quot;keyword_blocklist_guardrail_v1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># Canonical ID</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#guides-using_guardrails-__codelineno-1-13"></a>            <span class="s2">&quot;blocklist&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;unsafe_topic&quot;</span><span class="p">,</span> <span class="s2">&quot;banned_phrase&quot;</span><span class="p">],</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#guides-using_guardrails-__codelineno-1-14"></a>            <span class="s2">&quot;case_sensitive&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#guides-using_guardrails-__codelineno-1-15"></a>            <span class="s2">&quot;action_on_match&quot;</span><span class="p">:</span> <span class="s2">&quot;block&quot;</span> <span class="c1"># or &quot;warn&quot;</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#guides-using_guardrails-__codelineno-1-16"></a>        <span class="p">},</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#guides-using_guardrails-__codelineno-1-17"></a>        <span class="c1"># &quot;my_custom_tool_usage_policy_v1&quot;: { ... }</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#guides-using_guardrails-__codelineno-1-18"></a>    <span class="p">}</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#guides-using_guardrails-__codelineno-1-19"></a><span class="p">)</span>
</code></pre></div>
<ul>
<li><code>features.input_guardrails</code>, <code>features.output_guardrails</code>, <code>features.tool_usage_guardrails</code>: Lists of plugin IDs or aliases for guardrails to activate for each category.</li>
<li><code>guardrail_configurations</code>: A dictionary where keys are canonical guardrail plugin IDs (or aliases) and values are their specific configuration dictionaries.</li>
</ul>
<h2 id="guides-using_guardrails-implicit-integration">Implicit Integration<a class="headerlink" href="#guides-using_guardrails-implicit-integration" title="Permanent link">&para;</a></h2>
<p>Guardrails are automatically invoked by relevant <code>Genie</code> facade methods:</p>
<ul>
<li><strong>Input Guardrails</strong>:<ul>
<li>Checked by <code>genie.llm.chat()</code> and <code>genie.llm.generate()</code> before sending data to the LLM.</li>
<li>Checked by <code>genie.run_command()</code> on the user's command string before processing.</li>
</ul>
</li>
<li><strong>Output Guardrails</strong>:<ul>
<li>Checked by <code>genie.llm.chat()</code> and <code>genie.llm.generate()</code> on the LLM's response before returning it.</li>
<li>Checked by <code>genie.execute_tool()</code> (via the invocation strategy) on the raw tool result before transformation.</li>
</ul>
</li>
<li><strong>Tool Usage Guardrails</strong>:<ul>
<li>Checked by <code>genie.execute_tool()</code> (via the invocation strategy) before the tool's <code>execute()</code> method is called.</li>
<li>Checked by <code>genie.run_command()</code> after a tool and its parameters have been determined by the command processor, but before execution and before HITL (if HITL is also active).</li>
</ul>
</li>
</ul>
<p><strong>Behavior on "block":</strong>
*   If an input guardrail blocks, the operation (e.g., LLM call) is prevented, and a <code>PermissionError</code> is typically raised by the <code>Genie</code> facade method.
*   If an output guardrail blocks, the original output is replaced with a message indicating it was blocked (e.g., <code>"[RESPONSE BLOCKED: Reason]"</code>).
*   If a tool usage guardrail blocks, the tool execution is prevented, and an error is typically returned by <code>genie.run_command()</code> or <code>genie.execute_tool()</code>.</p>
<h2 id="guides-using_guardrails-built-in-guardrails">Built-in Guardrails<a class="headerlink" href="#guides-using_guardrails-built-in-guardrails" title="Permanent link">&para;</a></h2>
<ul>
<li><strong><code>KeywordBlocklistGuardrailPlugin</code> (alias: <code>keyword_blocklist_guardrail</code>)</strong>:<ul>
<li>Implements <code>InputGuardrailPlugin</code> and <code>OutputGuardrailPlugin</code>.</li>
<li>Checks text data against a configurable list of keywords.</li>
<li>Configuration:<ul>
<li><code>blocklist</code> (List[str]): Keywords to block/warn on.</li>
<li><code>case_sensitive</code> (bool, default: <code>False</code>): Whether matching is case-sensitive.</li>
<li><code>action_on_match</code> (Literal["block", "warn"], default: <code>"block"</code>): Action to take if a keyword is found.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="guides-using_guardrails-creating-custom-guardrail-plugins">Creating Custom Guardrail Plugins<a class="headerlink" href="#guides-using_guardrails-creating-custom-guardrail-plugins" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Choose the Base Protocol</strong>:</p>
<ul>
<li><code>InputGuardrailPlugin</code>: Implement <code>async def check_input(self, data: Any, context: Optional[Dict[str, Any]]) -&gt; GuardrailViolation</code>.</li>
<li><code>OutputGuardrailPlugin</code>: Implement <code>async def check_output(self, data: Any, context: Optional[Dict[str, Any]]) -&gt; GuardrailViolation</code>.</li>
<li><code>ToolUsageGuardrailPlugin</code>: Implement <code>async def check_tool_usage(self, tool: Tool, params: Dict[str, Any], context: Optional[Dict[str, Any]]) -&gt; GuardrailViolation</code>.
A single plugin class can implement multiple of these protocols if it's designed to check different types of data.</li>
</ul>
</li>
<li>
<p><strong>Implement the Check Logic</strong>: Your method should analyze the <code>data</code> (and <code>context</code> or <code>tool</code>/<code>params</code>) and return a <code>GuardrailViolation</code> dictionary.</p>
</li>
<li>
<p><strong>Register Your Plugin</strong>: Use entry points in <code>pyproject.toml</code> or place it in a directory specified by <code>plugin_dev_dirs</code> in <code>MiddlewareConfig</code>.</p>
</li>
<li>
<p><strong>Configure It</strong>: Add its ID to the appropriate list in <code>features</code> (e.g., <code>features.input_guardrails</code>) and provide any necessary configuration in <code>guardrail_configurations</code>.</p>
</li>
</ol></section><section class="print-page" id="guides-distributed_tasks" heading-number="1.17"><h1 id="guides-distributed_tasks-using-distributed-task-queues">Using Distributed Task Queues<a class="headerlink" href="#guides-distributed_tasks-using-distributed-task-queues" title="Permanent link">&para;</a></h1>
<p>Genie Tooling supports offloading tasks, such as long-running tool executions, to distributed task queues like Celery or RQ. This allows your main agent loop to remain responsive.</p>
<h2 id="guides-distributed_tasks-core-concepts">Core Concepts<a class="headerlink" href="#guides-distributed_tasks-core-concepts" title="Permanent link">&para;</a></h2>
<ul>
<li><strong><code>TaskQueueInterface</code> (<code>genie.task_queue</code>)</strong>: Facade for submitting and managing distributed tasks.</li>
<li><strong><code>DistributedTaskQueuePlugin</code></strong>: Plugin for a specific task queue system.<ul>
<li>Built-in: <code>CeleryTaskQueuePlugin</code> (alias: <code>celery_task_queue</code>), <code>RedisQueueTaskPlugin</code> (alias: <code>rq_task_queue</code>).</li>
</ul>
</li>
<li><strong><code>DistributedTaskInvocationStrategy</code></strong>: An <code>InvocationStrategy</code> that uses a task queue plugin to execute tools. (Note: This strategy is currently more conceptual and may require further application-side setup for robust use.)</li>
</ul>
<h2 id="guides-distributed_tasks-configuration">Configuration<a class="headerlink" href="#guides-distributed_tasks-configuration" title="Permanent link">&para;</a></h2>
<p>Enable and configure your chosen task queue system via <code>FeatureSettings</code>:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-distributed_tasks-__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiddlewareConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-distributed_tasks-__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.config.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureSettings</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#guides-distributed_tasks-__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#guides-distributed_tasks-__codelineno-0-4"></a><span class="c1"># Example for Celery</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#guides-distributed_tasks-__codelineno-0-5"></a><span class="n">app_config_celery</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#guides-distributed_tasks-__codelineno-0-6"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#guides-distributed_tasks-__codelineno-0-7"></a>        <span class="n">task_queue</span><span class="o">=</span><span class="s2">&quot;celery&quot;</span><span class="p">,</span> 
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#guides-distributed_tasks-__codelineno-0-8"></a>        <span class="n">task_queue_celery_broker_url</span><span class="o">=</span><span class="s2">&quot;redis://localhost:6379/1&quot;</span><span class="p">,</span> <span class="c1"># Your Celery broker</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#guides-distributed_tasks-__codelineno-0-9"></a>        <span class="n">task_queue_celery_backend_url</span><span class="o">=</span><span class="s2">&quot;redis://localhost:6379/2&quot;</span><span class="p">,</span> <span class="c1"># Your Celery result backend</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#guides-distributed_tasks-__codelineno-0-10"></a>    <span class="p">),</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#guides-distributed_tasks-__codelineno-0-11"></a>    <span class="c1"># Optional: Further Celery-specific configurations</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#guides-distributed_tasks-__codelineno-0-12"></a>    <span class="n">distributed_task_queue_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#guides-distributed_tasks-__codelineno-0-13"></a>        <span class="s2">&quot;celery_task_queue_v1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># Canonical ID</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#guides-distributed_tasks-__codelineno-0-14"></a>            <span class="s2">&quot;celery_app_name&quot;</span><span class="p">:</span> <span class="s2">&quot;my_genie_worker_app&quot;</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#guides-distributed_tasks-__codelineno-0-15"></a>            <span class="c1"># &quot;celery_include_task_paths&quot;: [&quot;my_project.worker_tasks&quot;] # Paths for Celery to find tasks</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#guides-distributed_tasks-__codelineno-0-16"></a>        <span class="p">}</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#guides-distributed_tasks-__codelineno-0-17"></a>    <span class="p">}</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#guides-distributed_tasks-__codelineno-0-18"></a><span class="p">)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#guides-distributed_tasks-__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#guides-distributed_tasks-__codelineno-0-20"></a><span class="c1"># Example for RQ (Redis Queue)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#guides-distributed_tasks-__codelineno-0-21"></a><span class="n">app_config_rq</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#guides-distributed_tasks-__codelineno-0-22"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#guides-distributed_tasks-__codelineno-0-23"></a>        <span class="n">task_queue</span><span class="o">=</span><span class="s2">&quot;rq&quot;</span> 
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#guides-distributed_tasks-__codelineno-0-24"></a>        <span class="c1"># RQ typically uses a single Redis connection, configured in its plugin settings</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#guides-distributed_tasks-__codelineno-0-25"></a>    <span class="p">),</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#guides-distributed_tasks-__codelineno-0-26"></a>    <span class="n">distributed_task_queue_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#guides-distributed_tasks-__codelineno-0-27"></a>        <span class="s2">&quot;redis_queue_task_plugin_v1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># Canonical ID</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#guides-distributed_tasks-__codelineno-0-28"></a>            <span class="s2">&quot;redis_url&quot;</span><span class="p">:</span> <span class="s2">&quot;redis://localhost:6379/3&quot;</span><span class="p">,</span> <span class="c1"># Redis for RQ</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#guides-distributed_tasks-__codelineno-0-29"></a>            <span class="s2">&quot;default_queue_name&quot;</span><span class="p">:</span> <span class="s2">&quot;genie-rq-default&quot;</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#guides-distributed_tasks-__codelineno-0-30"></a>        <span class="p">}</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#guides-distributed_tasks-__codelineno-0-31"></a>    <span class="p">}</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#guides-distributed_tasks-__codelineno-0-32"></a><span class="p">)</span>
</code></pre></div>
Ensure your chosen task queue broker (e.g., Redis, RabbitMQ) is running and accessible.</p>
<h2 id="guides-distributed_tasks-using-genietask_queue-direct-task-submission">Using <code>genie.task_queue</code> (Direct Task Submission)<a class="headerlink" href="#guides-distributed_tasks-using-genietask_queue-direct-task-submission" title="Permanent link">&para;</a></h2>
<p>This interface allows you to directly submit tasks to the configured queue. You need to have tasks defined and registered with your Celery/RQ worker environment.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-distributed_tasks-__codelineno-1-1"></a><span class="c1"># Assuming &#39;genie&#39; is initialized with a task queue configured (e.g., Celery)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#guides-distributed_tasks-__codelineno-1-2"></a><span class="c1"># and you have a Celery task defined as &#39;my_project.tasks.long_computation&#39;</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#guides-distributed_tasks-__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#guides-distributed_tasks-__codelineno-1-4"></a><span class="n">task_id</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">task_queue</span><span class="o">.</span><span class="n">submit_task</span><span class="p">(</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#guides-distributed_tasks-__codelineno-1-5"></a>    <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;my_project.tasks.long_computation&quot;</span><span class="p">,</span> 
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#guides-distributed_tasks-__codelineno-1-6"></a>    <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#guides-distributed_tasks-__codelineno-1-7"></a>    <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;multiply&quot;</span><span class="p">},</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#guides-distributed_tasks-__codelineno-1-8"></a>    <span class="n">task_options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;countdown&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span> <span class="c1"># Example: Celery-specific option</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#guides-distributed_tasks-__codelineno-1-9"></a><span class="p">)</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#guides-distributed_tasks-__codelineno-1-10"></a>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#guides-distributed_tasks-__codelineno-1-11"></a><span class="k">if</span> <span class="n">task_id</span><span class="p">:</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#guides-distributed_tasks-__codelineno-1-12"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Task submitted with ID: </span><span class="si">{</span><span class="n">task_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#guides-distributed_tasks-__codelineno-1-13"></a>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#guides-distributed_tasks-__codelineno-1-14"></a>    <span class="c1"># Poll for status and result (example polling loop)</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#guides-distributed_tasks-__codelineno-1-15"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span> <span class="c1"># Try for 30 seconds</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#guides-distributed_tasks-__codelineno-1-16"></a>        <span class="n">status</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">task_queue</span><span class="o">.</span><span class="n">get_task_status</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#guides-distributed_tasks-__codelineno-1-17"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Task </span><span class="si">{</span><span class="n">task_id</span><span class="si">}</span><span class="s2"> status: </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#guides-distributed_tasks-__codelineno-1-18"></a>        <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;success&quot;</span><span class="p">:</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#guides-distributed_tasks-__codelineno-1-19"></a>            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">genie</span><span class="o">.</span><span class="n">task_queue</span><span class="o">.</span><span class="n">get_task_result</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#guides-distributed_tasks-__codelineno-1-20"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Task result: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#guides-distributed_tasks-__codelineno-1-21"></a>            <span class="k">break</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#guides-distributed_tasks-__codelineno-1-22"></a>        <span class="k">elif</span> <span class="n">status</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;failure&quot;</span><span class="p">,</span> <span class="s2">&quot;revoked&quot;</span><span class="p">]:</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#guides-distributed_tasks-__codelineno-1-23"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Task failed or was revoked.&quot;</span><span class="p">)</span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#guides-distributed_tasks-__codelineno-1-24"></a>            <span class="c1"># Optionally try to get error details if it failed</span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#guides-distributed_tasks-__codelineno-1-25"></a>            <span class="c1"># result = await genie.task_queue.get_task_result(task_id) </span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#guides-distributed_tasks-__codelineno-1-26"></a>            <span class="k">break</span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#guides-distributed_tasks-__codelineno-1-27"></a>        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#guides-distributed_tasks-__codelineno-1-28"></a><span class="k">else</span><span class="p">:</span>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#guides-distributed_tasks-__codelineno-1-29"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to submit task.&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="guides-distributed_tasks-using-distributedtaskinvocationstrategy-for-tools-conceptual">Using <code>DistributedTaskInvocationStrategy</code> for Tools (Conceptual)<a class="headerlink" href="#guides-distributed_tasks-using-distributedtaskinvocationstrategy-for-tools-conceptual" title="Permanent link">&para;</a></h2>
<p>The <code>DistributedTaskInvocationStrategy</code> aims to automatically offload tool executions to a task queue. This is a more advanced setup.</p>
<ol>
<li><strong>Configure Task Queue</strong>: Ensure a task queue (e.g., Celery) is configured in <code>FeatureSettings</code>.</li>
<li><strong>Worker Task</strong>: Define a generic task in your Celery/RQ worker environment that can execute Genie tools. This task would typically:<ul>
<li>Receive <code>tool_id</code>, <code>tool_params</code>, and potentially serialized key information or context.</li>
<li>Instantiate a minimal Genie environment (or have one pre-configured).</li>
<li>Execute the specified tool with the given parameters.</li>
<li>Return the tool's result.</li>
<li>Example task name: <code>genie_tooling.worker_tasks.execute_genie_tool_task</code> (this is a placeholder; you'd implement this).</li>
</ul>
</li>
<li><strong>Configure the Strategy</strong>: In <code>MiddlewareConfig</code>, you would configure the <code>DistributedTaskInvocationStrategy</code> to use your chosen task queue plugin and specify the name of your generic worker task.
    <div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#guides-distributed_tasks-__codelineno-2-1"></a><span class="c1"># In MiddlewareConfig:</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#guides-distributed_tasks-__codelineno-2-2"></a><span class="c1"># invocation_strategy_configurations={</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#guides-distributed_tasks-__codelineno-2-3"></a><span class="c1">#     &quot;distributed_task_invocation_strategy_v1&quot;: {</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#guides-distributed_tasks-__codelineno-2-4"></a><span class="c1">#         &quot;task_queue_plugin_id&quot;: &quot;celery_task_queue_v1&quot;, # Or &quot;redis_queue_task_plugin_v1&quot;</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#guides-distributed_tasks-__codelineno-2-5"></a><span class="c1">#         &quot;worker_tool_execution_task_name&quot;: &quot;my_project.worker_tasks.execute_genie_tool_task&quot;</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#guides-distributed_tasks-__codelineno-2-6"></a><span class="c1">#     }</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#guides-distributed_tasks-__codelineno-2-7"></a><span class="c1"># }</span>
</code></pre></div></li>
<li><strong>Execute Tool with Strategy</strong>:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#guides-distributed_tasks-__codelineno-3-1"></a><span class="c1"># result_or_task_ref = await genie.execute_tool(</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#guides-distributed_tasks-__codelineno-3-2"></a><span class="c1">#     &quot;my_long_running_tool&quot;,</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#guides-distributed_tasks-__codelineno-3-3"></a><span class="c1">#     param1=&quot;value&quot;,</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#guides-distributed_tasks-__codelineno-3-4"></a><span class="c1">#     strategy_id=&quot;distributed_task_invocation_strategy_v1&quot; </span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#guides-distributed_tasks-__codelineno-3-5"></a><span class="c1">#     # The strategy might return a task ID or future immediately,</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#guides-distributed_tasks-__codelineno-3-6"></a><span class="c1">#     # or poll internally and return the final result.</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#guides-distributed_tasks-__codelineno-3-7"></a><span class="c1"># )</span>
</code></pre></div></li>
</ol>
<p><strong>Note on Security and Context:</strong> Securely passing API keys and sensitive context to distributed workers requires careful design. Options include:
*   Workers fetching credentials themselves from a secure vault.
*   Using short-lived, task-specific credentials.
*   Carefully serializing only necessary and safe context information.</p>
<p>The direct <code>genie.task_queue.submit_task</code> method gives you more control over what gets sent to the worker.</p></section></section>
                    <section class='print-page md-section' id='section-2' heading-number='2'>
                        <h1>Developer Guide<a class='headerlink' href='#section-2' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="guides-plugin_architecture" heading-number="2.1"><h1 id="guides-plugin_architecture-plugin-architecture">Plugin Architecture<a class="headerlink" href="#guides-plugin_architecture-plugin-architecture" title="Permanent link">&para;</a></h1>
<p>Genie Tooling is built upon a highly modular and extensible plugin architecture. This design principle allows developers to easily swap, customize, or add new functionalities without altering the core framework.</p>
<h2 id="guides-plugin_architecture-core-idea">Core Idea<a class="headerlink" href="#guides-plugin_architecture-core-idea" title="Permanent link">&para;</a></h2>
<p>The central idea is that most significant functionalities within Genie are implemented as <strong>plugins</strong>. Each plugin adheres to a specific <strong>protocol</strong> (an interface defined using Python's <code>typing.Protocol</code> or an Abstract Base Class). This ensures that different implementations of a particular functionality can be used interchangeably as long as they conform to the defined contract.</p>
<h2 id="guides-plugin_architecture-key-components">Key Components<a class="headerlink" href="#guides-plugin_architecture-key-components" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong><code>Plugin</code> Protocol (<code>genie_tooling.core.types.Plugin</code>)</strong>:
    This is the base protocol that all plugins should ideally implement. It defines:</p>
<ul>
<li><code>plugin_id</code> (property): A unique string identifier for the plugin.</li>
<li><code>async def setup(config)</code> (optional): For initialization with configuration.</li>
<li><code>async def teardown()</code> (optional): For resource cleanup.</li>
</ul>
</li>
<li>
<p><strong>Specific Plugin Protocols</strong>:
    For each type of extensible functionality, there's a more specific protocol that inherits from or includes the base <code>Plugin</code> requirements. Examples:</p>
<ul>
<li><code>Tool</code> (<code>genie_tooling.tools.abc.Tool</code>)</li>
<li><code>LLMProviderPlugin</code> (<code>genie_tooling.llm_providers.abc.LLMProviderPlugin</code>)</li>
<li><code>CacheProvider</code> (<code>genie_tooling.cache_providers.abc.CacheProvider</code>)</li>
<li><code>DocumentLoaderPlugin</code> (<code>genie_tooling.document_loaders.abc.DocumentLoaderPlugin</code>)</li>
<li>And many more (see <code>src/genie_tooling/.../abc.py</code> files).</li>
</ul>
</li>
<li>
<p><strong><code>PluginManager</code> (<code>genie_tooling.core.plugin_manager.PluginManager</code>)</strong>:</p>
<ul>
<li><strong>Discovery</strong>: Responsible for finding available plugin classes. It searches:<ul>
<li><strong>Entry Points</strong>: Defined in <code>pyproject.toml</code> under the <code>[tool.poetry.plugins."genie_tooling.plugins"]</code> group. This is the standard way for third-party libraries or separate modules to provide plugins.</li>
<li><strong>Plugin Development Directories</strong>: Specified in <code>MiddlewareConfig.plugin_dev_dirs</code>. Useful for project-specific plugins or during development.</li>
</ul>
</li>
<li><strong>Instantiation &amp; Setup</strong>: When a plugin is requested (e.g., by a manager or the <code>Genie</code> facade), the <code>PluginManager</code> instantiates the plugin class and calls its <code>async setup(config)</code> method, passing any relevant configuration.</li>
<li><strong>Caching</strong>: It typically caches instantiated plugins to avoid re-creating and re-setting them up on every request.</li>
<li><strong>Teardown</strong>: Manages the <code>async teardown()</code> lifecycle of loaded plugins.</li>
</ul>
</li>
<li>
<p><strong>Managers (e.g., <code>ToolManager</code>, <code>LLMProviderManager</code>, <code>RAGManager</code>)</strong>:</p>
<ul>
<li>These components orchestrate plugins of a specific type.</li>
<li>They use the <code>PluginManager</code> to get instances of the plugins they need based on configuration.</li>
<li>For example, <code>LLMProviderManager</code> uses <code>PluginManager</code> to load the configured <code>LLMProviderPlugin</code> (like <code>OllamaLLMProviderPlugin</code> or <code>OpenAILLMProviderPlugin</code>).</li>
</ul>
</li>
<li>
<p><strong><code>Genie</code> Facade</strong>:</p>
<ul>
<li>The <code>Genie</code> facade simplifies interaction with the underlying managers and, by extension, the plugins.</li>
<li>When you configure <code>Genie</code> (e.g., <code>features.llm = "ollama"</code>), it internally directs the <code>LLMProviderManager</code> to load and use the "ollama" LLM provider plugin.</li>
</ul>
</li>
</ol>
<h2 id="guides-plugin_architecture-benefits-of-the-plugin-architecture">Benefits of the Plugin Architecture<a class="headerlink" href="#guides-plugin_architecture-benefits-of-the-plugin-architecture" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Extensibility</strong>: Easily add new LLM providers, tools, data sources, caching backends, etc., without modifying Genie's core code.</li>
<li><strong>Customization</strong>: Replace default implementations with your own specialized versions.</li>
<li><strong>Modularity</strong>: Keeps different functionalities decoupled, making the system easier to understand, maintain, and test.</li>
<li><strong>Community Contributions</strong>: Facilitates sharing and using plugins developed by the community.</li>
<li><strong>Flexibility</strong>: Allows applications to select and configure only the components they need.</li>
</ul>
<h2 id="guides-plugin_architecture-how-to-create-a-plugin">How to Create a Plugin<a class="headerlink" href="#guides-plugin_architecture-how-to-create-a-plugin" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Identify the Protocol</strong>: Find the relevant plugin protocol in <code>genie_tooling</code> (e.g., <code>Tool</code> for a new tool, <code>CacheProvider</code> for a new cache).</li>
<li><strong>Implement the Class</strong>: Create a Python class that:<ul>
<li>Defines a unique <code>plugin_id</code> class attribute.</li>
<li>Implements all methods and properties required by the chosen protocol.</li>
<li>Optionally implements <code>async setup(config)</code> and <code>async teardown()</code>.</li>
</ul>
</li>
<li><strong>Register the Plugin</strong>:<ul>
<li>For distributable plugins: Add an entry point in your <code>pyproject.toml</code>.</li>
<li>For local plugins: Place the file in a directory specified in <code>MiddlewareConfig.plugin_dev_dirs</code>.</li>
</ul>
</li>
<li><strong>Configure Genie</strong>: Update your <code>MiddlewareConfig</code> to use your new plugin, either by setting it as a default or by providing its configuration in the relevant <code>*_configurations</code> dictionary. For tools, ensure they are enabled in <code>tool_configurations</code>.</li>
</ol>
<p>Refer to the specific "Creating ... Plugins" guides for more detailed instructions on particular plugin types.</p></section><section class="print-page" id="guides-creating_plugins" heading-number="2.2"><h1 id="guides-creating_plugins-creating-plugins-overview">Creating Plugins (Overview)<a class="headerlink" href="#guides-creating_plugins-creating-plugins-overview" title="Permanent link">&para;</a></h1>
<p>Genie Tooling is designed to be highly extensible through its plugin architecture. Almost every functional component can be replaced or augmented with custom implementations.</p>
<p>This page provides a general overview. For specific plugin types, refer to:
*   <a href="#guides-creating_tool_plugins">Creating Tool Plugins</a>
*   <a href="#guides-creating_rag_plugins">Creating RAG Plugins</a>
*   <a href="#guides-creating_other_plugins">Creating Other Plugins</a> (for caches, LLM providers, etc.)</p>
<h2 id="guides-creating_plugins-core-plugin-protocol">Core Plugin Protocol<a class="headerlink" href="#guides-creating_plugins-core-plugin-protocol" title="Permanent link">&para;</a></h2>
<p>All plugins in Genie Tooling should ideally adhere to the <code>genie_tooling.core.types.Plugin</code> protocol:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-creating_plugins-__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Protocol</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-creating_plugins-__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#guides-creating_plugins-__codelineno-0-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">Plugin</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#guides-creating_plugins-__codelineno-0-4"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#guides-creating_plugins-__codelineno-0-5"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plugin_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#guides-creating_plugins-__codelineno-0-6"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A unique identifier for this plugin instance/type.&quot;&quot;&quot;</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#guides-creating_plugins-__codelineno-0-7"></a>        <span class="o">...</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#guides-creating_plugins-__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#guides-creating_plugins-__codelineno-0-9"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#guides-creating_plugins-__codelineno-0-10"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#guides-creating_plugins-__codelineno-0-11"></a><span class="sd">        Optional asynchronous setup method.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#guides-creating_plugins-__codelineno-0-12"></a><span class="sd">        Called after the plugin is instantiated, with its specific configuration.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#guides-creating_plugins-__codelineno-0-13"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#guides-creating_plugins-__codelineno-0-14"></a>        <span class="k">pass</span> <span class="c1"># Default implementation</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#guides-creating_plugins-__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#guides-creating_plugins-__codelineno-0-16"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#guides-creating_plugins-__codelineno-0-17"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#guides-creating_plugins-__codelineno-0-18"></a><span class="sd">        Optional asynchronous teardown method.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#guides-creating_plugins-__codelineno-0-19"></a><span class="sd">        Called when the Genie facade is closing down, to release resources.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#guides-creating_plugins-__codelineno-0-20"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#guides-creating_plugins-__codelineno-0-21"></a>        <span class="k">pass</span> <span class="c1"># Default implementation</span>
</code></pre></div>
<p><strong>Key Requirements for a Plugin Class:</strong></p>
<ol>
<li>
<p><strong><code>plugin_id</code> (Class Attribute)</strong>:</p>
<ul>
<li>A <strong>unique string identifier</strong> for your plugin.</li>
<li>Convention: <code>your_plugin_name_v1</code> (e.g., <code>my_custom_llm_provider_v1</code>, <code>advanced_calculator_tool_v1</code>).</li>
<li>This ID is used in configuration files and for discovery.</li>
</ul>
</li>
<li>
<p><strong>Implement the Specific Protocol</strong>:</p>
<ul>
<li>Your plugin class must implement the methods defined by the protocol for its type (e.g., <code>Tool</code>, <code>LLMProviderPlugin</code>, <code>CacheProviderPlugin</code>).</li>
<li>These protocols are typically found in the <code>abc.py</code> file of the relevant submodule (e.g., <code>genie_tooling.tools.abc.Tool</code>).</li>
</ul>
</li>
<li>
<p><strong><code>async def setup(self, config: Optional[Dict[str, Any]] = None)</code> (Optional)</strong>:</p>
<ul>
<li>If your plugin needs initialization with configuration values, implement this asynchronous method.</li>
<li>The <code>config</code> dictionary will contain the settings provided for your plugin's <code>plugin_id</code> in the <code>MiddlewareConfig</code> (e.g., in <code>llm_provider_configurations["my_custom_llm_v1"]</code>).</li>
</ul>
</li>
<li>
<p><strong><code>async def teardown(self)</code> (Optional)</strong>:</p>
<ul>
<li>If your plugin acquires resources (e.g., network connections, file handles) that need to be released, implement this asynchronous method.</li>
</ul>
</li>
</ol>
<h2 id="guides-creating_plugins-plugin-discovery">Plugin Discovery<a class="headerlink" href="#guides-creating_plugins-plugin-discovery" title="Permanent link">&para;</a></h2>
<p>Genie's <code>PluginManager</code> discovers plugins through two primary mechanisms:</p>
<ol>
<li>
<p><strong>Entry Points (Recommended for distributable plugins)</strong>:</p>
<ul>
<li>Define an entry point in your package's <code>pyproject.toml</code> under the group <code>[tool.poetry.plugins."genie_tooling.plugins"]</code>.</li>
<li>Example:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-creating_plugins-__codelineno-1-1"></a><span class="k">[tool.poetry.plugins.</span><span class="s2">&quot;genie_tooling.plugins&quot;</span><span class="k">]</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#guides-creating_plugins-__codelineno-1-2"></a><span class="s2">&quot;my_awesome_tool_v1&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;my_package.my_module:MyAwesomeToolClass&quot;</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#guides-creating_plugins-__codelineno-1-3"></a><span class="s2">&quot;custom_cache_provider_alpha&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;my_other_package.cache:CustomCache&quot;</span>
</code></pre></div></li>
<li>The key is the <code>plugin_id</code> Genie will use to refer to your plugin.</li>
<li>The value is the import path to your plugin class.</li>
</ul>
</li>
<li>
<p><strong>Plugin Development Directories (For local/project-specific plugins)</strong>:</p>
<ul>
<li>Specify a list of directories in <code>MiddlewareConfig.plugin_dev_dirs</code>.</li>
<li>The <code>PluginManager</code> will scan these directories for Python files (<code>*.py</code>).</li>
<li>It will attempt to import these files as modules and look for classes that implement the <code>Plugin</code> protocol and have a <code>plugin_id</code>.</li>
<li>Files starting with <code>_</code> or <code>.</code> (e.g., <code>__init__.py</code>, <code>_internal_utils.py</code>) are ignored.</li>
</ul>
</li>
</ol>
<h2 id="guides-creating_plugins-configuration-and-usage">Configuration and Usage<a class="headerlink" href="#guides-creating_plugins-configuration-and-usage" title="Permanent link">&para;</a></h2>
<p>Once your plugin is discoverable, you can:
*   <strong>Configure it</strong>: Provide settings in the appropriate <code>*_configurations</code> dictionary within <code>MiddlewareConfig</code>, keyed by your plugin's <code>plugin_id</code>.
*   <strong>Set it as a default</strong>: If applicable, set its <code>plugin_id</code> in fields like <code>default_llm_provider_id</code>, <code>default_cache_provider_id</code>, etc., in <code>MiddlewareConfig</code> or via <code>FeatureSettings</code>.
*   <strong>Use it explicitly</strong>: Some <code>Genie</code> facade methods allow specifying a <code>plugin_id</code> at runtime (e.g., <code>genie.llm.chat(..., provider_id="my_llm_v1")</code>).</p>
<p>By adhering to these principles, you can create robust and reusable extensions for Genie Tooling.</p></section><section class="print-page" id="guides-creating_tool_plugins" heading-number="2.3"><h1 id="guides-creating_tool_plugins-creating-tool-plugins">Creating Tool Plugins<a class="headerlink" href="#guides-creating_tool_plugins-creating-tool-plugins" title="Permanent link">&para;</a></h1>
<p>Tools are fundamental to Genie Tooling, representing actions an agent can perform. You can create custom tools by implementing the <code>Tool</code> protocol.</p>
<h2 id="guides-creating_tool_plugins-the-tool-protocol">The <code>Tool</code> Protocol<a class="headerlink" href="#guides-creating_tool_plugins-the-tool-protocol" title="Permanent link">&para;</a></h2>
<p>Located in <code>genie_tooling.tools.abc.Tool</code>, the protocol requires:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-creating_tool_plugins-__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Protocol</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-creating_tool_plugins-__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.core.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">Plugin</span> <span class="c1"># For base Plugin behavior</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#guides-creating_tool_plugins-__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.security.key_provider</span><span class="w"> </span><span class="kn">import</span> <span class="n">KeyProvider</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#guides-creating_tool_plugins-__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#guides-creating_tool_plugins-__codelineno-0-5"></a><span class="k">class</span><span class="w"> </span><span class="nc">Tool</span><span class="p">(</span><span class="n">Plugin</span><span class="p">,</span> <span class="n">Protocol</span><span class="p">):</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#guides-creating_tool_plugins-__codelineno-0-6"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#guides-creating_tool_plugins-__codelineno-0-7"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#guides-creating_tool_plugins-__codelineno-0-8"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A unique string identifier for this tool.&quot;&quot;&quot;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#guides-creating_tool_plugins-__codelineno-0-9"></a>        <span class="o">...</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#guides-creating_tool_plugins-__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#guides-creating_tool_plugins-__codelineno-0-11"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#guides-creating_tool_plugins-__codelineno-0-12"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#guides-creating_tool_plugins-__codelineno-0-13"></a><span class="sd">        Returns comprehensive metadata about the tool.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#guides-creating_tool_plugins-__codelineno-0-14"></a><span class="sd">        Expected structure:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#guides-creating_tool_plugins-__codelineno-0-15"></a><span class="sd">        {</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#guides-creating_tool_plugins-__codelineno-0-16"></a><span class="sd">            &quot;identifier&quot;: str,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#guides-creating_tool_plugins-__codelineno-0-17"></a><span class="sd">            &quot;name&quot;: str, (Human-friendly)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#guides-creating_tool_plugins-__codelineno-0-18"></a><span class="sd">            &quot;description_human&quot;: str, (Detailed for UI/developers)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#guides-creating_tool_plugins-__codelineno-0-19"></a><span class="sd">            &quot;description_llm&quot;: str, (Concise for LLM prompts)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#guides-creating_tool_plugins-__codelineno-0-20"></a><span class="sd">            &quot;input_schema&quot;: Dict[str, Any], (JSON Schema for parameters)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#guides-creating_tool_plugins-__codelineno-0-21"></a><span class="sd">            &quot;output_schema&quot;: Dict[str, Any], (JSON Schema for result)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#guides-creating_tool_plugins-__codelineno-0-22"></a><span class="sd">            &quot;key_requirements&quot;: List[Dict[str, str]], (e.g., [{&quot;name&quot;: &quot;API_KEY_NAME&quot;, ...}])</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#guides-creating_tool_plugins-__codelineno-0-23"></a><span class="sd">            &quot;tags&quot;: List[str],</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#guides-creating_tool_plugins-__codelineno-0-24"></a><span class="sd">            &quot;version&quot;: str,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#guides-creating_tool_plugins-__codelineno-0-25"></a><span class="sd">            &quot;cacheable&quot;: bool, (Optional, default False)</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#guides-creating_tool_plugins-__codelineno-0-26"></a><span class="sd">            &quot;cache_ttl_seconds&quot;: Optional[int] (Optional)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#guides-creating_tool_plugins-__codelineno-0-27"></a><span class="sd">        }</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#guides-creating_tool_plugins-__codelineno-0-28"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#guides-creating_tool_plugins-__codelineno-0-29"></a>        <span class="o">...</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#guides-creating_tool_plugins-__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#guides-creating_tool_plugins-__codelineno-0-31"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#guides-creating_tool_plugins-__codelineno-0-32"></a>        <span class="bp">self</span><span class="p">,</span> 
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#guides-creating_tool_plugins-__codelineno-0-33"></a>        <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> 
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#guides-creating_tool_plugins-__codelineno-0-34"></a>        <span class="n">key_provider</span><span class="p">:</span> <span class="n">KeyProvider</span><span class="p">,</span> 
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#guides-creating_tool_plugins-__codelineno-0-35"></a>        <span class="n">context</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#guides-creating_tool_plugins-__codelineno-0-36"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#guides-creating_tool_plugins-__codelineno-0-37"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#guides-creating_tool_plugins-__codelineno-0-38"></a><span class="sd">        Executes the tool with validated parameters.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#guides-creating_tool_plugins-__codelineno-0-39"></a><span class="sd">        The `context` dictionary is now required and is used to pass system-level</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#guides-creating_tool_plugins-__codelineno-0-40"></a><span class="sd">        information, such as observability trace context.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#guides-creating_tool_plugins-__codelineno-0-41"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#guides-creating_tool_plugins-__codelineno-0-42"></a>        <span class="o">...</span>
</code></pre></div>
Your tool class must also have a <code>plugin_id</code> attribute (usually the same as <code>identifier</code>).</p>
<h2 id="guides-creating_tool_plugins-steps-to-create-a-tool-plugin">Steps to Create a Tool Plugin<a class="headerlink" href="#guides-creating_tool_plugins-steps-to-create-a-tool-plugin" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Define Your Class</strong>:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-creating_tool_plugins-__codelineno-1-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.tools.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tool</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#guides-creating_tool_plugins-__codelineno-1-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.security.key_provider</span><span class="w"> </span><span class="kn">import</span> <span class="n">KeyProvider</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#guides-creating_tool_plugins-__codelineno-1-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#guides-creating_tool_plugins-__codelineno-1-4"></a>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#guides-creating_tool_plugins-__codelineno-1-5"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyCustomSearchTool</span><span class="p">(</span><span class="n">Tool</span><span class="p">):</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#guides-creating_tool_plugins-__codelineno-1-6"></a>    <span class="n">plugin_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;my_custom_search_tool_v1&quot;</span> <span class="c1"># Unique plugin ID</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#guides-creating_tool_plugins-__codelineno-1-7"></a>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#guides-creating_tool_plugins-__codelineno-1-8"></a>    <span class="nd">@property</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#guides-creating_tool_plugins-__codelineno-1-9"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#guides-creating_tool_plugins-__codelineno-1-10"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span> <span class="c1"># Often same as plugin_id</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#guides-creating_tool_plugins-__codelineno-1-11"></a>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#guides-creating_tool_plugins-__codelineno-1-12"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#guides-creating_tool_plugins-__codelineno-1-13"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">api_base_url</span> <span class="o">=</span> <span class="p">(</span><span class="n">config</span> <span class="ow">or</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;api_base_url&quot;</span><span class="p">,</span> <span class="s2">&quot;https://api.customsearch.com&quot;</span><span class="p">)</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#guides-creating_tool_plugins-__codelineno-1-14"></a>        <span class="c1"># Initialize HTTP client, etc.</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#guides-creating_tool_plugins-__codelineno-1-15"></a>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#guides-creating_tool_plugins-__codelineno-1-16"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#guides-creating_tool_plugins-__codelineno-1-17"></a>        <span class="c1"># ... (metadata definition as before) ...</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#guides-creating_tool_plugins-__codelineno-1-18"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#guides-creating_tool_plugins-__codelineno-1-19"></a>            <span class="s2">&quot;identifier&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">,</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#guides-creating_tool_plugins-__codelineno-1-20"></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;My Custom Search&quot;</span><span class="p">,</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#guides-creating_tool_plugins-__codelineno-1-21"></a>            <span class="s2">&quot;description_human&quot;</span><span class="p">:</span> <span class="s2">&quot;Searches my custom data source.&quot;</span><span class="p">,</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#guides-creating_tool_plugins-__codelineno-1-22"></a>            <span class="s2">&quot;description_llm&quot;</span><span class="p">:</span> <span class="s2">&quot;CustomSearch: Finds items in my data. Args: query (str, req), limit (int, opt, default 10).&quot;</span><span class="p">,</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#guides-creating_tool_plugins-__codelineno-1-23"></a>            <span class="s2">&quot;input_schema&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#guides-creating_tool_plugins-__codelineno-1-24"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#guides-creating_tool_plugins-__codelineno-1-25"></a>                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#guides-creating_tool_plugins-__codelineno-1-26"></a>                    <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Search query.&quot;</span><span class="p">},</span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#guides-creating_tool_plugins-__codelineno-1-27"></a>                    <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Max results.&quot;</span><span class="p">}</span>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#guides-creating_tool_plugins-__codelineno-1-28"></a>                <span class="p">},</span>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#guides-creating_tool_plugins-__codelineno-1-29"></a>                <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]</span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#guides-creating_tool_plugins-__codelineno-1-30"></a>            <span class="p">},</span>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#guides-creating_tool_plugins-__codelineno-1-31"></a>            <span class="s2">&quot;output_schema&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#guides-creating_tool_plugins-__codelineno-1-32"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#guides-creating_tool_plugins-__codelineno-1-33"></a>                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#guides-creating_tool_plugins-__codelineno-1-34"></a>                    <span class="s2">&quot;results&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span> <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">}},</span>
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#guides-creating_tool_plugins-__codelineno-1-35"></a>                    <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;null&quot;</span><span class="p">]}</span>
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#guides-creating_tool_plugins-__codelineno-1-36"></a>                <span class="p">},</span>
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#guides-creating_tool_plugins-__codelineno-1-37"></a>                <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">]</span>
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#guides-creating_tool_plugins-__codelineno-1-38"></a>            <span class="p">},</span>
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#guides-creating_tool_plugins-__codelineno-1-39"></a>            <span class="s2">&quot;key_requirements&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;MY_CUSTOM_API_KEY&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;API key for custom search.&quot;</span><span class="p">}],</span>
<a id="__codelineno-1-40" name="__codelineno-1-40" href="#guides-creating_tool_plugins-__codelineno-1-40"></a>            <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;search&quot;</span><span class="p">,</span> <span class="s2">&quot;custom&quot;</span><span class="p">],</span>
<a id="__codelineno-1-41" name="__codelineno-1-41" href="#guides-creating_tool_plugins-__codelineno-1-41"></a>            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span>
<a id="__codelineno-1-42" name="__codelineno-1-42" href="#guides-creating_tool_plugins-__codelineno-1-42"></a>        <span class="p">}</span>
<a id="__codelineno-1-43" name="__codelineno-1-43" href="#guides-creating_tool_plugins-__codelineno-1-43"></a>
<a id="__codelineno-1-44" name="__codelineno-1-44" href="#guides-creating_tool_plugins-__codelineno-1-44"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span>
<a id="__codelineno-1-45" name="__codelineno-1-45" href="#guides-creating_tool_plugins-__codelineno-1-45"></a>        <span class="bp">self</span><span class="p">,</span> 
<a id="__codelineno-1-46" name="__codelineno-1-46" href="#guides-creating_tool_plugins-__codelineno-1-46"></a>        <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> 
<a id="__codelineno-1-47" name="__codelineno-1-47" href="#guides-creating_tool_plugins-__codelineno-1-47"></a>        <span class="n">key_provider</span><span class="p">:</span> <span class="n">KeyProvider</span><span class="p">,</span> 
<a id="__codelineno-1-48" name="__codelineno-1-48" href="#guides-creating_tool_plugins-__codelineno-1-48"></a>        <span class="n">context</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="c1"># Note: context is now required</span>
<a id="__codelineno-1-49" name="__codelineno-1-49" href="#guides-creating_tool_plugins-__codelineno-1-49"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-1-50" name="__codelineno-1-50" href="#guides-creating_tool_plugins-__codelineno-1-50"></a>        <span class="n">query</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]</span>
<a id="__codelineno-1-51" name="__codelineno-1-51" href="#guides-creating_tool_plugins-__codelineno-1-51"></a>        <span class="n">limit</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;limit&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-1-52" name="__codelineno-1-52" href="#guides-creating_tool_plugins-__codelineno-1-52"></a>        <span class="n">api_key</span> <span class="o">=</span> <span class="k">await</span> <span class="n">key_provider</span><span class="o">.</span><span class="n">get_key</span><span class="p">(</span><span class="s2">&quot;MY_CUSTOM_API_KEY&quot;</span><span class="p">)</span>
<a id="__codelineno-1-53" name="__codelineno-1-53" href="#guides-creating_tool_plugins-__codelineno-1-53"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">api_key</span><span class="p">:</span>
<a id="__codelineno-1-54" name="__codelineno-1-54" href="#guides-creating_tool_plugins-__codelineno-1-54"></a>            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;results&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;API key not found.&quot;</span><span class="p">}</span>
<a id="__codelineno-1-55" name="__codelineno-1-55" href="#guides-creating_tool_plugins-__codelineno-1-55"></a>
<a id="__codelineno-1-56" name="__codelineno-1-56" href="#guides-creating_tool_plugins-__codelineno-1-56"></a>        <span class="c1"># ... actual search logic using self.api_base_url, query, limit, api_key ...</span>
<a id="__codelineno-1-57" name="__codelineno-1-57" href="#guides-creating_tool_plugins-__codelineno-1-57"></a>        <span class="c1"># For example:</span>
<a id="__codelineno-1-58" name="__codelineno-1-58" href="#guides-creating_tool_plugins-__codelineno-1-58"></a>        <span class="c1"># response = await self._http_client.get(f&quot;{self.api_base_url}/search?q={query}&amp;limit={limit}&amp;key={api_key}&quot;)</span>
<a id="__codelineno-1-59" name="__codelineno-1-59" href="#guides-creating_tool_plugins-__codelineno-1-59"></a>        <span class="c1"># search_results = response.json() </span>
<a id="__codelineno-1-60" name="__codelineno-1-60" href="#guides-creating_tool_plugins-__codelineno-1-60"></a>        <span class="n">search_results</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Mock result for </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}]</span> <span class="c1"># Placeholder</span>
<a id="__codelineno-1-61" name="__codelineno-1-61" href="#guides-creating_tool_plugins-__codelineno-1-61"></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;results&quot;</span><span class="p">:</span> <span class="n">search_results</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
<a id="__codelineno-1-62" name="__codelineno-1-62" href="#guides-creating_tool_plugins-__codelineno-1-62"></a>
<a id="__codelineno-1-63" name="__codelineno-1-63" href="#guides-creating_tool_plugins-__codelineno-1-63"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-1-64" name="__codelineno-1-64" href="#guides-creating_tool_plugins-__codelineno-1-64"></a>        <span class="c1"># Close HTTP client, etc.</span>
<a id="__codelineno-1-65" name="__codelineno-1-65" href="#guides-creating_tool_plugins-__codelineno-1-65"></a>        <span class="k">pass</span>
</code></pre></div></p>
</li>
<li>
<p><strong>Register Your Plugin</strong>:</p>
<ul>
<li>Add an entry point in <code>pyproject.toml</code>:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#guides-creating_tool_plugins-__codelineno-2-1"></a><span class="k">[tool.poetry.plugins.</span><span class="s2">&quot;genie_tooling.plugins&quot;</span><span class="k">]</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#guides-creating_tool_plugins-__codelineno-2-2"></a><span class="s2">&quot;my_custom_search_tool_v1&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;my_package.tools:MyCustomSearchTool&quot;</span>
</code></pre></div></li>
<li>Or, place the Python file in a directory listed in <code>MiddlewareConfig.plugin_dev_dirs</code>.</li>
</ul>
</li>
<li>
<p><strong>Enable and Configure in <code>MiddlewareConfig</code></strong>:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#guides-creating_tool_plugins-__codelineno-3-1"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#guides-creating_tool_plugins-__codelineno-3-2"></a>    <span class="c1"># ...</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#guides-creating_tool_plugins-__codelineno-3-3"></a>    <span class="n">tool_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#guides-creating_tool_plugins-__codelineno-3-4"></a>        <span class="s2">&quot;my_custom_search_tool_v1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># This is the plugin_id</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#guides-creating_tool_plugins-__codelineno-3-5"></a>            <span class="s2">&quot;api_base_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://prod.customsearch.com/v2&quot;</span> <span class="c1"># Configuration for its setup()</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#guides-creating_tool_plugins-__codelineno-3-6"></a>        <span class="p">}</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#guides-creating_tool_plugins-__codelineno-3-7"></a>    <span class="p">}</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#guides-creating_tool_plugins-__codelineno-3-8"></a>    <span class="c1"># ...</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#guides-creating_tool_plugins-__codelineno-3-9"></a><span class="p">)</span>
</code></pre></div>
    <strong>Important</strong>: Your tool will only be loaded and available if its <code>plugin_id</code> is a key in the <code>tool_configurations</code> dictionary. An empty dictionary <code>{}</code> as the value is sufficient if no specific configuration is needed for <code>setup()</code>.</p>
</li>
</ol>
<p>Now, your <code>MyCustomSearchTool</code> can be used by <code>genie.execute_tool("my_custom_search_tool_v1", ...)</code> or selected by a command processor.</p></section><section class="print-page" id="guides-creating_rag_plugins" heading-number="2.4"><h1 id="guides-creating_rag_plugins-creating-rag-plugins">Creating RAG Plugins<a class="headerlink" href="#guides-creating_rag_plugins-creating-rag-plugins" title="Permanent link">&para;</a></h1>
<p>Genie Tooling's Retrieval Augmented Generation (RAG) system is composed of several pluggable components. You can create custom implementations for each to tailor the RAG pipeline to your specific data sources and needs.</p>
<p>The core RAG component protocols are:</p>
<ul>
<li><strong><code>DocumentLoaderPlugin</code></strong>: Loads raw data from a source (e.g., files, web pages, databases) into <code>Document</code> objects.<ul>
<li>Located in: <code>genie_tooling.document_loaders.abc</code></li>
<li>Key method: <code>async def load(self, source_uri: str, config: Optional[Dict[str, Any]] = None) -&gt; AsyncIterable[Document]</code></li>
</ul>
</li>
<li><strong><code>TextSplitterPlugin</code></strong>: Splits <code>Document</code> objects into smaller <code>Chunk</code> objects.<ul>
<li>Located in: <code>genie_tooling.text_splitters.abc</code></li>
<li>Key method: <code>async def split(self, documents: AsyncIterable[Document], config: Optional[Dict[str, Any]] = None) -&gt; AsyncIterable[Chunk]</code></li>
</ul>
</li>
<li><strong><code>EmbeddingGeneratorPlugin</code></strong>: Generates embedding vectors for <code>Chunk</code> objects.<ul>
<li>Located in: <code>genie_tooling.embedding_generators.abc</code></li>
<li>Key method: <code>async def embed(self, chunks: AsyncIterable[Chunk], config: Optional[Dict[str, Any]] = None) -&gt; AsyncIterable[Tuple[Chunk, EmbeddingVector]]</code></li>
</ul>
</li>
<li><strong><code>VectorStorePlugin</code></strong>: Stores, manages, and searches <code>Chunk</code> embeddings.<ul>
<li>Located in: <code>genie_tooling.vector_stores.abc</code></li>
<li>Key methods: <code>async def add(...)</code>, <code>async def search(...)</code>, <code>async def delete(...)</code>.</li>
</ul>
</li>
<li><strong><code>RetrieverPlugin</code></strong>: Orchestrates the process of taking a query, embedding it, and searching a vector store to retrieve relevant chunks. Often composes an <code>EmbeddingGeneratorPlugin</code> and a <code>VectorStorePlugin</code>.<ul>
<li>Located in: <code>genie_tooling.retrievers.abc</code></li>
<li>Key method: <code>async def retrieve(self, query: str, top_k: int, config: Optional[Dict[str, Any]] = None) -&gt; List[RetrievedChunk]</code></li>
</ul>
</li>
</ul>
<h2 id="guides-creating_rag_plugins-steps-to-create-a-rag-plugin">Steps to Create a RAG Plugin<a class="headerlink" href="#guides-creating_rag_plugins-steps-to-create-a-rag-plugin" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Identify the Component</strong>: Determine which part of the RAG pipeline you want to customize (e.g., a new document loader for a specific API, a different text splitting strategy).</li>
<li><strong>Implement the Protocol</strong>:<ul>
<li>Create a Python class that inherits from the relevant plugin protocol (e.g., <code>DocumentLoaderPlugin</code>).</li>
<li>Your class must also implicitly or explicitly adhere to the base <code>genie_tooling.core.types.Plugin</code> protocol (by having a <code>plugin_id</code> and optional <code>setup</code>/<code>teardown</code> methods).</li>
<li>Implement all required methods from the chosen RAG component protocol.
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-creating_rag_plugins-__codelineno-0-1"></a><span class="c1"># Example: Custom Document Loader</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-creating_rag_plugins-__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.core.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">Document</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#guides-creating_rag_plugins-__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.document_loaders.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">DocumentLoaderPlugin</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#guides-creating_rag_plugins-__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">AsyncIterable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#guides-creating_rag_plugins-__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#guides-creating_rag_plugins-__codelineno-0-6"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyCustomAPILoader</span><span class="p">(</span><span class="n">DocumentLoaderPlugin</span><span class="p">):</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#guides-creating_rag_plugins-__codelineno-0-7"></a>    <span class="n">plugin_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;my_custom_api_loader_v1&quot;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#guides-creating_rag_plugins-__codelineno-0-8"></a>    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Loads documents from MyCustomAPI.&quot;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#guides-creating_rag_plugins-__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#guides-creating_rag_plugins-__codelineno-0-10"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#guides-creating_rag_plugins-__codelineno-0-11"></a>        <span class="c1"># Initialize API clients, etc.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#guides-creating_rag_plugins-__codelineno-0-12"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">api_endpoint</span> <span class="o">=</span> <span class="p">(</span><span class="n">config</span> <span class="ow">or</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;api_endpoint&quot;</span><span class="p">,</span> <span class="s2">&quot;https://api.example.com/data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#guides-creating_rag_plugins-__codelineno-0-13"></a>        <span class="c1"># self.key_provider = (config or {}).get(&quot;key_provider&quot;) # If API key needed</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#guides-creating_rag_plugins-__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#guides-creating_rag_plugins-__codelineno-0-15"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterable</span><span class="p">[</span><span class="n">Document</span><span class="p">]:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#guides-creating_rag_plugins-__codelineno-0-16"></a>        <span class="c1"># source_uri might be an entity ID or query for your API</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#guides-creating_rag_plugins-__codelineno-0-17"></a>        <span class="c1"># api_key = await self.key_provider.get_key(&quot;MY_CUSTOM_API_KEY&quot;)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#guides-creating_rag_plugins-__codelineno-0-18"></a>        <span class="c1"># ... fetch data from API ...</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#guides-creating_rag_plugins-__codelineno-0-19"></a>        <span class="c1"># for item in fetched_data:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#guides-creating_rag_plugins-__codelineno-0-20"></a>        <span class="c1">#     yield Document(content=item[&#39;text&#39;], metadata={&quot;source&quot;: &quot;MyCustomAPI&quot;, &quot;id&quot;: item[&#39;id&#39;]})</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#guides-creating_rag_plugins-__codelineno-0-21"></a>        <span class="k">if</span> <span class="kc">False</span><span class="p">:</span> <span class="c1"># Make it an async generator</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#guides-creating_rag_plugins-__codelineno-0-22"></a>             <span class="k">yield</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#guides-creating_rag_plugins-__codelineno-0-23"></a>        <span class="k">pass</span> <span class="c1"># Replace with actual implementation</span>
</code></pre></div></li>
</ul>
</li>
<li><strong>Register Your Plugin</strong>:<ul>
<li>Use entry points in <code>pyproject.toml</code> or place it in a <code>plugin_dev_dirs</code> directory.</li>
</ul>
</li>
<li><strong>Configure Genie to Use Your Plugin</strong>:<ul>
<li>In <code>MiddlewareConfig</code>, update the relevant <code>features</code> settings (e.g., <code>features.rag_loader = "my_custom_api_loader_v1"</code>) or explicitly set the default ID (e.g., <code>default_rag_loader_id = "my_custom_api_loader_v1"</code>).</li>
<li>Provide any necessary configuration for your plugin in the corresponding <code>*_configurations</code> dictionary (e.g., <code>document_loader_configurations["my_custom_api_loader_v1"] = {"api_endpoint": "..."}</code>).</li>
</ul>
</li>
</ol>
<h2 id="guides-creating_rag_plugins-example-using-a-custom-rag-component">Example: Using a Custom RAG Component<a class="headerlink" href="#guides-creating_rag_plugins-example-using-a-custom-rag-component" title="Permanent link">&para;</a></h2>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-creating_rag_plugins-__codelineno-1-1"></a><span class="c1"># In your MiddlewareConfig</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#guides-creating_rag_plugins-__codelineno-1-2"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#guides-creating_rag_plugins-__codelineno-1-3"></a>    <span class="n">features</span><span class="o">=</span><span class="n">FeatureSettings</span><span class="p">(</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#guides-creating_rag_plugins-__codelineno-1-4"></a>        <span class="n">rag_loader</span><span class="o">=</span><span class="s2">&quot;my_custom_api_loader_v1&quot;</span><span class="p">,</span> <span class="c1"># Use your custom loader</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#guides-creating_rag_plugins-__codelineno-1-5"></a>        <span class="n">rag_embedder</span><span class="o">=</span><span class="s2">&quot;st_embedder&quot;</span><span class="p">,</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#guides-creating_rag_plugins-__codelineno-1-6"></a>        <span class="n">rag_vector_store</span><span class="o">=</span><span class="s2">&quot;faiss_vs&quot;</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#guides-creating_rag_plugins-__codelineno-1-7"></a>    <span class="p">),</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#guides-creating_rag_plugins-__codelineno-1-8"></a>    <span class="n">document_loader_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#guides-creating_rag_plugins-__codelineno-1-9"></a>        <span class="s2">&quot;my_custom_api_loader_v1&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#guides-creating_rag_plugins-__codelineno-1-10"></a>            <span class="s2">&quot;api_endpoint&quot;</span><span class="p">:</span> <span class="s2">&quot;https://my.service.com/data_source&quot;</span><span class="p">,</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#guides-creating_rag_plugins-__codelineno-1-11"></a>            <span class="c1"># &quot;key_provider&quot;: my_key_provider_instance (if needed and passed to Genie.create)</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#guides-creating_rag_plugins-__codelineno-1-12"></a>        <span class="p">}</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#guides-creating_rag_plugins-__codelineno-1-13"></a>    <span class="p">}</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#guides-creating_rag_plugins-__codelineno-1-14"></a><span class="p">)</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#guides-creating_rag_plugins-__codelineno-1-15"></a>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#guides-creating_rag_plugins-__codelineno-1-16"></a><span class="c1"># genie = await Genie.create(config=app_config, key_provider_instance=my_key_provider_instance)</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#guides-creating_rag_plugins-__codelineno-1-17"></a><span class="c1"># await genie.rag.index_directory(source_uri=&quot;query_for_my_api&quot;, collection_name=&quot;custom_data&quot;)</span>
</code></pre></div>
The <code>RAGManager</code> (used internally by <code>genie.rag</code>) will then pick up and use your custom plugin based on the configuration.</p></section><section class="print-page" id="guides-creating_other_plugins" heading-number="2.5"><h1 id="guides-creating_other_plugins-creating-other-plugins">Creating Other Plugins<a class="headerlink" href="#guides-creating_other_plugins-creating-other-plugins" title="Permanent link">&para;</a></h1>
<p>Beyond tools and RAG components, Genie Tooling's pluggable architecture allows for customization of many other functionalities. This guide provides an overview of how to create various other types of plugins.</p>
<h2 id="guides-creating_other_plugins-general-plugin-principles">General Plugin Principles<a class="headerlink" href="#guides-creating_other_plugins-general-plugin-principles" title="Permanent link">&para;</a></h2>
<p>All plugins in Genie Tooling typically adhere to the <code>genie_tooling.core.types.Plugin</code> protocol:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#guides-creating_other_plugins-__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Protocol</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#guides-creating_other_plugins-__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#guides-creating_other_plugins-__codelineno-0-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">Plugin</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#guides-creating_other_plugins-__codelineno-0-4"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#guides-creating_other_plugins-__codelineno-0-5"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plugin_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#guides-creating_other_plugins-__codelineno-0-6"></a>        <span class="o">...</span> <span class="c1"># Unique identifier for the plugin</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#guides-creating_other_plugins-__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#guides-creating_other_plugins-__codelineno-0-8"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#guides-creating_other_plugins-__codelineno-0-9"></a>        <span class="k">pass</span> <span class="c1"># Optional async setup</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#guides-creating_other_plugins-__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#guides-creating_other_plugins-__codelineno-0-11"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#guides-creating_other_plugins-__codelineno-0-12"></a>        <span class="k">pass</span> <span class="c1"># Optional async teardown</span>
</code></pre></div>
<p>Your custom plugin class should:
1.  Define a unique <code>plugin_id</code> as a class attribute.
2.  Implement the specific protocol for the type of plugin you are creating (e.g., <code>LLMProviderPlugin</code>, <code>CacheProviderPlugin</code>).
3.  Implement <code>async def setup(self, config: Optional[Dict[str, Any]] = None)</code> if your plugin requires initialization with configuration.
4.  Implement <code>async def teardown(self)</code> if your plugin needs to release resources.</p>
<h2 id="guides-creating_other_plugins-registering-your-plugin">Registering Your Plugin<a class="headerlink" href="#guides-creating_other_plugins-registering-your-plugin" title="Permanent link">&para;</a></h2>
<p>Make your plugin discoverable by Genie:
*   <strong>Entry Points</strong>: Define an entry point in your <code>pyproject.toml</code> under the <code>[tool.poetry.plugins."genie_tooling.plugins"]</code> group.
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#guides-creating_other_plugins-__codelineno-1-1"></a><span class="k">[tool.poetry.plugins.</span><span class="s2">&quot;genie_tooling.plugins&quot;</span><span class="k">]</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#guides-creating_other_plugins-__codelineno-1-2"></a><span class="s2">&quot;my_custom_cache_v1&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;my_package.my_module:MyCustomCacheProvider&quot;</span>
</code></pre></div>
*   <strong>Plugin Development Directories</strong>: Place your plugin's Python file in a directory specified in <code>MiddlewareConfig.plugin_dev_dirs</code>.</p>
<h2 id="guides-creating_other_plugins-common-plugin-categories-and-their-protocols">Common Plugin Categories and Their Protocols<a class="headerlink" href="#guides-creating_other_plugins-common-plugin-categories-and-their-protocols" title="Permanent link">&para;</a></h2>
<p>Refer to the <code>src/genie_tooling/</code> subdirectories for the specific abstract base classes (ABCs) or protocols for each plugin type. Key examples include:</p>
<ul>
<li><strong>Key Providers</strong>: <code>genie_tooling.security.key_provider.KeyProvider</code><ul>
<li>Implement <code>async def get_key(self, key_name: str) -&gt; Optional[str]</code></li>
</ul>
</li>
<li><strong>LLM Providers</strong>: <code>genie_tooling.llm_providers.abc.LLMProviderPlugin</code><ul>
<li>Implement <code>async def generate(...)</code> and/or <code>async def chat(...)</code>.</li>
</ul>
</li>
<li><strong>Command Processors</strong>: <code>genie_tooling.command_processors.abc.CommandProcessorPlugin</code><ul>
<li>Implement <code>async def process_command(...)</code>.</li>
</ul>
</li>
<li><strong>Definition Formatters</strong>: <code>genie_tooling.definition_formatters.abc.DefinitionFormatter</code><ul>
<li>Implement <code>def format(...)</code>.</li>
</ul>
</li>
<li><strong>Caching Providers</strong>: <code>genie_tooling.cache_providers.abc.CacheProvider</code><ul>
<li>Implement <code>async def get(...)</code>, <code>async def set(...)</code>, <code>async def delete(...)</code>, etc.</li>
</ul>
</li>
<li><strong>Invocation Strategies</strong>: <code>genie_tooling.invocation_strategies.abc.InvocationStrategy</code><ul>
<li>Implement <code>async def invoke(...)</code>.</li>
</ul>
</li>
<li><strong>Input Validators</strong>: <code>genie_tooling.input_validators.abc.InputValidator</code><ul>
<li>Implement <code>def validate(...)</code>.</li>
</ul>
</li>
<li><strong>Output Transformers</strong>: <code>genie_tooling.output_transformers.abc.OutputTransformer</code><ul>
<li>Implement <code>def transform(...)</code>.</li>
</ul>
</li>
<li><strong>Error Handlers &amp; Formatters</strong>: <code>genie_tooling.error_handlers.abc.ErrorHandler</code>, <code>genie_tooling.error_formatters.abc.ErrorFormatter</code></li>
<li><strong>Log Adapters &amp; Redactors</strong>: <code>genie_tooling.log_adapters.abc.LogAdapter</code>, <code>genie_tooling.redactors.abc.Redactor</code></li>
<li><strong>Code Executors</strong>: <code>genie_tooling.code_executors.abc.CodeExecutor</code></li>
<li><strong>Observability Tracers</strong>: <code>genie_tooling.observability.abc.InteractionTracerPlugin</code></li>
<li><strong>HITL Approvers</strong>: <code>genie_tooling.hitl.abc.HumanApprovalRequestPlugin</code></li>
<li><strong>Token Usage Recorders</strong>: <code>genie_tooling.token_usage.abc.TokenUsageRecorderPlugin</code></li>
<li><strong>Guardrail Plugins</strong>: <code>genie_tooling.guardrails.abc.InputGuardrailPlugin</code>, <code>OutputGuardrailPlugin</code>, <code>ToolUsageGuardrailPlugin</code></li>
<li><strong>Prompt System Plugins</strong>: <code>genie_tooling.prompts.abc.PromptRegistryPlugin</code>, <code>PromptTemplatePlugin</code></li>
<li><strong>Conversation State Providers</strong>: <code>genie_tooling.prompts.conversation.impl.abc.ConversationStateProviderPlugin</code></li>
<li><strong>LLM Output Parsers</strong>: <code>genie_tooling.prompts.llm_output_parsers.abc.LLMOutputParserPlugin</code></li>
<li><strong>Distributed Task Queues</strong>: <code>genie_tooling.task_queues.abc.DistributedTaskQueuePlugin</code></li>
</ul>
<h2 id="guides-creating_other_plugins-configuration">Configuration<a class="headerlink" href="#guides-creating_other_plugins-configuration" title="Permanent link">&para;</a></h2>
<p>Once your plugin is created and registered, you can configure it in <code>MiddlewareConfig</code> using the appropriate <code>*_configurations</code> dictionary, keyed by your plugin's <code>plugin_id</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#guides-creating_other_plugins-__codelineno-2-1"></a><span class="c1"># In your MiddlewareConfig</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#guides-creating_other_plugins-__codelineno-2-2"></a><span class="n">app_config</span> <span class="o">=</span> <span class="n">MiddlewareConfig</span><span class="p">(</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#guides-creating_other_plugins-__codelineno-2-3"></a>    <span class="c1"># ...</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#guides-creating_other_plugins-__codelineno-2-4"></a>    <span class="n">cache_provider_configurations</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#guides-creating_other_plugins-__codelineno-2-5"></a>        <span class="s2">&quot;my_custom_cache_v1&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#guides-creating_other_plugins-__codelineno-2-6"></a>            <span class="s2">&quot;connection_string&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#guides-creating_other_plugins-__codelineno-2-7"></a>            <span class="s2">&quot;default_ttl&quot;</span><span class="p">:</span> <span class="mi">300</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#guides-creating_other_plugins-__codelineno-2-8"></a>        <span class="p">}</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#guides-creating_other_plugins-__codelineno-2-9"></a>    <span class="p">},</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#guides-creating_other_plugins-__codelineno-2-10"></a>    <span class="n">default_cache_provider_id</span><span class="o">=</span><span class="s2">&quot;my_custom_cache_v1&quot;</span> <span class="c1"># If it should be the default</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#guides-creating_other_plugins-__codelineno-2-11"></a>    <span class="c1"># ...</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#guides-creating_other_plugins-__codelineno-2-12"></a><span class="p">)</span>
</code></pre></div>
<p>By following the relevant protocol and registering your plugin, you can extend Genie Tooling to meet your specific application needs.</p></section></section>
                    <section class='print-page md-section' id='section-3' heading-number='3'>
                        <h1>API Reference<a class='headerlink' href='#section-3' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="api" heading-number="3.1"><h1 id="api-api-reference">API Reference<a class="headerlink" href="#api-api-reference" title="Permanent link">&para;</a></h1>
<p>This section contains the auto-generated API documentation for Genie Tooling.</p>
<p>Explore the modules and classes below for detailed information.</p>
<h2 id="api-core">Core<a class="headerlink" href="#api-core" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="#api-genie_facade">Genie Facade &amp; Interfaces</a></li>
<li><a href="#api-decorators">Decorators (@tool)</a></li>
<li><a href="#api-core_types">Core Types</a> </li>
<li><a href="#api-plugin_manager">Plugin Manager</a></li>
</ul>
<h2 id="api-configuration">Configuration<a class="headerlink" href="#api-configuration" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="#api-config_models">MiddlewareConfig</a></li>
<li><a href="#api-config_features">FeatureSettings</a></li>
</ul>
<h2 id="api-plugins-protocols-implementations">Plugins (Protocols &amp; Implementations)<a class="headerlink" href="#api-plugins-protocols-implementations" title="Permanent link">&para;</a></h2>
<p>This section can be expanded by <code>mkdocstrings</code> or by manually linking to specific plugin protocol documentation pages. Key plugin categories include:
*   Tools
*   LLM Providers
*   Command Processors
*   RAG Components (Loaders, Splitters, Embedders, Vector Stores, Retrievers)
*   Tool Lookup Providers
*   Definition Formatters
*   Caching Providers
*   Key Providers
*   Invocation Strategies
*   Error Handling
*   Logging &amp; Redaction
*   Code Executors
*   <strong>Prompt System Plugins</strong> (Registries, Templates)
*   <strong>Conversation State Providers</strong>
*   <strong>Observability Tracers</strong>
*   <strong>HITL Approvers</strong>
*   <strong>Token Usage Recorders</strong>
*   <strong>Guardrail Plugins</strong>
*   <strong>LLM Output Parsers</strong></p>
<hr />


<div class="doc doc-object doc-module">



<h2 id="api-genie_tooling" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">genie_tooling</span>


<a href="#api-genie_tooling" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <h4 id="api-genie_tooling--genie-tooling">genie-tooling<a class="headerlink" href="#api-genie_tooling--genie-tooling" title="Permanent link">&para;</a></h4>
<p>A hyper-pluggable Python middleware for Agentic AI and LLM applications.
Async-first for performance.</p>









  <div class="doc doc-children">






<h3 id="api-genie_tooling-classes">Classes<a href="#api-genie_tooling-classes" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.BaseAgent" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">BaseAgent</span>


<a href="#api-genie_tooling.BaseAgent" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">BaseAgent</span><span class="p">(</span><span class="n">genie</span><span class="p">:</span> <span class="n">Genie</span><span class="p">,</span> <span class="n">agent_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="abc.ABC" optional hover>ABC</autoref></code></p>


        <p>Abstract base class for agents that implement specific execution patterns
(e.g., ReAct, Plan-and-Execute) using the Genie facade.</p>

        <p>Initializes the BaseAgent.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>genie</code>
            </td>
            <td>
                  <code><autoref identifier="genie_tooling.genie.Genie" backlink-type="used-by" backlink-anchor="genie_tooling.BaseAgent" optional hover>Genie</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An initialized instance of the Genie facade.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>agent_config</code>
            </td>
            <td>
                  <code><autoref identifier="typing.Optional" optional hover>Optional</autoref>[<autoref identifier="typing.Dict" optional hover>Dict</autoref>[<autoref identifier="str" optional>str</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional dictionary for agent-specific configurations.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>src/genie_tooling/agents/base_agent.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-17">17</a></span>
<span class="normal"><a href="#api-__codelineno-0-18">18</a></span>
<span class="normal"><a href="#api-__codelineno-0-19">19</a></span>
<span class="normal"><a href="#api-__codelineno-0-20">20</a></span>
<span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span>
<span class="normal"><a href="#api-__codelineno-0-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genie</span><span class="p">:</span> <span class="s2">&quot;Genie&quot;</span><span class="p">,</span> <span class="n">agent_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    Initializes the BaseAgent.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        genie: An initialized instance of the Genie facade.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        agent_config: Optional dictionary for agent-specific configurations.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">genie</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;A Genie instance is required to initialize an agent.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">genie</span> <span class="o">=</span> <span class="n">genie</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">agent_config</span> <span class="o">=</span> <span class="n">agent_config</span> <span class="ow">or</span> <span class="p">{}</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initialized </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> with Genie instance and config: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">agent_config</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<h5 id="api-genie_tooling.BaseAgent-functions">Functions<a href="#api-genie_tooling.BaseAgent-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.BaseAgent.run" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">run</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.BaseAgent.run" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">run</span><span class="p">(</span><span class="n">goal</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>The main entry point to execute the agent's logic for a given goal.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>goal</code>
            </td>
            <td>
                  <code><autoref identifier="str" backlink-type="used-by" backlink-anchor="genie_tooling.BaseAgent.run" optional>str</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The high-level goal or task for the agent to accomplish.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><autoref identifier="typing.Any" backlink-type="used-by" backlink-anchor="genie_tooling.BaseAgent.run" optional hover>Any</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional runtime parameters specific to the agent's execution.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><autoref identifier="typing.Any" backlink-type="returned-by" backlink-anchor="genie_tooling.BaseAgent.run" optional hover>Any</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The final result or outcome of the agent's execution.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><autoref identifier="typing.Any" backlink-type="returned-by" backlink-anchor="genie_tooling.BaseAgent.run" optional hover>Any</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The structure of the result is specific to the agent implementation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/agents/base_agent.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-31">31</a></span>
<span class="normal"><a href="#api-__codelineno-0-32">32</a></span>
<span class="normal"><a href="#api-__codelineno-0-33">33</a></span>
<span class="normal"><a href="#api-__codelineno-0-34">34</a></span>
<span class="normal"><a href="#api-__codelineno-0-35">35</a></span>
<span class="normal"><a href="#api-__codelineno-0-36">36</a></span>
<span class="normal"><a href="#api-__codelineno-0-37">37</a></span>
<span class="normal"><a href="#api-__codelineno-0-38">38</a></span>
<span class="normal"><a href="#api-__codelineno-0-39">39</a></span>
<span class="normal"><a href="#api-__codelineno-0-40">40</a></span>
<span class="normal"><a href="#api-__codelineno-0-41">41</a></span>
<span class="normal"><a href="#api-__codelineno-0-42">42</a></span>
<span class="normal"><a href="#api-__codelineno-0-43">43</a></span>
<span class="normal"><a href="#api-__codelineno-0-44">44</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">goal</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    The main entry point to execute the agent&#39;s logic for a given goal.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        goal: The high-level goal or task for the agent to accomplish.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        **kwargs: Additional runtime parameters specific to the agent&#39;s execution.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        The final result or outcome of the agent&#39;s execution.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        The structure of the result is specific to the agent implementation.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.BaseAgent.teardown" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">teardown</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.BaseAgent.teardown" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">teardown</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Optional method for any cleanup specific to the agent.
The Genie instance itself should be torn down separately by the application.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/agents/base_agent.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-46">46</a></span>
<span class="normal"><a href="#api-__codelineno-0-47">47</a></span>
<span class="normal"><a href="#api-__codelineno-0-48">48</a></span>
<span class="normal"><a href="#api-__codelineno-0-49">49</a></span>
<span class="normal"><a href="#api-__codelineno-0-50">50</a></span>
<span class="normal"><a href="#api-__codelineno-0-51">51</a></span>
<span class="normal"><a href="#api-__codelineno-0-52">52</a></span>
<span class="normal"><a href="#api-__codelineno-0-53">53</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    Optional method for any cleanup specific to the agent.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    The Genie instance itself should be torn down separately by the application.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> teardown initiated.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="c1"># Add any agent-specific cleanup here if needed in the future.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.PlanAndExecuteAgent" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">PlanAndExecuteAgent</span>


<a href="#api-genie_tooling.PlanAndExecuteAgent" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">PlanAndExecuteAgent</span><span class="p">(</span><span class="n">genie</span><span class="p">:</span> <span class="n">Genie</span><span class="p">,</span> <span class="n">agent_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.agents.base_agent.BaseAgent" backlink-type="subclassed-by" backlink-anchor="genie_tooling.PlanAndExecuteAgent" optional hover>BaseAgent</autoref></code></p>


        <p>Implements the Plan-and-Execute agentic loop.
1. Planner: LLM generates a sequence of steps (tool calls) to achieve the goal.
            Steps can name their outputs for use in subsequent steps.
2. Executor: Executes these steps sequentially, resolving placeholders.</p>







                  <details class="quote">
                    <summary>Source code in <code>src/genie_tooling/agents/plan_and_execute_agent.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-35">35</a></span>
<span class="normal"><a href="#api-__codelineno-0-36">36</a></span>
<span class="normal"><a href="#api-__codelineno-0-37">37</a></span>
<span class="normal"><a href="#api-__codelineno-0-38">38</a></span>
<span class="normal"><a href="#api-__codelineno-0-39">39</a></span>
<span class="normal"><a href="#api-__codelineno-0-40">40</a></span>
<span class="normal"><a href="#api-__codelineno-0-41">41</a></span>
<span class="normal"><a href="#api-__codelineno-0-42">42</a></span>
<span class="normal"><a href="#api-__codelineno-0-43">43</a></span>
<span class="normal"><a href="#api-__codelineno-0-44">44</a></span>
<span class="normal"><a href="#api-__codelineno-0-45">45</a></span>
<span class="normal"><a href="#api-__codelineno-0-46">46</a></span>
<span class="normal"><a href="#api-__codelineno-0-47">47</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genie</span><span class="p">:</span> <span class="s2">&quot;Genie&quot;</span><span class="p">,</span> <span class="n">agent_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">genie</span><span class="p">,</span> <span class="n">agent_config</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">planner_system_prompt_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;planner_system_prompt_id&quot;</span><span class="p">,</span> <span class="n">DEFAULT_PLANNER_SYSTEM_PROMPT_ID</span><span class="p">)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">planner_llm_provider_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;planner_llm_provider_id&quot;</span><span class="p">)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tool_formatter_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tool_formatter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;compact_text_formatter_plugin_v1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_plan_retries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_plan_retries&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_step_retries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_step_retries&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">replan_on_step_failure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;replan_on_step_failure&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="sa">f</span><span class="s2">&quot;PlanAndExecuteAgent initialized. Planner Prompt ID: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">planner_system_prompt_id</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="sa">f</span><span class="s2">&quot;Planner LLM: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">planner_llm_provider_id</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;Genie Default&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.ReActAgent" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ReActAgent</span>


<a href="#api-genie_tooling.ReActAgent" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">ReActAgent</span><span class="p">(</span><span class="n">genie</span><span class="p">:</span> <span class="n">Genie</span><span class="p">,</span> <span class="n">agent_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.agents.base_agent.BaseAgent" backlink-type="subclassed-by" backlink-anchor="genie_tooling.ReActAgent" optional hover>BaseAgent</autoref></code></p>


        <p>Implements the ReAct (Reason-Act) agentic loop.</p>







                  <details class="quote">
                    <summary>Source code in <code>src/genie_tooling/agents/react_agent.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-__codelineno-0-31">31</a></span>
<span class="normal"><a href="#api-__codelineno-0-32">32</a></span>
<span class="normal"><a href="#api-__codelineno-0-33">33</a></span>
<span class="normal"><a href="#api-__codelineno-0-34">34</a></span>
<span class="normal"><a href="#api-__codelineno-0-35">35</a></span>
<span class="normal"><a href="#api-__codelineno-0-36">36</a></span>
<span class="normal"><a href="#api-__codelineno-0-37">37</a></span>
<span class="normal"><a href="#api-__codelineno-0-38">38</a></span>
<span class="normal"><a href="#api-__codelineno-0-39">39</a></span>
<span class="normal"><a href="#api-__codelineno-0-40">40</a></span>
<span class="normal"><a href="#api-__codelineno-0-41">41</a></span>
<span class="normal"><a href="#api-__codelineno-0-42">42</a></span>
<span class="normal"><a href="#api-__codelineno-0-43">43</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genie</span><span class="p">:</span> <span class="s2">&quot;Genie&quot;</span><span class="p">,</span> <span class="n">agent_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">genie</span><span class="p">,</span> <span class="n">agent_config</span><span class="p">)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_iterations&quot;</span><span class="p">,</span> <span class="n">DEFAULT_REACT_MAX_ITERATIONS</span><span class="p">)</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">system_prompt_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system_prompt_id&quot;</span><span class="p">,</span> <span class="n">DEFAULT_REACT_SYSTEM_PROMPT_ID</span><span class="p">)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">llm_provider_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;llm_provider_id&quot;</span><span class="p">)</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tool_formatter_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tool_formatter_id&quot;</span><span class="p">,</span> <span class="s2">&quot;compact_text_formatter_plugin_v1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">stop_sequences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;stop_sequences&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Observation:&quot;</span><span class="p">])</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">llm_retry_attempts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;llm_retry_attempts&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">llm_retry_delay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;llm_retry_delay_seconds&quot;</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>        <span class="sa">f</span><span class="s2">&quot;ReActAgent initialized. Max iterations: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="sa">f</span><span class="s2">&quot;System Prompt ID: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">system_prompt_id</span><span class="si">}</span><span class="s2">, LLM Provider: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">llm_provider_id</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;Genie Default&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.AgentOutput" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">AgentOutput</span>


<a href="#api-genie_tooling.AgentOutput" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.TypedDict" backlink-type="subclassed-by" backlink-anchor="genie_tooling.AgentOutput" optional hover>TypedDict</autoref></code></p>


        <p>Standardized output structure from an agent's run method.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.PlannedStep" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">PlannedStep</span>


<a href="#api-genie_tooling.PlannedStep" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.TypedDict" backlink-type="subclassed-by" backlink-anchor="genie_tooling.PlannedStep" optional hover>TypedDict</autoref></code></p>


        <p>Represents a single step in a generated plan.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.ReActObservation" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ReActObservation</span>


<a href="#api-genie_tooling.ReActObservation" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.TypedDict" backlink-type="subclassed-by" backlink-anchor="genie_tooling.ReActObservation" optional hover>TypedDict</autoref></code></p>


        <p>Represents one cycle of Thought-Action-Observation in ReAct.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.CacheProviderPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">CacheProviderPlugin</span>


<a href="#api-genie_tooling.CacheProviderPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.CacheProviderPlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.CacheProviderPlugin" optional hover>Protocol</autoref></code></p>


        <p>Protocol for a cache provider, designed for async operations.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.CacheProviderPlugin-functions">Functions<a href="#api-genie_tooling.CacheProviderPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.CacheProviderPlugin.get" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.CacheProviderPlugin.get" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">get</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Retrieves an item from the cache.
Args:
    key: The key of the item to retrieve.
Returns:
    The cached item, or None if the key is not found or item is expired.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/cache_providers/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-15">15</a></span>
<span class="normal"><a href="#api-__codelineno-0-16">16</a></span>
<span class="normal"><a href="#api-__codelineno-0-17">17</a></span>
<span class="normal"><a href="#api-__codelineno-0-18">18</a></span>
<span class="normal"><a href="#api-__codelineno-0-19">19</a></span>
<span class="normal"><a href="#api-__codelineno-0-20">20</a></span>
<span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    Retrieves an item from the cache.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        key: The key of the item to retrieve.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        The cached item, or None if the key is not found or item is expired.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CacheProvider &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; get method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.CacheProviderPlugin.set" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">set</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.CacheProviderPlugin.set" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">set</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">ttl_seconds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Stores an item in the cache.
Args:
    key: The key under which to store the item.
    value: The item to store. Should be serializable if cache is external.
    ttl_seconds: Optional time-to-live in seconds. If None, item may persist indefinitely
                 or use a default TTL defined by the cache provider.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/cache_providers/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span>
<span class="normal"><a href="#api-__codelineno-0-29">29</a></span>
<span class="normal"><a href="#api-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-__codelineno-0-31">31</a></span>
<span class="normal"><a href="#api-__codelineno-0-32">32</a></span>
<span class="normal"><a href="#api-__codelineno-0-33">33</a></span>
<span class="normal"><a href="#api-__codelineno-0-34">34</a></span>
<span class="normal"><a href="#api-__codelineno-0-35">35</a></span>
<span class="normal"><a href="#api-__codelineno-0-36">36</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">ttl_seconds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    Stores an item in the cache.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        key: The key under which to store the item.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        value: The item to store. Should be serializable if cache is external.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        ttl_seconds: Optional time-to-live in seconds. If None, item may persist indefinitely</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">                     or use a default TTL defined by the cache provider.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CacheProvider &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; set method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.CacheProviderPlugin.delete" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">delete</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.CacheProviderPlugin.delete" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">delete</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Deletes an item from the cache.
Args:
    key: The key of the item to delete.
Returns:
    True if the key existed and was deleted, False otherwise.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/cache_providers/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-38">38</a></span>
<span class="normal"><a href="#api-__codelineno-0-39">39</a></span>
<span class="normal"><a href="#api-__codelineno-0-40">40</a></span>
<span class="normal"><a href="#api-__codelineno-0-41">41</a></span>
<span class="normal"><a href="#api-__codelineno-0-42">42</a></span>
<span class="normal"><a href="#api-__codelineno-0-43">43</a></span>
<span class="normal"><a href="#api-__codelineno-0-44">44</a></span>
<span class="normal"><a href="#api-__codelineno-0-45">45</a></span>
<span class="normal"><a href="#api-__codelineno-0-46">46</a></span>
<span class="normal"><a href="#api-__codelineno-0-47">47</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    Deletes an item from the cache.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        key: The key of the item to delete.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        True if the key existed and was deleted, False otherwise.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CacheProvider &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; delete method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.CacheProviderPlugin.exists" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">exists</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.CacheProviderPlugin.exists" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">exists</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Checks if a key exists in the cache (and is not expired).
Args:
    key: The key to check.
Returns:
    True if the key exists and is valid, False otherwise.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/cache_providers/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-49">49</a></span>
<span class="normal"><a href="#api-__codelineno-0-50">50</a></span>
<span class="normal"><a href="#api-__codelineno-0-51">51</a></span>
<span class="normal"><a href="#api-__codelineno-0-52">52</a></span>
<span class="normal"><a href="#api-__codelineno-0-53">53</a></span>
<span class="normal"><a href="#api-__codelineno-0-54">54</a></span>
<span class="normal"><a href="#api-__codelineno-0-55">55</a></span>
<span class="normal"><a href="#api-__codelineno-0-56">56</a></span>
<span class="normal"><a href="#api-__codelineno-0-57">57</a></span>
<span class="normal"><a href="#api-__codelineno-0-58">58</a></span>
<span class="normal"><a href="#api-__codelineno-0-59">59</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    Checks if a key exists in the cache (and is not expired).</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        key: The key to check.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        True if the key exists and is valid, False otherwise.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="c1"># Default implementation using get()</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CacheProvider &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; exists method using default get() check.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.CacheProviderPlugin.clear_all" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clear_all</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.CacheProviderPlugin.clear_all" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">clear_all</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Clears all items from the cache managed by this provider.
Use with caution, especially for shared caches.
Returns:
    True if the clear operation was successful or attempted, False on failure.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/cache_providers/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-61">61</a></span>
<span class="normal"><a href="#api-__codelineno-0-62">62</a></span>
<span class="normal"><a href="#api-__codelineno-0-63">63</a></span>
<span class="normal"><a href="#api-__codelineno-0-64">64</a></span>
<span class="normal"><a href="#api-__codelineno-0-65">65</a></span>
<span class="normal"><a href="#api-__codelineno-0-66">66</a></span>
<span class="normal"><a href="#api-__codelineno-0-67">67</a></span>
<span class="normal"><a href="#api-__codelineno-0-68">68</a></span>
<span class="normal"><a href="#api-__codelineno-0-69">69</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">clear_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    Clears all items from the cache managed by this provider.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    Use with caution, especially for shared caches.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        True if the clear operation was successful or attempted, False on failure.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CacheProvider &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; clear_all method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.CodeExecutionResult" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">CodeExecutionResult</span>


<a href="#api-genie_tooling.CodeExecutionResult" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.NamedTuple" backlink-type="subclassed-by" backlink-anchor="genie_tooling.CodeExecutionResult" optional hover>NamedTuple</autoref></code></p>


        <p>Standardized result structure for code execution.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.CodeExecutorPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">CodeExecutorPlugin</span>


<a href="#api-genie_tooling.CodeExecutorPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.CodeExecutorPlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.CodeExecutorPlugin" optional hover>Protocol</autoref></code></p>


        <p>Protocol for a plugin that executes code, ideally in a sandboxed environment.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.CodeExecutorPlugin-functions">Functions<a href="#api-genie_tooling.CodeExecutorPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.CodeExecutorPlugin.execute_code" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">execute_code</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.CodeExecutorPlugin.execute_code" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">execute_code</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">language</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a>    <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#api-__codelineno-0-4"></a>    <span class="n">timeout_seconds</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#api-__codelineno-0-5"></a>    <span class="n">input_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#api-__codelineno-0-6"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CodeExecutionResult</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Asynchronously executes the provided code string in the specified language.
Implementations should strive for secure execution (sandboxing).
Args:
    language: The programming language of the code.
    code: The code script to execute.
    timeout_seconds: Maximum allowed execution time in seconds.
    input_data: Optional dictionary to make available as variables within the code's scope
                (e.g., as a global dict named <code>_input</code> or similar, executor-defined).
Returns:
    A CodeExecutionResult NamedTuple.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/code_executors/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span>
<span class="normal"><a href="#api-__codelineno-0-29">29</a></span>
<span class="normal"><a href="#api-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-__codelineno-0-31">31</a></span>
<span class="normal"><a href="#api-__codelineno-0-32">32</a></span>
<span class="normal"><a href="#api-__codelineno-0-33">33</a></span>
<span class="normal"><a href="#api-__codelineno-0-34">34</a></span>
<span class="normal"><a href="#api-__codelineno-0-35">35</a></span>
<span class="normal"><a href="#api-__codelineno-0-36">36</a></span>
<span class="normal"><a href="#api-__codelineno-0-37">37</a></span>
<span class="normal"><a href="#api-__codelineno-0-38">38</a></span>
<span class="normal"><a href="#api-__codelineno-0-39">39</a></span>
<span class="normal"><a href="#api-__codelineno-0-40">40</a></span>
<span class="normal"><a href="#api-__codelineno-0-41">41</a></span>
<span class="normal"><a href="#api-__codelineno-0-42">42</a></span>
<span class="normal"><a href="#api-__codelineno-0-43">43</a></span>
<span class="normal"><a href="#api-__codelineno-0-44">44</a></span>
<span class="normal"><a href="#api-__codelineno-0-45">45</a></span>
<span class="normal"><a href="#api-__codelineno-0-46">46</a></span>
<span class="normal"><a href="#api-__codelineno-0-47">47</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute_code</span><span class="p">(</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">language</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">timeout_seconds</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="n">input_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># For passing structured input to the code&#39;s execution scope</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CodeExecutionResult</span><span class="p">:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    Asynchronously executes the provided code string in the specified language.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    Implementations should strive for secure execution (sandboxing).</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        language: The programming language of the code.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        code: The code script to execute.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        timeout_seconds: Maximum allowed execution time in seconds.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        input_data: Optional dictionary to make available as variables within the code&#39;s scope</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">                    (e.g., as a global dict named `_input` or similar, executor-defined).</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        A CodeExecutionResult NamedTuple.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CodeExecutor &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; execute_code method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="k">return</span> <span class="n">CodeExecutionResult</span><span class="p">(</span><span class="n">stdout</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="s2">&quot;Not implemented&quot;</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="s2">&quot;Executor not implemented&quot;</span><span class="p">,</span> <span class="n">execution_time_ms</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.CommandProcessorPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">CommandProcessorPlugin</span>


<a href="#api-genie_tooling.CommandProcessorPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.CommandProcessorPlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.CommandProcessorPlugin" optional hover>Protocol</autoref></code></p>


        <p>Protocol for a plugin that processes a natural language command to determine
which tool to use and what parameters to pass to it.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.CommandProcessorPlugin-functions">Functions<a href="#api-genie_tooling.CommandProcessorPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.CommandProcessorPlugin.setup" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">setup</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.CommandProcessorPlugin.setup" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">setup</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initializes the command processor.
Args:
    config: Processor-specific configuration dictionary. Expected to contain
            'genie_facade: Genie' for accessing other middleware components.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/command_processors/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span>
<span class="normal"><a href="#api-__codelineno-0-29">29</a></span>
<span class="normal"><a href="#api-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-__codelineno-0-31">31</a></span>
<span class="normal"><a href="#api-__codelineno-0-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    Initializes the command processor.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        config: Processor-specific configuration dictionary. Expected to contain</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">                &#39;genie_facade: Genie&#39; for accessing other middleware components.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="k">await</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CommandProcessorPlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39;: Base setup logic (if any) completed.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.CommandProcessorPlugin.process_command" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">process_command</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.CommandProcessorPlugin.process_command" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">process_command</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a>    <span class="n">conversation_history</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">ChatMessage</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#api-__codelineno-0-4"></a>    <span class="n">correlation_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#api-__codelineno-0-5"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandProcessorResponse</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Processes the given command, potentially using conversation history and
other Genie components (via the facade provided in setup), to decide
on a tool and its parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>command</code>
            </td>
            <td>
                  <code><autoref identifier="str" backlink-type="used-by" backlink-anchor="genie_tooling.CommandProcessorPlugin.process_command" optional>str</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The natural language command string from the user.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>conversation_history</code>
            </td>
            <td>
                  <code><autoref identifier="typing.Optional" optional hover>Optional</autoref>[<autoref identifier="typing.List" optional hover>List</autoref>[<autoref identifier="genie_tooling.llm_providers.types.ChatMessage" optional hover>ChatMessage</autoref>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional list of previous ChatMessages in the conversation.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>correlation_id</code>
            </td>
            <td>
                  <code><autoref identifier="typing.Optional" optional hover>Optional</autoref>[<autoref identifier="str" optional>str</autoref>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional ID to link related trace events.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><autoref identifier="genie_tooling.command_processors.types.CommandProcessorResponse" backlink-type="returned-by" backlink-anchor="genie_tooling.CommandProcessorPlugin.process_command" optional hover>CommandProcessorResponse</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A CommandProcessorResponse dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/command_processors/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-35">35</a></span>
<span class="normal"><a href="#api-__codelineno-0-36">36</a></span>
<span class="normal"><a href="#api-__codelineno-0-37">37</a></span>
<span class="normal"><a href="#api-__codelineno-0-38">38</a></span>
<span class="normal"><a href="#api-__codelineno-0-39">39</a></span>
<span class="normal"><a href="#api-__codelineno-0-40">40</a></span>
<span class="normal"><a href="#api-__codelineno-0-41">41</a></span>
<span class="normal"><a href="#api-__codelineno-0-42">42</a></span>
<span class="normal"><a href="#api-__codelineno-0-43">43</a></span>
<span class="normal"><a href="#api-__codelineno-0-44">44</a></span>
<span class="normal"><a href="#api-__codelineno-0-45">45</a></span>
<span class="normal"><a href="#api-__codelineno-0-46">46</a></span>
<span class="normal"><a href="#api-__codelineno-0-47">47</a></span>
<span class="normal"><a href="#api-__codelineno-0-48">48</a></span>
<span class="normal"><a href="#api-__codelineno-0-49">49</a></span>
<span class="normal"><a href="#api-__codelineno-0-50">50</a></span>
<span class="normal"><a href="#api-__codelineno-0-51">51</a></span>
<span class="normal"><a href="#api-__codelineno-0-52">52</a></span>
<span class="normal"><a href="#api-__codelineno-0-53">53</a></span>
<span class="normal"><a href="#api-__codelineno-0-54">54</a></span>
<span class="normal"><a href="#api-__codelineno-0-55">55</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">process_command</span><span class="p">(</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="n">conversation_history</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">ChatMessage</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="n">correlation_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandProcessorResponse</span><span class="p">:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    Processes the given command, potentially using conversation history and</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    other Genie components (via the facade provided in setup), to decide</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    on a tool and its parameters.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        command: The natural language command string from the user.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        conversation_history: Optional list of previous ChatMessages in the conversation.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        correlation_id: Optional ID to link related trace events.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        A CommandProcessorResponse dictionary.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CommandProcessorPlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; process_command method not implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CommandProcessorPlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; does not implement &#39;process_command&#39;.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.CommandProcessorResponse" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">CommandProcessorResponse</span>


<a href="#api-genie_tooling.CommandProcessorResponse" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.TypedDict" backlink-type="subclassed-by" backlink-anchor="genie_tooling.CommandProcessorResponse" optional hover>TypedDict</autoref></code></p>


        <p>Standardized response from a CommandProcessorPlugin.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.PluginManager" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">PluginManager</span>


<a href="#api-genie_tooling.PluginManager" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">PluginManager</span><span class="p">(</span><span class="n">plugin_dev_dirs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>Manages discovery, loading, and access to plugins.
Implements Hybrid: Entry Points + Configured Dev Directory discovery.</p>







                  <details class="quote">
                    <summary>Source code in <code>src/genie_tooling/core/plugin_manager.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plugin_dev_dirs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">plugin_dev_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">plugin_dev_dirs</span><span class="p">]</span> <span class="k">if</span> <span class="n">plugin_dev_dirs</span> <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_plugin_instances</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Plugin</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_discovered_plugin_classes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="n">Plugin</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_plugin_source_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PluginManager initialized. Dev dirs: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_dev_dirs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.Chunk" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">Chunk</span>


<a href="#api-genie_tooling.Chunk" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.Chunk" optional hover>Protocol</autoref></code></p>


        <p>Represents a chunk of a document after splitting.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.Document" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">Document</span>


<a href="#api-genie_tooling.Document" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.Document" optional hover>Protocol</autoref></code></p>


        <p>Represents a loaded document before splitting.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.Plugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">Plugin</span>


<a href="#api-genie_tooling.Plugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.Plugin" optional hover>Protocol</autoref></code></p>


        <p>Base protocol for all plugins.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.Plugin-functions">Functions<a href="#api-genie_tooling.Plugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.Plugin.setup" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">setup</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.Plugin.setup" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">setup</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Optional asynchronous setup method for plugins. Called after instantiation.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/core/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Optional asynchronous setup method for plugins. Called after instantiation.&quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.Plugin.teardown" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">teardown</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.Plugin.teardown" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">teardown</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Optional asynchronous teardown method for plugins. Called before application shutdown.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/core/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-29">29</a></span>
<span class="normal"><a href="#api-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-__codelineno-0-31">31</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Optional asynchronous teardown method for plugins. Called before application shutdown.&quot;&quot;&quot;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.RetrievedChunk" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">RetrievedChunk</span>


<a href="#api-genie_tooling.RetrievedChunk" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Chunk" backlink-type="subclassed-by" backlink-anchor="genie_tooling.RetrievedChunk" optional hover>Chunk</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.RetrievedChunk" optional hover>Protocol</autoref></code></p>


        <p>Represents a chunk retrieved from a vector store, with a relevance score.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.StructuredError" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">StructuredError</span>


<a href="#api-genie_tooling.StructuredError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.TypedDict" backlink-type="subclassed-by" backlink-anchor="genie_tooling.StructuredError" optional hover>TypedDict</autoref></code></p>


        <p>Standardized structure for reporting errors, especially to LLMs.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.DefinitionFormatterPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">DefinitionFormatterPlugin</span>


<a href="#api-genie_tooling.DefinitionFormatterPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.DefinitionFormatterPlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.DefinitionFormatterPlugin" optional hover>Protocol</autoref></code></p>


        <p>Protocol for a plugin that formats a tool's metadata
into a specific structure (e.g., for LLMs, for human readability).</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.DefinitionFormatterPlugin-functions">Functions<a href="#api-genie_tooling.DefinitionFormatterPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.DefinitionFormatterPlugin.format" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">format</span>


<a href="#api-genie_tooling.DefinitionFormatterPlugin.format" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">format</span><span class="p">(</span><span class="n">tool_metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Takes the comprehensive metadata from Tool.get_metadata()
and transforms it into the specific output format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool_metadata</code>
            </td>
            <td>
                  <code><autoref identifier="typing.Dict" optional hover>Dict</autoref>[<autoref identifier="str" optional>str</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The raw metadata dictionary from a Tool instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><autoref identifier="typing.Any" backlink-type="returned-by" backlink-anchor="genie_tooling.DefinitionFormatterPlugin.format" optional hover>Any</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The formatted definition (e.g., a dict for JSON, a string for text).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><autoref identifier="typing.Any" backlink-type="returned-by" backlink-anchor="genie_tooling.DefinitionFormatterPlugin.format" optional hover>Any</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type <code>Any</code> allows flexibility for various output formats.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/definition_formatters/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-17">17</a></span>
<span class="normal"><a href="#api-__codelineno-0-18">18</a></span>
<span class="normal"><a href="#api-__codelineno-0-19">19</a></span>
<span class="normal"><a href="#api-__codelineno-0-20">20</a></span>
<span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span>
<span class="normal"><a href="#api-__codelineno-0-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="k">def</span><span class="w"> </span><span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    Takes the comprehensive metadata from Tool.get_metadata()</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    and transforms it into the specific output format.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        tool_metadata: The raw metadata dictionary from a Tool instance.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        The formatted definition (e.g., a dict for JSON, a string for text).</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        The type `Any` allows flexibility for various output formats.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.DocumentLoaderPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">DocumentLoaderPlugin</span>


<a href="#api-genie_tooling.DocumentLoaderPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.DocumentLoaderPlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.DocumentLoaderPlugin" optional hover>Protocol</autoref></code></p>


        <p>Loads documents from a source into an async stream of Document objects.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.DocumentLoaderPlugin-functions">Functions<a href="#api-genie_tooling.DocumentLoaderPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.DocumentLoaderPlugin.load" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.DocumentLoaderPlugin.load" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">load</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">source_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterable</span><span class="p">[</span><span class="n">Document</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Loads documents from the given source URI.
Args:
    source_uri: The URI of the data source (e.g., file path, URL, database connection string).
    config: Loader-specific configuration dictionary.
Yields:
    Document objects.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/document_loaders/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span>
<span class="normal"><a href="#api-__codelineno-0-29">29</a></span>
<span class="normal"><a href="#api-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-__codelineno-0-31">31</a></span>
<span class="normal"><a href="#api-__codelineno-0-32">32</a></span>
<span class="normal"><a href="#api-__codelineno-0-33">33</a></span>
<span class="normal"><a href="#api-__codelineno-0-34">34</a></span>
<span class="normal"><a href="#api-__codelineno-0-35">35</a></span>
<span class="normal"><a href="#api-__codelineno-0-36">36</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterable</span><span class="p">[</span><span class="n">Document</span><span class="p">]:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    Loads documents from the given source URI.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        source_uri: The URI of the data source (e.g., file path, URL, database connection string).</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        config: Loader-specific configuration dictionary.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Yields:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        Document objects.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="c1"># Example of how to make an async generator that does nothing if not implemented:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DocumentLoaderPlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; load method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="k">if</span> <span class="kc">False</span><span class="p">:</span> <span class="c1"># pylint: disable=false-condition</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="k">yield</span> <span class="c1"># type: ignore</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.EmbeddingGeneratorPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">EmbeddingGeneratorPlugin</span>


<a href="#api-genie_tooling.EmbeddingGeneratorPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.EmbeddingGeneratorPlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.EmbeddingGeneratorPlugin" optional hover>Protocol</autoref></code></p>


        <p>Generates embeddings for an async stream of Chunks.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.EmbeddingGeneratorPlugin-functions">Functions<a href="#api-genie_tooling.EmbeddingGeneratorPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.EmbeddingGeneratorPlugin.embed" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">embed</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.EmbeddingGeneratorPlugin.embed" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">embed</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">chunks</span><span class="p">:</span> <span class="n">AsyncIterable</span><span class="p">[</span><span class="n">Chunk</span><span class="p">],</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Chunk</span><span class="p">,</span> <span class="n">EmbeddingVector</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generates embeddings for each chunk.
Args:
    chunks: An async iterable of Chunk objects.
    config: Embedder-specific configuration (e.g., model_name, batch_size, key_provider).
Yields:
    Tuples of (Chunk, EmbeddingVector).</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/embedding_generators/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span>
<span class="normal"><a href="#api-__codelineno-0-29">29</a></span>
<span class="normal"><a href="#api-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-__codelineno-0-31">31</a></span>
<span class="normal"><a href="#api-__codelineno-0-32">32</a></span>
<span class="normal"><a href="#api-__codelineno-0-33">33</a></span>
<span class="normal"><a href="#api-__codelineno-0-34">34</a></span>
<span class="normal"><a href="#api-__codelineno-0-35">35</a></span>
<span class="normal"><a href="#api-__codelineno-0-36">36</a></span>
<span class="normal"><a href="#api-__codelineno-0-37">37</a></span>
<span class="normal"><a href="#api-__codelineno-0-38">38</a></span>
<span class="normal"><a href="#api-__codelineno-0-39">39</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">embed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chunks</span><span class="p">:</span> <span class="n">AsyncIterable</span><span class="p">[</span><span class="n">Chunk</span><span class="p">],</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Chunk</span><span class="p">,</span> <span class="n">EmbeddingVector</span><span class="p">]]:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Generates embeddings for each chunk.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        chunks: An async iterable of Chunk objects.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        config: Embedder-specific configuration (e.g., model_name, batch_size, key_provider).</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    Yields:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        Tuples of (Chunk, EmbeddingVector).</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EmbeddingGeneratorPlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; embed method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="k">if</span> <span class="kc">False</span><span class="p">:</span> <span class="c1"># pylint: disable=false-condition</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>        <span class="k">yield</span> <span class="c1"># type: ignore</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.ErrorFormatter" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ErrorFormatter</span>


<a href="#api-genie_tooling.ErrorFormatter" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.ErrorFormatter" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.ErrorFormatter" optional hover>Protocol</autoref></code></p>


        <p>Protocol for formatting StructuredError for different consumers (e.g., LLM, logs).</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.ErrorFormatter-functions">Functions<a href="#api-genie_tooling.ErrorFormatter-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.ErrorFormatter.format" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">format</span>


<a href="#api-genie_tooling.ErrorFormatter.format" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">format</span><span class="p">(</span><span class="n">structured_error</span><span class="p">:</span> <span class="n">StructuredError</span><span class="p">,</span> <span class="n">target_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;llm&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Formats the structured_error.
Args:
    structured_error: The error dictionary produced by an ErrorHandler.
    target_format: A hint for the desired output format (e.g., "llm", "json", "human_log").
                   Default is "llm".
Returns:
    The formatted error (e.g., a string for LLM, a dict for JSON).
This method is synchronous.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/error_formatters/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-14">14</a></span>
<span class="normal"><a href="#api-__codelineno-0-15">15</a></span>
<span class="normal"><a href="#api-__codelineno-0-16">16</a></span>
<span class="normal"><a href="#api-__codelineno-0-17">17</a></span>
<span class="normal"><a href="#api-__codelineno-0-18">18</a></span>
<span class="normal"><a href="#api-__codelineno-0-19">19</a></span>
<span class="normal"><a href="#api-__codelineno-0-20">20</a></span>
<span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="k">def</span><span class="w"> </span><span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">structured_error</span><span class="p">:</span> <span class="n">StructuredError</span><span class="p">,</span> <span class="n">target_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;llm&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    Formats the structured_error.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        structured_error: The error dictionary produced by an ErrorHandler.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        target_format: A hint for the desired output format (e.g., &quot;llm&quot;, &quot;json&quot;, &quot;human_log&quot;).</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">                       Default is &quot;llm&quot;.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        The formatted error (e.g., a string for LLM, a dict for JSON).</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    This method is synchronous.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.ErrorHandler" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ErrorHandler</span>


<a href="#api-genie_tooling.ErrorHandler" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.ErrorHandler" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.ErrorHandler" optional hover>Protocol</autoref></code></p>


        <p>Protocol for handling exceptions during tool execution and converting them to StructuredError.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.ErrorHandler-functions">Functions<a href="#api-genie_tooling.ErrorHandler-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.ErrorHandler.handle" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">handle</span>


<a href="#api-genie_tooling.ErrorHandler.handle" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">handle</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">exception</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StructuredError</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Handles an exception that occurred during tool.execute() or related steps.
Args:
    exception: The exception instance caught.
    tool: The Tool instance that was being executed (typed as Any to avoid circular import).
          Implementations can cast or use getattr to access tool.identifier.
    context: Optional context dictionary active during the call.
Returns:
    A StructuredError dictionary.
This method is synchronous as error classification is typically CPU-bound.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/error_handlers/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-14">14</a></span>
<span class="normal"><a href="#api-__codelineno-0-15">15</a></span>
<span class="normal"><a href="#api-__codelineno-0-16">16</a></span>
<span class="normal"><a href="#api-__codelineno-0-17">17</a></span>
<span class="normal"><a href="#api-__codelineno-0-18">18</a></span>
<span class="normal"><a href="#api-__codelineno-0-19">19</a></span>
<span class="normal"><a href="#api-__codelineno-0-20">20</a></span>
<span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="k">def</span><span class="w"> </span><span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">StructuredError</span><span class="p">:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    Handles an exception that occurred during tool.execute() or related steps.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        exception: The exception instance caught.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        tool: The Tool instance that was being executed (typed as Any to avoid circular import).</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">              Implementations can cast or use getattr to access tool.identifier.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        context: Optional context dictionary active during the call.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        A StructuredError dictionary.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    This method is synchronous as error classification is typically CPU-bound.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.GuardrailPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">GuardrailPlugin</span>


<a href="#api-genie_tooling.GuardrailPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.GuardrailPlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.GuardrailPlugin" optional hover>Protocol</autoref></code></p>


        <p>Base protocol for all guardrail plugins.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.InputGuardrailPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">InputGuardrailPlugin</span>


<a href="#api-genie_tooling.InputGuardrailPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.guardrails.abc.GuardrailPlugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.InputGuardrailPlugin" optional hover>GuardrailPlugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.InputGuardrailPlugin" optional hover>Protocol</autoref></code></p>


        <p>Protocol for guardrails that check input data (e.g., prompts, user messages).</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.InputGuardrailPlugin-functions">Functions<a href="#api-genie_tooling.InputGuardrailPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.InputGuardrailPlugin.check_input" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">check_input</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.InputGuardrailPlugin.check_input" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">check_input</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GuardrailViolation</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Checks input data.
Returns:
    GuardrailViolation: Contains action (allow, block, warn) and reason.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/guardrails/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span>
<span class="normal"><a href="#api-__codelineno-0-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">check_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GuardrailViolation</span><span class="p">:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Checks input data.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        GuardrailViolation: Contains action (allow, block, warn) and reason.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;InputGuardrailPlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; check_input method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="k">return</span> <span class="n">GuardrailViolation</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_action</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Not implemented&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.OutputGuardrailPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">OutputGuardrailPlugin</span>


<a href="#api-genie_tooling.OutputGuardrailPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.guardrails.abc.GuardrailPlugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.OutputGuardrailPlugin" optional hover>GuardrailPlugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.OutputGuardrailPlugin" optional hover>Protocol</autoref></code></p>


        <p>Protocol for guardrails that check output data (e.g., LLM responses, tool results).</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.OutputGuardrailPlugin-functions">Functions<a href="#api-genie_tooling.OutputGuardrailPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.OutputGuardrailPlugin.check_output" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">check_output</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.OutputGuardrailPlugin.check_output" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">check_output</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GuardrailViolation</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Checks output data.
Returns:
    GuardrailViolation: Contains action (allow, block, warn) and reason.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/guardrails/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-34">34</a></span>
<span class="normal"><a href="#api-__codelineno-0-35">35</a></span>
<span class="normal"><a href="#api-__codelineno-0-36">36</a></span>
<span class="normal"><a href="#api-__codelineno-0-37">37</a></span>
<span class="normal"><a href="#api-__codelineno-0-38">38</a></span>
<span class="normal"><a href="#api-__codelineno-0-39">39</a></span>
<span class="normal"><a href="#api-__codelineno-0-40">40</a></span>
<span class="normal"><a href="#api-__codelineno-0-41">41</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">check_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GuardrailViolation</span><span class="p">:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    Checks output data.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        GuardrailViolation: Contains action (allow, block, warn) and reason.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;OutputGuardrailPlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; check_output method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="k">return</span> <span class="n">GuardrailViolation</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_action</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Not implemented&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.ToolUsageGuardrailPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ToolUsageGuardrailPlugin</span>


<a href="#api-genie_tooling.ToolUsageGuardrailPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.guardrails.abc.GuardrailPlugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.ToolUsageGuardrailPlugin" optional hover>GuardrailPlugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.ToolUsageGuardrailPlugin" optional hover>Protocol</autoref></code></p>


        <p>Protocol for guardrails that check tool usage attempts.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.ToolUsageGuardrailPlugin-functions">Functions<a href="#api-genie_tooling.ToolUsageGuardrailPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.ToolUsageGuardrailPlugin.check_tool_usage" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">check_tool_usage</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.ToolUsageGuardrailPlugin.check_tool_usage" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">check_tool_usage</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">tool</span><span class="p">:</span> <span class="n">Tool</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GuardrailViolation</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Checks if a tool usage attempt is permissible.
Returns:
    GuardrailViolation: Contains action (allow, block, warn) and reason.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/guardrails/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-46">46</a></span>
<span class="normal"><a href="#api-__codelineno-0-47">47</a></span>
<span class="normal"><a href="#api-__codelineno-0-48">48</a></span>
<span class="normal"><a href="#api-__codelineno-0-49">49</a></span>
<span class="normal"><a href="#api-__codelineno-0-50">50</a></span>
<span class="normal"><a href="#api-__codelineno-0-51">51</a></span>
<span class="normal"><a href="#api-__codelineno-0-52">52</a></span>
<span class="normal"><a href="#api-__codelineno-0-53">53</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">check_tool_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="n">Tool</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GuardrailViolation</span><span class="p">:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    Checks if a tool usage attempt is permissible.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        GuardrailViolation: Contains action (allow, block, warn) and reason.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ToolUsageGuardrailPlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; check_tool_usage method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="k">return</span> <span class="n">GuardrailViolation</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_action</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Not implemented&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.GuardrailViolation" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">GuardrailViolation</span>


<a href="#api-genie_tooling.GuardrailViolation" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.TypedDict" backlink-type="subclassed-by" backlink-anchor="genie_tooling.GuardrailViolation" optional hover>TypedDict</autoref></code></p>


        <p>Represents the outcome of a guardrail check.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.HumanApprovalRequestPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">HumanApprovalRequestPlugin</span>


<a href="#api-genie_tooling.HumanApprovalRequestPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.HumanApprovalRequestPlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.HumanApprovalRequestPlugin" optional hover>Protocol</autoref></code></p>


        <p>Protocol for a plugin that requests human approval for an action.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.HumanApprovalRequestPlugin-functions">Functions<a href="#api-genie_tooling.HumanApprovalRequestPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.HumanApprovalRequestPlugin.request_approval" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">request_approval</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.HumanApprovalRequestPlugin.request_approval" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">request_approval</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">ApprovalRequest</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApprovalResponse</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Requests human approval for a given action or data.
Implementations will vary (e.g., CLI prompt, web UI notification, API call).</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/hitl/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-16">16</a></span>
<span class="normal"><a href="#api-__codelineno-0-17">17</a></span>
<span class="normal"><a href="#api-__codelineno-0-18">18</a></span>
<span class="normal"><a href="#api-__codelineno-0-19">19</a></span>
<span class="normal"><a href="#api-__codelineno-0-20">20</a></span>
<span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">request_approval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">ApprovalRequest</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ApprovalResponse</span><span class="p">:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    Requests human approval for a given action or data.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    Implementations will vary (e.g., CLI prompt, web UI notification, API call).</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;HumanApprovalRequestPlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; request_approval method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="c1"># Default to denied if not implemented</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="k">return</span> <span class="n">ApprovalResponse</span><span class="p">(</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>        <span class="n">request_id</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">request_id</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>        <span class="n">status</span><span class="o">=</span><span class="s2">&quot;denied&quot;</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>        <span class="n">approver_id</span><span class="o">=</span><span class="s2">&quot;system_default&quot;</span><span class="p">,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Plugin not implemented.&quot;</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.HITLManager" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">HITLManager</span>


<a href="#api-genie_tooling.HITLManager" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">HITLManager</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">plugin_manager</span><span class="p">:</span> <span class="n">PluginManager</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a>    <span class="n">default_approver_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#api-__codelineno-0-4"></a>    <span class="n">approver_configurations</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#api-__codelineno-0-5"></a><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">








                  <details class="quote">
                    <summary>Source code in <code>src/genie_tooling/hitl/manager.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-14">14</a></span>
<span class="normal"><a href="#api-__codelineno-0-15">15</a></span>
<span class="normal"><a href="#api-__codelineno-0-16">16</a></span>
<span class="normal"><a href="#api-__codelineno-0-17">17</a></span>
<span class="normal"><a href="#api-__codelineno-0-18">18</a></span>
<span class="normal"><a href="#api-__codelineno-0-19">19</a></span>
<span class="normal"><a href="#api-__codelineno-0-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plugin_manager</span><span class="p">:</span> <span class="n">PluginManager</span><span class="p">,</span> <span class="n">default_approver_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">approver_configurations</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_plugin_manager</span> <span class="o">=</span> <span class="n">plugin_manager</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_default_approver_id</span> <span class="o">=</span> <span class="n">default_approver_id</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_approver_configurations</span> <span class="o">=</span> <span class="n">approver_configurations</span> <span class="ow">or</span> <span class="p">{}</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_default_approver_instance</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">HumanApprovalRequestPlugin</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_initialized_default</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;HITLManager initialized.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">





<h5 id="api-genie_tooling.HITLManager-attributes">Attributes<a href="#api-genie_tooling.HITLManager-attributes" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-attribute">



<h6 id="api-genie_tooling.HITLManager.is_active" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">is_active</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#api-genie_tooling.HITLManager.is_active" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="n">is_active</span><span class="p">:</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns True if a default approver is configured (and not 'none').</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.ApprovalRequest" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ApprovalRequest</span>


<a href="#api-genie_tooling.ApprovalRequest" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.TypedDict" backlink-type="subclassed-by" backlink-anchor="genie_tooling.ApprovalRequest" optional hover>TypedDict</autoref></code></p>


        <p>Represents a request for human approval.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.ApprovalResponse" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ApprovalResponse</span>


<a href="#api-genie_tooling.ApprovalResponse" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.TypedDict" backlink-type="subclassed-by" backlink-anchor="genie_tooling.ApprovalResponse" optional hover>TypedDict</autoref></code></p>


        <p>Represents the response from a human approval request.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.InputValidationException" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">InputValidationException</span>


<a href="#api-genie_tooling.InputValidationException" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">InputValidationException</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">errors</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="ValueError" backlink-type="subclassed-by" backlink-anchor="genie_tooling.InputValidationException" optional>ValueError</autoref></code></p>


        <p>Custom exception for input validation errors, providing more context.</p>







                  <details class="quote">
                    <summary>Source code in <code>src/genie_tooling/input_validators/abc.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-11">11</a></span>
<span class="normal"><a href="#api-__codelineno-0-12">12</a></span>
<span class="normal"><a href="#api-__codelineno-0-13">13</a></span>
<span class="normal"><a href="#api-__codelineno-0-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">errors</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.InputValidator" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">InputValidator</span>


<a href="#api-genie_tooling.InputValidator" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.InputValidator" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.InputValidator" optional hover>Protocol</autoref></code></p>


        <p>Protocol for input parameter validators.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.InputValidator-functions">Functions<a href="#api-genie_tooling.InputValidator-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.InputValidator.validate" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">validate</span>


<a href="#api-genie_tooling.InputValidator.validate" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">validate</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">schema</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Validates parameters against a schema.
Should raise InputValidationException on failure.
May return params (possibly coerced or with defaults applied by validator).
This method is synchronous as validation is typically CPU-bound.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/input_validators/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">schema</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    Validates parameters against a schema.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Should raise InputValidationException on failure.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    May return params (possibly coerced or with defaults applied by validator).</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    This method is synchronous as validation is typically CPU-bound.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.InvocationStrategy" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">InvocationStrategy</span>


<a href="#api-genie_tooling.InvocationStrategy" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.InvocationStrategy" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.InvocationStrategy" optional hover>Protocol</autoref></code></p>


        <p>Protocol for a strategy that defines the complete lifecycle of invoking a tool.
This includes validation, execution, transformation, caching, and error handling.
All strategies must be designed to be async.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.InvocationStrategy-functions">Functions<a href="#api-genie_tooling.InvocationStrategy-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.InvocationStrategy.invoke" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">invoke</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.InvocationStrategy.invoke" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">invoke</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">tool</span><span class="p">:</span> <span class="n">Tool</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a>    <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#api-__codelineno-0-4"></a>    <span class="n">key_provider</span><span class="p">:</span> <span class="n">KeyProvider</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#api-__codelineno-0-5"></a>    <span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#api-__codelineno-0-6"></a>    <span class="n">invoker_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#api-__codelineno-0-7"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Executes the full tool invocation lifecycle according to this strategy.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool</code>
            </td>
            <td>
                  <code><autoref identifier="genie_tooling.tools.abc.Tool" backlink-type="used-by" backlink-anchor="genie_tooling.InvocationStrategy.invoke" optional hover>Tool</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Tool instance to invoke.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><autoref identifier="typing.Dict" optional hover>Dict</autoref>[<autoref identifier="str" optional>str</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The parameters for the tool.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>key_provider</code>
            </td>
            <td>
                  <code><autoref identifier="genie_tooling.security.key_provider.KeyProvider" backlink-type="used-by" backlink-anchor="genie_tooling.InvocationStrategy.invoke" optional hover>KeyProvider</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The async key provider.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><autoref identifier="typing.Optional" optional hover>Optional</autoref>[<autoref identifier="typing.Dict" optional hover>Dict</autoref>[<autoref identifier="str" optional>str</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional context dictionary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>invoker_config</code>
            </td>
            <td>
                  <code><autoref identifier="typing.Dict" optional hover>Dict</autoref>[<autoref identifier="str" optional>str</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration from the ToolInvoker, including:
            - "plugin_manager": PluginManager instance
            - "validator_id": Optional[str]
            - "transformer_id": Optional[str]
            - "error_handler_id": Optional[str]
            - "error_formatter_id": Optional[str]
            - "cache_provider_id": Optional[str]
            - "cache_config": Optional[Dict[str, Any]]
            - "tracing_manager": Optional[InteractionTracingManager]
            - "correlation_id": Optional[str]</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><autoref identifier="typing.Any" backlink-type="returned-by" backlink-anchor="genie_tooling.InvocationStrategy.invoke" optional hover>Any</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The result of the tool execution (possibly transformed by an OutputTransformer)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><autoref identifier="typing.Any" backlink-type="returned-by" backlink-anchor="genie_tooling.InvocationStrategy.invoke" optional hover>Any</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>or a structured error (formatted by an ErrorFormatter). The exact type depends</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><autoref identifier="typing.Any" backlink-type="returned-by" backlink-anchor="genie_tooling.InvocationStrategy.invoke" optional hover>Any</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>on the formatter's output.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/invocation_strategies/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-18">18</a></span>
<span class="normal"><a href="#api-__codelineno-0-19">19</a></span>
<span class="normal"><a href="#api-__codelineno-0-20">20</a></span>
<span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span>
<span class="normal"><a href="#api-__codelineno-0-29">29</a></span>
<span class="normal"><a href="#api-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-__codelineno-0-31">31</a></span>
<span class="normal"><a href="#api-__codelineno-0-32">32</a></span>
<span class="normal"><a href="#api-__codelineno-0-33">33</a></span>
<span class="normal"><a href="#api-__codelineno-0-34">34</a></span>
<span class="normal"><a href="#api-__codelineno-0-35">35</a></span>
<span class="normal"><a href="#api-__codelineno-0-36">36</a></span>
<span class="normal"><a href="#api-__codelineno-0-37">37</a></span>
<span class="normal"><a href="#api-__codelineno-0-38">38</a></span>
<span class="normal"><a href="#api-__codelineno-0-39">39</a></span>
<span class="normal"><a href="#api-__codelineno-0-40">40</a></span>
<span class="normal"><a href="#api-__codelineno-0-41">41</a></span>
<span class="normal"><a href="#api-__codelineno-0-42">42</a></span>
<span class="normal"><a href="#api-__codelineno-0-43">43</a></span>
<span class="normal"><a href="#api-__codelineno-0-44">44</a></span>
<span class="normal"><a href="#api-__codelineno-0-45">45</a></span>
<span class="normal"><a href="#api-__codelineno-0-46">46</a></span>
<span class="normal"><a href="#api-__codelineno-0-47">47</a></span>
<span class="normal"><a href="#api-__codelineno-0-48">48</a></span>
<span class="normal"><a href="#api-__codelineno-0-49">49</a></span>
<span class="normal"><a href="#api-__codelineno-0-50">50</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">tool</span><span class="p">:</span> <span class="n">Tool</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="n">key_provider</span><span class="p">:</span> <span class="n">KeyProvider</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="n">invoker_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="c1"># Contains plugin_manager and override IDs for components</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Executes the full tool invocation lifecycle according to this strategy.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        tool: The Tool instance to invoke.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        params: The parameters for the tool.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        key_provider: The async key provider.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        context: Optional context dictionary.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        invoker_config: Configuration from the ToolInvoker, including:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">                        - &quot;plugin_manager&quot;: PluginManager instance</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">                        - &quot;validator_id&quot;: Optional[str]</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">                        - &quot;transformer_id&quot;: Optional[str]</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">                        - &quot;error_handler_id&quot;: Optional[str]</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">                        - &quot;error_formatter_id&quot;: Optional[str]</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">                        - &quot;cache_provider_id&quot;: Optional[str]</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">                        - &quot;cache_config&quot;: Optional[Dict[str, Any]]</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">                        - &quot;tracing_manager&quot;: Optional[InteractionTracingManager]</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">                        - &quot;correlation_id&quot;: Optional[str]</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        The result of the tool execution (possibly transformed by an OutputTransformer)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        or a structured error (formatted by an ErrorFormatter). The exact type depends</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        on the formatter&#39;s output.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.LLMProviderPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">LLMProviderPlugin</span>


<a href="#api-genie_tooling.LLMProviderPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.LLMProviderPlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.LLMProviderPlugin" optional hover>Protocol</autoref></code></p>


        <p>Protocol for a plugin that interacts with a Large Language Model provider.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.LLMProviderPlugin-functions">Functions<a href="#api-genie_tooling.LLMProviderPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.LLMProviderPlugin.setup" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">setup</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.LLMProviderPlugin.setup" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">setup</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initializes the LLM provider.
The 'config' dictionary is expected to contain 'key_provider: KeyProvider'
if the specific LLM provider implementation requires API keys.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/llm_providers/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-35">35</a></span>
<span class="normal"><a href="#api-__codelineno-0-36">36</a></span>
<span class="normal"><a href="#api-__codelineno-0-37">37</a></span>
<span class="normal"><a href="#api-__codelineno-0-38">38</a></span>
<span class="normal"><a href="#api-__codelineno-0-39">39</a></span>
<span class="normal"><a href="#api-__codelineno-0-40">40</a></span>
<span class="normal"><a href="#api-__codelineno-0-41">41</a></span>
<span class="normal"><a href="#api-__codelineno-0-42">42</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    Initializes the LLM provider.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    The &#39;config&#39; dictionary is expected to contain &#39;key_provider: KeyProvider&#39;</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    if the specific LLM provider implementation requires API keys.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="k">await</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LLMProviderPlugin &#39;</span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;plugin_id&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;UnknownPluginID&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;: Base setup logic (if any) completed.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.ChatMessage" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ChatMessage</span>


<a href="#api-genie_tooling.ChatMessage" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.TypedDict" backlink-type="subclassed-by" backlink-anchor="genie_tooling.ChatMessage" optional hover>TypedDict</autoref></code></p>


        <p>Represents a single message in a chat conversation.
Compatible with OpenAI's ChatCompletion message structure.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.LLMChatResponse" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">LLMChatResponse</span>


<a href="#api-genie_tooling.LLMChatResponse" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.TypedDict" backlink-type="subclassed-by" backlink-anchor="genie_tooling.LLMChatResponse" optional hover>TypedDict</autoref></code></p>


        <p>Standardized response for chat completion LLM calls.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.LLMCompletionResponse" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">LLMCompletionResponse</span>


<a href="#api-genie_tooling.LLMCompletionResponse" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.TypedDict" backlink-type="subclassed-by" backlink-anchor="genie_tooling.LLMCompletionResponse" optional hover>TypedDict</autoref></code></p>


        <p>Standardized response for text completion LLM calls.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.LLMUsageInfo" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">LLMUsageInfo</span>


<a href="#api-genie_tooling.LLMUsageInfo" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.TypedDict" backlink-type="subclassed-by" backlink-anchor="genie_tooling.LLMUsageInfo" optional hover>TypedDict</autoref></code></p>


        <p>Represents token usage information from an LLM response.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.ToolCall" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ToolCall</span>


<a href="#api-genie_tooling.ToolCall" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.TypedDict" backlink-type="subclassed-by" backlink-anchor="genie_tooling.ToolCall" optional hover>TypedDict</autoref></code></p>


        <p>Represents a tool call requested by the LLM.
Compatible with OpenAI's tool_calls structure.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.ToolCallFunction" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ToolCallFunction</span>


<a href="#api-genie_tooling.ToolCallFunction" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.TypedDict" backlink-type="subclassed-by" backlink-anchor="genie_tooling.ToolCallFunction" optional hover>TypedDict</autoref></code></p>


        <p>Represents the function to be called within a ToolCall.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.LogAdapterPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">LogAdapterPlugin</span>


<a href="#api-genie_tooling.LogAdapterPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.LogAdapterPlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.LogAdapterPlugin" optional hover>Protocol</autoref></code></p>


        <p>Protocol for a logging/monitoring adapter.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.LogAdapterPlugin-functions">Functions<a href="#api-genie_tooling.LogAdapterPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.LogAdapterPlugin.setup" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">setup</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.LogAdapterPlugin.setup" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">setup</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Configures logging handlers or integrates with external monitoring systems.
This method is called after the adapter is instantiated.
Args:
    config: Adapter-specific configuration dictionary. May include 'plugin_manager'
            if this adapter needs to load other plugins (e.g., a RedactorPlugin).</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/log_adapters/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-15">15</a></span>
<span class="normal"><a href="#api-__codelineno-0-16">16</a></span>
<span class="normal"><a href="#api-__codelineno-0-17">17</a></span>
<span class="normal"><a href="#api-__codelineno-0-18">18</a></span>
<span class="normal"><a href="#api-__codelineno-0-19">19</a></span>
<span class="normal"><a href="#api-__codelineno-0-20">20</a></span>
<span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    Configures logging handlers or integrates with external monitoring systems.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    This method is called after the adapter is instantiated.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        config: Adapter-specific configuration dictionary. May include &#39;plugin_manager&#39;</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">                if this adapter needs to load other plugins (e.g., a RedactorPlugin).</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.LogAdapterPlugin.process_event" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">process_event</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.LogAdapterPlugin.process_event" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">process_event</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">event_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a>    <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#api-__codelineno-0-4"></a>    <span class="n">schema_for_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#api-__codelineno-0-5"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Processes a structured event (e.g., for monitoring or detailed logging).
Data should be pre-sanitized by this method or by a configured RedactorPlugin.
Args:
    event_type: A string identifying the type of event (e.g., "tool_invoked", "tool_error").
    data: A dictionary containing event-specific data.
    schema_for_data: Optional JSON schema corresponding to 'data', to aid redaction.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/log_adapters/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span>
<span class="normal"><a href="#api-__codelineno-0-29">29</a></span>
<span class="normal"><a href="#api-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-__codelineno-0-31">31</a></span>
<span class="normal"><a href="#api-__codelineno-0-32">32</a></span>
<span class="normal"><a href="#api-__codelineno-0-33">33</a></span>
<span class="normal"><a href="#api-__codelineno-0-34">34</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">process_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">schema_for_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Processes a structured event (e.g., for monitoring or detailed logging).</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    Data should be pre-sanitized by this method or by a configured RedactorPlugin.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        event_type: A string identifying the type of event (e.g., &quot;tool_invoked&quot;, &quot;tool_error&quot;).</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        data: A dictionary containing event-specific data.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        schema_for_data: Optional JSON schema corresponding to &#39;data&#39;, to aid redaction.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.ToolLookupService" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ToolLookupService</span>


<a href="#api-genie_tooling.ToolLookupService" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">ToolLookupService</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">tool_manager</span><span class="p">:</span> <span class="n">ToolManager</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a>    <span class="n">plugin_manager</span><span class="p">:</span> <span class="n">PluginManager</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#api-__codelineno-0-4"></a>    <span class="n">default_provider_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">DEFAULT_LOOKUP_PROVIDER_ID</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#api-__codelineno-0-5"></a>    <span class="n">default_indexing_formatter_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">DEFAULT_INDEXING_FORMATTER_ID</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#api-__codelineno-0-6"></a>    <span class="n">tracing_manager</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">InteractionTracingManager</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#api-__codelineno-0-7"></a><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">








                  <details class="quote">
                    <summary>Source code in <code>src/genie_tooling/lookup/service.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span>
<span class="normal"><a href="#api-__codelineno-0-29">29</a></span>
<span class="normal"><a href="#api-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-__codelineno-0-31">31</a></span>
<span class="normal"><a href="#api-__codelineno-0-32">32</a></span>
<span class="normal"><a href="#api-__codelineno-0-33">33</a></span>
<span class="normal"><a href="#api-__codelineno-0-34">34</a></span>
<span class="normal"><a href="#api-__codelineno-0-35">35</a></span>
<span class="normal"><a href="#api-__codelineno-0-36">36</a></span>
<span class="normal"><a href="#api-__codelineno-0-37">37</a></span>
<span class="normal"><a href="#api-__codelineno-0-38">38</a></span>
<span class="normal"><a href="#api-__codelineno-0-39">39</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="n">tool_manager</span><span class="p">:</span> <span class="n">ToolManager</span><span class="p">,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="n">plugin_manager</span><span class="p">:</span> <span class="n">PluginManager</span><span class="p">,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="n">default_provider_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">DEFAULT_LOOKUP_PROVIDER_ID</span><span class="p">,</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">default_indexing_formatter_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">DEFAULT_INDEXING_FORMATTER_ID</span><span class="p">,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="n">tracing_manager</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">InteractionTracingManager</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="p">):</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_tool_manager</span> <span class="o">=</span> <span class="n">tool_manager</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_plugin_manager</span> <span class="o">=</span> <span class="n">plugin_manager</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_default_provider_id</span> <span class="o">=</span> <span class="n">default_provider_id</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_default_indexing_formatter_id</span> <span class="o">=</span> <span class="n">default_indexing_formatter_id</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_tracing_manager</span> <span class="o">=</span> <span class="n">tracing_manager</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_tracing_manager</span> <span class="o">=</span> <span class="n">tracing_manager</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_is_indexed_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ToolLookupService initialized. Default provider: &#39;</span><span class="si">{</span><span class="n">default_provider_id</span><span class="si">}</span><span class="s2">&#39;, default formatter plugin for indexing: &#39;</span><span class="si">{</span><span class="n">default_indexing_formatter_id</span><span class="si">}</span><span class="s2">&#39;. Tracing enabled: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_tracing_manager</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<h5 id="api-genie_tooling.ToolLookupService-functions">Functions<a href="#api-genie_tooling.ToolLookupService-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.ToolLookupService.add_or_update_tools" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_or_update_tools</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.ToolLookupService.add_or_update_tools" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">add_or_update_tools</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">tool_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a>    <span class="n">provider_id_override</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#api-__codelineno-0-4"></a>    <span class="n">indexing_formatter_id_override</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#api-__codelineno-0-5"></a>    <span class="n">provider_config_override</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#api-__codelineno-0-6"></a>    <span class="n">correlation_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#api-__codelineno-0-7"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Adds or updates a list of tools in the specified lookup provider's index.
This is an incremental update.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/lookup/service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-119">119</a></span>
<span class="normal"><a href="#api-__codelineno-0-120">120</a></span>
<span class="normal"><a href="#api-__codelineno-0-121">121</a></span>
<span class="normal"><a href="#api-__codelineno-0-122">122</a></span>
<span class="normal"><a href="#api-__codelineno-0-123">123</a></span>
<span class="normal"><a href="#api-__codelineno-0-124">124</a></span>
<span class="normal"><a href="#api-__codelineno-0-125">125</a></span>
<span class="normal"><a href="#api-__codelineno-0-126">126</a></span>
<span class="normal"><a href="#api-__codelineno-0-127">127</a></span>
<span class="normal"><a href="#api-__codelineno-0-128">128</a></span>
<span class="normal"><a href="#api-__codelineno-0-129">129</a></span>
<span class="normal"><a href="#api-__codelineno-0-130">130</a></span>
<span class="normal"><a href="#api-__codelineno-0-131">131</a></span>
<span class="normal"><a href="#api-__codelineno-0-132">132</a></span>
<span class="normal"><a href="#api-__codelineno-0-133">133</a></span>
<span class="normal"><a href="#api-__codelineno-0-134">134</a></span>
<span class="normal"><a href="#api-__codelineno-0-135">135</a></span>
<span class="normal"><a href="#api-__codelineno-0-136">136</a></span>
<span class="normal"><a href="#api-__codelineno-0-137">137</a></span>
<span class="normal"><a href="#api-__codelineno-0-138">138</a></span>
<span class="normal"><a href="#api-__codelineno-0-139">139</a></span>
<span class="normal"><a href="#api-__codelineno-0-140">140</a></span>
<span class="normal"><a href="#api-__codelineno-0-141">141</a></span>
<span class="normal"><a href="#api-__codelineno-0-142">142</a></span>
<span class="normal"><a href="#api-__codelineno-0-143">143</a></span>
<span class="normal"><a href="#api-__codelineno-0-144">144</a></span>
<span class="normal"><a href="#api-__codelineno-0-145">145</a></span>
<span class="normal"><a href="#api-__codelineno-0-146">146</a></span>
<span class="normal"><a href="#api-__codelineno-0-147">147</a></span>
<span class="normal"><a href="#api-__codelineno-0-148">148</a></span>
<span class="normal"><a href="#api-__codelineno-0-149">149</a></span>
<span class="normal"><a href="#api-__codelineno-0-150">150</a></span>
<span class="normal"><a href="#api-__codelineno-0-151">151</a></span>
<span class="normal"><a href="#api-__codelineno-0-152">152</a></span>
<span class="normal"><a href="#api-__codelineno-0-153">153</a></span>
<span class="normal"><a href="#api-__codelineno-0-154">154</a></span>
<span class="normal"><a href="#api-__codelineno-0-155">155</a></span>
<span class="normal"><a href="#api-__codelineno-0-156">156</a></span>
<span class="normal"><a href="#api-__codelineno-0-157">157</a></span>
<span class="normal"><a href="#api-__codelineno-0-158">158</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">add_or_update_tools</span><span class="p">(</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="n">tool_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="n">provider_id_override</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">indexing_formatter_id_override</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">provider_config_override</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="n">correlation_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">    Adds or updates a list of tools in the specified lookup provider&#39;s index.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">    This is an incremental update.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="n">corr_id</span> <span class="o">=</span> <span class="n">correlation_id</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace</span><span class="p">(</span><span class="s2">&quot;tool_lookup.add_or_update.start&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;tool_ids&quot;</span><span class="p">:</span> <span class="n">tool_ids</span><span class="p">},</span> <span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="n">corr_id</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="n">target_provider_id</span> <span class="o">=</span> <span class="n">provider_id_override</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_provider_id</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">target_provider_id</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace</span><span class="p">(</span><span class="s2">&quot;log.warning&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;No tool lookup provider specified for add/update. Skipping.&quot;</span><span class="p">},</span> <span class="s2">&quot;warning&quot;</span><span class="p">,</span> <span class="n">corr_id</span><span class="p">)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="k">return</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="n">formatter_id_to_use</span> <span class="o">=</span> <span class="n">indexing_formatter_id_override</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_indexing_formatter_id</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">formatter_id_to_use</span><span class="p">:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace</span><span class="p">(</span><span class="s2">&quot;log.error&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;No indexing formatter ID available for provider &#39;</span><span class="si">{</span><span class="n">target_provider_id</span><span class="si">}</span><span class="s2">&#39;. Cannot update index.&quot;</span><span class="p">},</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="n">corr_id</span><span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="k">return</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_provider_is_indexed</span><span class="p">(</span><span class="n">target_provider_id</span><span class="p">,</span> <span class="n">formatter_id_to_use</span><span class="p">,</span> <span class="n">provider_config_override</span><span class="p">,</span> <span class="n">correlation_id</span><span class="o">=</span><span class="n">corr_id</span><span class="p">)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">provider_instance</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plugin_manager</span><span class="o">.</span><span class="n">get_plugin_instance</span><span class="p">(</span><span class="n">target_provider_id</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">provider_config_override</span><span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">provider_instance</span><span class="p">,</span> <span class="n">ToolLookupProviderPlugin</span><span class="p">):</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace</span><span class="p">(</span><span class="s2">&quot;log.error&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Tool lookup provider &#39;</span><span class="si">{</span><span class="n">target_provider_id</span><span class="si">}</span><span class="s2">&#39; not found or invalid for update.&quot;</span><span class="p">},</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="n">corr_id</span><span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="k">return</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="k">for</span> <span class="n">tool_id</span> <span class="ow">in</span> <span class="n">tool_ids</span><span class="p">:</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="n">tool_data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_formatted_tool_data</span><span class="p">(</span><span class="n">tool_id</span><span class="p">,</span> <span class="n">formatter_id_to_use</span><span class="p">,</span> <span class="n">correlation_id</span><span class="o">=</span><span class="n">corr_id</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="k">if</span> <span class="n">tool_data</span><span class="p">:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>                <span class="k">await</span> <span class="n">provider_instance</span><span class="o">.</span><span class="n">update_tool</span><span class="p">(</span><span class="n">tool_id</span><span class="p">,</span> <span class="n">tool_data</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">provider_config_override</span><span class="p">)</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace</span><span class="p">(</span><span class="s2">&quot;tool_lookup.add_or_update.success&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;tool_id&quot;</span><span class="p">:</span> <span class="n">tool_id</span><span class="p">},</span> <span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="n">corr_id</span><span class="p">)</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e_update</span><span class="p">:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace</span><span class="p">(</span><span class="s2">&quot;log.error&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error updating tool &#39;</span><span class="si">{</span><span class="n">tool_id</span><span class="si">}</span><span class="s2">&#39; in provider &#39;</span><span class="si">{</span><span class="n">target_provider_id</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e_update</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;exc_info&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="n">corr_id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.ToolLookupService.remove_tools" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">remove_tools</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.ToolLookupService.remove_tools" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">remove_tools</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">tool_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a>    <span class="n">provider_id_override</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#api-__codelineno-0-4"></a>    <span class="n">provider_config_override</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#api-__codelineno-0-5"></a>    <span class="n">correlation_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#api-__codelineno-0-6"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Removes a list of tools from the specified lookup provider's index.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/lookup/service.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-160">160</a></span>
<span class="normal"><a href="#api-__codelineno-0-161">161</a></span>
<span class="normal"><a href="#api-__codelineno-0-162">162</a></span>
<span class="normal"><a href="#api-__codelineno-0-163">163</a></span>
<span class="normal"><a href="#api-__codelineno-0-164">164</a></span>
<span class="normal"><a href="#api-__codelineno-0-165">165</a></span>
<span class="normal"><a href="#api-__codelineno-0-166">166</a></span>
<span class="normal"><a href="#api-__codelineno-0-167">167</a></span>
<span class="normal"><a href="#api-__codelineno-0-168">168</a></span>
<span class="normal"><a href="#api-__codelineno-0-169">169</a></span>
<span class="normal"><a href="#api-__codelineno-0-170">170</a></span>
<span class="normal"><a href="#api-__codelineno-0-171">171</a></span>
<span class="normal"><a href="#api-__codelineno-0-172">172</a></span>
<span class="normal"><a href="#api-__codelineno-0-173">173</a></span>
<span class="normal"><a href="#api-__codelineno-0-174">174</a></span>
<span class="normal"><a href="#api-__codelineno-0-175">175</a></span>
<span class="normal"><a href="#api-__codelineno-0-176">176</a></span>
<span class="normal"><a href="#api-__codelineno-0-177">177</a></span>
<span class="normal"><a href="#api-__codelineno-0-178">178</a></span>
<span class="normal"><a href="#api-__codelineno-0-179">179</a></span>
<span class="normal"><a href="#api-__codelineno-0-180">180</a></span>
<span class="normal"><a href="#api-__codelineno-0-181">181</a></span>
<span class="normal"><a href="#api-__codelineno-0-182">182</a></span>
<span class="normal"><a href="#api-__codelineno-0-183">183</a></span>
<span class="normal"><a href="#api-__codelineno-0-184">184</a></span>
<span class="normal"><a href="#api-__codelineno-0-185">185</a></span>
<span class="normal"><a href="#api-__codelineno-0-186">186</a></span>
<span class="normal"><a href="#api-__codelineno-0-187">187</a></span>
<span class="normal"><a href="#api-__codelineno-0-188">188</a></span>
<span class="normal"><a href="#api-__codelineno-0-189">189</a></span>
<span class="normal"><a href="#api-__codelineno-0-190">190</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">remove_tools</span><span class="p">(</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="n">tool_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="n">provider_id_override</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="n">provider_config_override</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="n">correlation_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Removes a list of tools from the specified lookup provider&#39;s index.&quot;&quot;&quot;</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="n">corr_id</span> <span class="o">=</span> <span class="n">correlation_id</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace</span><span class="p">(</span><span class="s2">&quot;tool_lookup.remove.start&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;tool_ids&quot;</span><span class="p">:</span> <span class="n">tool_ids</span><span class="p">},</span> <span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="n">corr_id</span><span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="n">target_provider_id</span> <span class="o">=</span> <span class="n">provider_id_override</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_provider_id</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">target_provider_id</span><span class="p">:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace</span><span class="p">(</span><span class="s2">&quot;log.warning&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;No tool lookup provider specified for remove. Skipping.&quot;</span><span class="p">},</span> <span class="s2">&quot;warning&quot;</span><span class="p">,</span> <span class="n">corr_id</span><span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="k">return</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_indexed_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target_provider_id</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace</span><span class="p">(</span><span class="s2">&quot;log.debug&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Index for provider &#39;</span><span class="si">{</span><span class="n">target_provider_id</span><span class="si">}</span><span class="s2">&#39; not built. Skipping tool removal as it&#39;s not indexed anyway.&quot;</span><span class="p">},</span> <span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="n">corr_id</span><span class="p">)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="k">return</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="n">provider_instance</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plugin_manager</span><span class="o">.</span><span class="n">get_plugin_instance</span><span class="p">(</span><span class="n">target_provider_id</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">provider_config_override</span><span class="p">)</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">provider_instance</span><span class="p">,</span> <span class="n">ToolLookupProviderPlugin</span><span class="p">):</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace</span><span class="p">(</span><span class="s2">&quot;log.error&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Tool lookup provider &#39;</span><span class="si">{</span><span class="n">target_provider_id</span><span class="si">}</span><span class="s2">&#39; not found or invalid for removal.&quot;</span><span class="p">},</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="n">corr_id</span><span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="k">return</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="k">for</span> <span class="n">tool_id</span> <span class="ow">in</span> <span class="n">tool_ids</span><span class="p">:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="k">await</span> <span class="n">provider_instance</span><span class="o">.</span><span class="n">remove_tool</span><span class="p">(</span><span class="n">tool_id</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">provider_config_override</span><span class="p">)</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace</span><span class="p">(</span><span class="s2">&quot;tool_lookup.remove.success&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;tool_id&quot;</span><span class="p">:</span> <span class="n">tool_id</span><span class="p">},</span> <span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="n">corr_id</span><span class="p">)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e_remove</span><span class="p">:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace</span><span class="p">(</span><span class="s2">&quot;log.error&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error removing tool &#39;</span><span class="si">{</span><span class="n">tool_id</span><span class="si">}</span><span class="s2">&#39; from provider &#39;</span><span class="si">{</span><span class="n">target_provider_id</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e_remove</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;exc_info&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="n">corr_id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.RankedToolResult" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">RankedToolResult</span>


<a href="#api-genie_tooling.RankedToolResult" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">RankedToolResult</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">tool_identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a>    <span class="n">score</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#api-__codelineno-0-4"></a>    <span class="n">matched_tool_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#api-__codelineno-0-5"></a>    <span class="n">description_snippet</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#api-__codelineno-0-6"></a>    <span class="n">matched_keywords</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#api-__codelineno-0-7"></a>    <span class="n">similarity_score_details</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#api-__codelineno-0-8"></a><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>Represents a tool found by a lookup provider, with diagnostic info.</p>







                  <details class="quote">
                    <summary>Source code in <code>src/genie_tooling/lookup/types.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#api-__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#api-__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#api-__codelineno-0-10">10</a></span>
<span class="normal"><a href="#api-__codelineno-0-11">11</a></span>
<span class="normal"><a href="#api-__codelineno-0-12">12</a></span>
<span class="normal"><a href="#api-__codelineno-0-13">13</a></span>
<span class="normal"><a href="#api-__codelineno-0-14">14</a></span>
<span class="normal"><a href="#api-__codelineno-0-15">15</a></span>
<span class="normal"><a href="#api-__codelineno-0-16">16</a></span>
<span class="normal"><a href="#api-__codelineno-0-17">17</a></span>
<span class="normal"><a href="#api-__codelineno-0-18">18</a></span>
<span class="normal"><a href="#api-__codelineno-0-19">19</a></span>
<span class="normal"><a href="#api-__codelineno-0-20">20</a></span>
<span class="normal"><a href="#api-__codelineno-0-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    <span class="n">tool_identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="n">score</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="n">matched_tool_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">description_snippet</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="n">matched_keywords</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="n">similarity_score_details</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="p">):</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tool_identifier</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">tool_identifier</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">score</span> <span class="c1"># Relevance score (higher is better)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">matched_tool_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="n">matched_tool_data</span> <span class="ow">or</span> <span class="p">{}</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">description_snippet</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">description_snippet</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">matched_keywords</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">matched_keywords</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">similarity_score_details</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="n">similarity_score_details</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.InteractionTracerPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">InteractionTracerPlugin</span>


<a href="#api-genie_tooling.InteractionTracerPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.InteractionTracerPlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.InteractionTracerPlugin" optional hover>Protocol</autoref></code></p>


        <p>Protocol for a plugin that records interaction traces.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.InteractionTracerPlugin-functions">Functions<a href="#api-genie_tooling.InteractionTracerPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.InteractionTracerPlugin.record_trace" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">record_trace</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.InteractionTracerPlugin.record_trace" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">record_trace</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">TraceEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Records a single trace event.
Implementations should handle batching or asynchronous sending if needed.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/observability/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-16">16</a></span>
<span class="normal"><a href="#api-__codelineno-0-17">17</a></span>
<span class="normal"><a href="#api-__codelineno-0-18">18</a></span>
<span class="normal"><a href="#api-__codelineno-0-19">19</a></span>
<span class="normal"><a href="#api-__codelineno-0-20">20</a></span>
<span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">record_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">TraceEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    Records a single trace event.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    Implementations should handle batching or asynchronous sending if needed.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;InteractionTracerPlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; record_trace method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.TraceEvent" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">TraceEvent</span>


<a href="#api-genie_tooling.TraceEvent" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.TypedDict" backlink-type="subclassed-by" backlink-anchor="genie_tooling.TraceEvent" optional hover>TypedDict</autoref></code></p>


        <p>Represents a single event to be traced.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.OutputTransformer" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">OutputTransformer</span>


<a href="#api-genie_tooling.OutputTransformer" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.OutputTransformer" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.OutputTransformer" optional hover>Protocol</autoref></code></p>


        <p>Protocol for output transformers.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.OutputTransformer-functions">Functions<a href="#api-genie_tooling.OutputTransformer-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.OutputTransformer.transform" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">transform</span>


<a href="#api-genie_tooling.OutputTransformer.transform" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">transform</span><span class="p">(</span><span class="n">output</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Transforms raw tool output according to an output_schema or desired format.
Raises OutputTransformationException on failure.
This method is synchronous as transformation is typically CPU-bound.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/output_transformers/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="k">def</span><span class="w"> </span><span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    Transforms raw tool output according to an output_schema or desired format.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Raises OutputTransformationException on failure.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    This method is synchronous as transformation is typically CPU-bound.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.LLMOutputParserPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">LLMOutputParserPlugin</span>


<a href="#api-genie_tooling.LLMOutputParserPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.LLMOutputParserPlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.LLMOutputParserPlugin" optional hover>Protocol</autoref></code></p>


        <p>Protocol for a plugin that parses the text output of an LLM.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.LLMOutputParserPlugin-functions">Functions<a href="#api-genie_tooling.LLMOutputParserPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.LLMOutputParserPlugin.parse" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">parse</span>


<a href="#api-genie_tooling.LLMOutputParserPlugin.parse" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">parse</span><span class="p">(</span><span class="n">text_output</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParsedOutput</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Parses the LLM's text output.
Args:
    text_output: The raw text string from the LLM.
    schema: Optional schema (e.g., Pydantic model, JSON schema) to guide parsing.
Returns:
    The parsed data, which could be a dict, list, Pydantic model instance, etc.
Raises:
    ValueError or a custom parsing exception if parsing fails.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/prompts/llm_output_parsers/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-18">18</a></span>
<span class="normal"><a href="#api-__codelineno-0-19">19</a></span>
<span class="normal"><a href="#api-__codelineno-0-20">20</a></span>
<span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span>
<span class="normal"><a href="#api-__codelineno-0-29">29</a></span>
<span class="normal"><a href="#api-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-__codelineno-0-31">31</a></span>
<span class="normal"><a href="#api-__codelineno-0-32">32</a></span>
<span class="normal"><a href="#api-__codelineno-0-33">33</a></span>
<span class="normal"><a href="#api-__codelineno-0-34">34</a></span>
<span class="normal"><a href="#api-__codelineno-0-35">35</a></span>
<span class="normal"><a href="#api-__codelineno-0-36">36</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="k">def</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text_output</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParsedOutput</span><span class="p">:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    Parses the LLM&#39;s text output.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        text_output: The raw text string from the LLM.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        schema: Optional schema (e.g., Pydantic model, JSON schema) to guide parsing.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        The parsed data, which could be a dict, list, Pydantic model instance, etc.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        ValueError or a custom parsing exception if parsing fails.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LLMOutputParserPlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; parse method not implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="c1"># Basic fallback: return as is, or attempt JSON if it looks like it</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="k">if</span> <span class="n">text_output</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">text_output</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">):</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">text_output</span><span class="p">)</span> <span class="c1"># type: ignore</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>            <span class="k">pass</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="k">return</span> <span class="n">text_output</span> <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.RedactorPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">RedactorPlugin</span>


<a href="#api-genie_tooling.RedactorPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.RedactorPlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.RedactorPlugin" optional hover>Protocol</autoref></code></p>


        <p>Protocol for a data redaction plugin.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.RedactorPlugin-functions">Functions<a href="#api-genie_tooling.RedactorPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.RedactorPlugin.sanitize" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sanitize</span>


<a href="#api-genie_tooling.RedactorPlugin.sanitize" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">sanitize</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">schema_hints</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Sanitizes data to remove or mask sensitive information.
This method is synchronous as redaction is typically CPU-bound.
Args:
    data: The data to sanitize (can be any Python object, commonly dicts or lists).
    schema_hints: Optional JSON schema corresponding to 'data'. If provided,
                  the redactor can use schema annotations (e.g., 'x-sensitive', 'format')
                  to guide redaction.
Returns:
    The sanitized data, with sensitive parts replaced or removed.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/redactors/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-15">15</a></span>
<span class="normal"><a href="#api-__codelineno-0-16">16</a></span>
<span class="normal"><a href="#api-__codelineno-0-17">17</a></span>
<span class="normal"><a href="#api-__codelineno-0-18">18</a></span>
<span class="normal"><a href="#api-__codelineno-0-19">19</a></span>
<span class="normal"><a href="#api-__codelineno-0-20">20</a></span>
<span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="k">def</span><span class="w"> </span><span class="nf">sanitize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">schema_hints</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    Sanitizes data to remove or mask sensitive information.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    This method is synchronous as redaction is typically CPU-bound.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        data: The data to sanitize (can be any Python object, commonly dicts or lists).</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        schema_hints: Optional JSON schema corresponding to &#39;data&#39;. If provided,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">                      the redactor can use schema annotations (e.g., &#39;x-sensitive&#39;, &#39;format&#39;)</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">                      to guide redaction.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        The sanitized data, with sensitive parts replaced or removed.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Redactor &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; sanitize method not fully implemented. Returning data as is.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="k">return</span> <span class="n">data</span> <span class="c1"># Default: no redaction</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.RetrieverPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">RetrieverPlugin</span>


<a href="#api-genie_tooling.RetrieverPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.RetrieverPlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.RetrieverPlugin" optional hover>Protocol</autoref></code></p>


        <p>Retrieves relevant chunks based on a query, typically by composing an embedder and a vector store.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.RetrieverPlugin-functions">Functions<a href="#api-genie_tooling.RetrieverPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.RetrieverPlugin.retrieve" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">retrieve</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.RetrieverPlugin.retrieve" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">retrieve</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">RetrievedChunk</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Retrieves relevant chunks for the given query.
Args:
    query: The natural language query string.
    top_k: The number of top results to return.
    config: Retriever-specific configuration. This should include details for
              the embedder (e.g., "embedder_id", "embedder_config") and
              vector store (e.g., "vector_store_id", "vector_store_config")
              that this retriever instance will use. It should also contain "plugin_manager".
Returns:
    A list of RetrievedChunk objects.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/retrievers/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span>
<span class="normal"><a href="#api-__codelineno-0-29">29</a></span>
<span class="normal"><a href="#api-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-__codelineno-0-31">31</a></span>
<span class="normal"><a href="#api-__codelineno-0-32">32</a></span>
<span class="normal"><a href="#api-__codelineno-0-33">33</a></span>
<span class="normal"><a href="#api-__codelineno-0-34">34</a></span>
<span class="normal"><a href="#api-__codelineno-0-35">35</a></span>
<span class="normal"><a href="#api-__codelineno-0-36">36</a></span>
<span class="normal"><a href="#api-__codelineno-0-37">37</a></span>
<span class="normal"><a href="#api-__codelineno-0-38">38</a></span>
<span class="normal"><a href="#api-__codelineno-0-39">39</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">retrieve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">RetrievedChunk</span><span class="p">]:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Retrieves relevant chunks for the given query.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        query: The natural language query string.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        top_k: The number of top results to return.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        config: Retriever-specific configuration. This should include details for</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">                  the embedder (e.g., &quot;embedder_id&quot;, &quot;embedder_config&quot;) and</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">                  vector store (e.g., &quot;vector_store_id&quot;, &quot;vector_store_config&quot;)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">                  that this retriever instance will use. It should also contain &quot;plugin_manager&quot;.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        A list of RetrievedChunk objects.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RetrieverPlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; retrieve method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.KeyProvider" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">KeyProvider</span>


<a href="#api-genie_tooling.KeyProvider" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.KeyProvider" optional hover>Protocol</autoref></code></p>


        <p>Protocol for a component that securely provides API keys.
This protocol <strong>must be implemented by the consuming application</strong>.
The middleware itself does not store or manage API keys directly.
All methods must be async.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.KeyProvider-functions">Functions<a href="#api-genie_tooling.KeyProvider-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.KeyProvider.get_key" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_key</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.KeyProvider.get_key" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">get_key</span><span class="p">(</span><span class="n">key_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Asynchronously retrieves the API key value for the given key name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>key_name</code>
            </td>
            <td>
                  <code><autoref identifier="str" backlink-type="used-by" backlink-anchor="genie_tooling.KeyProvider.get_key" optional>str</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The logical name of the API key required by a tool
      (e.g., "OPENWEATHERMAP_API_KEY", "OPENAI_API_KEY").</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><autoref identifier="typing.Optional" optional hover>Optional</autoref>[<autoref identifier="str" optional>str</autoref>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The API key string if found and accessible, otherwise None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><autoref identifier="typing.Optional" optional hover>Optional</autoref>[<autoref identifier="str" optional>str</autoref>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Implementations should fetch keys securely (e.g., from environment</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><autoref identifier="typing.Optional" optional hover>Optional</autoref>[<autoref identifier="str" optional>str</autoref>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>variables, a secrets manager/vault, or application configuration).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><autoref identifier="typing.Optional" optional hover>Optional</autoref>[<autoref identifier="str" optional>str</autoref>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>It should log (at debug level) if a key is requested but not found,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><autoref identifier="typing.Optional" optional hover>Optional</autoref>[<autoref identifier="str" optional>str</autoref>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>but avoid logging the key value itself.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/security/key_provider.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-15">15</a></span>
<span class="normal"><a href="#api-__codelineno-0-16">16</a></span>
<span class="normal"><a href="#api-__codelineno-0-17">17</a></span>
<span class="normal"><a href="#api-__codelineno-0-18">18</a></span>
<span class="normal"><a href="#api-__codelineno-0-19">19</a></span>
<span class="normal"><a href="#api-__codelineno-0-20">20</a></span>
<span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span>
<span class="normal"><a href="#api-__codelineno-0-29">29</a></span>
<span class="normal"><a href="#api-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-__codelineno-0-31">31</a></span>
<span class="normal"><a href="#api-__codelineno-0-32">32</a></span>
<span class="normal"><a href="#api-__codelineno-0-33">33</a></span>
<span class="normal"><a href="#api-__codelineno-0-34">34</a></span>
<span class="normal"><a href="#api-__codelineno-0-35">35</a></span>
<span class="normal"><a href="#api-__codelineno-0-36">36</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    Asynchronously retrieves the API key value for the given key name.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        key_name: The logical name of the API key required by a tool</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">                  (e.g., &quot;OPENWEATHERMAP_API_KEY&quot;, &quot;OPENAI_API_KEY&quot;).</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        The API key string if found and accessible, otherwise None.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        Implementations should fetch keys securely (e.g., from environment</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        variables, a secrets manager/vault, or application configuration).</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        It should log (at debug level) if a key is requested but not found,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        but avoid logging the key value itself.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="c1"># Example of what an implementation might log (this is a protocol, so no actual logic here)</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="c1"># logger.debug(f&quot;KeyProvider: Request received for key &#39;{key_name}&#39;.&quot;)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="c1"># value = self._internal_secure_key_storage.get(key_name)</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="c1"># if not value:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="c1">#     logger.warning(f&quot;KeyProvider: Key &#39;{key_name}&#39; not found in secure storage.&quot;)</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="c1"># return value</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="o">...</span> <span class="c1"># Indicates abstract method in Protocol</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.DistributedTaskQueuePlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">DistributedTaskQueuePlugin</span>


<a href="#api-genie_tooling.DistributedTaskQueuePlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.DistributedTaskQueuePlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.DistributedTaskQueuePlugin" optional hover>Protocol</autoref></code></p>


        <p>Protocol for a plugin that interacts with a distributed task queue system.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.DistributedTaskQueuePlugin-functions">Functions<a href="#api-genie_tooling.DistributedTaskQueuePlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.DistributedTaskQueuePlugin.submit_task" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">submit_task</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.DistributedTaskQueuePlugin.submit_task" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">submit_task</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">task_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a>    <span class="n">args</span><span class="p">:</span> <span class="n">Tuple</span> <span class="o">=</span> <span class="p">(),</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#api-__codelineno-0-4"></a>    <span class="n">kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#api-__codelineno-0-5"></a>    <span class="n">queue_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#api-__codelineno-0-6"></a>    <span class="n">task_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#api-__codelineno-0-7"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Submits a task to the distributed queue.
Returns:
    str: The unique ID of the submitted task.
Raises:
    Exception: If submission fails.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/task_queues/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-16">16</a></span>
<span class="normal"><a href="#api-__codelineno-0-17">17</a></span>
<span class="normal"><a href="#api-__codelineno-0-18">18</a></span>
<span class="normal"><a href="#api-__codelineno-0-19">19</a></span>
<span class="normal"><a href="#api-__codelineno-0-20">20</a></span>
<span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span>
<span class="normal"><a href="#api-__codelineno-0-29">29</a></span>
<span class="normal"><a href="#api-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-__codelineno-0-31">31</a></span>
<span class="normal"><a href="#api-__codelineno-0-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">submit_task</span><span class="p">(</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">task_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="c1"># Name of the task registered with the queue system</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">args</span><span class="p">:</span> <span class="n">Tuple</span> <span class="o">=</span> <span class="p">(),</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">queue_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="c1"># Specific queue to send to</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="n">task_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># Options like countdown, eta, priority</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    Submits a task to the distributed queue.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        str: The unique ID of the submitted task.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        Exception: If submission fails.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DistributedTaskQueuePlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; submit_task not implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.DistributedTaskQueuePlugin.get_task_status" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_task_status</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.DistributedTaskQueuePlugin.get_task_status" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">get_task_status</span><span class="p">(</span><span class="n">task_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">queue_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaskStatus</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Gets the status of a previously submitted task.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/task_queues/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-34">34</a></span>
<span class="normal"><a href="#api-__codelineno-0-35">35</a></span>
<span class="normal"><a href="#api-__codelineno-0-36">36</a></span>
<span class="normal"><a href="#api-__codelineno-0-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_task_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">queue_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TaskStatus</span><span class="p">:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the status of a previously submitted task.&quot;&quot;&quot;</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DistributedTaskQueuePlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; get_task_status not implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="k">return</span> <span class="s2">&quot;unknown&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.DistributedTaskQueuePlugin.get_task_result" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_task_result</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.DistributedTaskQueuePlugin.get_task_result" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">get_task_result</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">task_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a>    <span class="n">queue_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#api-__codelineno-0-4"></a>    <span class="n">timeout_seconds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#api-__codelineno-0-5"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Retrieves the result of a completed task.
May block until the task is complete or timeout occurs.
Raises:
    TimeoutError: If timeout is specified and exceeded.
    Exception: If task failed or other error.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/task_queues/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-39">39</a></span>
<span class="normal"><a href="#api-__codelineno-0-40">40</a></span>
<span class="normal"><a href="#api-__codelineno-0-41">41</a></span>
<span class="normal"><a href="#api-__codelineno-0-42">42</a></span>
<span class="normal"><a href="#api-__codelineno-0-43">43</a></span>
<span class="normal"><a href="#api-__codelineno-0-44">44</a></span>
<span class="normal"><a href="#api-__codelineno-0-45">45</a></span>
<span class="normal"><a href="#api-__codelineno-0-46">46</a></span>
<span class="normal"><a href="#api-__codelineno-0-47">47</a></span>
<span class="normal"><a href="#api-__codelineno-0-48">48</a></span>
<span class="normal"><a href="#api-__codelineno-0-49">49</a></span>
<span class="normal"><a href="#api-__codelineno-0-50">50</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_task_result</span><span class="p">(</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">queue_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    Retrieves the result of a completed task.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    May block until the task is complete or timeout occurs.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        TimeoutError: If timeout is specified and exceeded.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        Exception: If task failed or other error.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DistributedTaskQueuePlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; get_task_result not implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.DistributedTaskQueuePlugin.revoke_task" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">revoke_task</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.DistributedTaskQueuePlugin.revoke_task" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">revoke_task</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">task_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">queue_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">terminate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Revokes (cancels) a pending or running task.
Args:
    terminate: If True, attempt to terminate a running task.
Returns:
    True if revocation was successful or task was already completed/revoked.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/task_queues/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-52">52</a></span>
<span class="normal"><a href="#api-__codelineno-0-53">53</a></span>
<span class="normal"><a href="#api-__codelineno-0-54">54</a></span>
<span class="normal"><a href="#api-__codelineno-0-55">55</a></span>
<span class="normal"><a href="#api-__codelineno-0-56">56</a></span>
<span class="normal"><a href="#api-__codelineno-0-57">57</a></span>
<span class="normal"><a href="#api-__codelineno-0-58">58</a></span>
<span class="normal"><a href="#api-__codelineno-0-59">59</a></span>
<span class="normal"><a href="#api-__codelineno-0-60">60</a></span>
<span class="normal"><a href="#api-__codelineno-0-61">61</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">revoke_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">queue_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">terminate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    Revokes (cancels) a pending or running task.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">        terminate: If True, attempt to terminate a running task.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        True if revocation was successful or task was already completed/revoked.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DistributedTaskQueuePlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; revoke_task not implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.TextSplitterPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">TextSplitterPlugin</span>


<a href="#api-genie_tooling.TextSplitterPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.TextSplitterPlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.TextSplitterPlugin" optional hover>Protocol</autoref></code></p>


        <p>Splits an async stream of Documents into an async stream of Chunks.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.TextSplitterPlugin-functions">Functions<a href="#api-genie_tooling.TextSplitterPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.TextSplitterPlugin.split" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">split</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.TextSplitterPlugin.split" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">split</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">documents</span><span class="p">:</span> <span class="n">AsyncIterable</span><span class="p">[</span><span class="n">Document</span><span class="p">],</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterable</span><span class="p">[</span><span class="n">Chunk</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Splits documents into smaller chunks.
Args:
    documents: An async iterable of Document objects.
    config: Splitter-specific configuration (e.g., chunk_size, chunk_overlap).
Yields:
    Chunk objects.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/text_splitters/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span>
<span class="normal"><a href="#api-__codelineno-0-29">29</a></span>
<span class="normal"><a href="#api-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-__codelineno-0-31">31</a></span>
<span class="normal"><a href="#api-__codelineno-0-32">32</a></span>
<span class="normal"><a href="#api-__codelineno-0-33">33</a></span>
<span class="normal"><a href="#api-__codelineno-0-34">34</a></span>
<span class="normal"><a href="#api-__codelineno-0-35">35</a></span>
<span class="normal"><a href="#api-__codelineno-0-36">36</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">documents</span><span class="p">:</span> <span class="n">AsyncIterable</span><span class="p">[</span><span class="n">Document</span><span class="p">],</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterable</span><span class="p">[</span><span class="n">Chunk</span><span class="p">]:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    Splits documents into smaller chunks.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        documents: An async iterable of Document objects.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        config: Splitter-specific configuration (e.g., chunk_size, chunk_overlap).</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    Yields:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        Chunk objects.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TextSplitterPlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; split method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="k">if</span> <span class="kc">False</span><span class="p">:</span> <span class="c1"># pylint: disable=false-condition</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="k">yield</span> <span class="c1"># type: ignore</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.TokenUsageRecorderPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">TokenUsageRecorderPlugin</span>


<a href="#api-genie_tooling.TokenUsageRecorderPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.TokenUsageRecorderPlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.TokenUsageRecorderPlugin" optional hover>Protocol</autoref></code></p>


        <p>Protocol for a plugin that records LLM token usage.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.TokenUsageRecorderPlugin-functions">Functions<a href="#api-genie_tooling.TokenUsageRecorderPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.TokenUsageRecorderPlugin.record_usage" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">record_usage</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.TokenUsageRecorderPlugin.record_usage" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">record_usage</span><span class="p">(</span><span class="n">record</span><span class="p">:</span> <span class="n">TokenUsageRecord</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Records a single token usage event.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/token_usage/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-16">16</a></span>
<span class="normal"><a href="#api-__codelineno-0-17">17</a></span>
<span class="normal"><a href="#api-__codelineno-0-18">18</a></span>
<span class="normal"><a href="#api-__codelineno-0-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">record_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">:</span> <span class="n">TokenUsageRecord</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Records a single token usage event.&quot;&quot;&quot;</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TokenUsageRecorderPlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; record_usage method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.TokenUsageRecorderPlugin.get_summary" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_summary</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.TokenUsageRecorderPlugin.get_summary" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">get_summary</span><span class="p">(</span><span class="n">filter_criteria</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Retrieves a summary of token usage.
The structure of the summary is implementation-dependent.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/token_usage/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_criteria</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    Retrieves a summary of token usage.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    The structure of the summary is implementation-dependent.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TokenUsageRecorderPlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; get_summary method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Not implemented&quot;</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.TokenUsageRecorderPlugin.clear_records" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clear_records</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.TokenUsageRecorderPlugin.clear_records" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">clear_records</span><span class="p">(</span><span class="n">filter_criteria</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Clears recorded usage data, optionally based on criteria.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/token_usage/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-29">29</a></span>
<span class="normal"><a href="#api-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-__codelineno-0-31">31</a></span>
<span class="normal"><a href="#api-__codelineno-0-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">clear_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_criteria</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Clears recorded usage data, optionally based on criteria.&quot;&quot;&quot;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TokenUsageRecorderPlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; clear_records method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.TokenUsageRecord" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">TokenUsageRecord</span>


<a href="#api-genie_tooling.TokenUsageRecord" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.TypedDict" backlink-type="subclassed-by" backlink-anchor="genie_tooling.TokenUsageRecord" optional hover>TypedDict</autoref></code></p>


        <p>Represents a single LLM token usage event.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.ToolLookupProviderPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ToolLookupProviderPlugin</span>


<a href="#api-genie_tooling.ToolLookupProviderPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.ToolLookupProviderPlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.ToolLookupProviderPlugin" optional hover>Protocol</autoref></code></p>


        <p>Protocol for a plugin that finds relevant tools based on a query.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.ToolLookupProviderPlugin-functions">Functions<a href="#api-genie_tooling.ToolLookupProviderPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.ToolLookupProviderPlugin.index_tools" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">index_tools</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.ToolLookupProviderPlugin.index_tools" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">index_tools</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">tools_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Builds or completely replaces an internal index using formatted tool data.
This is for full, batch re-indexing. For dynamic updates, use add/update/remove_tool.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/tool_lookup_providers/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-19">19</a></span>
<span class="normal"><a href="#api-__codelineno-0-20">20</a></span>
<span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">index_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tools_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    Builds or completely replaces an internal index using formatted tool data.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    This is for full, batch re-indexing. For dynamic updates, use add/update/remove_tool.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ToolLookupProvider &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; index_tools method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.ToolLookupProviderPlugin.add_tool" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_tool</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.ToolLookupProviderPlugin.add_tool" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">add_tool</span><span class="p">(</span><span class="n">tool_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Adds a single tool to the index.
Returns:
    True if the tool was added successfully, False otherwise.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/tool_lookup_providers/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span>
<span class="normal"><a href="#api-__codelineno-0-29">29</a></span>
<span class="normal"><a href="#api-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-__codelineno-0-31">31</a></span>
<span class="normal"><a href="#api-__codelineno-0-32">32</a></span>
<span class="normal"><a href="#api-__codelineno-0-33">33</a></span>
<span class="normal"><a href="#api-__codelineno-0-34">34</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">add_tool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Adds a single tool to the index.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        True if the tool was added successfully, False otherwise.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ToolLookupProvider &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; add_tool method not implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.ToolLookupProviderPlugin.update_tool" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">update_tool</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.ToolLookupProviderPlugin.update_tool" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">update_tool</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">tool_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tool_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Updates an existing tool in the index. This may be an add/overwrite operation.
Returns:
    True if the tool was updated successfully, False otherwise.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/tool_lookup_providers/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-36">36</a></span>
<span class="normal"><a href="#api-__codelineno-0-37">37</a></span>
<span class="normal"><a href="#api-__codelineno-0-38">38</a></span>
<span class="normal"><a href="#api-__codelineno-0-39">39</a></span>
<span class="normal"><a href="#api-__codelineno-0-40">40</a></span>
<span class="normal"><a href="#api-__codelineno-0-41">41</a></span>
<span class="normal"><a href="#api-__codelineno-0-42">42</a></span>
<span class="normal"><a href="#api-__codelineno-0-43">43</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">update_tool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tool_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    Updates an existing tool in the index. This may be an add/overwrite operation.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        True if the tool was updated successfully, False otherwise.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ToolLookupProvider &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; update_tool method not implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.ToolLookupProviderPlugin.remove_tool" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">remove_tool</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.ToolLookupProviderPlugin.remove_tool" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">remove_tool</span><span class="p">(</span><span class="n">tool_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Removes a single tool from the index by its ID.
Returns:
    True if the tool was removed or did not exist, False on failure.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/tool_lookup_providers/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-45">45</a></span>
<span class="normal"><a href="#api-__codelineno-0-46">46</a></span>
<span class="normal"><a href="#api-__codelineno-0-47">47</a></span>
<span class="normal"><a href="#api-__codelineno-0-48">48</a></span>
<span class="normal"><a href="#api-__codelineno-0-49">49</a></span>
<span class="normal"><a href="#api-__codelineno-0-50">50</a></span>
<span class="normal"><a href="#api-__codelineno-0-51">51</a></span>
<span class="normal"><a href="#api-__codelineno-0-52">52</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">remove_tool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    Removes a single tool from the index by its ID.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        True if the tool was removed or did not exist, False on failure.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ToolLookupProvider &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; remove_tool method not implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.ToolLookupProviderPlugin.find_tools" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">find_tools</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.ToolLookupProviderPlugin.find_tools" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">find_tools</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">natural_language_query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">RankedToolResult</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Searches the indexed tools based on the natural_language_query.
Returns:
    A list of RankedToolResult objects, sorted by relevance (highest score first).</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/tool_lookup_providers/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-54">54</a></span>
<span class="normal"><a href="#api-__codelineno-0-55">55</a></span>
<span class="normal"><a href="#api-__codelineno-0-56">56</a></span>
<span class="normal"><a href="#api-__codelineno-0-57">57</a></span>
<span class="normal"><a href="#api-__codelineno-0-58">58</a></span>
<span class="normal"><a href="#api-__codelineno-0-59">59</a></span>
<span class="normal"><a href="#api-__codelineno-0-60">60</a></span>
<span class="normal"><a href="#api-__codelineno-0-61">61</a></span>
<span class="normal"><a href="#api-__codelineno-0-62">62</a></span>
<span class="normal"><a href="#api-__codelineno-0-63">63</a></span>
<span class="normal"><a href="#api-__codelineno-0-64">64</a></span>
<span class="normal"><a href="#api-__codelineno-0-65">65</a></span>
<span class="normal"><a href="#api-__codelineno-0-66">66</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">find_tools</span><span class="p">(</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="n">natural_language_query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">RankedToolResult</span><span class="p">]:</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    Searches the indexed tools based on the natural_language_query.</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">        A list of RankedToolResult objects, sorted by relevance (highest score first).</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ToolLookupProvider &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; find_tools method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.ToolPlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ToolPlugin</span>


<a href="#api-genie_tooling.ToolPlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.ToolPlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.ToolPlugin" optional hover>Protocol</autoref></code></p>


        <p>Protocol for a tool that can be executed by the middleware.
All tools must be designed to be async.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.ToolPlugin-functions">Functions<a href="#api-genie_tooling.ToolPlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.ToolPlugin.get_metadata" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_metadata</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.ToolPlugin.get_metadata" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">get_metadata</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns comprehensive metadata about the tool.
This metadata is crucial for tool discovery, LLM function calling, and UI display.</p>
<p>Expected structure:
{
    "identifier": str, (matches self.identifier)
    "name": str, (human-friendly name)
    "description_human": str, (detailed for developers/UI)
    "description_llm": str, (concise, token-efficient for LLM prompts/function descriptions)
    "input_schema": Dict[str, Any], (JSON Schema for tool parameters)
    "output_schema": Dict[str, Any], (JSON Schema for tool's expected output structure)
    "key_requirements": List[Dict[str, str]], (e.g., [{"name": "API_KEY_NAME", "description": "Purpose of key"}])
    "tags": List[str], (for categorization, e.g., ["weather", "api", "location"])
    "version": str, (e.g., "1.0.0")
    "cacheable": bool, (optional, hints if tool output can be cached, default False)
    "cache_ttl_seconds": Optional[int] (optional, default TTL if cacheable)
}</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/tools/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-18">18</a></span>
<span class="normal"><a href="#api-__codelineno-0-19">19</a></span>
<span class="normal"><a href="#api-__codelineno-0-20">20</a></span>
<span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-__codelineno-0-27">27</a></span>
<span class="normal"><a href="#api-__codelineno-0-28">28</a></span>
<span class="normal"><a href="#api-__codelineno-0-29">29</a></span>
<span class="normal"><a href="#api-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-__codelineno-0-31">31</a></span>
<span class="normal"><a href="#api-__codelineno-0-32">32</a></span>
<span class="normal"><a href="#api-__codelineno-0-33">33</a></span>
<span class="normal"><a href="#api-__codelineno-0-34">34</a></span>
<span class="normal"><a href="#api-__codelineno-0-35">35</a></span>
<span class="normal"><a href="#api-__codelineno-0-36">36</a></span>
<span class="normal"><a href="#api-__codelineno-0-37">37</a></span>
<span class="normal"><a href="#api-__codelineno-0-38">38</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    Returns comprehensive metadata about the tool.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    This metadata is crucial for tool discovery, LLM function calling, and UI display.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    Expected structure:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    {</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        &quot;identifier&quot;: str, (matches self.identifier)</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        &quot;name&quot;: str, (human-friendly name)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        &quot;description_human&quot;: str, (detailed for developers/UI)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        &quot;description_llm&quot;: str, (concise, token-efficient for LLM prompts/function descriptions)</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        &quot;input_schema&quot;: Dict[str, Any], (JSON Schema for tool parameters)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        &quot;output_schema&quot;: Dict[str, Any], (JSON Schema for tool&#39;s expected output structure)</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        &quot;key_requirements&quot;: List[Dict[str, str]], (e.g., [{&quot;name&quot;: &quot;API_KEY_NAME&quot;, &quot;description&quot;: &quot;Purpose of key&quot;}])</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        &quot;tags&quot;: List[str], (for categorization, e.g., [&quot;weather&quot;, &quot;api&quot;, &quot;location&quot;])</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        &quot;version&quot;: str, (e.g., &quot;1.0.0&quot;)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        &quot;cacheable&quot;: bool, (optional, hints if tool output can be cached, default False)</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        &quot;cache_ttl_seconds&quot;: Optional[int] (optional, default TTL if cacheable)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    }</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.ToolPlugin.execute" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">execute</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.ToolPlugin.execute" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">execute</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">key_provider</span><span class="p">:</span> <span class="n">KeyProvider</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Executes the tool with the given parameters.
Must be an async method.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><autoref identifier="typing.Dict" optional hover>Dict</autoref>[<autoref identifier="str" optional>str</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Validated parameters for the tool, conforming to its input_schema.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>key_provider</code>
            </td>
            <td>
                  <code><autoref identifier="genie_tooling.security.key_provider.KeyProvider" backlink-type="used-by" backlink-anchor="genie_tooling.ToolPlugin.execute" optional hover>KeyProvider</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An async key provider instance for fetching necessary API keys.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><autoref identifier="typing.Dict" optional hover>Dict</autoref>[<autoref identifier="str" optional>str</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Context dictionary carrying session/request-specific data, including
     observability trace context.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><autoref identifier="typing.Any" backlink-type="returned-by" backlink-anchor="genie_tooling.ToolPlugin.execute" optional hover>Any</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The result of the tool execution. The structure should align with output_schema.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><autoref identifier="typing.Any" backlink-type="returned-by" backlink-anchor="genie_tooling.ToolPlugin.execute" optional hover>Any</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If an error occurs during execution that the tool handles, it should still</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><autoref identifier="typing.Any" backlink-type="returned-by" backlink-anchor="genie_tooling.ToolPlugin.execute" optional hover>Any</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>return a structured response, possibly including an 'error' field, conforming</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><autoref identifier="typing.Any" backlink-type="returned-by" backlink-anchor="genie_tooling.ToolPlugin.execute" optional hover>Any</autoref></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>to its output_schema. Unhandled exceptions will be caught by the InvocationStrategy.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/tools/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-40">40</a></span>
<span class="normal"><a href="#api-__codelineno-0-41">41</a></span>
<span class="normal"><a href="#api-__codelineno-0-42">42</a></span>
<span class="normal"><a href="#api-__codelineno-0-43">43</a></span>
<span class="normal"><a href="#api-__codelineno-0-44">44</a></span>
<span class="normal"><a href="#api-__codelineno-0-45">45</a></span>
<span class="normal"><a href="#api-__codelineno-0-46">46</a></span>
<span class="normal"><a href="#api-__codelineno-0-47">47</a></span>
<span class="normal"><a href="#api-__codelineno-0-48">48</a></span>
<span class="normal"><a href="#api-__codelineno-0-49">49</a></span>
<span class="normal"><a href="#api-__codelineno-0-50">50</a></span>
<span class="normal"><a href="#api-__codelineno-0-51">51</a></span>
<span class="normal"><a href="#api-__codelineno-0-52">52</a></span>
<span class="normal"><a href="#api-__codelineno-0-53">53</a></span>
<span class="normal"><a href="#api-__codelineno-0-54">54</a></span>
<span class="normal"><a href="#api-__codelineno-0-55">55</a></span>
<span class="normal"><a href="#api-__codelineno-0-56">56</a></span>
<span class="normal"><a href="#api-__codelineno-0-57">57</a></span>
<span class="normal"><a href="#api-__codelineno-0-58">58</a></span>
<span class="normal"><a href="#api-__codelineno-0-59">59</a></span>
<span class="normal"><a href="#api-__codelineno-0-60">60</a></span>
<span class="normal"><a href="#api-__codelineno-0-61">61</a></span>
<span class="normal"><a href="#api-__codelineno-0-62">62</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">key_provider</span><span class="p">:</span> <span class="n">KeyProvider</span><span class="p">,</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">context</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    Executes the tool with the given parameters.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    Must be an async method.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        params: Validated parameters for the tool, conforming to its input_schema.</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        key_provider: An async key provider instance for fetching necessary API keys.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        context: Context dictionary carrying session/request-specific data, including</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">                 observability trace context.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        The result of the tool execution. The structure should align with output_schema.</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        If an error occurs during execution that the tool handles, it should still</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        return a structured response, possibly including an &#39;error&#39; field, conforming</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        to its output_schema. Unhandled exceptions will be caught by the InvocationStrategy.</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.ToolManager" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ToolManager</span>


<a href="#api-genie_tooling.ToolManager" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">ToolManager</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">plugin_manager</span><span class="p">:</span> <span class="n">PluginManager</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a>    <span class="n">tracing_manager</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">InteractionTracingManager</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#api-__codelineno-0-4"></a><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">








                  <details class="quote">
                    <summary>Source code in <code>src/genie_tooling/tools/manager.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-20">20</a></span>
<span class="normal"><a href="#api-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-__codelineno-0-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plugin_manager</span><span class="p">:</span> <span class="n">PluginManager</span><span class="p">,</span> <span class="n">tracing_manager</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">InteractionTracingManager</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_plugin_manager</span> <span class="o">=</span> <span class="n">plugin_manager</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_tracing_manager</span> <span class="o">=</span> <span class="n">tracing_manager</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_tools</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tool</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_tool_initial_configs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># Stores the initial tool_configurations</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;ToolManager initialized.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<h5 id="api-genie_tooling.ToolManager-functions">Functions<a href="#api-genie_tooling.ToolManager-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.ToolManager.register_decorated_tools" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">register_decorated_tools</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.ToolManager.register_decorated_tools" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">register_decorated_tools</span><span class="p">(</span><span class="n">functions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Callable</span><span class="p">],</span> <span class="n">auto_enable</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Processes a list of @tool decorated functions, enabling them based on the auto_enable flag
and whether they are listed in the initial tool_configurations.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/tools/manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#api-__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#api-__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#api-__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#api-__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#api-__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#api-__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#api-__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#api-__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#api-__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#api-__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#api-__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#api-__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#api-__codelineno-0-100">100</a></span>
<span class="normal"><a href="#api-__codelineno-0-101">101</a></span>
<span class="normal"><a href="#api-__codelineno-0-102">102</a></span>
<span class="normal"><a href="#api-__codelineno-0-103">103</a></span>
<span class="normal"><a href="#api-__codelineno-0-104">104</a></span>
<span class="normal"><a href="#api-__codelineno-0-105">105</a></span>
<span class="normal"><a href="#api-__codelineno-0-106">106</a></span>
<span class="normal"><a href="#api-__codelineno-0-107">107</a></span>
<span class="normal"><a href="#api-__codelineno-0-108">108</a></span>
<span class="normal"><a href="#api-__codelineno-0-109">109</a></span>
<span class="normal"><a href="#api-__codelineno-0-110">110</a></span>
<span class="normal"><a href="#api-__codelineno-0-111">111</a></span>
<span class="normal"><a href="#api-__codelineno-0-112">112</a></span>
<span class="normal"><a href="#api-__codelineno-0-113">113</a></span>
<span class="normal"><a href="#api-__codelineno-0-114">114</a></span>
<span class="normal"><a href="#api-__codelineno-0-115">115</a></span>
<span class="normal"><a href="#api-__codelineno-0-116">116</a></span>
<span class="normal"><a href="#api-__codelineno-0-117">117</a></span>
<span class="normal"><a href="#api-__codelineno-0-118">118</a></span>
<span class="normal"><a href="#api-__codelineno-0-119">119</a></span>
<span class="normal"><a href="#api-__codelineno-0-120">120</a></span>
<span class="normal"><a href="#api-__codelineno-0-121">121</a></span>
<span class="normal"><a href="#api-__codelineno-0-122">122</a></span>
<span class="normal"><a href="#api-__codelineno-0-123">123</a></span>
<span class="normal"><a href="#api-__codelineno-0-124">124</a></span>
<span class="normal"><a href="#api-__codelineno-0-125">125</a></span>
<span class="normal"><a href="#api-__codelineno-0-126">126</a></span>
<span class="normal"><a href="#api-__codelineno-0-127">127</a></span>
<span class="normal"><a href="#api-__codelineno-0-128">128</a></span>
<span class="normal"><a href="#api-__codelineno-0-129">129</a></span>
<span class="normal"><a href="#api-__codelineno-0-130">130</a></span>
<span class="normal"><a href="#api-__codelineno-0-131">131</a></span>
<span class="normal"><a href="#api-__codelineno-0-132">132</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">register_decorated_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">functions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Callable</span><span class="p">],</span> <span class="n">auto_enable</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    Processes a list of @tool decorated functions, enabling them based on the auto_enable flag</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    and whether they are listed in the initial tool_configurations.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">genie_tooling.genie</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="n">FunctionToolWrapper</span><span class="p">,</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">registered_count</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="k">for</span> <span class="n">func_item</span> <span class="ow">in</span> <span class="n">functions</span><span class="p">:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="n">metadata</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">func_item</span><span class="p">,</span> <span class="s2">&quot;_tool_metadata_&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="n">original_func_to_call</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">func_item</span><span class="p">,</span> <span class="s2">&quot;_original_function_&quot;</span><span class="p">,</span> <span class="n">func_item</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">metadata</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">original_func_to_call</span><span class="p">)):</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace</span><span class="p">(</span><span class="s2">&quot;log.warning&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Function &#39;</span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">func_item</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;__name__&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">func_item</span><span class="p">))</span><span class="si">}</span><span class="s2">&#39; not @tool decorated. Skipping.&quot;</span><span class="p">})</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="k">continue</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="n">tool_wrapper</span> <span class="o">=</span> <span class="n">FunctionToolWrapper</span><span class="p">(</span><span class="n">original_func_to_call</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="n">tool_id</span> <span class="o">=</span> <span class="n">tool_wrapper</span><span class="o">.</span><span class="n">identifier</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="k">if</span> <span class="n">tool_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tools</span><span class="p">:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="c1"># This case means a class-based tool with the same identifier was already loaded</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="c1"># via tool_configurations. We honor the explicitly configured class-based tool.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace</span><span class="p">(</span><span class="s2">&quot;log.debug&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Tool &#39;</span><span class="si">{</span><span class="n">tool_id</span><span class="si">}</span><span class="s2">&#39; from decorated function was already loaded (e.g., as a class-based plugin via tool_configurations). Explicit/prior loading takes precedence.&quot;</span><span class="p">})</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>            <span class="k">continue</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="c1"># Determine if the tool should be enabled:</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="c1"># 1. If auto_enable is True.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="c1"># 2. OR if auto_enable is False, BUT the tool_id is present in self._tool_initial_configs</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="c1">#    (meaning it was listed in the `tool_configurations` dict passed to Genie.create).</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="n">should_enable_this_tool</span> <span class="o">=</span> <span class="n">auto_enable</span> <span class="ow">or</span> <span class="p">(</span><span class="n">tool_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tool_initial_configs</span><span class="p">)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="k">if</span> <span class="n">should_enable_this_tool</span><span class="p">:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_tools</span><span class="p">[</span><span class="n">tool_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">tool_wrapper</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="n">registered_count</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="k">if</span> <span class="n">auto_enable</span><span class="p">:</span> <span class="c1"># Logged as auto-enabled</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace</span><span class="p">(</span><span class="s2">&quot;log.info&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Auto-enabled tool &#39;</span><span class="si">{</span><span class="n">tool_id</span><span class="si">}</span><span class="s2">&#39; from decorated function &#39;</span><span class="si">{</span><span class="n">func_item</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">})</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="k">else</span><span class="p">:</span> <span class="c1"># Logged as explicitly enabled via tool_configurations</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace</span><span class="p">(</span><span class="s2">&quot;log.info&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Explicitly enabled tool &#39;</span><span class="si">{</span><span class="n">tool_id</span><span class="si">}</span><span class="s2">&#39; from decorated function &#39;</span><span class="si">{</span><span class="n">func_item</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; via tool_configurations.&quot;</span><span class="p">})</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="k">else</span><span class="p">:</span> <span class="c1"># auto_enable is False AND tool_id is NOT in tool_configurations</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace</span><span class="p">(</span><span class="s2">&quot;log.warning&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Tool &#39;</span><span class="si">{</span><span class="n">tool_id</span><span class="si">}</span><span class="s2">&#39; from decorated function &#39;</span><span class="si">{</span><span class="n">func_item</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; was registered but is NOT active. To enable it, add &#39;</span><span class="si">{</span><span class="n">tool_id</span><span class="si">}</span><span class="s2">&#39; to the `tool_configurations` dictionary in MiddlewareConfig.&quot;</span><span class="p">})</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="k">if</span> <span class="n">registered_count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">auto_enable</span><span class="p">:</span> <span class="c1"># Log summary if any tools were enabled explicitly this way</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace</span><span class="p">(</span><span class="s2">&quot;log.info&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Explicitly enabled </span><span class="si">{</span><span class="n">registered_count</span><span class="si">}</span><span class="s2"> decorated tools listed in tool_configurations.&quot;</span><span class="p">})</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="k">elif</span> <span class="n">registered_count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">auto_enable</span><span class="p">:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace</span><span class="p">(</span><span class="s2">&quot;log.info&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Auto-enabled </span><span class="si">{</span><span class="n">registered_count</span><span class="si">}</span><span class="s2"> decorated tools.&quot;</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-genie_tooling.VectorStorePlugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">VectorStorePlugin</span>


<a href="#api-genie_tooling.VectorStorePlugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Plugin" backlink-type="subclassed-by" backlink-anchor="genie_tooling.VectorStorePlugin" optional hover>Plugin</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.VectorStorePlugin" optional hover>Protocol</autoref></code></p>


        <p>Interface for interacting with a vector database.</p>










  <div class="doc doc-children">







<h5 id="api-genie_tooling.VectorStorePlugin-functions">Functions<a href="#api-genie_tooling.VectorStorePlugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.VectorStorePlugin.add" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.VectorStorePlugin.add" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">add</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">embeddings</span><span class="p">:</span> <span class="n">AsyncIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Chunk</span><span class="p">,</span> <span class="n">EmbeddingVector</span><span class="p">]],</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#api-__codelineno-0-4"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Adds chunks and their embeddings to the vector store.
Should handle batching internally if the input stream is large.
Args:
    embeddings: An async iterable of (Chunk, EmbeddingVector) tuples.
    config: Vector store-specific configuration (e.g., collection name, batch_size).
Returns:
    A dictionary with status, e.g., {"added_count": int, "errors": List[str]}</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/vector_stores/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-28">28</a></span>
<span class="normal"><a href="#api-__codelineno-0-29">29</a></span>
<span class="normal"><a href="#api-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-__codelineno-0-31">31</a></span>
<span class="normal"><a href="#api-__codelineno-0-32">32</a></span>
<span class="normal"><a href="#api-__codelineno-0-33">33</a></span>
<span class="normal"><a href="#api-__codelineno-0-34">34</a></span>
<span class="normal"><a href="#api-__codelineno-0-35">35</a></span>
<span class="normal"><a href="#api-__codelineno-0-36">36</a></span>
<span class="normal"><a href="#api-__codelineno-0-37">37</a></span>
<span class="normal"><a href="#api-__codelineno-0-38">38</a></span>
<span class="normal"><a href="#api-__codelineno-0-39">39</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embeddings</span><span class="p">:</span> <span class="n">AsyncIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Chunk</span><span class="p">,</span> <span class="n">EmbeddingVector</span><span class="p">]],</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span> <span class="c1"># Returns status/count</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    Adds chunks and their embeddings to the vector store.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    Should handle batching internally if the input stream is large.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        embeddings: An async iterable of (Chunk, EmbeddingVector) tuples.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        config: Vector store-specific configuration (e.g., collection name, batch_size).</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        A dictionary with status, e.g., {&quot;added_count&quot;: int, &quot;errors&quot;: List[str]}</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;VectorStorePlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; add method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;added_count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;errors&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Not implemented&quot;</span><span class="p">]}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.VectorStorePlugin.search" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">search</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.VectorStorePlugin.search" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">search</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">query_embedding</span><span class="p">:</span> <span class="n">EmbeddingVector</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a>    <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#api-__codelineno-0-4"></a>    <span class="n">filter_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#api-__codelineno-0-5"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#api-__codelineno-0-6"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">RetrievedChunk</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Searches the vector store for chunks similar to the query_embedding.
Args:
    query_embedding: The embedding vector of the query.
    top_k: The number of top results to return.
    filter_metadata: Optional metadata filter to apply during search.
    config: Search-specific configuration.
Returns:
    A list of RetrievedChunk objects.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/vector_stores/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-41">41</a></span>
<span class="normal"><a href="#api-__codelineno-0-42">42</a></span>
<span class="normal"><a href="#api-__codelineno-0-43">43</a></span>
<span class="normal"><a href="#api-__codelineno-0-44">44</a></span>
<span class="normal"><a href="#api-__codelineno-0-45">45</a></span>
<span class="normal"><a href="#api-__codelineno-0-46">46</a></span>
<span class="normal"><a href="#api-__codelineno-0-47">47</a></span>
<span class="normal"><a href="#api-__codelineno-0-48">48</a></span>
<span class="normal"><a href="#api-__codelineno-0-49">49</a></span>
<span class="normal"><a href="#api-__codelineno-0-50">50</a></span>
<span class="normal"><a href="#api-__codelineno-0-51">51</a></span>
<span class="normal"><a href="#api-__codelineno-0-52">52</a></span>
<span class="normal"><a href="#api-__codelineno-0-53">53</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_embedding</span><span class="p">:</span> <span class="n">EmbeddingVector</span><span class="p">,</span> <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">filter_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">RetrievedChunk</span><span class="p">]:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    Searches the vector store for chunks similar to the query_embedding.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        query_embedding: The embedding vector of the query.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        top_k: The number of top results to return.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        filter_metadata: Optional metadata filter to apply during search.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        config: Search-specific configuration.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        A list of RetrievedChunk objects.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;VectorStorePlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; search method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-genie_tooling.VectorStorePlugin.delete" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">delete</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-genie_tooling.VectorStorePlugin.delete" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">delete</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-__codelineno-0-2"></a>    <span class="n">ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-__codelineno-0-3"></a>    <span class="n">filter_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#api-__codelineno-0-4"></a>    <span class="n">delete_all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#api-__codelineno-0-5"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#api-__codelineno-0-6"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Deletes items from the vector store.
Args:
    ids: Optional list of chunk IDs to delete.
    filter_metadata: Optional metadata filter to select items for deletion.
    delete_all: If True, delete all items in the collection/store.
    config: Deletion-specific configuration.
Returns:
    True if deletion was successful (or partially successful), False otherwise.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/vector_stores/abc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-55">55</a></span>
<span class="normal"><a href="#api-__codelineno-0-56">56</a></span>
<span class="normal"><a href="#api-__codelineno-0-57">57</a></span>
<span class="normal"><a href="#api-__codelineno-0-58">58</a></span>
<span class="normal"><a href="#api-__codelineno-0-59">59</a></span>
<span class="normal"><a href="#api-__codelineno-0-60">60</a></span>
<span class="normal"><a href="#api-__codelineno-0-61">61</a></span>
<span class="normal"><a href="#api-__codelineno-0-62">62</a></span>
<span class="normal"><a href="#api-__codelineno-0-63">63</a></span>
<span class="normal"><a href="#api-__codelineno-0-64">64</a></span>
<span class="normal"><a href="#api-__codelineno-0-65">65</a></span>
<span class="normal"><a href="#api-__codelineno-0-66">66</a></span>
<span class="normal"><a href="#api-__codelineno-0-67">67</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">filter_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">delete_all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    Deletes items from the vector store.</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        ids: Optional list of chunk IDs to delete.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        filter_metadata: Optional metadata filter to select items for deletion.</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        delete_all: If True, delete all items in the collection/store.</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        config: Deletion-specific configuration.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">        True if deletion was successful (or partially successful), False otherwise.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;VectorStorePlugin &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_id</span><span class="si">}</span><span class="s2">&#39; delete method not fully implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>
<h3 id="api-genie_tooling-functions">Functions<a href="#api-genie_tooling-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="api-genie_tooling.tool" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">tool</span>


<a href="#api-genie_tooling.tool" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-__codelineno-0-1"></a><span class="nf">tool</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Decorator to transform a Python function into a Genie-compatible Tool.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/decorators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-__codelineno-0-129">129</a></span>
<span class="normal"><a href="#api-__codelineno-0-130">130</a></span>
<span class="normal"><a href="#api-__codelineno-0-131">131</a></span>
<span class="normal"><a href="#api-__codelineno-0-132">132</a></span>
<span class="normal"><a href="#api-__codelineno-0-133">133</a></span>
<span class="normal"><a href="#api-__codelineno-0-134">134</a></span>
<span class="normal"><a href="#api-__codelineno-0-135">135</a></span>
<span class="normal"><a href="#api-__codelineno-0-136">136</a></span>
<span class="normal"><a href="#api-__codelineno-0-137">137</a></span>
<span class="normal"><a href="#api-__codelineno-0-138">138</a></span>
<span class="normal"><a href="#api-__codelineno-0-139">139</a></span>
<span class="normal"><a href="#api-__codelineno-0-140">140</a></span>
<span class="normal"><a href="#api-__codelineno-0-141">141</a></span>
<span class="normal"><a href="#api-__codelineno-0-142">142</a></span>
<span class="normal"><a href="#api-__codelineno-0-143">143</a></span>
<span class="normal"><a href="#api-__codelineno-0-144">144</a></span>
<span class="normal"><a href="#api-__codelineno-0-145">145</a></span>
<span class="normal"><a href="#api-__codelineno-0-146">146</a></span>
<span class="normal"><a href="#api-__codelineno-0-147">147</a></span>
<span class="normal"><a href="#api-__codelineno-0-148">148</a></span>
<span class="normal"><a href="#api-__codelineno-0-149">149</a></span>
<span class="normal"><a href="#api-__codelineno-0-150">150</a></span>
<span class="normal"><a href="#api-__codelineno-0-151">151</a></span>
<span class="normal"><a href="#api-__codelineno-0-152">152</a></span>
<span class="normal"><a href="#api-__codelineno-0-153">153</a></span>
<span class="normal"><a href="#api-__codelineno-0-154">154</a></span>
<span class="normal"><a href="#api-__codelineno-0-155">155</a></span>
<span class="normal"><a href="#api-__codelineno-0-156">156</a></span>
<span class="normal"><a href="#api-__codelineno-0-157">157</a></span>
<span class="normal"><a href="#api-__codelineno-0-158">158</a></span>
<span class="normal"><a href="#api-__codelineno-0-159">159</a></span>
<span class="normal"><a href="#api-__codelineno-0-160">160</a></span>
<span class="normal"><a href="#api-__codelineno-0-161">161</a></span>
<span class="normal"><a href="#api-__codelineno-0-162">162</a></span>
<span class="normal"><a href="#api-__codelineno-0-163">163</a></span>
<span class="normal"><a href="#api-__codelineno-0-164">164</a></span>
<span class="normal"><a href="#api-__codelineno-0-165">165</a></span>
<span class="normal"><a href="#api-__codelineno-0-166">166</a></span>
<span class="normal"><a href="#api-__codelineno-0-167">167</a></span>
<span class="normal"><a href="#api-__codelineno-0-168">168</a></span>
<span class="normal"><a href="#api-__codelineno-0-169">169</a></span>
<span class="normal"><a href="#api-__codelineno-0-170">170</a></span>
<span class="normal"><a href="#api-__codelineno-0-171">171</a></span>
<span class="normal"><a href="#api-__codelineno-0-172">172</a></span>
<span class="normal"><a href="#api-__codelineno-0-173">173</a></span>
<span class="normal"><a href="#api-__codelineno-0-174">174</a></span>
<span class="normal"><a href="#api-__codelineno-0-175">175</a></span>
<span class="normal"><a href="#api-__codelineno-0-176">176</a></span>
<span class="normal"><a href="#api-__codelineno-0-177">177</a></span>
<span class="normal"><a href="#api-__codelineno-0-178">178</a></span>
<span class="normal"><a href="#api-__codelineno-0-179">179</a></span>
<span class="normal"><a href="#api-__codelineno-0-180">180</a></span>
<span class="normal"><a href="#api-__codelineno-0-181">181</a></span>
<span class="normal"><a href="#api-__codelineno-0-182">182</a></span>
<span class="normal"><a href="#api-__codelineno-0-183">183</a></span>
<span class="normal"><a href="#api-__codelineno-0-184">184</a></span>
<span class="normal"><a href="#api-__codelineno-0-185">185</a></span>
<span class="normal"><a href="#api-__codelineno-0-186">186</a></span>
<span class="normal"><a href="#api-__codelineno-0-187">187</a></span>
<span class="normal"><a href="#api-__codelineno-0-188">188</a></span>
<span class="normal"><a href="#api-__codelineno-0-189">189</a></span>
<span class="normal"><a href="#api-__codelineno-0-190">190</a></span>
<span class="normal"><a href="#api-__codelineno-0-191">191</a></span>
<span class="normal"><a href="#api-__codelineno-0-192">192</a></span>
<span class="normal"><a href="#api-__codelineno-0-193">193</a></span>
<span class="normal"><a href="#api-__codelineno-0-194">194</a></span>
<span class="normal"><a href="#api-__codelineno-0-195">195</a></span>
<span class="normal"><a href="#api-__codelineno-0-196">196</a></span>
<span class="normal"><a href="#api-__codelineno-0-197">197</a></span>
<span class="normal"><a href="#api-__codelineno-0-198">198</a></span>
<span class="normal"><a href="#api-__codelineno-0-199">199</a></span>
<span class="normal"><a href="#api-__codelineno-0-200">200</a></span>
<span class="normal"><a href="#api-__codelineno-0-201">201</a></span>
<span class="normal"><a href="#api-__codelineno-0-202">202</a></span>
<span class="normal"><a href="#api-__codelineno-0-203">203</a></span>
<span class="normal"><a href="#api-__codelineno-0-204">204</a></span>
<span class="normal"><a href="#api-__codelineno-0-205">205</a></span>
<span class="normal"><a href="#api-__codelineno-0-206">206</a></span>
<span class="normal"><a href="#api-__codelineno-0-207">207</a></span>
<span class="normal"><a href="#api-__codelineno-0-208">208</a></span>
<span class="normal"><a href="#api-__codelineno-0-209">209</a></span>
<span class="normal"><a href="#api-__codelineno-0-210">210</a></span>
<span class="normal"><a href="#api-__codelineno-0-211">211</a></span>
<span class="normal"><a href="#api-__codelineno-0-212">212</a></span>
<span class="normal"><a href="#api-__codelineno-0-213">213</a></span>
<span class="normal"><a href="#api-__codelineno-0-214">214</a></span>
<span class="normal"><a href="#api-__codelineno-0-215">215</a></span>
<span class="normal"><a href="#api-__codelineno-0-216">216</a></span>
<span class="normal"><a href="#api-__codelineno-0-217">217</a></span>
<span class="normal"><a href="#api-__codelineno-0-218">218</a></span>
<span class="normal"><a href="#api-__codelineno-0-219">219</a></span>
<span class="normal"><a href="#api-__codelineno-0-220">220</a></span>
<span class="normal"><a href="#api-__codelineno-0-221">221</a></span>
<span class="normal"><a href="#api-__codelineno-0-222">222</a></span>
<span class="normal"><a href="#api-__codelineno-0-223">223</a></span>
<span class="normal"><a href="#api-__codelineno-0-224">224</a></span>
<span class="normal"><a href="#api-__codelineno-0-225">225</a></span>
<span class="normal"><a href="#api-__codelineno-0-226">226</a></span>
<span class="normal"><a href="#api-__codelineno-0-227">227</a></span>
<span class="normal"><a href="#api-__codelineno-0-228">228</a></span>
<span class="normal"><a href="#api-__codelineno-0-229">229</a></span>
<span class="normal"><a href="#api-__codelineno-0-230">230</a></span>
<span class="normal"><a href="#api-__codelineno-0-231">231</a></span>
<span class="normal"><a href="#api-__codelineno-0-232">232</a></span>
<span class="normal"><a href="#api-__codelineno-0-233">233</a></span>
<span class="normal"><a href="#api-__codelineno-0-234">234</a></span>
<span class="normal"><a href="#api-__codelineno-0-235">235</a></span>
<span class="normal"><a href="#api-__codelineno-0-236">236</a></span>
<span class="normal"><a href="#api-__codelineno-0-237">237</a></span>
<span class="normal"><a href="#api-__codelineno-0-238">238</a></span>
<span class="normal"><a href="#api-__codelineno-0-239">239</a></span>
<span class="normal"><a href="#api-__codelineno-0-240">240</a></span>
<span class="normal"><a href="#api-__codelineno-0-241">241</a></span>
<span class="normal"><a href="#api-__codelineno-0-242">242</a></span>
<span class="normal"><a href="#api-__codelineno-0-243">243</a></span>
<span class="normal"><a href="#api-__codelineno-0-244">244</a></span>
<span class="normal"><a href="#api-__codelineno-0-245">245</a></span>
<span class="normal"><a href="#api-__codelineno-0-246">246</a></span>
<span class="normal"><a href="#api-__codelineno-0-247">247</a></span>
<span class="normal"><a href="#api-__codelineno-0-248">248</a></span>
<span class="normal"><a href="#api-__codelineno-0-249">249</a></span>
<span class="normal"><a href="#api-__codelineno-0-250">250</a></span>
<span class="normal"><a href="#api-__codelineno-0-251">251</a></span>
<span class="normal"><a href="#api-__codelineno-0-252">252</a></span>
<span class="normal"><a href="#api-__codelineno-0-253">253</a></span>
<span class="normal"><a href="#api-__codelineno-0-254">254</a></span>
<span class="normal"><a href="#api-__codelineno-0-255">255</a></span>
<span class="normal"><a href="#api-__codelineno-0-256">256</a></span>
<span class="normal"><a href="#api-__codelineno-0-257">257</a></span>
<span class="normal"><a href="#api-__codelineno-0-258">258</a></span>
<span class="normal"><a href="#api-__codelineno-0-259">259</a></span>
<span class="normal"><a href="#api-__codelineno-0-260">260</a></span>
<span class="normal"><a href="#api-__codelineno-0-261">261</a></span>
<span class="normal"><a href="#api-__codelineno-0-262">262</a></span>
<span class="normal"><a href="#api-__codelineno-0-263">263</a></span>
<span class="normal"><a href="#api-__codelineno-0-264">264</a></span>
<span class="normal"><a href="#api-__codelineno-0-265">265</a></span>
<span class="normal"><a href="#api-__codelineno-0-266">266</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="k">def</span><span class="w"> </span><span class="nf">tool</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator to transform a Python function into a Genie-compatible Tool.&quot;&quot;&quot;</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="n">globalns</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="s2">&quot;__globals__&quot;</span><span class="p">,</span> <span class="p">{})</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="n">type_hints</span> <span class="o">=</span> <span class="n">get_type_hints</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">globalns</span><span class="o">=</span><span class="n">globalns</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="k">except</span> <span class="ne">NameError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>            <span class="n">type_hints</span> <span class="o">=</span> <span class="n">get_type_hints</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="n">type_hints</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>                <span class="sa">f</span><span class="s2">&quot;Warning: Could not fully resolve type hints for </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> due to </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">. Schemas might be incomplete.&quot;</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="n">docstring</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getdoc</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="n">main_description</span> <span class="o">=</span> <span class="n">docstring</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;Executes the &#39;</span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; tool.&quot;</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">param_descriptions_from_doc</span> <span class="o">=</span> <span class="n">_parse_docstring_for_params</span><span class="p">(</span><span class="n">docstring</span><span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">properties</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="n">required_params</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;self&quot;</span><span class="p">,</span> <span class="s2">&quot;cls&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">param</span><span class="o">.</span><span class="n">kind</span> <span class="ow">in</span> <span class="p">(</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="n">inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">VAR_POSITIONAL</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>            <span class="n">inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">VAR_KEYWORD</span><span class="p">,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="p">):</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="k">continue</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="n">param_py_type_hint</span> <span class="o">=</span> <span class="n">type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Any</span><span class="p">)</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param_py_type_hint</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>                <span class="n">param_py_type_hint</span> <span class="o">=</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="n">param_py_type_hint</span><span class="p">)</span><span class="o">.</span><span class="n">_evaluate</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>                    <span class="n">globalns</span><span class="p">,</span> <span class="p">{},</span> <span class="n">recursive_guard</span><span class="o">=</span><span class="nb">frozenset</span><span class="p">()</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>                <span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>                <span class="n">param_py_type_hint</span> <span class="o">=</span> <span class="n">Any</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="n">is_optional_from_union_type</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="n">actual_param_type_for_schema</span> <span class="o">=</span> <span class="n">param_py_type_hint</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="n">origin</span> <span class="o">=</span> <span class="n">get_origin</span><span class="p">(</span><span class="n">param_py_type_hint</span><span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="n">args</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">(</span><span class="n">param_py_type_hint</span><span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="k">if</span> <span class="n">origin</span> <span class="ow">is</span> <span class="n">Union</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="n">args</span> <span class="ow">or</span> <span class="p">[]):</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="n">is_optional_from_union_type</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>            <span class="k">if</span> <span class="n">args</span><span class="p">:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>                <span class="n">non_none_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)]</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">non_none_args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>                    <span class="n">actual_param_type_for_schema</span> <span class="o">=</span> <span class="n">non_none_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>                    <span class="n">actual_param_type_for_schema</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">non_none_args</span><span class="p">)]</span>  <span class="c1"># Keep as Union of non-None</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="n">param_schema_def</span> <span class="o">=</span> <span class="n">_map_type_to_json_schema</span><span class="p">(</span><span class="n">actual_param_type_for_schema</span><span class="p">)</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="c1"># --- FIX: Default to &#39;string&#39; if schema is empty (from Any type) ---</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">param_schema_def</span><span class="p">:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="n">param_schema_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;string&quot;</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="n">param_schema_def</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">param_descriptions_from_doc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Parameter &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="c1"># Handle optionality by adding &quot;null&quot; to the type list</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="k">if</span> <span class="n">is_optional_from_union_type</span><span class="p">:</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">param_schema_def</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param_schema_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                <span class="n">param_schema_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">param_schema_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">],</span> <span class="s2">&quot;null&quot;</span><span class="p">]</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="k">elif</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">param_schema_def</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param_schema_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>                <span class="k">if</span> <span class="s2">&quot;null&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">param_schema_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>                    <span class="n">param_schema_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;null&quot;</span><span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="n">inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_optional_from_union_type</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">FRAMEWORK_INJECTED_PARAMS</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>                <span class="n">required_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>            <span class="n">param_schema_def</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">default</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="n">properties</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">param_schema_def</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="n">input_schema</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span> <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="n">properties</span><span class="p">}</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="k">if</span> <span class="n">required_params</span><span class="p">:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="n">input_schema</span><span class="p">[</span><span class="s2">&quot;required&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">required_params</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="n">return_py_type_hint</span> <span class="o">=</span> <span class="n">type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;return&quot;</span><span class="p">,</span> <span class="n">Any</span><span class="p">)</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">return_py_type_hint</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="n">return_py_type_hint</span> <span class="o">=</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="n">return_py_type_hint</span><span class="p">)</span><span class="o">.</span><span class="n">_evaluate</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>                <span class="n">globalns</span><span class="p">,</span> <span class="p">{},</span> <span class="n">recursive_guard</span><span class="o">=</span><span class="nb">frozenset</span><span class="p">()</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>            <span class="p">)</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="n">return_py_type_hint</span> <span class="o">=</span> <span class="n">Any</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">actual_return_type_for_schema</span> <span class="o">=</span> <span class="n">return_py_type_hint</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="n">ret_origin</span> <span class="o">=</span> <span class="n">get_origin</span><span class="p">(</span><span class="n">return_py_type_hint</span><span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="n">ret_args</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">(</span><span class="n">return_py_type_hint</span><span class="p">)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="k">if</span> <span class="n">ret_origin</span> <span class="ow">is</span> <span class="n">Union</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ret_args</span> <span class="ow">or</span> <span class="p">[]):</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="k">if</span> <span class="n">ret_args</span><span class="p">:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="n">actual_return_type_for_schema</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ret_args</span> <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)),</span> <span class="n">Any</span><span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">output_schema_prop_def</span> <span class="o">=</span> <span class="n">_map_type_to_json_schema</span><span class="p">(</span><span class="n">actual_return_type_for_schema</span><span class="p">)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">output_schema_prop_def</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="n">output_schema_prop_def</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">}</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="n">output_schema</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span> <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="n">output_schema_prop_def</span><span class="p">}}</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="n">output_schema_prop_def</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;null&quot;</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">output_schema_prop_def</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">),</span> <span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="ow">and</span> <span class="s2">&quot;null&quot;</span> <span class="ow">in</span> <span class="n">output_schema_prop_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>            <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">output_schema_prop_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="p">)</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="ow">and</span> <span class="n">output_schema_prop_def</span> <span class="o">!=</span> <span class="p">{}</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="p">):</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="n">output_schema</span><span class="p">[</span><span class="s2">&quot;required&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="n">tool_metadata</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="s2">&quot;identifier&quot;</span><span class="p">:</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="s2">&quot;description_human&quot;</span><span class="p">:</span> <span class="n">main_description</span><span class="p">,</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="s2">&quot;description_llm&quot;</span><span class="p">:</span> <span class="n">main_description</span><span class="p">,</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="s2">&quot;input_schema&quot;</span><span class="p">:</span> <span class="n">input_schema</span><span class="p">,</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="s2">&quot;output_schema&quot;</span><span class="p">:</span> <span class="n">output_schema</span><span class="p">,</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="s2">&quot;key_requirements&quot;</span><span class="p">:</span> <span class="p">[],</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;decorated_tool&quot;</span><span class="p">],</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="s2">&quot;cacheable&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="p">}</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">iscoroutinefunction</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>            <span class="k">return</span> <span class="k">await</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="n">wrapper</span><span class="o">.</span><span class="n">_tool_metadata_</span> <span class="o">=</span> <span class="n">tool_metadata</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="n">wrapper</span><span class="o">.</span><span class="n">_original_function_</span> <span class="o">=</span> <span class="n">func</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="k">return</span> <span class="n">wrapper</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div></section><section class="print-page" id="api-genie_facade" heading-number="3.2"><h1 id="api-genie_facade-genie-facade-and-interfaces">Genie Facade and Interfaces<a class="headerlink" href="#api-genie_facade-genie-facade-and-interfaces" title="Permanent link">&para;</a></h1>
<h2 id="api-genie_facade-genie-facade">Genie Facade<a class="headerlink" href="#api-genie_facade-genie-facade" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h2 id="api-genie_facade-genie_tooling.genie.Genie" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">genie_tooling.genie.Genie</span>


<a href="#api-genie_facade-genie_tooling.genie.Genie" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-genie_facade-__codelineno-0-1"></a><span class="nf">Genie</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-genie_facade-__codelineno-0-2"></a>    <span class="n">plugin_manager</span><span class="p">:</span> <span class="n">PluginManager</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-genie_facade-__codelineno-0-3"></a>    <span class="n">key_provider</span><span class="p">:</span> <span class="n">KeyProvider</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#api-genie_facade-__codelineno-0-4"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">MiddlewareConfig</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#api-genie_facade-__codelineno-0-5"></a>    <span class="n">tool_manager</span><span class="p">:</span> <span class="n">ToolManager</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#api-genie_facade-__codelineno-0-6"></a>    <span class="n">tool_invoker</span><span class="p">:</span> <span class="n">ToolInvoker</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#api-genie_facade-__codelineno-0-7"></a>    <span class="n">rag_manager</span><span class="p">:</span> <span class="n">RAGManager</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#api-genie_facade-__codelineno-0-8"></a>    <span class="n">tool_lookup_service</span><span class="p">:</span> <span class="n">ToolLookupService</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#api-genie_facade-__codelineno-0-9"></a>    <span class="n">llm_provider_manager</span><span class="p">:</span> <span class="n">LLMProviderManager</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#api-genie_facade-__codelineno-0-10"></a>    <span class="n">command_processor_manager</span><span class="p">:</span> <span class="n">CommandProcessorManager</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#api-genie_facade-__codelineno-0-11"></a>    <span class="n">log_adapter</span><span class="p">:</span> <span class="n">LogAdapter</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#api-genie_facade-__codelineno-0-12"></a>    <span class="n">tracing_manager</span><span class="p">:</span> <span class="n">InteractionTracingManager</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#api-genie_facade-__codelineno-0-13"></a>    <span class="n">hitl_manager</span><span class="p">:</span> <span class="n">HITLManager</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#api-genie_facade-__codelineno-0-14"></a>    <span class="n">token_usage_manager</span><span class="p">:</span> <span class="n">TokenUsageManager</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#api-genie_facade-__codelineno-0-15"></a>    <span class="n">guardrail_manager</span><span class="p">:</span> <span class="n">GuardrailManager</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#api-genie_facade-__codelineno-0-16"></a>    <span class="n">prompt_manager</span><span class="p">:</span> <span class="n">PromptManager</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#api-genie_facade-__codelineno-0-17"></a>    <span class="n">conversation_manager</span><span class="p">:</span> <span class="n">ConversationStateManager</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#api-genie_facade-__codelineno-0-18"></a>    <span class="n">llm_output_parser_manager</span><span class="p">:</span> <span class="n">LLMOutputParserManager</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#api-genie_facade-__codelineno-0-19"></a>    <span class="n">task_queue_manager</span><span class="p">:</span> <span class="n">DistributedTaskQueueManager</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#api-genie_facade-__codelineno-0-20"></a>    <span class="n">llm_interface</span><span class="p">:</span> <span class="n">LLMInterface</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#api-genie_facade-__codelineno-0-21"></a>    <span class="n">rag_interface</span><span class="p">:</span> <span class="n">RAGInterface</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#api-genie_facade-__codelineno-0-22"></a>    <span class="n">observability_interface</span><span class="p">:</span> <span class="n">ObservabilityInterface</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#api-genie_facade-__codelineno-0-23"></a>    <span class="n">hitl_interface</span><span class="p">:</span> <span class="n">HITLInterface</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#api-genie_facade-__codelineno-0-24"></a>    <span class="n">usage_tracking_interface</span><span class="p">:</span> <span class="n">UsageTrackingInterface</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#api-genie_facade-__codelineno-0-25"></a>    <span class="n">prompt_interface</span><span class="p">:</span> <span class="n">PromptInterface</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#api-genie_facade-__codelineno-0-26"></a>    <span class="n">conversation_interface</span><span class="p">:</span> <span class="n">ConversationInterface</span><span class="p">,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#api-genie_facade-__codelineno-0-27"></a>    <span class="n">task_queue_interface</span><span class="p">:</span> <span class="n">TaskQueueInterface</span><span class="p">,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#api-genie_facade-__codelineno-0-28"></a><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">








                  <details class="quote">
                    <summary>Source code in <code>src/genie_tooling/genie.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-genie_facade-__codelineno-0-132">132</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-133">133</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-134">134</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-135">135</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-136">136</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-137">137</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-138">138</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-139">139</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-140">140</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-141">141</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-142">142</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-143">143</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-144">144</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-145">145</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-146">146</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-147">147</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-148">148</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-149">149</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-150">150</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-151">151</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-152">152</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-153">153</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-154">154</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-155">155</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-156">156</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-157">157</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-158">158</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-159">159</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-160">160</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-161">161</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-162">162</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-163">163</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-164">164</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-165">165</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-166">166</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-167">167</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-168">168</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-169">169</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-170">170</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-171">171</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">plugin_manager</span><span class="p">:</span> <span class="n">PluginManager</span><span class="p">,</span> <span class="n">key_provider</span><span class="p">:</span> <span class="n">KeyProvider</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">MiddlewareConfig</span><span class="p">,</span> <span class="n">tool_manager</span><span class="p">:</span> <span class="n">ToolManager</span><span class="p">,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="n">tool_invoker</span><span class="p">:</span> <span class="n">ToolInvoker</span><span class="p">,</span> <span class="n">rag_manager</span><span class="p">:</span> <span class="n">RAGManager</span><span class="p">,</span> <span class="n">tool_lookup_service</span><span class="p">:</span> <span class="n">ToolLookupService</span><span class="p">,</span> <span class="n">llm_provider_manager</span><span class="p">:</span> <span class="n">LLMProviderManager</span><span class="p">,</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="n">command_processor_manager</span><span class="p">:</span> <span class="n">CommandProcessorManager</span><span class="p">,</span> <span class="n">log_adapter</span><span class="p">:</span> <span class="n">LogAdapterPlugin</span><span class="p">,</span> <span class="n">tracing_manager</span><span class="p">:</span> <span class="n">InteractionTracingManager</span><span class="p">,</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="n">hitl_manager</span><span class="p">:</span> <span class="n">HITLManager</span><span class="p">,</span> <span class="n">token_usage_manager</span><span class="p">:</span> <span class="n">TokenUsageManager</span><span class="p">,</span> <span class="n">guardrail_manager</span><span class="p">:</span> <span class="n">GuardrailManager</span><span class="p">,</span> <span class="n">prompt_manager</span><span class="p">:</span> <span class="n">PromptManager</span><span class="p">,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="n">conversation_manager</span><span class="p">:</span> <span class="n">ConversationStateManager</span><span class="p">,</span> <span class="n">llm_output_parser_manager</span><span class="p">:</span> <span class="n">LLMOutputParserManager</span><span class="p">,</span> <span class="n">task_queue_manager</span><span class="p">:</span> <span class="n">DistributedTaskQueueManager</span><span class="p">,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="n">llm_interface</span><span class="p">:</span> <span class="n">LLMInterface</span><span class="p">,</span> <span class="n">rag_interface</span><span class="p">:</span> <span class="n">RAGInterface</span><span class="p">,</span> <span class="n">observability_interface</span><span class="p">:</span> <span class="n">ObservabilityInterface</span><span class="p">,</span> <span class="n">hitl_interface</span><span class="p">:</span> <span class="n">HITLInterface</span><span class="p">,</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="n">usage_tracking_interface</span><span class="p">:</span> <span class="n">UsageTrackingInterface</span><span class="p">,</span> <span class="n">prompt_interface</span><span class="p">:</span> <span class="n">PromptInterface</span><span class="p">,</span> <span class="n">conversation_interface</span><span class="p">:</span> <span class="n">ConversationInterface</span><span class="p">,</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="n">task_queue_interface</span><span class="p">:</span> <span class="n">TaskQueueInterface</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="p">):</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_plugin_manager</span> <span class="o">=</span> <span class="n">plugin_manager</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_key_provider</span> <span class="o">=</span> <span class="n">key_provider</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_tool_manager</span> <span class="o">=</span> <span class="n">tool_manager</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_tool_invoker</span> <span class="o">=</span> <span class="n">tool_invoker</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_rag_manager</span> <span class="o">=</span> <span class="n">rag_manager</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_tool_lookup_service</span> <span class="o">=</span> <span class="n">tool_lookup_service</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_llm_provider_manager</span> <span class="o">=</span> <span class="n">llm_provider_manager</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_command_processor_manager</span> <span class="o">=</span> <span class="n">command_processor_manager</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_log_adapter</span> <span class="o">=</span> <span class="n">log_adapter</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_tracing_manager</span> <span class="o">=</span> <span class="n">tracing_manager</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_hitl_manager</span> <span class="o">=</span> <span class="n">hitl_manager</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_token_usage_manager</span> <span class="o">=</span> <span class="n">token_usage_manager</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_guardrail_manager</span> <span class="o">=</span> <span class="n">guardrail_manager</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_prompt_manager</span> <span class="o">=</span> <span class="n">prompt_manager</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_conversation_manager</span> <span class="o">=</span> <span class="n">conversation_manager</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_llm_output_parser_manager</span> <span class="o">=</span> <span class="n">llm_output_parser_manager</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_task_queue_manager</span> <span class="o">=</span> <span class="n">task_queue_manager</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">llm</span> <span class="o">=</span> <span class="n">llm_interface</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">rag</span> <span class="o">=</span> <span class="n">rag_interface</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">observability</span> <span class="o">=</span> <span class="n">observability_interface</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">human_in_loop</span> <span class="o">=</span> <span class="n">hitl_interface</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">usage</span> <span class="o">=</span> <span class="n">usage_tracking_interface</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">prompts</span> <span class="o">=</span> <span class="n">prompt_interface</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">conversation</span> <span class="o">=</span> <span class="n">conversation_interface</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">task_queue</span> <span class="o">=</span> <span class="n">task_queue_interface</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">_genie_instance</span> <span class="o">=</span> <span class="bp">self</span> <span class="c1"># type: ignore</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="n">task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">observability</span><span class="o">.</span><span class="n">trace_event</span><span class="p">(</span><span class="s2">&quot;log.info&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Genie facade initialized with resolved configuration.&quot;</span><span class="p">},</span> <span class="s2">&quot;Genie&quot;</span><span class="p">))</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">background_tasks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="n">task</span><span class="o">.</span><span class="n">add_done_callback</span><span class="p">(</span><span class="n">background_tasks</span><span class="o">.</span><span class="n">discard</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div><h2 id="core-interfaces">Core Interfaces<a class="headerlink" href="#api-genie_facade-core-interfaces" title="Permanent link">&para;</a></h2>
<p>These interfaces are accessed via attributes on the <code>Genie</code> facade instance (e.g., <code>genie.llm</code>, <code>genie.rag</code>).</p>


<div class="doc doc-object doc-class">



<h2 id="api-genie_facade-genie_tooling.interfaces.LLMInterface" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">genie_tooling.interfaces.LLMInterface</span>


<a href="#api-genie_facade-genie_tooling.interfaces.LLMInterface" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-genie_facade-__codelineno-0-1"></a><span class="nf">LLMInterface</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-genie_facade-__codelineno-0-2"></a>    <span class="n">llm_provider_manager</span><span class="p">:</span> <span class="n">LLMProviderManager</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-genie_facade-__codelineno-0-3"></a>    <span class="n">default_provider_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#api-genie_facade-__codelineno-0-4"></a>    <span class="n">output_parser_manager</span><span class="p">:</span> <span class="n">LLMOutputParserManager</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#api-genie_facade-__codelineno-0-5"></a>    <span class="n">tracing_manager</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">InteractionTracingManager</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#api-genie_facade-__codelineno-0-6"></a>    <span class="n">guardrail_manager</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">GuardrailManager</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#api-genie_facade-__codelineno-0-7"></a>    <span class="n">token_usage_manager</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">TokenUsageManager</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#api-genie_facade-__codelineno-0-8"></a><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">








                  <details class="quote">
                    <summary>Source code in <code>src/genie_tooling/interfaces.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-genie_facade-__codelineno-0-64">64</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-65">65</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-66">66</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-67">67</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-68">68</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-69">69</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-70">70</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-71">71</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-72">72</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-73">73</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-74">74</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-75">75</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-76">76</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-77">77</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-78">78</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-79">79</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="n">llm_provider_manager</span><span class="p">:</span> <span class="s2">&quot;LLMProviderManager&quot;</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">default_provider_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">output_parser_manager</span><span class="p">:</span> <span class="s2">&quot;LLMOutputParserManager&quot;</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">tracing_manager</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;InteractionTracingManager&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">guardrail_manager</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;GuardrailManager&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">token_usage_manager</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;TokenUsageManager&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="p">):</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_llm_provider_manager</span> <span class="o">=</span> <span class="n">llm_provider_manager</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_default_provider_id</span> <span class="o">=</span> <span class="n">default_provider_id</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_output_parser_manager</span> <span class="o">=</span> <span class="n">output_parser_manager</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_tracing_manager</span> <span class="o">=</span> <span class="n">tracing_manager</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_guardrail_manager</span> <span class="o">=</span> <span class="n">guardrail_manager</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_token_usage_manager</span> <span class="o">=</span> <span class="n">token_usage_manager</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LLMInterface initialized with default provider ID: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_provider_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="api-genie_facade-genie_tooling.interfaces.RAGInterface" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">genie_tooling.interfaces.RAGInterface</span>


<a href="#api-genie_facade-genie_tooling.interfaces.RAGInterface" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-genie_facade-__codelineno-0-1"></a><span class="nf">RAGInterface</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#api-genie_facade-__codelineno-0-2"></a>    <span class="n">rag_manager</span><span class="p">:</span> <span class="n">RAGManager</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#api-genie_facade-__codelineno-0-3"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">MiddlewareConfig</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#api-genie_facade-__codelineno-0-4"></a>    <span class="n">key_provider</span><span class="p">:</span> <span class="n">KeyProvider</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#api-genie_facade-__codelineno-0-5"></a>    <span class="n">tracing_manager</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">InteractionTracingManager</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#api-genie_facade-__codelineno-0-6"></a><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">








                  <details class="quote">
                    <summary>Source code in <code>src/genie_tooling/interfaces.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-genie_facade-__codelineno-0-286">286</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-287">287</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-288">288</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-289">289</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-290">290</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-291">291</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rag_manager</span><span class="p">:</span> <span class="s2">&quot;RAGManager&quot;</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="s2">&quot;MiddlewareConfig&quot;</span><span class="p">,</span> <span class="n">key_provider</span><span class="p">:</span> <span class="s2">&quot;KeyProvider&quot;</span><span class="p">,</span> <span class="n">tracing_manager</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;InteractionTracingManager&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_rag_manager</span> <span class="o">=</span> <span class="n">rag_manager</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_key_provider</span> <span class="o">=</span> <span class="n">key_provider</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_tracing_manager</span> <span class="o">=</span> <span class="n">tracing_manager</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;RAGInterface initialized.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="api-genie_facade-genie_tooling.interfaces.ObservabilityInterface" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">genie_tooling.interfaces.ObservabilityInterface</span>


<a href="#api-genie_facade-genie_tooling.interfaces.ObservabilityInterface" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-genie_facade-__codelineno-0-1"></a><span class="nf">ObservabilityInterface</span><span class="p">(</span><span class="n">tracing_manager</span><span class="p">:</span> <span class="n">InteractionTracingManager</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">








                  <details class="quote">
                    <summary>Source code in <code>src/genie_tooling/interfaces.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-genie_facade-__codelineno-0-451">451</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tracing_manager</span><span class="p">:</span> <span class="s2">&quot;InteractionTracingManager&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracing_manager</span> <span class="o">=</span> <span class="n">tracing_manager</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="api-genie_facade-genie_tooling.interfaces.HITLInterface" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">genie_tooling.interfaces.HITLInterface</span>


<a href="#api-genie_facade-genie_tooling.interfaces.HITLInterface" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-genie_facade-__codelineno-0-1"></a><span class="nf">HITLInterface</span><span class="p">(</span><span class="n">hitl_manager</span><span class="p">:</span> <span class="n">HITLManager</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">








                  <details class="quote">
                    <summary>Source code in <code>src/genie_tooling/interfaces.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-genie_facade-__codelineno-0-457">457</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hitl_manager</span><span class="p">:</span> <span class="s2">&quot;HITLManager&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hitl_manager</span> <span class="o">=</span> <span class="n">hitl_manager</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="api-genie_facade-genie_tooling.interfaces.UsageTrackingInterface" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">genie_tooling.interfaces.UsageTrackingInterface</span>


<a href="#api-genie_facade-genie_tooling.interfaces.UsageTrackingInterface" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-genie_facade-__codelineno-0-1"></a><span class="nf">UsageTrackingInterface</span><span class="p">(</span><span class="n">token_usage_manager</span><span class="p">:</span> <span class="n">TokenUsageManager</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">








                  <details class="quote">
                    <summary>Source code in <code>src/genie_tooling/interfaces.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-genie_facade-__codelineno-0-466">466</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token_usage_manager</span><span class="p">:</span> <span class="s2">&quot;TokenUsageManager&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_token_usage_manager</span> <span class="o">=</span> <span class="n">token_usage_manager</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="api-genie_facade-genie_tooling.interfaces.PromptInterface" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">genie_tooling.interfaces.PromptInterface</span>


<a href="#api-genie_facade-genie_tooling.interfaces.PromptInterface" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-genie_facade-__codelineno-0-1"></a><span class="nf">PromptInterface</span><span class="p">(</span><span class="n">prompt_manager</span><span class="p">:</span> <span class="n">PromptManager</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">








                  <details class="quote">
                    <summary>Source code in <code>src/genie_tooling/interfaces.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-genie_facade-__codelineno-0-476">476</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prompt_manager</span><span class="p">:</span> <span class="s2">&quot;PromptManager&quot;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prompt_manager</span> <span class="o">=</span> <span class="n">prompt_manager</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="api-genie_facade-genie_tooling.interfaces.ConversationInterface" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">genie_tooling.interfaces.ConversationInterface</span>


<a href="#api-genie_facade-genie_tooling.interfaces.ConversationInterface" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-genie_facade-__codelineno-0-1"></a><span class="nf">ConversationInterface</span><span class="p">(</span><span class="n">conversation_manager</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ConversationStateManager</span><span class="p">])</span>
</code></pre></div>

    <div class="doc doc-contents first">








                  <details class="quote">
                    <summary>Source code in <code>src/genie_tooling/interfaces.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-genie_facade-__codelineno-0-487">487</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-488">488</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-489">489</a></span>
<span class="normal"><a href="#api-genie_facade-__codelineno-0-490">490</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conversation_manager</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;ConversationStateManager&quot;</span><span class="p">]):</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_conversation_manager</span> <span class="o">=</span> <span class="n">conversation_manager</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conversation_manager</span><span class="p">:</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;ConversationInterface initialized without a ConversationStateManager. Operations will be no-ops or return defaults.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div></section><section class="print-page" id="api-decorators" heading-number="3.3"><h1 id="api-decorators-decorators">Decorators<a class="headerlink" href="#api-decorators-decorators" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<h2 id="api-decorators-genie_tooling.decorators" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">genie_tooling.decorators</span>


<a href="#api-decorators-genie_tooling.decorators" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">









  <div class="doc doc-children">







<h3 id="api-decorators-genie_tooling.decorators-functions">Functions<a href="#api-decorators-genie_tooling.decorators-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="api-decorators-genie_tooling.decorators.tool" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">tool</span>


<a href="#api-decorators-genie_tooling.decorators.tool" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-decorators-__codelineno-0-1"></a><span class="nf">tool</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Decorator to transform a Python function into a Genie-compatible Tool.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/decorators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-decorators-__codelineno-0-129">129</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-130">130</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-131">131</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-132">132</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-133">133</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-134">134</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-135">135</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-136">136</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-137">137</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-138">138</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-139">139</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-140">140</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-141">141</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-142">142</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-143">143</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-144">144</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-145">145</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-146">146</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-147">147</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-148">148</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-149">149</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-150">150</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-151">151</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-152">152</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-153">153</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-154">154</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-155">155</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-156">156</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-157">157</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-158">158</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-159">159</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-160">160</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-161">161</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-162">162</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-163">163</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-164">164</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-165">165</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-166">166</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-167">167</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-168">168</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-169">169</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-170">170</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-171">171</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-172">172</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-173">173</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-174">174</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-175">175</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-176">176</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-177">177</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-178">178</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-179">179</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-180">180</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-181">181</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-182">182</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-183">183</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-184">184</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-185">185</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-186">186</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-187">187</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-188">188</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-189">189</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-190">190</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-191">191</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-192">192</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-193">193</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-194">194</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-195">195</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-196">196</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-197">197</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-198">198</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-199">199</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-200">200</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-201">201</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-202">202</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-203">203</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-204">204</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-205">205</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-206">206</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-207">207</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-208">208</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-209">209</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-210">210</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-211">211</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-212">212</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-213">213</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-214">214</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-215">215</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-216">216</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-217">217</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-218">218</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-219">219</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-220">220</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-221">221</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-222">222</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-223">223</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-224">224</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-225">225</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-226">226</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-227">227</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-228">228</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-229">229</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-230">230</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-231">231</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-232">232</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-233">233</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-234">234</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-235">235</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-236">236</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-237">237</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-238">238</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-239">239</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-240">240</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-241">241</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-242">242</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-243">243</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-244">244</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-245">245</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-246">246</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-247">247</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-248">248</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-249">249</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-250">250</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-251">251</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-252">252</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-253">253</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-254">254</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-255">255</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-256">256</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-257">257</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-258">258</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-259">259</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-260">260</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-261">261</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-262">262</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-263">263</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-264">264</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-265">265</a></span>
<span class="normal"><a href="#api-decorators-__codelineno-0-266">266</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="k">def</span><span class="w"> </span><span class="nf">tool</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator to transform a Python function into a Genie-compatible Tool.&quot;&quot;&quot;</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="n">globalns</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="s2">&quot;__globals__&quot;</span><span class="p">,</span> <span class="p">{})</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="n">type_hints</span> <span class="o">=</span> <span class="n">get_type_hints</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">globalns</span><span class="o">=</span><span class="n">globalns</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="k">except</span> <span class="ne">NameError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>            <span class="n">type_hints</span> <span class="o">=</span> <span class="n">get_type_hints</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="n">type_hints</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>                <span class="sa">f</span><span class="s2">&quot;Warning: Could not fully resolve type hints for </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> due to </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">. Schemas might be incomplete.&quot;</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="n">docstring</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getdoc</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="n">main_description</span> <span class="o">=</span> <span class="n">docstring</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;Executes the &#39;</span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; tool.&quot;</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">param_descriptions_from_doc</span> <span class="o">=</span> <span class="n">_parse_docstring_for_params</span><span class="p">(</span><span class="n">docstring</span><span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">properties</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="n">required_params</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;self&quot;</span><span class="p">,</span> <span class="s2">&quot;cls&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">param</span><span class="o">.</span><span class="n">kind</span> <span class="ow">in</span> <span class="p">(</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="n">inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">VAR_POSITIONAL</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>            <span class="n">inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">VAR_KEYWORD</span><span class="p">,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="p">):</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="k">continue</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="n">param_py_type_hint</span> <span class="o">=</span> <span class="n">type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Any</span><span class="p">)</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param_py_type_hint</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>                <span class="n">param_py_type_hint</span> <span class="o">=</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="n">param_py_type_hint</span><span class="p">)</span><span class="o">.</span><span class="n">_evaluate</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>                    <span class="n">globalns</span><span class="p">,</span> <span class="p">{},</span> <span class="n">recursive_guard</span><span class="o">=</span><span class="nb">frozenset</span><span class="p">()</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>                <span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>                <span class="n">param_py_type_hint</span> <span class="o">=</span> <span class="n">Any</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="n">is_optional_from_union_type</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="n">actual_param_type_for_schema</span> <span class="o">=</span> <span class="n">param_py_type_hint</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="n">origin</span> <span class="o">=</span> <span class="n">get_origin</span><span class="p">(</span><span class="n">param_py_type_hint</span><span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="n">args</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">(</span><span class="n">param_py_type_hint</span><span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="k">if</span> <span class="n">origin</span> <span class="ow">is</span> <span class="n">Union</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="n">args</span> <span class="ow">or</span> <span class="p">[]):</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="n">is_optional_from_union_type</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>            <span class="k">if</span> <span class="n">args</span><span class="p">:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>                <span class="n">non_none_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)]</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">non_none_args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>                    <span class="n">actual_param_type_for_schema</span> <span class="o">=</span> <span class="n">non_none_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>                    <span class="n">actual_param_type_for_schema</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">non_none_args</span><span class="p">)]</span>  <span class="c1"># Keep as Union of non-None</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="n">param_schema_def</span> <span class="o">=</span> <span class="n">_map_type_to_json_schema</span><span class="p">(</span><span class="n">actual_param_type_for_schema</span><span class="p">)</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="c1"># --- FIX: Default to &#39;string&#39; if schema is empty (from Any type) ---</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">param_schema_def</span><span class="p">:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="n">param_schema_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;string&quot;</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="n">param_schema_def</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">param_descriptions_from_doc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Parameter &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="c1"># Handle optionality by adding &quot;null&quot; to the type list</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="k">if</span> <span class="n">is_optional_from_union_type</span><span class="p">:</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">param_schema_def</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param_schema_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                <span class="n">param_schema_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">param_schema_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">],</span> <span class="s2">&quot;null&quot;</span><span class="p">]</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="k">elif</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">param_schema_def</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param_schema_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>                <span class="k">if</span> <span class="s2">&quot;null&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">param_schema_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>                    <span class="n">param_schema_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;null&quot;</span><span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="n">inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_optional_from_union_type</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">FRAMEWORK_INJECTED_PARAMS</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>                <span class="n">required_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>            <span class="n">param_schema_def</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">default</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="n">properties</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">param_schema_def</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="n">input_schema</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span> <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="n">properties</span><span class="p">}</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="k">if</span> <span class="n">required_params</span><span class="p">:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="n">input_schema</span><span class="p">[</span><span class="s2">&quot;required&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">required_params</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="n">return_py_type_hint</span> <span class="o">=</span> <span class="n">type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;return&quot;</span><span class="p">,</span> <span class="n">Any</span><span class="p">)</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">return_py_type_hint</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="n">return_py_type_hint</span> <span class="o">=</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="n">return_py_type_hint</span><span class="p">)</span><span class="o">.</span><span class="n">_evaluate</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>                <span class="n">globalns</span><span class="p">,</span> <span class="p">{},</span> <span class="n">recursive_guard</span><span class="o">=</span><span class="nb">frozenset</span><span class="p">()</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>            <span class="p">)</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="n">return_py_type_hint</span> <span class="o">=</span> <span class="n">Any</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">actual_return_type_for_schema</span> <span class="o">=</span> <span class="n">return_py_type_hint</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="n">ret_origin</span> <span class="o">=</span> <span class="n">get_origin</span><span class="p">(</span><span class="n">return_py_type_hint</span><span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="n">ret_args</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">(</span><span class="n">return_py_type_hint</span><span class="p">)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="k">if</span> <span class="n">ret_origin</span> <span class="ow">is</span> <span class="n">Union</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ret_args</span> <span class="ow">or</span> <span class="p">[]):</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="k">if</span> <span class="n">ret_args</span><span class="p">:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="n">actual_return_type_for_schema</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ret_args</span> <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)),</span> <span class="n">Any</span><span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">output_schema_prop_def</span> <span class="o">=</span> <span class="n">_map_type_to_json_schema</span><span class="p">(</span><span class="n">actual_return_type_for_schema</span><span class="p">)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">output_schema_prop_def</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="n">output_schema_prop_def</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">}</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="n">output_schema</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span> <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="n">output_schema_prop_def</span><span class="p">}}</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="n">output_schema_prop_def</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;null&quot;</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">output_schema_prop_def</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">),</span> <span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="ow">and</span> <span class="s2">&quot;null&quot;</span> <span class="ow">in</span> <span class="n">output_schema_prop_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>            <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">output_schema_prop_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="p">)</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="ow">and</span> <span class="n">output_schema_prop_def</span> <span class="o">!=</span> <span class="p">{}</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="p">):</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="n">output_schema</span><span class="p">[</span><span class="s2">&quot;required&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="n">tool_metadata</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="s2">&quot;identifier&quot;</span><span class="p">:</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="s2">&quot;description_human&quot;</span><span class="p">:</span> <span class="n">main_description</span><span class="p">,</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="s2">&quot;description_llm&quot;</span><span class="p">:</span> <span class="n">main_description</span><span class="p">,</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="s2">&quot;input_schema&quot;</span><span class="p">:</span> <span class="n">input_schema</span><span class="p">,</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="s2">&quot;output_schema&quot;</span><span class="p">:</span> <span class="n">output_schema</span><span class="p">,</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="s2">&quot;key_requirements&quot;</span><span class="p">:</span> <span class="p">[],</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;decorated_tool&quot;</span><span class="p">],</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="s2">&quot;cacheable&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="p">}</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">iscoroutinefunction</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>            <span class="k">return</span> <span class="k">await</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="n">wrapper</span><span class="o">.</span><span class="n">_tool_metadata_</span> <span class="o">=</span> <span class="n">tool_metadata</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="n">wrapper</span><span class="o">.</span><span class="n">_original_function_</span> <span class="o">=</span> <span class="n">func</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="k">return</span> <span class="n">wrapper</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div></section><section class="print-page" id="api-core_types" heading-number="3.4"><h1 id="api-core_types-api-core_types">Core Types</h1><h3 id="docsapicore_typesmd">docs/api/core_types.md<a class="headerlink" href="#api-core_types-docsapicore_typesmd" title="Permanent link">&para;</a></h3>
<h1 id="api-core_types-core-types">Core Types<a class="headerlink" href="#api-core_types-core-types" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<h2 id="api-core_types-genie_tooling.core.types" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">genie_tooling.core.types</span>


<a href="#api-core_types-genie_tooling.core.types" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>Core shared types and protocols for the middleware.</p>









  <div class="doc doc-children">






<h3 id="api-core_types-genie_tooling.core.types-classes">Classes<a href="#api-core_types-genie_tooling.core.types-classes" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-class">



<h4 id="api-core_types-genie_tooling.core.types.Plugin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">Plugin</span>


<a href="#api-core_types-genie_tooling.core.types.Plugin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.core.types.Plugin" optional hover>Protocol</autoref></code></p>


        <p>Base protocol for all plugins.</p>










  <div class="doc doc-children">







<h5 id="api-core_types-genie_tooling.core.types.Plugin-functions">Functions<a href="#api-core_types-genie_tooling.core.types.Plugin-functions" class="headerlink" title="Permanent link">&para;</a></h5>

<div class="doc doc-object doc-function">


<h6 id="api-core_types-genie_tooling.core.types.Plugin.setup" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">setup</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-core_types-genie_tooling.core.types.Plugin.setup" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-core_types-__codelineno-0-1"></a><span class="nf">setup</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Optional asynchronous setup method for plugins. Called after instantiation.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/core/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-core_types-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-core_types-__codelineno-0-26">26</a></span>
<span class="normal"><a href="#api-core_types-__codelineno-0-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Optional asynchronous setup method for plugins. Called after instantiation.&quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="api-core_types-genie_tooling.core.types.Plugin.teardown" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">teardown</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#api-core_types-genie_tooling.core.types.Plugin.teardown" class="headerlink" title="Permanent link">&para;</a></h6>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-core_types-__codelineno-0-1"></a><span class="nf">teardown</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Optional asynchronous teardown method for plugins. Called before application shutdown.</p>


            <details class="quote">
              <summary>Source code in <code>src/genie_tooling/core/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-core_types-__codelineno-0-29">29</a></span>
<span class="normal"><a href="#api-core_types-__codelineno-0-30">30</a></span>
<span class="normal"><a href="#api-core_types-__codelineno-0-31">31</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Optional asynchronous teardown method for plugins. Called before application shutdown.&quot;&quot;&quot;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-core_types-genie_tooling.core.types.Document" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">Document</span>


<a href="#api-core_types-genie_tooling.core.types.Document" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.core.types.Document" optional hover>Protocol</autoref></code></p>


        <p>Represents a loaded document before splitting.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-core_types-genie_tooling.core.types.Chunk" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">Chunk</span>


<a href="#api-core_types-genie_tooling.core.types.Chunk" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.core.types.Chunk" optional hover>Protocol</autoref></code></p>


        <p>Represents a chunk of a document after splitting.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-core_types-genie_tooling.core.types.RetrievedChunk" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">RetrievedChunk</span>


<a href="#api-core_types-genie_tooling.core.types.RetrievedChunk" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="genie_tooling.core.types.Chunk" backlink-type="subclassed-by" backlink-anchor="genie_tooling.core.types.RetrievedChunk" optional hover>Chunk</autoref></code>, <code><autoref identifier="typing.Protocol" backlink-type="subclassed-by" backlink-anchor="genie_tooling.core.types.RetrievedChunk" optional hover>Protocol</autoref></code></p>


        <p>Represents a chunk retrieved from a vector store, with a relevance score.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="api-core_types-genie_tooling.core.types.StructuredError" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">StructuredError</span>


<a href="#api-core_types-genie_tooling.core.types.StructuredError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="typing.TypedDict" backlink-type="subclassed-by" backlink-anchor="genie_tooling.core.types.StructuredError" optional hover>TypedDict</autoref></code></p>


        <p>Standardized structure for reporting errors, especially to LLMs.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div></section><section class="print-page" id="api-plugin_manager" heading-number="3.5"><h1 id="api-plugin_manager-api-plugin_manager">Plugin Manager</h1><h3 id="docsapiplugin_managermd">docs/api/plugin_manager.md<a class="headerlink" href="#api-plugin_manager-docsapiplugin_managermd" title="Permanent link">&para;</a></h3>
<h1 id="api-plugin_manager-plugin-manager">Plugin Manager<a class="headerlink" href="#api-plugin_manager-plugin-manager" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<h2 id="api-plugin_manager-genie_tooling.core.plugin_manager" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">genie_tooling.core.plugin_manager</span>


<a href="#api-plugin_manager-genie_tooling.core.plugin_manager" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>PluginManager for discovering, loading, and managing plugins.</p>









  <div class="doc doc-children">






<h3 id="api-plugin_manager-genie_tooling.core.plugin_manager-classes">Classes<a href="#api-plugin_manager-genie_tooling.core.plugin_manager-classes" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-class">



<h4 id="api-plugin_manager-genie_tooling.core.plugin_manager.PluginManager" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">PluginManager</span>


<a href="#api-plugin_manager-genie_tooling.core.plugin_manager.PluginManager" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#api-plugin_manager-__codelineno-0-1"></a><span class="nf">PluginManager</span><span class="p">(</span><span class="n">plugin_dev_dirs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>Manages discovery, loading, and access to plugins.
Implements Hybrid: Entry Points + Configured Dev Directory discovery.</p>







                  <details class="quote">
                    <summary>Source code in <code>src/genie_tooling/core/plugin_manager.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#api-plugin_manager-__codelineno-0-21">21</a></span>
<span class="normal"><a href="#api-plugin_manager-__codelineno-0-22">22</a></span>
<span class="normal"><a href="#api-plugin_manager-__codelineno-0-23">23</a></span>
<span class="normal"><a href="#api-plugin_manager-__codelineno-0-24">24</a></span>
<span class="normal"><a href="#api-plugin_manager-__codelineno-0-25">25</a></span>
<span class="normal"><a href="#api-plugin_manager-__codelineno-0-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plugin_dev_dirs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">plugin_dev_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">plugin_dev_dirs</span><span class="p">]</span> <span class="k">if</span> <span class="n">plugin_dev_dirs</span> <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_plugin_instances</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Plugin</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_discovered_plugin_classes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="n">Plugin</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_plugin_source_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PluginManager initialized. Dev dirs: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plugin_dev_dirs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div></section><section class="print-page" id="api-config_models" heading-number="3.6"><h1 id="api-config_models-api-config_models">MiddlewareConfig</h1><h3 id="docsapiconfig_modelsmd">docs/api/config_models.md<a class="headerlink" href="#api-config_models-docsapiconfig_modelsmd" title="Permanent link">&para;</a></h3>
<h1 id="api-config_models-middlewareconfig">MiddlewareConfig<a class="headerlink" href="#api-config_models-middlewareconfig" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<h2 id="api-config_models-genie_tooling.config.models" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">genie_tooling.config.models</span>


<a href="#api-config_models-genie_tooling.config.models" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">









  <div class="doc doc-children">






<h3 id="api-config_models-genie_tooling.config.models-classes">Classes<a href="#api-config_models-genie_tooling.config.models-classes" class="headerlink" title="Permanent link">&para;</a></h3>




  </div>

    </div>

</div></section><section class="print-page" id="api-config_features" heading-number="3.7"><h1 id="api-config_features-api-config_features">FeatureSettings</h1><h3 id="docsapiconfig_featuresmd">docs/api/config_features.md<a class="headerlink" href="#api-config_features-docsapiconfig_featuresmd" title="Permanent link">&para;</a></h3>
<h1 id="api-config_features-featuresettings">FeatureSettings<a class="headerlink" href="#api-config_features-featuresettings" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<h2 id="api-config_features-genie_tooling.config.features" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">genie_tooling.config.features</span>


<a href="#api-config_features-genie_tooling.config.features" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">









  <div class="doc doc-children">






<h3 id="api-config_features-genie_tooling.config.features-classes">Classes<a href="#api-config_features-genie_tooling.config.features-classes" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-class">



<h4 id="api-config_features-genie_tooling.config.features.FeatureSettings" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">FeatureSettings</span>


<a href="#api-config_features-genie_tooling.config.features.FeatureSettings" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="pydantic.BaseModel" backlink-type="subclassed-by" backlink-anchor="genie_tooling.config.features.FeatureSettings" optional hover>BaseModel</autoref></code></p>


        <p>Defines high-level, user-friendly feature toggles and default choices
for initializing the Genie middleware. This model is processed by
ConfigResolver to populate the more detailed MiddlewareConfig.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div></section></section>
                    <section class='print-page md-section' id='section-4' heading-number='4'>
                        <h1>Tutorials & Examples<a class='headerlink' href='#section-4' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="tutorials-e01_simple_agent_cli" heading-number="4.1"><h1 id="tutorials-e01_simple_agent_cli-tutorial-simple-agent-cli-e01">Tutorial: Simple Agent CLI (E01)<a class="headerlink" href="#tutorials-e01_simple_agent_cli-tutorial-simple-agent-cli-e01" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E01_simple_agent_cli.py</code>.</p>
<p>It demonstrates a basic command-line agent that does <strong>not</strong> use an LLM for tool selection. Instead, it shows how to:
- Configure the <code>simple_keyword</code> command processor, which maps keywords like "calculate" or "weather" to specific tool IDs.
- Explicitly enable the <code>calculator_tool</code> and <code>open_weather_map_tool</code> in <code>tool_configurations</code>.
- Use <code>genie.run_command()</code> to process user input. The keyword processor will find the tool and then prompt the user for the necessary parameters.</p>
<h2 id="tutorials-e01_simple_agent_cli-example-code">Example Code<a class="headerlink" href="#tutorials-e01_simple_agent_cli-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e01_simple_agent_cli-examplese01_simple_agent_clipy">examples/E01_simple_agent_cli.py<a class="headerlink" href="#tutorials-e01_simple_agent_cli-examplese01_simple_agent_clipy" title="Permanent link">&para;</a></h1>
<p>"""
Example: Simple Agent CLI (Refactored for Genie Facade)</p>
<hr />
<p>This example demonstrates a basic command-line agent that uses the Genie
facade to interact with tools, configured via FeatureSettings.</p>
<p>To Run:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras</code>).
2. Set an environment variable for OpenWeatherMap API key if you want to test that tool:
   <code>export OPENWEATHERMAP_API_KEY="your_actual_key"</code>
3. Run from the root of the project:
   <code>poetry run python examples/E01_simple_agent_cli.py</code></p>
<p>The agent will:
- Initialize Genie with a simple keyword command processor.
- Ask for your input (e.g., "calculate 10 + 5", "weather in London").
- Use genie.run_command() to process the input and execute the tool.
- Display the result.
"""
import asyncio
import json
import logging
import os
from typing import Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie</p>
<h1 id="tutorials-e01_simple_agent_cli-genie-uses-environmentkeyprovider-by-default-if-no-key_provider_instance-is-given">Genie uses EnvironmentKeyProvider by default if no key_provider_instance is given<a class="headerlink" href="#tutorials-e01_simple_agent_cli-genie-uses-environmentkeyprovider-by-default-if-no-key_provider_instance-is-given" title="Permanent link">&para;</a></h1>
<h1 id="tutorials-e01_simple_agent_cli-and-key_provider_id-is-not-set-or-set-to-env_keys-in-middlewareconfig">and key_provider_id is not set or set to "env_keys" in MiddlewareConfig.<a class="headerlink" href="#tutorials-e01_simple_agent_cli-and-key_provider_id-is-not-set-or-set-to-env_keys-in-middlewareconfig" title="Permanent link">&para;</a></h1>
<p>async def run_simple_agent_cli():
    print("--- Simple Agent CLI (Genie Facade Version) ---")</p>
<div class="highlight"><pre><span></span><code># 1. Configure Middleware using FeatureSettings
app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;none&quot;, # Using simple_keyword, no LLM needed for command processing itself
        command_processor=&quot;simple_keyword&quot;,
        # No RAG or complex tool lookup needed for this basic CLI
        rag_embedder=&quot;none&quot;,
        tool_lookup=&quot;none&quot;,
    ),
    # Configure the simple_keyword_processor
    command_processor_configurations={
        &quot;simple_keyword_processor_v1&quot;: { # Canonical ID
            &quot;keyword_map&quot;: {
                &quot;calculate&quot;: &quot;calculator_tool&quot;,
                &quot;math&quot;: &quot;calculator_tool&quot;,
                &quot;add&quot;: &quot;calculator_tool&quot;,
                &quot;plus&quot;: &quot;calculator_tool&quot;,
                &quot;weather&quot;: &quot;open_weather_map_tool&quot;,
                &quot;forecast&quot;: &quot;open_weather_map_tool&quot;,
            },
            &quot;keyword_priority&quot;: [&quot;calculate&quot;, &quot;math&quot;, &quot;add&quot;, &quot;plus&quot;, &quot;weather&quot;, &quot;forecast&quot;]
        }
    },
    tool_configurations={
        # Explicitly enable the tools to be used
        &quot;calculator_tool&quot;: {},
        &quot;open_weather_map_tool&quot;: {}
        # No specific config needed for these tools if API keys are handled
        # by the default EnvironmentKeyProvider.
    }
)

# 2. Instantiate Genie
genie: Optional[Genie] = None
try:
    print(&quot;\nInitializing Genie facade...&quot;)
    # No key_provider_instance needed if using EnvironmentKeyProvider (default)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie facade initialized successfully!&quot;)

    # 3. CLI Loop
    print(&quot;\nType &#39;quit&#39; to exit.&quot;)
    if not os.getenv(&quot;OPENWEATHERMAP_API_KEY&quot;):
        print(&quot;Note: OPENWEATHERMAP_API_KEY not set. &#39;weather&#39; commands will select the tool but execution will fail.&quot;)

    while True:
        try:
            user_query = await asyncio.to_thread(input, &quot;\n&gt; Your query: &quot;)
        except KeyboardInterrupt:
            print(&quot;\nExiting...&quot;)
            break
        if user_query.lower() == &quot;quit&quot;:
            print(&quot;Exiting...&quot;)
            break
        if not user_query.strip():
            continue

        print(f&quot;Processing command: &#39;{user_query}&#39;&quot;)
        try:
            # genie.run_command will use the configured &#39;simple_keyword_processor_v1&#39;
            # which will prompt for parameters if a tool is matched.
            command_result = await genie.run_command(user_query)

            print(&quot;\nCommand Result:&quot;)
            if command_result:
                print(json.dumps(command_result, indent=2, default=str))
                if command_result.get(&quot;tool_result&quot;) and command_result[&quot;tool_result&quot;].get(&quot;error_message&quot;):
                    print(f&quot;Tool Execution Error: {command_result[&#39;tool_result&#39;][&#39;error_message&#39;]}&quot;)
                elif command_result.get(&quot;error&quot;):
                     print(f&quot;Command Processing Error: {command_result[&#39;error&#39;]}&quot;)
            else:
                print(&quot;Command did not produce a result.&quot;)

        except Exception as e:
            print(f&quot;An error occurred while processing the command: {e}&quot;)
            logging.exception(&quot;Error details:&quot;)

except Exception as e:
    print(f&quot;Failed to initialize or run agent: {e}&quot;)
    logging.exception(&quot;Initialization/runtime error details:&quot;)
finally:
    if genie:
        print(&quot;\nTearing down Genie facade...&quot;)
        await genie.close()
        print(&quot;Genie facade torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    logging.basicConfig(level=logging.INFO)
    # For more detailed library logs:
    # logging.getLogger("genie_tooling").setLevel(logging.DEBUG)
    asyncio.run(run_simple_agent_cli())</p></section><section class="print-page" id="tutorials-e02_ollama_chat_example" heading-number="4.2"><h1 id="tutorials-e02_ollama_chat_example-tutorial-ollama-chat-example-e02">Tutorial: Ollama Chat Example (E02)<a class="headerlink" href="#tutorials-e02_ollama_chat_example-tutorial-ollama-chat-example-e02" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E02_ollama_chat_example.py</code>.</p>
<p>It demonstrates the simplest way to interact with a Large Language Model using Genie. It shows how to:
- Use <code>FeatureSettings</code> to quickly configure Genie to use an Ollama provider (<code>llm="ollama"</code>).
- Specify the model to use (e.g., <code>mistral:latest</code>).
- Use <code>genie.llm.chat()</code> to send a message to the LLM and receive a response.</p>
<p><strong>Prerequisite</strong>: Ensure you have an Ollama instance running and the specified model pulled (e.g., <code>ollama pull mistral</code>).</p>
<h2 id="tutorials-e02_ollama_chat_example-example-code">Example Code<a class="headerlink" href="#tutorials-e02_ollama_chat_example-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e02_ollama_chat_example-examplese02_ollama_chat_examplepy">examples/E02_ollama_chat_example.py<a class="headerlink" href="#tutorials-e02_ollama_chat_example-examplese02_ollama_chat_examplepy" title="Permanent link">&para;</a></h1>
<p>"""
Example: Ollama Chat with Genie Facade</p>
<hr />
<p>This example demonstrates how to use the Genie facade to chat with an
Ollama-hosted LLM (e.g., Mistral).</p>
<p>To Run:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras</code>).
2. Ensure Ollama is running and the model 'mistral:latest' (or your chosen model) is pulled:
   <code>ollama serve</code>
   <code>ollama pull mistral</code>
3. Run from the root of the project:
   <code>poetry run python examples/E02_ollama_chat_example.py</code>
"""
import asyncio
import logging
from typing import List, Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie
from genie_tooling.llm_providers.types import ChatMessage</p>
<p>async def run_ollama_chat_demo():
    print("--- Ollama Chat Example ---")</p>
<div class="highlight"><pre><span></span><code>app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;ollama&quot;,
        llm_ollama_model_name=&quot;mistral:latest&quot; # Or any other model you have pulled
    )
)

genie: Optional[Genie] = None
try:
    print(&quot;\nInitializing Genie with Ollama...&quot;)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie initialized!&quot;)

    messages: List[ChatMessage] = [
        {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Hello, Ollama! Tell me a fun fact about llamas.&quot;}
    ]
    print(f&quot;\nSending to Ollama: {messages[0][&#39;content&#39;]}&quot;)

    response = await genie.llm.chat(messages)
    # Default provider is Ollama as per FeatureSettings

    assistant_response = response.get(&quot;message&quot;, {}).get(&quot;content&quot;, &quot;No content received.&quot;)
    print(f&quot;\nOllama says: {assistant_response}&quot;)

except Exception as e:
    print(f&quot;\nAn error occurred: {e}&quot;)
    logging.exception(&quot;Ollama chat error details:&quot;)
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    logging.basicConfig(level=logging.INFO)
    # logging.getLogger("genie_tooling").setLevel(logging.DEBUG)
    asyncio.run(run_ollama_chat_demo())</p></section><section class="print-page" id="tutorials-e03_openai_chat_example" heading-number="4.3"><h1 id="tutorials-e03_openai_chat_example-tutorial-openai-chat-example-e03">Tutorial: OpenAI Chat Example (E03)<a class="headerlink" href="#tutorials-e03_openai_chat_example-tutorial-openai-chat-example-e03" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E03_openai_chat_example.py</code>.</p>
<p>It demonstrates how to configure Genie to use the OpenAI API. It shows how to:
- Use <code>FeatureSettings</code> to select the OpenAI provider (<code>llm="openai"</code>).
- Specify the model to use (e.g., <code>gpt-3.5-turbo</code>).
- Rely on the default <code>EnvironmentKeyProvider</code> to automatically pick up the <code>OPENAI_API_KEY</code> from your environment variables.</p>
<p><strong>Prerequisite</strong>: You must have your <code>OPENAI_API_KEY</code> set as an environment variable.</p>
<h2 id="tutorials-e03_openai_chat_example-example-code">Example Code<a class="headerlink" href="#tutorials-e03_openai_chat_example-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e03_openai_chat_example-examplese03_openai_chat_examplepy">examples/E03_openai_chat_example.py<a class="headerlink" href="#tutorials-e03_openai_chat_example-examplese03_openai_chat_examplepy" title="Permanent link">&para;</a></h1>
<p>"""
Example: OpenAI Chat with Genie Facade</p>
<hr />
<p>This example demonstrates how to use the Genie facade to chat with an
OpenAI LLM (e.g., gpt-3.5-turbo).</p>
<p>To Run:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras</code>).
2. Set your OpenAI API key as an environment variable:
   <code>export OPENAI_API_KEY="your_openai_api_key"</code>
3. Run from the root of the project:
   <code>poetry run python examples/E03_openai_chat_example.py</code>
"""
import asyncio
import logging
import os
from typing import List, Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie
from genie_tooling.llm_providers.types import ChatMessage</p>
<p>async def run_openai_chat_demo():
    print("--- OpenAI Chat Example ---")</p>
<div class="highlight"><pre><span></span><code>if not os.getenv(&quot;OPENAI_API_KEY&quot;):
    print(&quot;ERROR: OPENAI_API_KEY environment variable not set. Please set it to run this demo.&quot;)
    return

app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;openai&quot;,
        llm_openai_model_name=&quot;gpt-3.5-turbo&quot;
    )
    # KeyProvider defaults to EnvironmentKeyProvider, which will pick up OPENAI_API_KEY
)

genie: Optional[Genie] = None
try:
    print(&quot;\nInitializing Genie with OpenAI...&quot;)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie initialized!&quot;)

    messages: List[ChatMessage] = [
        {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Hello, OpenAI! What is the capital of France?&quot;}
    ]
    print(f&quot;\nSending to OpenAI: {messages[0][&#39;content&#39;]}&quot;)

    response = await genie.llm.chat(messages) # Uses default provider (OpenAI)

    assistant_response = response.get(&quot;message&quot;, {}).get(&quot;content&quot;, &quot;No content received.&quot;)
    print(f&quot;\nOpenAI says: {assistant_response}&quot;)

except Exception as e:
    print(f&quot;\nAn error occurred: {e}&quot;)
    logging.exception(&quot;OpenAI chat error details:&quot;)
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    logging.basicConfig(level=logging.INFO)
    # logging.getLogger("genie_tooling").setLevel(logging.DEBUG)
    asyncio.run(run_openai_chat_demo())</p></section><section class="print-page" id="tutorials-e04_gemini_chat_example" heading-number="4.4"><h1 id="tutorials-e04_gemini_chat_example-tutorial-gemini-chat-example-e04">Tutorial: Gemini Chat Example (E04)<a class="headerlink" href="#tutorials-e04_gemini_chat_example-tutorial-gemini-chat-example-e04" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E04_gemini_chat_example.py</code>.</p>
<p>It demonstrates how to configure Genie to use the Google Gemini API. It shows how to:
- Use <code>FeatureSettings</code> to select the Gemini provider (<code>llm="gemini"</code>).
- Specify the model to use (e.g., <code>gemini-1.5-flash-latest</code>).
- Rely on the default <code>EnvironmentKeyProvider</code> to automatically pick up the <code>GOOGLE_API_KEY</code> from your environment variables.</p>
<p><strong>Prerequisite</strong>: You must have your <code>GOOGLE_API_KEY</code> set as an environment variable.</p>
<h2 id="tutorials-e04_gemini_chat_example-example-code">Example Code<a class="headerlink" href="#tutorials-e04_gemini_chat_example-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e04_gemini_chat_example-examplese04_gemini_chat_examplepy">examples/E04_gemini_chat_example.py<a class="headerlink" href="#tutorials-e04_gemini_chat_example-examplese04_gemini_chat_examplepy" title="Permanent link">&para;</a></h1>
<p>"""
Example: Gemini Chat with Genie Facade</p>
<hr />
<p>This example demonstrates how to use the Genie facade to chat with a
Google Gemini LLM (e.g., gemini-1.5-flash-latest).</p>
<p>To Run:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras --extras gemini</code>).
2. Set your Google API key as an environment variable:
   <code>export GOOGLE_API_KEY="your_google_api_key"</code>
3. Run from the root of the project:
   <code>poetry run python examples/E04_gemini_chat_example.py</code>
"""
import asyncio
import logging
import os
from typing import List, Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie
from genie_tooling.llm_providers.types import ChatMessage</p>
<p>async def run_gemini_chat_demo():
    print("--- Gemini Chat Example ---")</p>
<div class="highlight"><pre><span></span><code>if not os.getenv(&quot;GOOGLE_API_KEY&quot;):
    print(&quot;ERROR: GOOGLE_API_KEY environment variable not set. Please set it to run this demo.&quot;)
    return

app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;gemini&quot;,
        llm_gemini_model_name=&quot;gemini-1.5-flash-latest&quot;
    )
    # KeyProvider defaults to EnvironmentKeyProvider
)

genie: Optional[Genie] = None
try:
    print(&quot;\nInitializing Genie with Gemini...&quot;)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie initialized!&quot;)

    messages: List[ChatMessage] = [
        {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Hello, Gemini! Can you write a short poem about AI?&quot;}
    ]
    print(f&quot;\nSending to Gemini: {messages[0][&#39;content&#39;]}&quot;)

    response = await genie.llm.chat(messages) # Uses default provider (Gemini)

    assistant_response = response.get(&quot;message&quot;, {}).get(&quot;content&quot;, &quot;No content received.&quot;)
    print(f&quot;\nGemini says: {assistant_response}&quot;)

except Exception as e:
    print(f&quot;\nAn error occurred: {e}&quot;)
    logging.exception(&quot;Gemini chat error details:&quot;)
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    logging.basicConfig(level=logging.INFO)
    # logging.getLogger("genie_tooling").setLevel(logging.DEBUG)
    asyncio.run(run_gemini_chat_demo())</p></section><section class="print-page" id="tutorials-e05_rag_pipeline_demo" heading-number="4.5"><h1 id="tutorials-e05_rag_pipeline_demo-tutorial-rag-pipeline-demo-e05">Tutorial: RAG Pipeline Demo (E05)<a class="headerlink" href="#tutorials-e05_rag_pipeline_demo-tutorial-rag-pipeline-demo-e05" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E05_rag_pipeline_demo.py</code>.</p>
<p>It demonstrates how to set up and use a complete, local Retrieval Augmented Generation (RAG) pipeline. It shows how to:
- Configure a local RAG pipeline using <code>FeatureSettings</code> (Sentence Transformers for embeddings and FAISS for an in-memory vector store).
- Index documents from a local directory using <code>genie.rag.index_directory()</code>.
- Perform a similarity search on the indexed documents using <code>genie.rag.search()</code>.</p>
<h2 id="tutorials-e05_rag_pipeline_demo-example-code">Example Code<a class="headerlink" href="#tutorials-e05_rag_pipeline_demo-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e05_rag_pipeline_demo-examplese05_rag_pipeline_demopy">examples/E05_rag_pipeline_demo.py<a class="headerlink" href="#tutorials-e05_rag_pipeline_demo-examplese05_rag_pipeline_demopy" title="Permanent link">&para;</a></h1>
<p>"""
Example: RAG Pipeline Demo using Genie Facade (Updated)</p>
<hr />
<p>This example demonstrates setting up and using a RAG pipeline to index
local text files and perform similarity searches using the Genie facade
and FeatureSettings for simplified configuration.</p>
<p>To Run:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras</code>).
   You'll need dependencies for local RAG, e.g., sentence-transformers, faiss-cpu.
2. The script will create dummy data files in examples/data/ if they don't exist.
3. Run from the root of the project:
   <code>poetry run python examples/E05_rag_pipeline_demo.py</code></p>
<p>The demo will:
- Initialize the Genie facade using FeatureSettings for RAG components.
- Index documents from the 'examples/data/' directory.
- Perform a search query against the indexed documents.
- Print the search results.
"""
import asyncio
import logging
from pathlib import Path
from typing import Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie</p>
<p>async def main():
    print("--- RAG Pipeline Demo using Genie Facade (FeatureSettings) ---")</p>
<div class="highlight"><pre><span></span><code>current_file_dir = Path(__file__).parent
data_dir = current_file_dir / &quot;data&quot;
data_dir.mkdir(exist_ok=True) # Ensure data directory exists

# Create dummy files if they don&#39;t exist for the demo
doc1_path = data_dir / &quot;doc1.txt&quot;
doc2_path = data_dir / &quot;doc2.txt&quot;
doc3_path = data_dir / &quot;doc3.txt&quot;

if not doc1_path.exists(): doc1_path.write_text(&quot;The quick brown fox jumps over the lazy dog.\nLarge language models are transforming AI.&quot;)
if not doc2_path.exists(): doc2_path.write_text(&quot;Genie Tooling provides a hyper-pluggable middleware.\nRetrieval Augmented Generation enhances LLM responses.&quot;)
if not doc3_path.exists(): doc3_path.write_text(&quot;Python is a versatile programming language.\nAsync programming is key for I/O bound tasks.&quot;)


# 1. Configure Middleware using FeatureSettings for RAG
app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;none&quot;,
        command_processor=&quot;none&quot;,
        rag_embedder=&quot;sentence_transformer&quot;,
        rag_vector_store=&quot;faiss&quot;,
    )
)

genie: Optional[Genie] = None
try:
    print(&quot;\nInitializing Genie facade...&quot;)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie facade initialized.&quot;)

    collection_name_for_demo = &quot;my_local_rag_collection_e05&quot;
    print(f&quot;\nIndexing documents from &#39;{data_dir}&#39; into collection &#39;{collection_name_for_demo}&#39;...&quot;)

    index_result = await genie.rag.index_directory(
        str(data_dir),
        collection_name=collection_name_for_demo
    )
    print(f&quot;Indexing result: {index_result}&quot;)
    if index_result.get(&quot;status&quot;) != &quot;success&quot;:
        print(f&quot;ERROR: Indexing failed: {index_result.get(&#39;message&#39;)}&quot;)
        return

    query = &quot;What is Genie Tooling?&quot;
    print(f&quot;\nPerforming search for query: &#39;{query}&#39; in collection &#39;{collection_name_for_demo}&#39;&quot;)

    search_results = await genie.rag.search(
        query,
        collection_name=collection_name_for_demo,
        top_k=2
    )

    if not search_results:
        print(&quot;No search results found.&quot;)
    else:
        print(&quot;\nSearch Results:&quot;)
        for i, result_chunk in enumerate(search_results):
            print(f&quot;  --- Result {i+1} (Score: {result_chunk.score:.4f}, ID: {result_chunk.id}) ---&quot;)
            print(f&quot;  Content: {result_chunk.content[:200]}...&quot;)
            print(f&quot;  Metadata: {result_chunk.metadata}&quot;)
            print(&quot;  ------------------------------------&quot;)

except Exception as e:
    print(f&quot;\nAn unexpected error occurred: {e}&quot;)
    logging.exception(&quot;Error details:&quot;)
finally:
    if genie:
        print(&quot;\n--- Tearing down Genie facade ---&quot;)
        await genie.close()
        print(&quot;Genie facade teardown complete.&quot;)

    # Clean up dummy files (optional, but good for repeated test runs)
    # for p in [doc1_path, doc2_path, doc3_path]:
    #     p.unlink(missing_ok=True)
    # if data_dir.exists() and not any(data_dir.iterdir()): # Only remove if empty
    #     data_dir.rmdir()
    # For simplicity, we&#39;ll leave the data dir and files for now.
    # To fully clean up FAISS index files if they were persisted to default location:
    # default_faiss_path = Path(&quot;./.genie_data/faiss&quot;)
    # if default_faiss_path.exists():
    #     shutil.rmtree(default_faiss_path, ignore_errors=True)
    #     print(f&quot;Cleaned up FAISS data at {default_faiss_path}&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    logging.basicConfig(level=logging.INFO)
    # logging.getLogger("genie_tooling").setLevel(logging.DEBUG)
    asyncio.run(main())</p></section><section class="print-page" id="tutorials-e06_run_command_simple_keyword_example" heading-number="4.6"><h1 id="tutorials-e06_run_command_simple_keyword_example-tutorial-simple-keyword-command-e06">Tutorial: Simple Keyword Command (E06)<a class="headerlink" href="#tutorials-e06_run_command_simple_keyword_example-tutorial-simple-keyword-command-e06" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E06_run_command_simple_keyword_example.py</code>.</p>
<p>It demonstrates how to configure and use the <code>simple_keyword</code> command processor. This processor does not use an LLM. It shows how to:
- Define a <code>keyword_map</code> to associate keywords (like "calculate", "sum") with a specific tool (<code>calculator_tool</code>).
- Use <code>genie.run_command()</code>, which will trigger the processor to find the tool and then interactively prompt the user for the tool's parameters.</p>
<h2 id="tutorials-e06_run_command_simple_keyword_example-example-code">Example Code<a class="headerlink" href="#tutorials-e06_run_command_simple_keyword_example-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e06_run_command_simple_keyword_example-examplese06_run_command_simple_keyword_examplepy">examples/E06_run_command_simple_keyword_example.py<a class="headerlink" href="#tutorials-e06_run_command_simple_keyword_example-examplese06_run_command_simple_keyword_examplepy" title="Permanent link">&para;</a></h1>
<p>"""
Example: genie.run_command() with Simple Keyword Processor</p>
<hr />
<p>This example demonstrates using genie.run_command() with the
'simple_keyword' command processor.</p>
<p>To Run:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras</code>).
2. Run from the root of the project:
   <code>poetry run python examples/E06_run_command_simple_keyword_example.py</code>
"""
import asyncio
import json
import logging
from typing import Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie</p>
<p>async def run_simple_keyword_command_demo():
    print("--- Simple Keyword Command Processor Demo ---")</p>
<div class="highlight"><pre><span></span><code>app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;none&quot;, # No LLM needed for this processor
        command_processor=&quot;simple_keyword&quot;
    ),
    command_processor_configurations={
        &quot;simple_keyword_processor_v1&quot;: { # Canonical ID
            &quot;keyword_map&quot;: {
                &quot;calculate&quot;: &quot;calculator_tool&quot;,
                &quot;sum&quot;: &quot;calculator_tool&quot;,
                &quot;add&quot;: &quot;calculator_tool&quot;,
                &quot;plus&quot;: &quot;calculator_tool&quot;,
            },
            &quot;keyword_priority&quot;: [&quot;calculate&quot;, &quot;sum&quot;, &quot;add&quot;, &quot;plus&quot;]
        }
    },
    tool_configurations={
        &quot;calculator_tool&quot;: {} # Enable the calculator tool
    }
)

genie: Optional[Genie] = None
try:
    print(&quot;\nInitializing Genie...&quot;)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie initialized!&quot;)

    command_text = &quot;calculate 25 plus 75&quot;
    print(f&quot;\nRunning command: &#39;{command_text}&#39;&quot;)
    print(&quot;The SimpleKeywordToolSelectorProcessorPlugin will prompt for parameters if a tool is matched.&quot;)

    # For non-interactive, you&#39;d typically use execute_tool or an LLM-assisted processor.
    # This demo shows the prompting behavior.
    command_result = await genie.run_command(command_text)

    print(&quot;\nCommand Result:&quot;)
    if command_result:
        print(json.dumps(command_result, indent=2))
    else:
        print(&quot;Command did not produce a result.&quot;)

except Exception as e:
    print(f&quot;\nAn error occurred: {e}&quot;)
    logging.exception(&quot;Error details:&quot;)
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    logging.basicConfig(level=logging.INFO)
    asyncio.run(run_simple_keyword_command_demo())</p></section><section class="print-page" id="tutorials-e07_run_command_llm_assisted_example" heading-number="4.7"><h1 id="tutorials-e07_run_command_llm_assisted_example-tutorial-llm-assisted-command-e07">Tutorial: LLM-Assisted Command (E07)<a class="headerlink" href="#tutorials-e07_run_command_llm_assisted_example-tutorial-llm-assisted-command-e07" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E07_run_command_llm_assisted_example.py</code>.</p>
<p>It demonstrates the core agentic capability of using an LLM to interpret a natural language command. It shows how to:
- Configure the <code>llm_assisted</code> command processor.
- Configure an embedding-based <code>tool_lookup</code> service to help the LLM find relevant tools.
- Use <code>genie.run_command()</code>, which will leverage the LLM to select the correct tool and extract its parameters from the user's sentence, all in one step.</p>
<h2 id="tutorials-e07_run_command_llm_assisted_example-example-code">Example Code<a class="headerlink" href="#tutorials-e07_run_command_llm_assisted_example-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e07_run_command_llm_assisted_example-examplese07_run_command_llm_assisted_examplepy">examples/E07_run_command_llm_assisted_example.py<a class="headerlink" href="#tutorials-e07_run_command_llm_assisted_example-examplese07_run_command_llm_assisted_examplepy" title="Permanent link">&para;</a></h1>
<p>"""
Example: genie.run_command() with LLM-Assisted Processor</p>
<hr />
<p>This example demonstrates using genie.run_command() with the
'llm_assisted' command processor, using Ollama as the backing LLM.</p>
<p>To Run:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras</code>).
2. Ensure Ollama is running and 'mistral:latest' (or your chosen model) is pulled.
3. Run from the root of the project:
   <code>poetry run python examples/E07_run_command_llm_assisted_example.py</code>
"""
import asyncio
import json
import logging
from typing import Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie</p>
<p>async def run_llm_assisted_command_demo():
    print("--- LLM-Assisted Command Processor Demo (Ollama) ---")</p>
<div class="highlight"><pre><span></span><code>app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;ollama&quot;,
        llm_ollama_model_name=&quot;mistral:latest&quot;,
        command_processor=&quot;llm_assisted&quot;,
        # Use default compact_text_formatter for command_processor_formatter_id_alias
        # Use default embedding tool lookup with default ST embedder and compact_text_formatter
        tool_lookup=&quot;embedding&quot;,
    ),
    # Optional: Configure tool_lookup_top_k for the LLM-assisted processor
    command_processor_configurations={
        &quot;llm_assisted_tool_selection_processor_v1&quot;: { # Canonical ID
            &quot;tool_lookup_top_k&quot;: 3
        }
    },
    tool_configurations={
        # Ensure tools the LLM might select are enabled
        &quot;calculator_tool&quot;: {}
    }
)

genie: Optional[Genie] = None
try:
    print(&quot;\nInitializing Genie...&quot;)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie initialized!&quot;)

    command_text = &quot;What is 123 multiplied by 4?&quot;
    print(f&quot;\nRunning command: &#39;{command_text}&#39;&quot;)

    command_result = await genie.run_command(command_text)

    print(&quot;\nCommand Result:&quot;)
    if command_result:
        print(json.dumps(command_result, indent=2, default=str))
        if command_result.get(&quot;tool_result&quot;, {}).get(&quot;error_message&quot;):
             print(f&quot;Tool Execution Error: {command_result[&#39;tool_result&#39;][&#39;error_message&#39;]}&quot;)
        elif command_result.get(&quot;error&quot;):
             print(f&quot;Command Processing Error: {command_result[&#39;error&#39;]}&quot;)
    else:
        print(&quot;Command did not produce a result.&quot;)

except Exception as e:
    print(f&quot;\nAn error occurred: {e}&quot;)
    logging.exception(&quot;Error details:&quot;)
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    logging.basicConfig(level=logging.INFO)
    # logging.getLogger("genie_tooling").setLevel(logging.DEBUG)
    asyncio.run(run_llm_assisted_command_demo())</p></section><section class="print-page" id="tutorials-e08_decorator_tool_example" heading-number="4.8"><h1 id="tutorials-e08_decorator_tool_example-tutorial-tool-decorator-e08">Tutorial: @tool Decorator (E08)<a class="headerlink" href="#tutorials-e08_decorator_tool_example-tutorial-tool-decorator-e08" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E08_decorator_tool_example.py</code>.</p>
<p>It demonstrates the easiest way to create custom tools in Genie. It shows how to:
- Define a standard Python function (sync or async).
- Apply the <code>@genie_tooling.tool</code> decorator to it, which automatically generates the necessary metadata and schema from the function's signature and docstring.
- Register the decorated function with <code>genie.register_tool_functions()</code>.
- Execute the tool directly using <code>genie.execute_tool()</code>.</p>
<h2 id="tutorials-e08_decorator_tool_example-example-code">Example Code<a class="headerlink" href="#tutorials-e08_decorator_tool_example-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e08_decorator_tool_example-examplese08_decorator_tool_examplepy">examples/E08_decorator_tool_example.py<a class="headerlink" href="#tutorials-e08_decorator_tool_example-examplese08_decorator_tool_examplepy" title="Permanent link">&para;</a></h1>
<p>"""
Example: Using the @tool Decorator</p>
<hr />
<p>This example demonstrates defining simple functions, decorating them with
@genie_tooling.tool, and registering them with Genie. By default, these
tools are automatically enabled for use.</p>
<p>To Run:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras</code>).
2. Run from the root of the project:
   <code>poetry run python examples/E08_decorator_tool_example.py</code>
"""
import asyncio
import logging
from typing import Optional</p>
<p>from genie_tooling import tool  # Import the decorator
from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie</p>
<h1 id="tutorials-e08_decorator_tool_example-1-define-your-functions-and-decorate-them">1. Define your functions and decorate them<a class="headerlink" href="#tutorials-e08_decorator_tool_example-1-define-your-functions-and-decorate-them" title="Permanent link">&para;</a></h1>
<p>@tool
async def greet_user(name: str, enthusiasm_level: int = 1) -&gt; str:
    """
    Greets a user with a specified level of enthusiasm.</p>
<div class="highlight"><pre><span></span><code>Args:
    name (str): The name of the user to greet.
    enthusiasm_level (int): How enthusiastic the greeting should be (1-3).

Returns:
    str: The generated greeting message.
&quot;&quot;&quot;
if not 1 &lt;= enthusiasm_level &lt;= 3:
    return f&quot;Sorry {name}, I can only be enthusiastic from level 1 to 3.&quot;

greeting = f&quot;Hello, {name}&quot;
greeting += &quot;!&quot; * enthusiasm_level
return greeting
</code></pre></div>
<p>@tool
def simple_math_operation(a: float, b: float, operation: str = "add") -&gt; float:
    """
    Performs a simple math operation.
    Args:
        a (float): First number.
        b (float): Second number.
        operation (str): 'add' or 'subtract'.
    Returns:
        float: The result of the operation.
    """
    if operation == "add":
        return a + b
    elif operation == "subtract":
        return a - b
    raise ValueError("Unknown operation for simple_math_operation")</p>
<p>async def run_decorator_tool_demo():
    print("--- @tool Decorator Example ---")</p>
<div class="highlight"><pre><span></span><code># By default, `auto_enable_registered_tools` is True, so we don&#39;t need
# to list the decorated tools in `tool_configurations` to enable them.
# For production, set `auto_enable_registered_tools=False` and explicitly
# list all tools you want to activate.
app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;none&quot;,
        command_processor=&quot;none&quot;
    ),
    # tool_configurations is empty because our tools are auto-enabled.
    tool_configurations={}
)

genie: Optional[Genie] = None
try:
    print(&quot;\nInitializing Genie...&quot;)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie initialized!&quot;)

    # 2. Register the decorated functions with Genie
    await genie.register_tool_functions([greet_user, simple_math_operation])
    print(&quot;Decorated functions registered and auto-enabled.&quot;)

    # 3. Execute the tools using their function names as identifiers
    print(&quot;\nExecuting &#39;greet_user&#39; tool...&quot;)
    greeting_result = await genie.execute_tool(
        &quot;greet_user&quot;,
        name=&quot;Alice&quot;,
        enthusiasm_level=3
    )
    print(f&quot;Result from greet_user: {greeting_result}&quot;)

    print(&quot;\nExecuting &#39;simple_math_operation&#39; tool...&quot;)
    math_result = await genie.execute_tool(
        &quot;simple_math_operation&quot;,
        a=10.5,
        b=5.5,
        operation=&quot;subtract&quot;
    )
    print(f&quot;Result from simple_math_operation: {math_result}&quot;)


except Exception as e:
    print(f&quot;\nAn error occurred: {e}&quot;)
    logging.exception(&quot;Error details:&quot;)
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    logging.basicConfig(level=logging.INFO)
    asyncio.run(run_decorator_tool_demo())</p></section><section class="print-page" id="tutorials-e09_web_rag_example" heading-number="4.9"><h1 id="tutorials-e09_web_rag_example-tutorial-web-rag-e09">Tutorial: Web RAG (E09)<a class="headerlink" href="#tutorials-e09_web_rag_example-tutorial-web-rag-e09" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E09_web_rag_example.py</code>.</p>
<p>It demonstrates how to use the RAG pipeline to ingest data directly from the web. It shows how to:
- Configure the <code>WebPageLoader</code> plugin (aliased as <code>web_page</code>).
- Use <code>genie.rag.index_web_page()</code> to fetch content from a URL, extract its main text, and index it into a vector store.
- Perform a semantic search over the ingested web content.</p>
<h2 id="tutorials-e09_web_rag_example-example-code">Example Code<a class="headerlink" href="#tutorials-e09_web_rag_example-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e09_web_rag_example-examplese09_web_rag_examplepy">examples/E09_web_rag_example.py<a class="headerlink" href="#tutorials-e09_web_rag_example-examplese09_web_rag_examplepy" title="Permanent link">&para;</a></h1>
<p>"""
Example: RAG with WebPageLoader using Genie Facade</p>
<hr />
<p>This example demonstrates indexing content from a web page and performing
a similarity search using the Genie facade and FeatureSettings.</p>
<p>To Run:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras</code>).
   You'll need dependencies for web loading (beautifulsoup4, trafilatura),
   local RAG (sentence-transformers, faiss-cpu).
2. Run from the root of the project:
   <code>poetry run python examples/E09_web_rag_example.py</code>
"""
import asyncio
import logging
from typing import Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie</p>
<p>async def run_web_rag_demo():
    print("--- Web Page RAG Demo ---")</p>
<div class="highlight"><pre><span></span><code># URL to index (Python&#39;s Getting Started page as an example)
web_page_url = &quot;https://www.python.org/about/gettingstarted/&quot;
collection_name = &quot;python_docs_web_collection_e09&quot;

app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;none&quot;, # Not needed for RAG indexing/search focus
        command_processor=&quot;none&quot;,

        rag_loader=&quot;web_page&quot;, # Use WebPageLoader by default
        rag_embedder=&quot;sentence_transformer&quot;,
        rag_vector_store=&quot;faiss&quot;, # In-memory FAISS for this demo
    ),
    # Optionally configure WebPageLoader (e.g., to use trafilatura)
    document_loader_configurations={
        &quot;web_page_loader_v1&quot;: { # Canonical ID
            &quot;use_trafilatura&quot;: True # Attempt to use trafilatura for better content extraction
        }
    }
)

genie: Optional[Genie] = None
try:
    print(&quot;\nInitializing Genie for Web RAG...&quot;)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie initialized!&quot;)

    # Index the web page
    print(f&quot;\nIndexing web page: {web_page_url} into collection &#39;{collection_name}&#39;...&quot;)
    index_result = await genie.rag.index_web_page(
        web_page_url,
        collection_name=collection_name
    )
    print(f&quot;Indexing result: {index_result}&quot;)
    if index_result.get(&quot;status&quot;) != &quot;success&quot;:
        print(f&quot;ERROR: Indexing failed: {index_result.get(&#39;message&#39;)}&quot;)
        return

    # Perform a search
    query = &quot;What are Python libraries?&quot;
    print(f&quot;\nPerforming search for: &#39;{query}&#39; in &#39;{collection_name}&#39;&quot;)
    search_results = await genie.rag.search(
        query,
        collection_name=collection_name,
        top_k=2
    )

    if not search_results:
        print(&quot;No search results found.&quot;)
    else:
        print(&quot;\nSearch Results:&quot;)
        for i, chunk in enumerate(search_results):
            print(f&quot;  --- Result {i+1} (Score: {chunk.score:.4f}) ---&quot;)
            print(f&quot;  Content: {chunk.content[:300]}...&quot;) # Print snippet
            print(f&quot;  Source: {chunk.metadata.get(&#39;url&#39;)}&quot;)
            print(&quot;  ------------------------------------&quot;)

except Exception as e:
    print(f&quot;\nAn error occurred: {e}&quot;)
    logging.exception(&quot;Web RAG demo error details:&quot;)
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    logging.basicConfig(level=logging.INFO)
    # logging.getLogger("genie_tooling").setLevel(logging.DEBUG) # For detailed logs
    asyncio.run(run_web_rag_demo())</p></section><section class="print-page" id="tutorials-e10_chroma_tool_lookup_showcase" heading-number="4.10"><h1 id="tutorials-e10_chroma_tool_lookup_showcase-tutorial-chromadb-tool-lookup-e10">Tutorial: ChromaDB Tool Lookup (E10)<a class="headerlink" href="#tutorials-e10_chroma_tool_lookup_showcase-tutorial-chromadb-tool-lookup-e10" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E10_chroma_tool_lookup_showcase.py</code>.</p>
<p>It demonstrates how to make the embedding-based tool lookup service persistent. It shows how to:
- Configure the <code>embedding</code> tool lookup provider to use ChromaDB as its backend via <code>FeatureSettings</code>.
- Specify a local path for the ChromaDB database, allowing tool embeddings to persist between application runs.
- Use the <code>llm_assisted</code> command processor, which will now benefit from this persistent tool index.</p>
<h2 id="tutorials-e10_chroma_tool_lookup_showcase-example-code">Example Code<a class="headerlink" href="#tutorials-e10_chroma_tool_lookup_showcase-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e10_chroma_tool_lookup_showcase-examplese10_chroma_tool_lookup_showcasepy">examples/E10_chroma_tool_lookup_showcase.py<a class="headerlink" href="#tutorials-e10_chroma_tool_lookup_showcase-examplese10_chroma_tool_lookup_showcasepy" title="Permanent link">&para;</a></h1>
<p>"""
Example: ChromaDB-backed Tool Lookup Showcase (Updated)</p>
<hr />
<p>This example demonstrates using ChromaDB for tool lookup via the
LLMAssistedCommandProcessor, configured using FeatureSettings.</p>
<p>To Run:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras</code>).
   You'll need dependencies for chromadb-client, sentence-transformers, and ollama.
2. Ensure Ollama is running and the model specified (e.g., 'mistral:latest') is pulled:
   <code>ollama serve</code>
   <code>ollama pull mistral</code>
3. Set OPENWEATHERMAP_API_KEY if you want the weather tool to execute successfully:
   <code>export OPENWEATHERMAP_API_KEY="your_key"</code>
4. Run from the root of the project:
   <code>poetry run python examples/E10_chroma_tool_lookup_showcase.py</code></p>
<p>The demo will:
- Initialize Genie with an LLM-assisted command processor.
- Configure tool lookup to use embeddings stored in ChromaDB.
- Process commands, demonstrating tool selection and execution.
"""
import asyncio
import json
import logging
import os
import shutil
from pathlib import Path
from typing import Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie</p>
<p>async def run_chroma_tool_lookup_showcase():
    print("--- ChromaDB-backed Tool Lookup Showcase (FeatureSettings) ---")</p>
<div class="highlight"><pre><span></span><code>current_file_dir = Path(__file__).parent
chroma_tool_embeddings_path_str = str(current_file_dir / &quot;chroma_db_tool_embeddings_e10&quot;)

# Clean up previous run&#39;s data
if Path(chroma_tool_embeddings_path_str).exists():
    print(f&quot;Cleaning up existing ChromaDB tool embeddings data at: {chroma_tool_embeddings_path_str}&quot;)
    shutil.rmtree(chroma_tool_embeddings_path_str)

tool_embeddings_collection_name = &quot;genie_tool_definitions_chroma_e10&quot;

# 1. Configure Middleware using FeatureSettings
app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;ollama&quot;,
        llm_ollama_model_name=&quot;mistral:latest&quot;,

        command_processor=&quot;llm_assisted&quot;,
        command_processor_formatter_id_alias=&quot;compact_text_formatter&quot;,

        tool_lookup=&quot;embedding&quot;,
        tool_lookup_formatter_id_alias=&quot;compact_text_formatter&quot;,
        tool_lookup_embedder_id_alias=&quot;st_embedder&quot;,
        tool_lookup_chroma_path=chroma_tool_embeddings_path_str,
        tool_lookup_chroma_collection_name=tool_embeddings_collection_name,
    ),
    command_processor_configurations={
        &quot;llm_assisted_tool_selection_processor_v1&quot;: {
            &quot;tool_lookup_top_k&quot;: 3
        }
    },
    tool_configurations={
        &quot;calculator_tool&quot;: {},
        &quot;open_weather_map_tool&quot;: {}
    }
)

genie: Optional[Genie] = None
try:
    print(&quot;\nInitializing Genie facade...&quot;)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie facade initialized for ChromaDB-backed tool lookup.&quot;)
    print(f&quot;Tool embeddings will be indexed in ChromaDB at: {chroma_tool_embeddings_path_str}&quot;)
    print(f&quot;Using collection: {tool_embeddings_collection_name}&quot;)

    print(&quot;\n--- Using Tool Lookup via LLM-Assisted Command Processor ---&quot;)

    commands_to_test = [
        &quot;What is the sum of 15 and 30?&quot;,
        &quot;Tell me the current weather in Paris.&quot;
    ]

    if not os.getenv(&quot;OPENWEATHERMAP_API_KEY&quot;) and any(&quot;weather&quot; in cmd.lower() for cmd in commands_to_test):
        print(&quot;\nWARNING: OPENWEATHERMAP_API_KEY not set. Weather tool lookup might select the tool, but execution will likely fail.&quot;)
        print(&#39;You can set it with: export OPENWEATHERMAP_API_KEY=&quot;your_key&quot;\n&#39;)

    for cmd_text in commands_to_test:
        print(f&quot;\nProcessing command: &#39;{cmd_text}&#39;&quot;)
        try:
            command_result = await genie.run_command(command=cmd_text)
            if command_result:
                print(f&quot;  Thought Process: {command_result.get(&#39;thought_process&#39;)}&quot;)
                if command_result.get(&quot;tool_result&quot;):
                    print(f&quot;  Tool Result: {json.dumps(command_result[&#39;tool_result&#39;], indent=2)}&quot;)
                elif command_result.get(&quot;error&quot;):
                    print(f&quot;  Command Error: {command_result[&#39;error&#39;]}&quot;)
                elif command_result.get(&quot;message&quot;):
                    print(f&quot;  Message: {command_result[&#39;message&#39;]}&quot;)
                else:
                    print(f&quot;  Raw Command Result: {json.dumps(command_result, indent=2)}&quot;)
            else:
                print(&quot;  Command processor returned no result.&quot;)
        except Exception as e:
            print(f&quot;  Error processing command &#39;{cmd_text}&#39;: {e}&quot;)
            logging.exception(&quot;Command processing error details:&quot;)

    print(f&quot;\n[Persistence Demo] Tool definition embeddings are stored in ChromaDB at &#39;{chroma_tool_embeddings_path_str}&#39;.&quot;)
    print(&quot;You can inspect this directory after the script finishes.&quot;)

except Exception as e:
    print(f&quot;\nAn unexpected error occurred in the showcase: {e}&quot;)
    logging.exception(&quot;Showcase error details:&quot;)
finally:
    if genie:
        print(&quot;\nGenie facade tearing down...&quot;)
        await genie.close()
        print(&quot;Genie facade torn down.&quot;)
    # Optional: Clean up ChromaDB directory after test
    # if Path(chroma_tool_embeddings_path_str).exists():
    #     shutil.rmtree(chroma_tool_embeddings_path_str)
    #     print(f&quot;Cleaned up ChromaDB data at: {chroma_tool_embeddings_path_str}&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    logging.basicConfig(level=logging.INFO)
    # logging.getLogger("genie_tooling").setLevel(logging.DEBUG)
    asyncio.run(run_chroma_tool_lookup_showcase())</p></section><section class="print-page" id="tutorials-e11_advanced_showcase_agent" heading-number="4.11"><h1 id="tutorials-e11_advanced_showcase_agent-tutorial-advanced-showcase-e11">Tutorial: Advanced Showcase (E11)<a class="headerlink" href="#tutorials-e11_advanced_showcase_agent-tutorial-advanced-showcase-e11" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E11_advanced_showcase_agent.py</code>.</p>
<p>It demonstrates a more complex configuration, combining multiple features and plugins. It shows how to:
- Configure multiple LLM providers (<code>ollama</code>, <code>openai</code>, <code>gemini</code>) and select them at runtime.
- Configure multiple command processors (<code>llm_assisted</code>, <code>simple_keyword</code>) and select them at runtime.
- Use a custom <code>KeyProvider</code> for fetching API keys.
- Combine RAG, command processing, and direct tool execution in a single application.</p>
<h2 id="tutorials-e11_advanced_showcase_agent-example-code">Example Code<a class="headerlink" href="#tutorials-e11_advanced_showcase_agent-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e11_advanced_showcase_agent-examplese11_advanced_showcase_agentpy">examples/E11_advanced_showcase_agent.py<a class="headerlink" href="#tutorials-e11_advanced_showcase_agent-examplese11_advanced_showcase_agentpy" title="Permanent link">&para;</a></h1>
<p>"""
Example: Advanced Agent Showcase using Genie Facade</p>
<hr />
<p>This example demonstrates configuring and using various components of the
Genie Tooling middleware through the Genie facade.
"""
import asyncio
import json
import logging
import os
from typing import List, Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.core.types import Plugin as CorePluginType
from genie_tooling.genie import Genie
from genie_tooling.llm_providers.types import ChatMessage
from genie_tooling.security.key_provider import KeyProvider</p>
<p>logger = logging.getLogger(<strong>name</strong>)</p>
<h1 id="tutorials-e11_advanced_showcase_agent--1-custom-keyprovider-">--- 1. Custom KeyProvider ---<a class="headerlink" href="#tutorials-e11_advanced_showcase_agent--1-custom-keyprovider-" title="Permanent link">&para;</a></h1>
<p>class DemoKeyProvider(KeyProvider, CorePluginType):
    plugin_id: str = "demo_showcase_key_provider_v1"
    async def get_key(self, key_name: str) -&gt; Optional[str]:
        val = os.environ.get(key_name)
        if not val:
            print(f"[KeyProvider - Showcase] WARNING: Key '{key_name}' not found.")
        return val
    async def setup(self, config=None): print(f"[{self.plugin_id}] Setup.")
    async def teardown(self): print(f"[{self.plugin_id}] Teardown.")</p>
<p>async def main():
    print("--- Advanced Agent Showcase ---")
    key_provider_instance = DemoKeyProvider()</p>
<div class="highlight"><pre><span></span><code>app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;ollama&quot;, # Default LLM
        llm_ollama_model_name=&quot;mistral:latest&quot;,
        llm_openai_model_name=&quot;gpt-3.5-turbo&quot;, # For OpenAI provider if used
        llm_gemini_model_name=&quot;gemini-1.5-flash-latest&quot;, # For Gemini provider if used

        command_processor=&quot;llm_assisted&quot;, # Default command processor
        command_processor_formatter_id_alias=&quot;compact_text_formatter&quot;, # For LLM-assisted

        tool_lookup=&quot;embedding&quot;, # Default tool lookup
        tool_lookup_formatter_id_alias=&quot;compact_text_formatter&quot;, # For indexing
        tool_lookup_embedder_id_alias=&quot;st_embedder&quot;, # For tool lookup embeddings

        rag_loader=&quot;web_page&quot;, # Default RAG loader
        rag_embedder=&quot;sentence_transformer&quot;, # Default RAG embedder
        rag_vector_store=&quot;faiss&quot;, # Default RAG vector store
    ),
    default_log_level=&quot;INFO&quot;,

    llm_provider_configurations={
        &quot;ollama&quot;: { &quot;request_timeout_seconds&quot;: 180.0 },
        &quot;openai&quot;: { &quot;model_name&quot;: &quot;gpt-4-turbo-preview&quot; },
        &quot;gemini&quot;: {}
    },
    command_processor_configurations={
        &quot;simple_keyword_cmd_proc&quot;: { # Alias for simple_keyword_processor_v1
            &quot;keyword_map&quot;: {
                &quot;calculate&quot;: &quot;calculator_tool&quot;, &quot;math&quot;: &quot;calculator_tool&quot;,
                &quot;weather&quot;: &quot;open_weather_map_tool&quot;, &quot;forecast&quot;: &quot;open_weather_map_tool&quot;
            }
        },
        &quot;llm_assisted_cmd_proc&quot;: { # Alias for llm_assisted_tool_selection_processor_v1
            &quot;tool_lookup_top_k&quot;: 3
        }
    },
    tool_configurations={ # Tools must be enabled
        &quot;calculator_tool&quot;: {},
        &quot;open_weather_map_tool&quot;: {},
        &quot;generic_code_execution_tool&quot;: {}
    }
)

genie: Optional[Genie] = None
try:
    print(&quot;\nInitializing Genie facade with showcase configuration...&quot;)
    genie = await Genie.create(config=app_config, key_provider_instance=key_provider_instance)
    print(&quot;Genie facade initialized.&quot;)

    # --- 1. LLM Interaction ---
    print(&quot;\n--- LLM Showcase ---&quot;)
    if os.getenv(&quot;OPENAI_API_KEY&quot;):
        try:
            print(&quot;Trying OpenAI LLM (gpt-4-turbo-preview) for chat...&quot;)
            chat_messages: List[ChatMessage] = [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;What is the capital of France?&quot;}]
            openai_response = await genie.llm.chat(messages=chat_messages, provider_id=&quot;openai&quot;)
            print(f&quot;OpenAI Response: {openai_response[&#39;message&#39;][&#39;content&#39;]}&quot;)
        except Exception as e:
            print(f&quot;Error with OpenAI LLM: {e}&quot;)
    else:
        print(&quot;Skipping OpenAI LLM showcase (OPENAI_API_KEY not set).&quot;)

    try:
        print(&quot;\nTrying default LLM (Ollama/Mistral) for generation...&quot;)
        ollama_response = await genie.llm.generate(&quot;Explain RAG in one sentence.&quot;, options={&quot;temperature&quot;: 0.7})
        print(f&quot;Ollama/Mistral Response: {ollama_response[&#39;text&#39;]}&quot;)
    except Exception as e:
        print(f&quot;Error with Ollama LLM: {e}&quot;)

    # --- 2. RAG Showcase ---
    print(&quot;\n--- RAG Showcase ---&quot;)
    rag_collection = &quot;showcase_rag_collection_e11&quot;
    dummy_url = &quot;https://www.python.org/about/gettingstarted/&quot;
    try:
        print(f&quot;Indexing web page: {dummy_url} into collection &#39;{rag_collection}&#39;...&quot;)
        index_result = await genie.rag.index_web_page(dummy_url, collection_name=rag_collection)
        print(f&quot;Web page indexing result: {json.dumps(index_result, indent=2)}&quot;)
        if index_result.get(&quot;status&quot;) == &quot;success&quot;:
            rag_results = await genie.rag.search(&quot;What are Python libraries?&quot;, collection_name=rag_collection, top_k=1)
            if rag_results:
                print(f&quot;Top RAG: {rag_results[0].content[:300]}... (Source: {rag_results[0].metadata.get(&#39;url&#39;)})&quot;)
    except Exception as e:
        print(f&quot;Error during RAG showcase: {e}&quot;)

    # --- 3. Command Processing Showcase ---
    print(&quot;\n--- Command Processing Showcase ---&quot;)
    commands = [&quot;calculate 100 times 3.14&quot;, &quot;what&#39;s the weather like in London?&quot;]
    for cmd_text in commands:
        print(f&quot;\nProcessing command: &#39;{cmd_text}&#39; (using default LLM-assisted processor)&quot;)
        try:
            cmd_result = await genie.run_command(command=cmd_text)
            print(f&quot;Result: {json.dumps(cmd_result, indent=2, default=str)}&quot;)
        except Exception as e:
            print(f&quot;Error: {e}&quot;)

    print(&quot;\nProcessing command: &#39;sum 5 and 7&#39; (using simple_keyword processor)&quot;)
    try:
        keyword_cmd_result = await genie.run_command(&quot;sum 5 and 7&quot;, processor_id=&quot;simple_keyword_cmd_proc&quot;)
        print(f&quot;Keyword Result: {json.dumps(keyword_cmd_result, indent=2, default=str)}&quot;)
    except Exception as e:
        print(f&quot;Error: {e}&quot;)

    # --- 4. Direct Tool Invocation ---
    print(&quot;\n--- Direct Tool Invocation Showcase ---&quot;)
    if os.getenv(&quot;OPENWEATHERMAP_API_KEY&quot;):
        try:
            weather_result = await genie.execute_tool(&quot;open_weather_map_tool&quot;, city=&quot;New York, US&quot;, units=&quot;metric&quot;)
            print(f&quot;Direct Weather: {json.dumps(weather_result, indent=2)}&quot;)
        except Exception as e:
            print(f&quot;Error: {e}&quot;)
    else:
        print(&quot;Skipping direct OpenWeatherMapTool (OPENWEATHERMAP_API_KEY not set).&quot;)

except Exception as e:
    print(f&quot;\nUNEXPECTED CRITICAL error: {e}&quot;)
    import traceback
    traceback.print_exc()
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie facade torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    logging.basicConfig(level=logging.INFO)
    # logging.getLogger("genie_tooling").setLevel(logging.DEBUG)
    asyncio.run(main())</p></section><section class="print-page" id="tutorials-e12_custom_key_provider_example" heading-number="4.12"><h1 id="tutorials-e12_custom_key_provider_example-tutorial-custom-keyprovider-e12">Tutorial: Custom KeyProvider (E12)<a class="headerlink" href="#tutorials-e12_custom_key_provider_example-tutorial-custom-keyprovider-e12" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E12_custom_key_provider_example.py</code>.</p>
<p>It demonstrates how to implement and use a custom <code>KeyProvider</code> class. This is useful for integrating with custom secret management systems (like HashiCorp Vault, AWS Secrets Manager, etc.) instead of relying on environment variables. It shows how to:
- Create a class that implements the <code>KeyProvider</code> protocol.
- Implement the <code>async def get_key(...)</code> method.
- Pass an instance of your custom provider to <code>Genie.create()</code>.</p>
<h2 id="tutorials-e12_custom_key_provider_example-example-code">Example Code<a class="headerlink" href="#tutorials-e12_custom_key_provider_example-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e12_custom_key_provider_example-examplese12_custom_key_provider_examplepy">examples/E12_custom_key_provider_example.py<a class="headerlink" href="#tutorials-e12_custom_key_provider_example-examplese12_custom_key_provider_examplepy" title="Permanent link">&para;</a></h1>
<p>"""
Example: Using a Custom KeyProvider with Genie</p>
<hr />
<p>This example demonstrates how to implement a custom KeyProvider and
use it with the Genie facade, for instance, to fetch an OpenAI API key.</p>
<p>To Run:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras</code>).
2. Set an environment variable for your custom key provider to read:
   <code>export MY_APP_OPENAI_KEY="your_actual_openai_api_key"</code>
3. Run from the root of the project:
   <code>poetry run python examples/E12_custom_key_provider_example.py</code>
"""
import asyncio
import logging
import os
from typing import Any, Dict, List, Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.core.types import (
    Plugin as CorePluginType,
)
from genie_tooling.genie import Genie
from genie_tooling.llm_providers.types import ChatMessage
from genie_tooling.security.key_provider import KeyProvider</p>
<p>logger = logging.getLogger(<strong>name</strong>)</p>
<h1 id="tutorials-e12_custom_key_provider_example-1-implement-your-applications-keyprovider">1. Implement your application's KeyProvider<a class="headerlink" href="#tutorials-e12_custom_key_provider_example-1-implement-your-applications-keyprovider" title="Permanent link">&para;</a></h1>
<p>class MyAppCustomKeyProvider(KeyProvider, CorePluginType):
    plugin_id = "my_app_custom_key_provider_v1"</p>
<div class="highlight"><pre><span></span><code>async def get_key(self, key_name: str) -&gt; str | None:
    if key_name == &quot;OPENAI_API_KEY&quot;:
        return os.environ.get(&quot;MY_APP_OPENAI_KEY&quot;)
    logger.debug(f&quot;[{self.plugin_id}] Requested key &#39;{key_name}&#39;, not specifically handled by this provider.&quot;)
    return None

async def setup(self, config: Optional[Dict[str, Any]] = None):
    logger.info(f&quot;[{self.plugin_id}] Custom KeyProvider setup.&quot;)

async def teardown(self):
    logger.info(f&quot;[{self.plugin_id}] Custom KeyProvider teardown.&quot;)
</code></pre></div>
<p>async def run_custom_key_provider_demo():
    print("--- Custom KeyProvider Demo ---")</p>
<div class="highlight"><pre><span></span><code>if not os.getenv(&quot;MY_APP_OPENAI_KEY&quot;):
    print(&quot;ERROR: MY_APP_OPENAI_KEY environment variable not set. Please set it to run this demo.&quot;)
    return

my_key_provider = MyAppCustomKeyProvider()

app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;openai&quot;,
        llm_openai_model_name=&quot;gpt-3.5-turbo&quot;
    )
)

genie: Optional[Genie] = None
try:
    print(&quot;\nInitializing Genie with custom KeyProvider...&quot;)
    genie = await Genie.create(
        config=app_config,
        key_provider_instance=my_key_provider
    )
    print(&quot;Genie initialized!&quot;)

    messages: List[ChatMessage] = [
        {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Hello via custom KeyProvider! What&#39;s a fun fact?&quot;}
    ]
    print(f&quot;\nSending to OpenAI: {messages[0][&#39;content&#39;]}&quot;)

    response = await genie.llm.chat(messages)

    assistant_response = response.get(&quot;message&quot;, {}).get(&quot;content&quot;, &quot;No content received.&quot;)
    print(f&quot;\nOpenAI (via custom KeyProvider) says: {assistant_response}&quot;)

except Exception as e:
    print(f&quot;\nAn error occurred: {e}&quot;)
    logging.exception(&quot;Custom KeyProvider demo error details:&quot;)
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    logging.basicConfig(level=logging.INFO)
    # logging.getLogger("genie_tooling").setLevel(logging.DEBUG)
    asyncio.run(run_custom_key_provider_demo())</p></section><section class="print-page" id="tutorials-e13_google_search_demo" heading-number="4.13"><h1 id="tutorials-e13_google_search_demo-tutorial-google-search-tool-e13">Tutorial: Google Search Tool (E13)<a class="headerlink" href="#tutorials-e13_google_search_demo-tutorial-google-search-tool-e13" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E13_google_search_demo.py</code>.</p>
<p>It demonstrates how to use the built-in <code>GoogleSearchTool</code>. It shows how to:
- Enable the tool in <code>tool_configurations</code>.
- Provide the necessary API keys (<code>GOOGLE_API_KEY</code>, <code>GOOGLE_CSE_ID</code>) via environment variables.
- Execute the tool directly using <code>genie.execute_tool()</code>.</p>
<h2 id="tutorials-e13_google_search_demo-example-code">Example Code<a class="headerlink" href="#tutorials-e13_google_search_demo-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e13_google_search_demo-examplese13_google_search_demopy">examples/E13_google_search_demo.py<a class="headerlink" href="#tutorials-e13_google_search_demo-examplese13_google_search_demopy" title="Permanent link">&para;</a></h1>
<p>"""
Example: GoogleSearchTool Demo</p>
<hr />
<p>This example demonstrates configuring and using the GoogleSearchTool
via the Genie facade.</p>
<p>To Run:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras</code>).
2. Set Environment Variables:
   - <code>export GOOGLE_API_KEY="YOUR_GOOGLE_API_KEY"</code>
   - <code>export GOOGLE_CSE_ID="YOUR_CUSTOM_SEARCH_ENGINE_ID"</code>
   (Replace with your actual key and CSE ID from Google Cloud Console
    and Programmable Search Engine setup)
3. Run from the root of the project:
   <code>poetry run python examples/E13_google_search_demo.py</code></p>
<p>The demo will:
- Initialize Genie with the GoogleSearchTool.
- Perform a search query using the tool.
- Print the search results or an error message.
"""
import asyncio
import json
import logging
import os</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie</p>
<p>async def run_google_search_demo():
    print("--- GoogleSearchTool Demo ---")</p>
<div class="highlight"><pre><span></span><code>if not os.getenv(&quot;GOOGLE_API_KEY&quot;) or not os.getenv(&quot;GOOGLE_CSE_ID&quot;):
    print(&quot;\nERROR: Please set GOOGLE_API_KEY and GOOGLE_CSE_ID environment variables to run this demo.&quot;)
    print(&quot;Example: &quot;)
    print(&#39;  export GOOGLE_API_KEY=&quot;your_actual_api_key&quot;&#39;)
    print(&#39;  export GOOGLE_CSE_ID=&quot;your_actual_cse_id&quot;&#39;)
    return

app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;none&quot;,
        command_processor=&quot;none&quot;
    ),
    tool_configurations={
        &quot;google_search_tool_v1&quot;: {} # Enable the Google Search tool
    }
)

genie: Genie | None = None
try:
    genie = await Genie.create(config=app_config)
    print(&quot;Genie facade initialized.&quot;)

    search_query = &quot;What is Retrieval Augmented Generation?&quot;
    num_results_to_fetch = 3

    print(f&quot;\nAttempting to search for: &#39;{search_query}&#39; (max {num_results_to_fetch} results)...&quot;)
    search_result = await genie.execute_tool(
        &quot;google_search_tool_v1&quot;,
        query=search_query,
        num_results=num_results_to_fetch
    )

    print(&quot;\nSearch Result:&quot;)
    print(json.dumps(search_result, indent=2))

    if search_result.get(&quot;error&quot;):
        print(f&quot;\nSearch failed: {search_result[&#39;error&#39;]}&quot;)
    elif search_result.get(&quot;results&quot;):
        print(f&quot;\nSuccessfully retrieved {len(search_result[&#39;results&#39;])} results.&quot;)
        for i, item in enumerate(search_result[&quot;results&quot;]):
            print(f&quot;  Result {i+1}:&quot;)
            print(f&quot;    Title: {item.get(&#39;title&#39;)}&quot;)
            print(f&quot;    Link: {item.get(&#39;link&#39;)}&quot;)
            print(f&quot;    Snippet: {item.get(&#39;snippet&#39;)[:100]}...&quot;)
    else:
        print(&quot;\nSearch returned no results and no error.&quot;)

except Exception as e:
    print(f&quot;\nAn unexpected error occurred: {e}&quot;)
    import traceback
    traceback.print_exc()
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie facade torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    logging.basicConfig(level=logging.INFO)
    asyncio.run(run_google_search_demo())</p></section><section class="print-page" id="tutorials-e14_filesystem_tool_demo" heading-number="4.14"><h1 id="tutorials-e14_filesystem_tool_demo-tutorial-filesystem-tool-e14">Tutorial: FileSystem Tool (E14)<a class="headerlink" href="#tutorials-e14_filesystem_tool_demo-tutorial-filesystem-tool-e14" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E14_filesystem_tool_demo.py</code>.</p>
<p>It demonstrates how to configure and use the <code>SandboxedFileSystemTool</code> for safe file operations. It shows how to:
- Enable the tool and configure its <code>sandbox_base_path</code> in <code>tool_configurations</code>.
- Perform <code>write_file</code>, <code>read_file</code>, and <code>list_directory</code> operations.
- Verify that path traversal attempts outside the sandbox are prevented.</p>
<h2 id="tutorials-e14_filesystem_tool_demo-example-code">Example Code<a class="headerlink" href="#tutorials-e14_filesystem_tool_demo-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e14_filesystem_tool_demo-examplese14_filesystem_tool_demopy">examples/E14_filesystem_tool_demo.py<a class="headerlink" href="#tutorials-e14_filesystem_tool_demo-examplese14_filesystem_tool_demopy" title="Permanent link">&para;</a></h1>
<p>"""
Example: SandboxedFileSystemTool Demo</p>
<hr />
<p>This example demonstrates configuring and using the SandboxedFileSystemTool
via the Genie facade.</p>
<p>To Run:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras</code>).
2. Run from the root of the project:
   <code>poetry run python examples/E14_filesystem_tool_demo.py</code></p>
<p>The demo will:
- Create a sandbox directory ('./my_agent_sandbox_demo_e14').
- Initialize Genie with the SandboxedFileSystemTool configured to use this sandbox.
- Perform write, read, and list operations using the tool.
- Clean up the sandbox directory.
"""
import asyncio
import os
import shutil
from pathlib import Path</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.core.types import Plugin as CorePluginType
from genie_tooling.genie import Genie
from genie_tooling.security.key_provider import KeyProvider</p>
<p>class DemoFSKeyProvider(KeyProvider, CorePluginType):
    plugin_id = "demo_fs_key_provider_e14_v1"
    async def get_key(self, key_name: str) -&gt; str | None: return os.environ.get(key_name)
    async def setup(self, config=None): pass
    async def teardown(self): pass</p>
<p>async def run_fs_tool_demo():
    print("--- SandboxedFileSystemTool Demo ---")</p>
<div class="highlight"><pre><span></span><code>sandbox_dir_name = &quot;my_agent_sandbox_demo_e14&quot;
sandbox_path = Path(__file__).parent / sandbox_dir_name

if sandbox_path.exists():
    shutil.rmtree(sandbox_path)
sandbox_path.mkdir(parents=True, exist_ok=True)
print(f&quot;Sandbox directory prepared at: {sandbox_path.resolve()}&quot;)

app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;none&quot;,
        command_processor=&quot;none&quot;
    ),
    tool_configurations={
        &quot;sandboxed_fs_tool_v1&quot;: {&quot;sandbox_base_path&quot;: str(sandbox_path.resolve())}
    }
)

key_provider = DemoFSKeyProvider()
genie: Genie | None = None

try:
    genie = await Genie.create(config=app_config, key_provider_instance=key_provider)
    print(&quot;Genie facade initialized with SandboxedFileSystemTool.&quot;)

    file_to_write = &quot;test_doc.txt&quot;
    content_to_write = &quot;Hello from the sandboxed world of Genie!&quot;
    subdir_file = &quot;notes/important.md&quot;
    subdir_content = &quot;# Project Ideas\n- Build more cool agents!&quot;

    print(f&quot;\nAttempting to write &#39;{file_to_write}&#39;...&quot;)
    write_result = await genie.execute_tool(
        &quot;sandboxed_fs_tool_v1&quot;,
        operation=&quot;write_file&quot;,
        path=file_to_write,
        content=content_to_write
    )
    print(f&quot;Write result: {write_result}&quot;)
    assert write_result.get(&quot;success&quot;) is True

    print(f&quot;\nAttempting to write &#39;{subdir_file}&#39;...&quot;)
    write_subdir_result = await genie.execute_tool(
        &quot;sandboxed_fs_tool_v1&quot;,
        operation=&quot;write_file&quot;,
        path=subdir_file,
        content=subdir_content,
        overwrite=True
    )
    print(f&quot;Write to subdir result: {write_subdir_result}&quot;)
    assert write_subdir_result.get(&quot;success&quot;) is True

    print(f&quot;\nAttempting to read &#39;{file_to_write}&#39;...&quot;)
    read_result = await genie.execute_tool(
        &quot;sandboxed_fs_tool_v1&quot;,
        operation=&quot;read_file&quot;,
        path=file_to_write
    )
    print(f&quot;Read result: {read_result}&quot;)
    assert read_result.get(&quot;success&quot;) is True
    assert read_result.get(&quot;content&quot;) == content_to_write

    print(&quot;\nAttempting to list sandbox root directory &#39;.&#39; ...&quot;)
    list_result_root = await genie.execute_tool(
        &quot;sandboxed_fs_tool_v1&quot;,
        operation=&quot;list_directory&quot;,
        path=&quot;.&quot;
    )
    print(f&quot;List directory (root) result: {list_result_root}&quot;)
    assert list_result_root.get(&quot;success&quot;) is True
    assert file_to_write in list_result_root.get(&quot;file_list&quot;, [])
    assert &quot;notes&quot; in list_result_root.get(&quot;file_list&quot;, [])

    print(&quot;\nAttempting to list &#39;notes&#39; subdirectory...&quot;)
    list_result_subdir = await genie.execute_tool(
        &quot;sandboxed_fs_tool_v1&quot;,
        operation=&quot;list_directory&quot;,
        path=&quot;notes&quot;
    )
    print(f&quot;List directory (&#39;notes&#39;) result: {list_result_subdir}&quot;)
    assert list_result_subdir.get(&quot;success&quot;) is True
    assert Path(subdir_file).name in list_result_subdir.get(&quot;file_list&quot;, [])

    print(&quot;\nAttempting path traversal (should fail)...&quot;)
    traversal_result = await genie.execute_tool(
        &quot;sandboxed_fs_tool_v1&quot;,
        operation=&quot;read_file&quot;,
        path=&quot;../outside_file.txt&quot;
    )
    print(f&quot;Path traversal result: {traversal_result}&quot;)
    assert traversal_result.get(&quot;success&quot;) is False
    assert &quot;Path traversal attempt detected&quot; in traversal_result.get(&quot;message&quot;, &quot;&quot;)

except Exception as e:
    print(f&quot;\nAn unexpected error occurred: {e}&quot;)
    import traceback
    traceback.print_exc()
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie facade torn down.&quot;)

    if sandbox_path.exists():
        shutil.rmtree(sandbox_path)
        print(f&quot;Sandbox directory &#39;{sandbox_path.resolve()}&#39; cleaned up.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    import logging
    logging.basicConfig(level=logging.INFO)
    # logging.getLogger("genie_tooling").setLevel(logging.DEBUG)
    asyncio.run(run_fs_tool_demo())</p></section><section class="print-page" id="tutorials-e15_prompt_management_example" heading-number="4.15"><h1 id="tutorials-e15_prompt_management_example-tutorial-prompt-management-e15">Tutorial: Prompt Management (E15)<a class="headerlink" href="#tutorials-e15_prompt_management_example-tutorial-prompt-management-e15" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E15_prompt_management_example.py</code>.</p>
<p>It demonstrates how to use the prompt management system (<code>genie.prompts</code>) to separate prompt templates from application code. It shows how to:
- Configure <code>FileSystemPromptRegistryPlugin</code> to load templates from a directory.
- Use different template engines (<code>BasicStringFormatTemplatePlugin</code>, <code>Jinja2ChatTemplatePlugin</code>).
- Render simple string prompts and complex, structured chat prompts from templates.</p>
<h2 id="tutorials-e15_prompt_management_example-example-code">Example Code<a class="headerlink" href="#tutorials-e15_prompt_management_example-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e15_prompt_management_example-examplese15_prompt_management_examplepy">examples/E15_prompt_management_example.py<a class="headerlink" href="#tutorials-e15_prompt_management_example-examplese15_prompt_management_examplepy" title="Permanent link">&para;</a></h1>
<p>"""
Example: Using the Prompt Management System (<code>genie.prompts</code>)</p>
<hr />
<p>This example demonstrates how to use <code>genie.prompts</code> to load and render
prompt templates. It assumes you have a <code>FileSystemPromptRegistryPlugin</code>
configured and some template files.</p>
<p>To Run:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras</code>).
2. The script will create a temporary prompt directory and files.
3. Run from the root of the project:
   <code>poetry run python examples/E15_prompt_management_example.py</code>
"""
import asyncio
import logging
import shutil  # For cleanup
from pathlib import Path
from typing import Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie
from genie_tooling.prompts.types import PromptData</p>
<p>async def run_prompt_management_demo():
    print("--- Prompt Management Example ---")
    logging.basicConfig(level=logging.INFO)</p>
<div class="highlight"><pre><span></span><code>prompt_dir = Path(__file__).parent / &quot;my_app_prompts_e15&quot; # Use example-local dir
prompt_dir.mkdir(exist_ok=True)
(prompt_dir / &quot;greeting.txt&quot;).write_text(&quot;Hello, {name}! Welcome to {place}.&quot;)
(prompt_dir / &quot;chat_intro.j2&quot;).write_text(
    &#39;[\n&#39;
    &#39;  {&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: &quot;You are a {{ bot_role }} assistant.&quot;},\n&#39;
    &#39;  {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Please tell me about {{ topic }}.&quot;}\n&#39;
    &#39;]&#39;
)

app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;ollama&quot;,
        llm_ollama_model_name=&quot;mistral:latest&quot;,
        prompt_registry=&quot;file_system_prompt_registry&quot;,
    ),
    prompt_registry_configurations={
        &quot;file_system_prompt_registry_v1&quot;: {
            &quot;base_path&quot;: str(prompt_dir.resolve()),
        }
    }
)

genie: Optional[Genie] = None
try:
    print(&quot;\nInitializing Genie for prompt management...&quot;)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie initialized!&quot;)

    print(&quot;\n--- Available Templates ---&quot;)
    templates = await genie.prompts.list_templates()
    if templates:
        for t_id in templates:
            print(f&quot;- Name: {t_id[&#39;name&#39;]}, Version: {t_id.get(&#39;version&#39;, &#39;N/A&#39;)}&quot;)
    else:
        print(&quot;No templates found (check base_path and suffix).&quot;)

    print(&quot;\n--- Raw Template Content (greeting.txt) ---&quot;)
    raw_greeting = await genie.prompts.get_prompt_template_content(name=&quot;greeting&quot;)
    print(raw_greeting)

    print(&quot;\n--- Rendered String Prompt (greeting.txt) ---&quot;)
    greeting_data: PromptData = {&quot;name&quot;: &quot;Explorer&quot;, &quot;place&quot;: &quot;Genieville&quot;}
    rendered_greeting = await genie.prompts.render_prompt(
        name=&quot;greeting&quot;,
        data=greeting_data,
        template_engine_id=&quot;basic_string_formatter&quot; # Explicitly use basic formatter
    )
    print(rendered_greeting)

    print(&quot;\n--- Rendered Chat Prompt (chat_intro.j2) ---&quot;)
    chat_data: PromptData = {&quot;bot_role&quot;: &quot;helpful&quot;, &quot;topic&quot;: &quot;AI agents&quot;}
    rendered_chat_messages = await genie.prompts.render_chat_prompt(
        name=&quot;chat_intro&quot;,
        data=chat_data,
        template_engine_id=&quot;jinja2_chat_formatter&quot; # Explicitly use Jinja2 formatter
    )
    print(rendered_chat_messages)

    if rendered_chat_messages:
        print(&quot;\n--- Sending rendered chat to LLM ---&quot;)
        try:
            chat_response = await genie.llm.chat(rendered_chat_messages)
            print(f&quot;LLM Response: {chat_response[&#39;message&#39;][&#39;content&#39;][:150]}...&quot;)
        except Exception as e_llm:
            print(f&quot;LLM chat error: {e_llm}&quot;)

except Exception as e:
    print(f&quot;\nAn error occurred: {e}&quot;)
    logging.exception(&quot;Prompt management demo error details:&quot;)
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie torn down.&quot;)
    if prompt_dir.exists():
        shutil.rmtree(prompt_dir)
        print(f&quot;Cleaned up demo prompt directory: {prompt_dir}&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    asyncio.run(run_prompt_management_demo())</p></section><section class="print-page" id="tutorials-e16_conversation_state_example" heading-number="4.16"><h1 id="tutorials-e16_conversation_state_example-tutorial-conversation-state-e16">Tutorial: Conversation State (E16)<a class="headerlink" href="#tutorials-e16_conversation_state_example-tutorial-conversation-state-e16" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E16_conversation_state_example.py</code>.</p>
<p>It demonstrates how to manage conversation history using <code>genie.conversation</code>. It shows how to:
- Configure a <code>ConversationStateProviderPlugin</code> (e.g., <code>in_memory_convo_provider</code>).
- Load, add messages to, and delete conversation state for a given session ID.
- Observe how metadata like <code>created_at</code> and <code>last_updated</code> is automatically managed.</p>
<h2 id="tutorials-e16_conversation_state_example-example-code">Example Code<a class="headerlink" href="#tutorials-e16_conversation_state_example-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e16_conversation_state_example-examplese16_conversation_state_examplepy">examples/E16_conversation_state_example.py<a class="headerlink" href="#tutorials-e16_conversation_state_example-examplese16_conversation_state_examplepy" title="Permanent link">&para;</a></h1>
<p>"""
Example: Using Conversation State Management (<code>genie.conversation</code>)</p>
<hr />
<p>This example demonstrates how to load, add messages to, and save
conversation state using <code>genie.conversation</code>. It uses the in-memory
state provider by default.</p>
<p>To Run:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras</code>).
2. Run from the root of the project:
   <code>poetry run python examples/E16_conversation_state_example.py</code>
"""
import asyncio
import logging
import uuid
from typing import Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie
from genie_tooling.llm_providers.types import ChatMessage</p>
<p>async def run_conversation_state_demo():
    print("--- Conversation State Example ---")
    logging.basicConfig(level=logging.INFO)</p>
<div class="highlight"><pre><span></span><code>app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;ollama&quot;,
        llm_ollama_model_name=&quot;mistral:latest&quot;,
        conversation_state_provider=&quot;in_memory_convo_provider&quot;
    ),
)

genie: Optional[Genie] = None
session_id = f&quot;demo_session_e16_{uuid.uuid4().hex[:8]}&quot;
print(f&quot;Using Session ID: {session_id}&quot;)

try:
    print(&quot;\nInitializing Genie for conversation state...&quot;)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie initialized!&quot;)

    print(f&quot;\n1. Loading state for session &#39;{session_id}&#39;...&quot;)
    initial_state = await genie.conversation.load_state(session_id)
    if initial_state:
        print(f&quot;  Found existing state: {initial_state}&quot;)
    else:
        print(&quot;  No existing state found (as expected for new session).&quot;)

    print(&quot;\n2. Adding user message...&quot;)
    user_msg: ChatMessage = {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Hello Genie, how are you?&quot;}
    await genie.conversation.add_message(session_id, user_msg)
    print(f&quot;  Added: {user_msg}&quot;)

    state_after_user = await genie.conversation.load_state(session_id)
    if state_after_user:
        print(f&quot;  Current history: {state_after_user[&#39;history&#39;]}&quot;)
        print(f&quot;  Metadata: {state_after_user.get(&#39;metadata&#39;)}&quot;)
    else:
        print(&quot;  Error: State not found after adding user message.&quot;)
        return

    print(&quot;\n3. Adding assistant message...&quot;)
    assistant_msg: ChatMessage = {&quot;role&quot;: &quot;assistant&quot;, &quot;content&quot;: &quot;I am doing well, thank you for asking!&quot;}
    await genie.conversation.add_message(session_id, assistant_msg)
    print(f&quot;  Added: {assistant_msg}&quot;)

    final_state = await genie.conversation.load_state(session_id)
    if final_state:
        print(&quot;\n--- Final Conversation State ---&quot;)
        print(f&quot;Session ID: {final_state[&#39;session_id&#39;]}&quot;)
        print(&quot;History:&quot;)
        for msg in final_state[&quot;history&quot;]:
            print(f&quot;  - {msg[&#39;role&#39;]}: {msg[&#39;content&#39;]}&quot;)
        print(f&quot;Metadata: {final_state.get(&#39;metadata&#39;)}&quot;)
    else:
        print(&quot;  Error: Final state not found.&quot;)

    print(f&quot;\n4. Deleting state for session &#39;{session_id}&#39;...&quot;)
    deleted = await genie.conversation.delete_state(session_id)
    print(f&quot;  Deletion successful: {deleted}&quot;)

    state_after_delete = await genie.conversation.load_state(session_id)
    assert state_after_delete is None, &quot;State should be None after deletion.&quot;
    print(&quot;  State confirmed deleted.&quot;)

except Exception as e:
    print(f&quot;\nAn error occurred: {e}&quot;)
    logging.exception(&quot;Conversation state demo error details:&quot;)
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    asyncio.run(run_conversation_state_demo())</p></section><section class="print-page" id="tutorials-e17_observability_tracing_example" heading-number="4.17"><h1 id="tutorials-e17_observability_tracing_example-tutorial-observability-tracing-e17">Tutorial: Observability &amp; Tracing (E17)<a class="headerlink" href="#tutorials-e17_observability_tracing_example-tutorial-observability-tracing-e17" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E17_observability_tracing_example.py</code>.</p>
<p>It demonstrates how to use Genie's built-in tracing capabilities for debugging and monitoring. It shows how to:
- Configure a tracer plugin (e.g., <code>ConsoleTracerPlugin</code> or <code>OpenTelemetryTracerPlugin</code>).
- Observe the automatic trace events generated by core <code>Genie</code> operations (like LLM calls).
- Manually emit custom application-level trace events using <code>genie.observability.trace_event()</code>.</p>
<h2 id="tutorials-e17_observability_tracing_example-example-code">Example Code<a class="headerlink" href="#tutorials-e17_observability_tracing_example-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e17_observability_tracing_example-examplese17_observability_tracing_examplepy">examples/E17_observability_tracing_example.py<a class="headerlink" href="#tutorials-e17_observability_tracing_example-examplese17_observability_tracing_examplepy" title="Permanent link">&para;</a></h1>
<p>"""
Example: Using Observability and Interaction Tracing (<code>genie.observability</code>)</p>
<hr />
<p>This example demonstrates how to enable and use the interaction tracing
feature of Genie Tooling. It shows configuration for both ConsoleTracerPlugin
and the new OpenTelemetryTracerPlugin.</p>
<p>To Run with Console Tracer:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras</code>).
2. Run from the root of the project:
   <code>poetry run python examples/E17_observability_tracing_example.py</code>
   You should see trace logs in your console output.</p>
<p>To Run with OpenTelemetry Tracer (e.g., to Jaeger):
1. Ensure OTel dependencies are installed: <code>poetry install --extras observability</code>
2. Start an OTel collector (e.g., Jaeger all-in-one):
   <code>docker run -d --name jaeger -e COLLECTOR_OTLP_ENABLED=true -p 16686:16686 -p 4317:4317 -p 4318:4318 jaegertracing/all-in-one:latest</code>
3. Modify the <code>app_config</code> below to use <code>otel_tracer</code> and configure the OTLP endpoint.
4. Run the script. Traces should appear in Jaeger UI (http://localhost:16686).
"""
import asyncio
import logging
import traceback
import uuid
from typing import Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie</p>
<p>async def run_observability_demo():
    print("--- Observability and Tracing Example ---")</p>
<div class="highlight"><pre><span></span><code>logging.basicConfig(level=logging.INFO)

app_config_console = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;ollama&quot;,
        llm_ollama_model_name=&quot;mistral:latest&quot;,
        observability_tracer=&quot;console_tracer&quot;
    ),
    observability_tracer_configurations={
        &quot;console_tracer_plugin_v1&quot;: {
            &quot;log_level&quot;: &quot;INFO&quot;
        }
    }
)

app_config_otel = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;ollama&quot;,
        llm_ollama_model_name=&quot;mistral:latest&quot;,
        observability_tracer=&quot;otel_tracer&quot;,
        token_usage_recorder=&quot;otel_metrics_recorder&quot;
    ),
    observability_tracer_configurations={
        &quot;otel_tracer_plugin_v1&quot;: {
            &quot;otel_service_name&quot;: &quot;genie-e17-demo-app&quot;,
            &quot;otel_service_version&quot;: &quot;0.1.0&quot;,
            &quot;exporter_type&quot;: &quot;otlp_http&quot;,
            &quot;otlp_http_endpoint&quot;: &quot;http://localhost:4318/v1/traces&quot;,
            &quot;resource_attributes&quot;: {&quot;deployment.environment&quot;: &quot;development_e17&quot;}
        }
    }
)

# --- CHOOSE CONFIGURATION TO RUN ---
app_config = app_config_console
# app_config = app_config_otel # Uncomment to use OpenTelemetry
# ------------------------------------

genie: Optional[Genie] = None
try:
    print(f&quot;\nInitializing Genie with tracer: {app_config.features.observability_tracer}...&quot;)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie initialized! Automatic traces will now be generated.&quot;)

    print(&quot;\n--- Performing operations that trigger automatic traces ---&quot;)
    try:
        chat_response = await genie.llm.chat([{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Hello Tracer! Tell me a short story.&quot;}])
        print(f&quot;LLM Response: {chat_response[&#39;message&#39;][&#39;content&#39;][:60]}...&quot;)
    except Exception as e_llm:
        print(f&quot;LLM call failed (expected if Ollama not running): {e_llm}&quot;)

    print(&quot;\n--- Emitting a custom trace event ---&quot;)
    custom_correlation_id = str(uuid.uuid4())
    await genie.observability.trace_event(
        event_name=&quot;my_app.custom_operation.start&quot;,
        data={&quot;user_id&quot;: &quot;test_user&quot;, &quot;input_param&quot;: &quot;example_value&quot;},
        component=&quot;MyApplicationLogic&quot;,
        correlation_id=custom_correlation_id
    )
    await asyncio.sleep(0.1)
    try:
        raise ValueError(&quot;Something went wrong in custom op!&quot;)
    except ValueError as e_custom:
        await genie.observability.trace_event(
            event_name=&quot;my_app.custom_operation.error&quot;,
            data={
                &quot;status&quot;: &quot;failed&quot;,
                &quot;error_message&quot;: str(e_custom),
                &quot;error_type&quot;: type(e_custom).__name__,
                &quot;error_stacktrace&quot;: traceback.format_exc()
                },
            component=&quot;MyApplicationLogic&quot;,
            correlation_id=custom_correlation_id
        )
    print(&quot;Custom trace events (including an error) emitted.&quot;)

except Exception as e:
    print(f&quot;\nAn error occurred: {e}&quot;)
    logging.exception(&quot;Observability demo error details:&quot;)
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    asyncio.run(run_observability_demo())</p></section><section class="print-page" id="tutorials-e18_human_in_loop_example" heading-number="4.18"><h1 id="tutorials-e18_human_in_loop_example-tutorial-human-in-the-loop-e18">Tutorial: Human-in-the-Loop (E18)<a class="headerlink" href="#tutorials-e18_human_in_loop_example-tutorial-human-in-the-loop-e18" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E18_human_in_loop_example.py</code>.</p>
<p>It demonstrates how to add a human approval step before executing critical actions. It shows how to:
- Configure a <code>HumanApprovalRequestPlugin</code> (e.g., <code>cli_hitl_approver</code>).
- See how <code>genie.run_command()</code> automatically triggers the HITL flow before executing a tool.
- Understand the approval/denial workflow from the user's perspective.</p>
<h2 id="tutorials-e18_human_in_loop_example-example-code">Example Code<a class="headerlink" href="#tutorials-e18_human_in_loop_example-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e18_human_in_loop_example-examplese18_human_in_loop_examplepy">examples/E18_human_in_loop_example.py<a class="headerlink" href="#tutorials-e18_human_in_loop_example-examplese18_human_in_loop_examplepy" title="Permanent link">&para;</a></h1>
<p>"""
Example: Using Human-in-the-Loop (HITL) (<code>genie.human_in_loop</code>)</p>
<hr />
<p>This example demonstrates how to configure and use the Human-in-the-Loop
feature for approvals. It uses the <code>CliApprovalPlugin</code> by default,
which will prompt on the command line.</p>
<p>This example will primarily show HITL integrated with <code>genie.run_command</code>.</p>
<p>To Run:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras</code>).
2. Ensure Ollama is running and 'mistral:latest' is pulled for the LLM-assisted processor.
3. Run from the root of the project:
   <code>poetry run python examples/E18_human_in_loop_example.py</code>
   You will be prompted in the console to approve/deny tool execution.
"""
import asyncio
import json
import logging
from typing import Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie</p>
<p>async def run_hitl_demo():
    print("--- Human-in-the-Loop (HITL) Example ---")
    logging.basicConfig(level=logging.INFO)</p>
<div class="highlight"><pre><span></span><code>app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;ollama&quot;,
        llm_ollama_model_name=&quot;mistral:latest&quot;,
        command_processor=&quot;llm_assisted&quot;,
        tool_lookup=&quot;embedding&quot;,
        hitl_approver=&quot;cli_hitl_approver&quot;
    ),
    tool_configurations={
        &quot;calculator_tool&quot;: {}
    }
)

genie: Optional[Genie] = None
try:
    print(&quot;\nInitializing Genie with HITL enabled...&quot;)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie initialized!&quot;)

    print(&quot;\n--- `run_command` with HITL ---&quot;)
    command_text = &quot;What is 15 multiplied by 7?&quot;
    print(f&quot;Sending command: &#39;{command_text}&#39;&quot;)
    print(&quot;The system will now select the &#39;calculator_tool&#39; and then prompt for human approval before execution.&quot;)

    command_result = await genie.run_command(command_text)

    print(&quot;\nCommand Result after HITL:&quot;)
    print(json.dumps(command_result, indent=2, default=str))

    if command_result and command_result.get(&quot;tool_result&quot;):
        print(f&quot;\nTool Result: {command_result[&#39;tool_result&#39;]}&quot;)
    elif command_result and &quot;hitl_decision&quot; in command_result and command_result[&quot;hitl_decision&quot;].get(&quot;status&quot;) != &quot;approved&quot;:
        print(f&quot;\nTool execution was {command_result[&#39;hitl_decision&#39;][&#39;status&#39;]}. Reason: {command_result[&#39;hitl_decision&#39;].get(&#39;reason&#39;)}&quot;)
    elif command_result and command_result.get(&quot;error&quot;):
         print(f&quot;\nCommand Error: {command_result[&#39;error&#39;]}&quot;)
    else:
         print(f&quot;\nCommand did not result in a tool call or expected HITL flow: {command_result}&quot;)

except Exception as e:
    print(f&quot;\nAn error occurred: {e}&quot;)
    logging.exception(&quot;HITL demo error details:&quot;)
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    asyncio.run(run_hitl_demo())</p></section><section class="print-page" id="tutorials-e19_llm_output_parsing_example" heading-number="4.19"><h1 id="tutorials-e19_llm_output_parsing_example-tutorial-llm-output-parsing-e19">Tutorial: LLM Output Parsing (E19)<a class="headerlink" href="#tutorials-e19_llm_output_parsing_example-tutorial-llm-output-parsing-e19" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E19_llm_output_parsing_example.py</code>.</p>
<p>It demonstrates how to reliably extract structured data from an LLM's text response. It shows how to:
- Use <code>genie.llm.parse_output()</code> to convert LLM text into Python objects.
- Configure and use <code>JSONOutputParserPlugin</code> to extract JSON.
- Configure and use <code>PydanticOutputParserPlugin</code> to parse JSON directly into a Pydantic model instance for validation and type safety.</p>
<h2 id="tutorials-e19_llm_output_parsing_example-example-code">Example Code<a class="headerlink" href="#tutorials-e19_llm_output_parsing_example-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e19_llm_output_parsing_example-examplese19_llm_output_parsing_examplepy">examples/E19_llm_output_parsing_example.py<a class="headerlink" href="#tutorials-e19_llm_output_parsing_example-examplese19_llm_output_parsing_examplepy" title="Permanent link">&para;</a></h1>
<p>"""
Example: Using LLM Output Parsing (<code>genie.llm.parse_output</code>)</p>
<hr />
<p>This example demonstrates how to use <code>genie.llm.parse_output</code> to parse
structured data (like JSON) from an LLM's text response. It also shows
parsing into a Pydantic model.</p>
<p>To Run:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras</code>).
   (Pydantic is a core dependency).
2. Ensure Ollama is running and 'mistral:latest' is pulled (or configure a different LLM).
3. Run from the root of the project:
   <code>poetry run python examples/E19_llm_output_parsing_example.py</code>
"""
import asyncio
import logging
from typing import Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie
from genie_tooling.llm_providers.types import LLMChatResponse
from pydantic import BaseModel, Field</p>
<p>class ExtractedInfo(BaseModel):
    name: str = Field(description="The full name of the person.")
    age: Optional[int] = Field(None, description="The person's age, if mentioned.")
    city: Optional[str] = Field(None, description="The city the person lives in, if mentioned.")</p>
<p>async def run_llm_output_parsing_demo():
    print("--- LLM Output Parsing Example ---")
    logging.basicConfig(level=logging.INFO)</p>
<div class="highlight"><pre><span></span><code>app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;ollama&quot;,
        llm_ollama_model_name=&quot;mistral:latest&quot;,
        default_llm_output_parser=&quot;json_output_parser&quot; # Set default
    )
)

genie: Optional[Genie] = None
try:
    print(&quot;\nInitializing Genie for LLM output parsing...&quot;)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie initialized!&quot;)

    print(&quot;\n--- Parsing to Dictionary (JSON) ---&quot;)
    prompt_for_json = (
        &quot;Extract the name, age, and city from the following text &quot;
        &quot;and return it as a JSON object: &quot;
        &quot;&#39;John Doe is 42 years old and lives in New York. He enjoys programming.&#39; &quot;
        &quot;Ensure your output is ONLY the JSON object.&quot;
    )
    print(f&quot;Sending prompt for JSON: {prompt_for_json}&quot;)

    try:
        llm_response_json: LLMChatResponse = await genie.llm.chat(
            [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: prompt_for_json}]
        )
        print(f&quot;LLM Raw Text Output: {llm_response_json[&#39;message&#39;][&#39;content&#39;]}&quot;)

        parsed_dict = await genie.llm.parse_output(llm_response_json) # Uses default JSON parser
        print(f&quot;Parsed Dictionary: {parsed_dict}&quot;)
        if isinstance(parsed_dict, dict):
            print(f&quot;  Name from dict: {parsed_dict.get(&#39;name&#39;)}&quot;)
    except Exception as e_json:
        print(f&quot;Error during JSON parsing: {e_json}&quot;)


    print(&quot;\n--- Parsing to Pydantic Model ---&quot;)
    prompt_for_pydantic = (
        &quot;From the text &#39;Alice is thirty and resides in London.&#39;, &quot;
        &quot;extract the name, age, and city. Format as a JSON object &quot;
        &quot;suitable for a model with fields: name (str), age (int, optional), city (str, optional).&quot;
        &quot;Output ONLY the JSON object.&quot;
    )
    print(f&quot;Sending prompt for Pydantic: {prompt_for_pydantic}&quot;)

    try:
        llm_response_pydantic: LLMChatResponse = await genie.llm.chat(
             [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: prompt_for_pydantic}]
        )
        print(f&quot;LLM Raw Text Output: {llm_response_pydantic[&#39;message&#39;][&#39;content&#39;]}&quot;)

        parsed_model_instance = await genie.llm.parse_output(
            llm_response_pydantic,
            parser_id=&quot;pydantic_output_parser_v1&quot;,
            schema=ExtractedInfo
        )

        if isinstance(parsed_model_instance, ExtractedInfo):
            print(f&quot;Parsed Pydantic Model: {parsed_model_instance.model_dump()}&quot;)
            print(f&quot;  Name from model: {parsed_model_instance.name}&quot;)
            print(f&quot;  Age from model: {parsed_model_instance.age}&quot;)
        else:
            print(f&quot;Parsing did not return an ExtractedInfo instance. Got: {type(parsed_model_instance)}&quot;)

    except Exception as e_pydantic:
        print(f&quot;Error during Pydantic parsing: {e_pydantic}&quot;)

except Exception as e:
    print(f&quot;\nAn error occurred: {e}&quot;)
    logging.exception(&quot;LLM output parsing demo error details:&quot;)
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    asyncio.run(run_llm_output_parsing_demo())</p></section><section class="print-page" id="tutorials-e20_token_usage_example" heading-number="4.20"><h1 id="tutorials-e20_token_usage_example-tutorial-token-usage-tracking-e20">Tutorial: Token Usage Tracking (E20)<a class="headerlink" href="#tutorials-e20_token_usage_example-tutorial-token-usage-tracking-e20" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E20_token_usage_example.py</code>.</p>
<p>It demonstrates how to monitor LLM token consumption for cost and performance analysis. It shows how to:
- Configure a <code>TokenUsageRecorderPlugin</code> (e.g., <code>in_memory_token_recorder</code>).
- Observe how token usage is automatically recorded after <code>genie.llm</code> calls.
- Retrieve and interpret a usage summary using <code>genie.usage.get_summary()</code>.</p>
<h2 id="tutorials-e20_token_usage_example-example-code">Example Code<a class="headerlink" href="#tutorials-e20_token_usage_example-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e20_token_usage_example-examplese20_token_usage_examplepy">examples/E20_token_usage_example.py<a class="headerlink" href="#tutorials-e20_token_usage_example-examplese20_token_usage_examplepy" title="Permanent link">&para;</a></h1>
<p>"""
Example: Using Token Usage Tracking (<code>genie.usage</code>)</p>
<hr />
<p>This example demonstrates how to enable and use the token usage tracking
feature of Genie Tooling. It shows configuration for both the
<code>InMemoryTokenUsageRecorderPlugin</code> and the <code>OpenTelemetryMetricsTokenRecorderPlugin</code>.</p>
<p>To Run with InMemory Recorder:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras</code>).
2. Ensure Ollama is running and 'mistral:latest' is pulled (or configure a different LLM).
3. Run from the root of the project:
   <code>poetry run python examples/E20_token_usage_example.py</code></p>
<p>To Run with OpenTelemetry Metrics Recorder (e.g., to Prometheus via OTel Collector):
1. Ensure OTel dependencies: <code>poetry install --extras observability</code>
2. Set up an OTel Collector configured to scrape Prometheus metrics and export them
   (e.g., to a Prometheus instance).
3. Modify <code>app_config</code> below to use <code>token_usage_recorder="otel_metrics_recorder"</code>
   and ensure <code>observability_tracer="otel_tracer"</code> is also configured for the OTel SDK to be initialized.
4. Run the script. Metrics should be available in your Prometheus/Grafana setup.
"""
import asyncio
import json
import logging
from typing import Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie</p>
<p>async def run_token_usage_demo():
    print("--- Token Usage Tracking Example ---")
    logging.basicConfig(level=logging.INFO)</p>
<div class="highlight"><pre><span></span><code>app_config_in_memory = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;ollama&quot;,
        llm_ollama_model_name=&quot;mistral:latest&quot;,
        token_usage_recorder=&quot;in_memory_token_recorder&quot;
    )
)

app_config_otel_metrics = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;ollama&quot;,
        llm_ollama_model_name=&quot;mistral:latest&quot;,
        token_usage_recorder=&quot;otel_metrics_recorder&quot;,
        observability_tracer=&quot;otel_tracer&quot; # OTel SDK needs to be initialized
    ),
    observability_tracer_configurations={
        &quot;otel_tracer_plugin_v1&quot;: {
            &quot;otel_service_name&quot;: &quot;genie-e20-token-metrics-app&quot;,
            &quot;exporter_type&quot;: &quot;console&quot; # Or &quot;otlp_http&quot; to send to a collector
        }
    }
)

# --- CHOOSE CONFIGURATION TO RUN ---
app_config = app_config_in_memory
# app_config = app_config_otel_metrics # Uncomment to use OTel Metrics
# ------------------------------------

genie: Optional[Genie] = None
try:
    print(f&quot;\nInitializing Genie with token usage recorder: {app_config.features.token_usage_recorder}...&quot;)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie initialized!&quot;)

    print(&quot;\n--- Making LLM calls ---&quot;)
    try:
        await genie.llm.chat([{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Tell me a short story about a robot.&quot;}])
        print(&quot;First LLM chat call complete.&quot;)
        await genie.llm.generate(&quot;What is the capital of France?&quot;)
        print(&quot;Second LLM generate call complete.&quot;)
        await genie.llm.chat([{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Another question for the same model.&quot;}])
        print(&quot;Third LLM chat call complete.&quot;)

    except Exception as e_llm:
        print(f&quot;LLM call failed (expected if Ollama not running): {e_llm}&quot;)
        print(&quot;Token usage summary might be empty or incomplete.&quot;)

    print(&quot;\n--- Token Usage Summary ---&quot;)
    # For in-memory, get_summary returns a dict. For OTel, it returns a status message.
    summary = await genie.usage.get_summary()
    print(json.dumps(summary, indent=2))

    if app_config.features.token_usage_recorder == &quot;in_memory_token_recorder&quot; and summary:
        recorder_id = &quot;in_memory_token_usage_recorder_v1&quot;
        if recorder_id in summary and isinstance(summary[recorder_id], dict) and isinstance(summary[recorder_id].get(&quot;by_model&quot;), dict):
            print(&quot;\nBreakdown by model (for in_memory_token_recorder):&quot;)
            for model_name, data in summary[recorder_id][&quot;by_model&quot;].items():
                print(f&quot;  Model: {model_name}&quot;)
                print(f&quot;    Calls: {data.get(&#39;count&#39;)}&quot;)
                print(f&quot;    Prompt Tokens: {data.get(&#39;prompt&#39;)}&quot;)
                print(f&quot;    Completion Tokens: {data.get(&#39;completion&#39;)}&quot;)
                print(f&quot;    Total Tokens: {data.get(&#39;total&#39;)}&quot;)
    elif app_config.features.token_usage_recorder == &quot;otel_metrics_recorder&quot;:
        print(&quot;\nFor &#39;otel_metrics_recorder&#39;, view metrics in your OpenTelemetry backend (e.g., Prometheus/Grafana).&quot;)
        print(&quot;Example Prometheus queries:&quot;)
        print(&quot;  - sum(rate(llm_request_tokens_prompt_total[5m])) by (llm_model_name)&quot;)
        print(&quot;  - sum(rate(llm_request_tokens_completion_total[5m])) by (llm_provider_id)&quot;)

except Exception as e:
    print(f&quot;\nAn error occurred: {e}&quot;)
    logging.exception(&quot;Token usage demo error details:&quot;)
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    asyncio.run(run_token_usage_demo())</p></section><section class="print-page" id="tutorials-e21_guardrails_example" heading-number="4.21"><h1 id="tutorials-e21_guardrails_example-tutorial-guardrails-e21">Tutorial: Guardrails (E21)<a class="headerlink" href="#tutorials-e21_guardrails_example-tutorial-guardrails-e21" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E21_guardrails_example.py</code>.</p>
<p>It demonstrates how to enforce safety policies on LLM inputs and outputs. It shows how to:
- Configure the built-in <code>KeywordBlocklistGuardrailPlugin</code>.
- See how input guardrails can block potentially harmful prompts before they reach the LLM.
- See how output guardrails can sanitize or block LLM responses that violate a policy.</p>
<h2 id="tutorials-e21_guardrails_example-example-code">Example Code<a class="headerlink" href="#tutorials-e21_guardrails_example-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e21_guardrails_example-examplese21_guardrails_examplepy">examples/E21_guardrails_example.py<a class="headerlink" href="#tutorials-e21_guardrails_example-examplese21_guardrails_examplepy" title="Permanent link">&para;</a></h1>
<p>"""
Example: Using Guardrails</p>
<hr />
<p>This example demonstrates how to configure and use Guardrails in Genie Tooling.
It uses the built-in <code>KeywordBlocklistGuardrailPlugin</code>.</p>
<p>To Run:
1. Ensure Genie Tooling is installed (<code>poetry install --all-extras</code>).
2. Ensure Ollama is running and 'mistral:latest' is pulled (or configure a different LLM).
3. Run from the root of the project:
   <code>poetry run python examples/E21_guardrails_example.py</code>
   Observe how inputs/outputs containing 'secret' or 'forbidden' are handled.
"""
import asyncio
import logging
from typing import Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie</p>
<p>async def run_guardrails_demo():
    print("--- Guardrails Example ---")
    logging.basicConfig(level=logging.INFO)</p>
<div class="highlight"><pre><span></span><code>app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;ollama&quot;,
        llm_ollama_model_name=&quot;mistral:latest&quot;,
        command_processor=&quot;llm_assisted&quot;,
        tool_lookup=&quot;embedding&quot;,
        input_guardrails=[&quot;keyword_blocklist_guardrail&quot;],
        output_guardrails=[&quot;keyword_blocklist_guardrail&quot;],
    ),
    guardrail_configurations={
        &quot;keyword_blocklist_guardrail_v1&quot;: {
            &quot;blocklist&quot;: [&quot;secret&quot;, &quot;forbidden_word&quot;, &quot;sensitive_operation&quot;],
            &quot;case_sensitive&quot;: False,
            &quot;action_on_match&quot;: &quot;block&quot;
        }
    },
    tool_configurations={
        &quot;calculator_tool&quot;: {}
    }
)

genie: Optional[Genie] = None
try:
    print(&quot;\nInitializing Genie with Guardrails enabled...&quot;)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie initialized!&quot;)

    print(&quot;\n--- Testing Input Guardrail (LLM Chat) ---&quot;)
    blocked_input_prompt = &quot;Tell me a secret about the project.&quot;
    print(f&quot;Sending potentially blocked input: &#39;{blocked_input_prompt}&#39;&quot;)
    try:
        chat_response_blocked = await genie.llm.chat([{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: blocked_input_prompt}])
        print(f&quot;LLM Response (should not be reached if blocked): {chat_response_blocked[&#39;message&#39;][&#39;content&#39;]}&quot;)
    except PermissionError as e_perm:
        print(f&quot;Input Guardrail Blocked: {e_perm}&quot;)
    except Exception as e_llm_in:
        print(f&quot;LLM chat error (possibly unrelated to guardrail): {e_llm_in}&quot;)

    allowed_input_prompt = &quot;Tell me a fun fact.&quot;
    print(f&quot;\nSending allowed input: &#39;{allowed_input_prompt}&#39;&quot;)
    try:
        chat_response_allowed = await genie.llm.chat([{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: allowed_input_prompt}])
        print(f&quot;LLM Response: {chat_response_allowed[&#39;message&#39;][&#39;content&#39;][:100]}...&quot;)
    except Exception as e_llm_allowed:
        print(f&quot;LLM chat error for allowed input: {e_llm_allowed}&quot;)


    print(&quot;\n--- Testing Output Guardrail (LLM Generate) ---&quot;)
    prompt_for_blocked_output = &quot;Write a sentence that includes the word &#39;secret&#39;.&quot;
    print(f&quot;Sending prompt for potentially blocked output: &#39;{prompt_for_blocked_output}&#39;&quot;)
    try:
        gen_response = await genie.llm.generate(prompt_for_blocked_output)
        print(f&quot;LLM Generated Text: {gen_response[&#39;text&#39;]}&quot;)
        if &quot;[RESPONSE BLOCKED&quot; in gen_response[&quot;text&quot;]:
            print(&quot;Output Guardrail successfully blocked the response.&quot;)
        elif &quot;secret&quot; in gen_response[&quot;text&quot;].lower():
             print(&quot;Warning: Output guardrail did not block &#39;secret&#39; as expected. LLM output was: &quot;, gen_response[&quot;text&quot;])
    except Exception as e_gen:
        print(f&quot;LLM generate error: {e_gen}&quot;)

    print(&quot;\n--- (Illustrative) Tool Usage Guardrail ---&quot;)
    print(&quot;To test tool usage guardrails, enable &#39;tool_usage_guardrails&#39; in FeatureSettings&quot;)
    print(&quot;and try a command that would pass a blocked keyword as a tool parameter.&quot;)

except Exception as e:
    print(f&quot;\nAn error occurred: {e}&quot;)
    logging.exception(&quot;Guardrails demo error details:&quot;)
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    asyncio.run(run_guardrails_demo())</p></section><section class="print-page" id="tutorials-e22_distributed_task_example" heading-number="4.22"><h1 id="tutorials-e22_distributed_task_example-tutorial-distributed-tasks-e22">Tutorial: Distributed Tasks (E22)<a class="headerlink" href="#tutorials-e22_distributed_task_example-tutorial-distributed-tasks-e22" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E22_distributed_task_example.py</code>.</p>
<p>It demonstrates how to offload long-running tasks to a distributed queue like Celery or RQ. It shows how to:
- Configure a <code>DistributedTaskQueuePlugin</code> for Celery or RQ.
- Use <code>genie.task_queue.submit_task()</code> to send a task to a worker.
- Use <code>genie.task_queue.get_task_status()</code> and <code>genie.task_queue.get_task_result()</code> to monitor and retrieve results.</p>
<p><strong>Note</strong>: This example focuses on the client-side API. A running Celery/RQ worker environment is required to execute the tasks.</p>
<h2 id="tutorials-e22_distributed_task_example-example-code">Example Code<a class="headerlink" href="#tutorials-e22_distributed_task_example-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e22_distributed_task_example-examplese22_distributed_task_examplepy">examples/E22_distributed_task_example.py<a class="headerlink" href="#tutorials-e22_distributed_task_example-examplese22_distributed_task_examplepy" title="Permanent link">&para;</a></h1>
<p>"""
Example: Distributed Task Offloading (Conceptual)</p>
<hr />
<p>This example outlines how one might use the Distributed Task Queue feature
with Celery or RQ. It assumes:
1. Celery/RQ and a broker (e.g., Redis) are installed.
2. A worker is running and configured to find tasks.
3. A task (e.g., <code>execute_genie_tool_task</code>) is defined for the worker
   that can instantiate a minimal Genie environment or directly execute a tool.</p>
<p>This example focuses on the Genie client-side configuration and submission.
The worker-side task implementation is beyond this basic example.</p>
<p>To Run (Conceptual - requires worker setup):
1. Start Redis: <code>docker run -d -p 6379:6379 redis</code>
2. Start a Celery or RQ worker (details depend on your task definitions).
3. Run this script: <code>poetry run python examples/E22_distributed_task_example.py</code>
"""
import asyncio
import logging
from typing import Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie</p>
<p>REMOTE_TOOL_EXEC_TASK_NAME = "genie_tooling.worker_tasks.execute_genie_tool_task" # Placeholder</p>
<p>async def run_distributed_task_demo():
    print("--- Distributed Task Offloading Demo (Conceptual) ---")
    logging.basicConfig(level=logging.INFO)
    # logging.getLogger("genie_tooling").setLevel(logging.DEBUG)</p>
<div class="highlight"><pre><span></span><code># --- Configuration for Celery ---
app_config_celery = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;none&quot;,
        command_processor=&quot;none&quot;,
        task_queue=&quot;celery&quot;,
        task_queue_celery_broker_url=&quot;redis://localhost:6379/1&quot;,
        task_queue_celery_backend_url=&quot;redis://localhost:6379/2&quot;,
    ),
    distributed_task_queue_configurations={
        &quot;celery_task_queue_v1&quot;: {
            &quot;celery_app_name&quot;: &quot;genie_example_tasks_celery&quot;,
        }
    }
)

# --- Configuration for RQ (Redis Queue) ---
app_config_rq = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;none&quot;,
        command_processor=&quot;none&quot;,
        task_queue=&quot;rq&quot;,
    ),
    distributed_task_queue_configurations={
        &quot;redis_queue_task_plugin_v1&quot;: { # Canonical ID for RQ plugin
            &quot;redis_url&quot;: &quot;redis://localhost:6379/3&quot;, # Separate Redis DB for RQ
            &quot;default_queue_name&quot;: &quot;genie-rq-jobs&quot;
        }
    }
)

# Select the configuration to use
app_config = app_config_celery
# app_config = app_config_rq # Uncomment to test with RQ

print(f&quot;Using task queue: {app_config.features.task_queue}&quot;)

genie: Optional[Genie] = None
try:
    genie = await Genie.create(config=app_config)
    print(f&quot;Genie initialized with {app_config.features.task_queue} task queue support.&quot;)

    tool_exec_params = {
        &quot;tool_id&quot;: &quot;calculator_tool&quot;,
        &quot;tool_params&quot;: {&quot;num1&quot;: 200, &quot;num2&quot;: 25, &quot;operation&quot;: &quot;multiply&quot;},
        &quot;context_info&quot;: {&quot;user_id&quot;: &quot;demo_user&quot;}
    }

    task_id_tool = await genie.task_queue.submit_task(
        task_name=REMOTE_TOOL_EXEC_TASK_NAME,
        kwargs=tool_exec_params
    )

    if task_id_tool:
        print(f&quot;Tool execution task for &#39;calculator_tool&#39; submitted with ID: {task_id_tool}&quot;)
        result_output = &quot;Polling for result...&quot;
        for i in range(15): # Poll for up to 15 seconds
            status = await genie.task_queue.get_task_status(task_id_tool)
            print(f&quot;  (Poll {i+1}) Task {task_id_tool} status: {status}&quot;)
            if status == &quot;success&quot;:
                tool_result = await genie.task_queue.get_task_result(task_id_tool)
                result_output = f&quot;Tool task &#39;{task_id_tool}&#39; successful. Result: {tool_result}&quot;
                break
            elif status in [&quot;failure&quot;, &quot;revoked&quot;]:
                result_output = f&quot;Tool task &#39;{task_id_tool}&#39; failed or revoked. Status: {status}&quot;
                try:
                    error_details = await genie.task_queue.get_task_result(task_id_tool)
                    result_output += f&quot; Details: {error_details}&quot;
                except Exception:
                    pass # Error details might not be available or might raise
                break
            await asyncio.sleep(1)
        print(result_output)
    else:
        print(&quot;Failed to submit tool execution task.&quot;)

except Exception as e:
    print(f&quot;An error occurred: {e}&quot;)
    logging.exception(&quot;Distributed task demo error details:&quot;)
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    print("This example is conceptual and requires a configured Celery/RQ worker.")
    print("It demonstrates the client-side API usage for both.")
    asyncio.run(run_distributed_task_demo())</p></section><section class="print-page" id="tutorials-e23_local_e2e_llama_cpp_server" heading-number="4.23"><h1 id="tutorials-e23_local_e2e_llama_cpp_server-tutorial-llamacpp-server-e2e-e23">Tutorial: Llama.cpp Server E2E (E23)<a class="headerlink" href="#tutorials-e23_local_e2e_llama_cpp_server-tutorial-llamacpp-server-e2e-e23" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E23_local_e2e_llama_cpp_server.py</code>.</p>
<p>It provides a comprehensive end-to-end test using the Llama.cpp server provider. It covers most of Genie's features in a single, integrated script, including:
- LLM chat and generation with Pydantic parsing (GBNF).
- RAG indexing and search.
- Custom tool registration and execution.
- Command processing with HITL.
- Prompt management and conversation state.
- Guardrails and token usage tracking.
- A simple ReAct agent loop.</p>
<h2 id="tutorials-e23_local_e2e_llama_cpp_server-example-code">Example Code<a class="headerlink" href="#tutorials-e23_local_e2e_llama_cpp_server-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e23_local_e2e_llama_cpp_server-examplese23_local_e2e_llama_cpp_serverpy">examples/E23_local_e2e_llama_cpp_server.py<a class="headerlink" href="#tutorials-e23_local_e2e_llama_cpp_server-examplese23_local_e2e_llama_cpp_serverpy" title="Permanent link">&para;</a></h1>
<p>"""
End-to-End Test for Genie Tooling with Llama.cpp Server Provider</p>
<hr />
<p>This example demonstrates a comprehensive flow using the Genie facade,
targeting a Llama.cpp server (Ollama-compatible API) for LLM operations.
It covers LLM chat/generate with Pydantic parsing, RAG, custom tool
execution, command processing with HITL, prompt management, conversation
state, guardrails, and a simple ReActAgent.</p>
<p>It also demonstrates the use of the <code>@traceable</code> decorator for adding
custom application logic to the observability trace.</p>
<p>Prerequisites:
1. <code>genie-tooling</code> installed (<code>poetry install --all-extras</code>).
2. A Llama.cpp server running and accessible, typically at <code>http://localhost:8080</code>.
   The server should be configured with a GBNF-compatible model (e.g., Mistral).
   You can set the model alias used by the server via the <code>LLAMA_CPP_MODEL_ALIAS</code>
   environment variable (defaults to "mistral:latest" if not set).
   Example server command:
   <code>./server -m mistral-7b-instruct-v0.2.Q4_K_M.gguf -c 4096 --host 0.0.0.0 --port 8080 --api-key mysecretkey --model-alias mistral:latest --cont-batching --embedding --gbnf-enabled</code>
   (Adjust model path and other server parameters as needed. If using an API key,
    set <code>LLAMA_CPP_API_KEY="mysecretkey"</code> in your environment for this script.)
"""
import asyncio
import json
import logging
import os
import shutil
import uuid
from pathlib import Path
from typing import Any, Dict, Optional</p>
<p>from genie_tooling import tool
from genie_tooling.agents.react_agent import ReActAgent
from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie
from genie_tooling.observability import traceable  # Import the new decorator
from pydantic import BaseModel
from pydantic import Field as PydanticField</p>
<h1 id="tutorials-e23_local_e2e_llama_cpp_server--configuration-">--- Configuration ---<a class="headerlink" href="#tutorials-e23_local_e2e_llama_cpp_server--configuration-" title="Permanent link">&para;</a></h1>
<p>LLAMA_CPP_BASE_URL = os.getenv("LLAMA_CPP_BASE_URL", "http://localhost:8080")
LLAMA_CPP_MODEL_ALIAS = os.getenv("LLAMA_CPP_MODEL_ALIAS", "mistral:latest") # Model alias server uses
LLAMA_CPP_API_KEY_NAME = "LLAMA_CPP_API_KEY" # Env var name for the API key if server needs one</p>
<h1 id="tutorials-e23_local_e2e_llama_cpp_server--pydantic-model-for-llm-output-parsing-">--- Pydantic Model for LLM Output Parsing ---<a class="headerlink" href="#tutorials-e23_local_e2e_llama_cpp_server--pydantic-model-for-llm-output-parsing-" title="Permanent link">&para;</a></h1>
<p>class ExtractedDetails(BaseModel):
    item_name: str = PydanticField(description="The name of the item.")
    quantity: int = PydanticField(gt=0, description="The quantity of the item.")
    notes: Optional[str] = PydanticField(None, description="Optional notes about the item.")</p>
<h1 id="tutorials-e23_local_e2e_llama_cpp_server--helper-function-decorated-with-traceable-">--- Helper function decorated with @traceable ---<a class="headerlink" href="#tutorials-e23_local_e2e_llama_cpp_server--helper-function-decorated-with-traceable-" title="Permanent link">&para;</a></h1>
<p>@traceable
async def _get_size_from_path(file_path: Path, context: Dict[str, Any]) -&gt; int:
    """A helper function to demonstrate custom tracing."""
    # This function's execution will appear as a nested span in the trace.
    # The 'file_path' argument will be automatically added as a span attribute.
    logging.info(f"[_get_size_from_path] Getting size for: {file_path}")
    return file_path.stat().st_size</p>
<h1 id="tutorials-e23_local_e2e_llama_cpp_server--custom-tool-definition-">--- Custom Tool Definition ---<a class="headerlink" href="#tutorials-e23_local_e2e_llama_cpp_server--custom-tool-definition-" title="Permanent link">&para;</a></h1>
<p>@tool
async def get_file_metadata(file_path: str, context: Dict[str, Any]) -&gt; Dict[str, Any]:
    """
    Retrieves metadata for a specified file within the agent's sandbox.
    Args:
        file_path (str): The relative path to the file within the agent's sandbox.
        context (Dict[str, Any]): The invocation context, used for tracing.
    Returns:
        Dict[str, Any]: A dictionary containing file metadata (name, size, exists) or an error.
    """
    sandbox_base = Path("./e23_agent_sandbox")
    try:
        prospective_path = (sandbox_base / file_path).resolve()
        if not str(prospective_path).startswith(str(sandbox_base.resolve())):
            return {"error": "Path traversal attempt detected.", "path_resolved": str(prospective_path)}
        full_path = prospective_path
    except Exception as e:
        return {"error": f"Path resolution error: {e!s}"}</p>
<div class="highlight"><pre><span></span><code>if full_path.exists() and full_path.is_file():
    # Call the traceable helper function, passing the context through
    file_size = await _get_size_from_path(file_path=full_path, context=context)
    return {&quot;file_name&quot;: full_path.name, &quot;size_bytes&quot;: file_size, &quot;exists&quot;: True}
else:
    return {&quot;error&quot;: &quot;File not found or is not a file.&quot;, &quot;path_checked&quot;: str(full_path), &quot;exists&quot;: False}
</code></pre></div>
<p>async def run_local_e2e_llama_cpp_server():
    logging.basicConfig(level=logging.INFO)
    # logging.getLogger("genie_tooling").setLevel(logging.DEBUG)
    # logging.getLogger("genie_tooling.llm_providers.impl.llama_cpp_provider").setLevel(logging.DEBUG)</p>
<div class="highlight"><pre><span></span><code>print(f&quot;--- Genie Tooling Local E2E Test (Llama.cpp Server @ {LLAMA_CPP_BASE_URL} with model {LLAMA_CPP_MODEL_ALIAS}) ---&quot;)
if os.getenv(LLAMA_CPP_API_KEY_NAME):
    print(f&quot;Using API Key from environment variable: {LLAMA_CPP_API_KEY_NAME}&quot;)
else:
    print(f&quot;No API Key ({LLAMA_CPP_API_KEY_NAME}) found in environment. Assuming server does not require one.&quot;)


sandbox_dir = Path(&quot;./e23_agent_sandbox&quot;)
rag_data_dir = sandbox_dir / &quot;rag_docs&quot;
prompt_dir = Path(&quot;./e23_prompts&quot;)

for p in [sandbox_dir, rag_data_dir, prompt_dir]:
    if p.exists(): shutil.rmtree(p)
    p.mkdir(parents=True, exist_ok=True)

(rag_data_dir / &quot;doc1.txt&quot;).write_text(&quot;Llama.cpp is a C/C++ port of Llama for fast inference.&quot;)
(rag_data_dir / &quot;doc2.txt&quot;).write_text(&quot;Genie Tooling uses llama.cpp via its Ollama-compatible API for structured output.&quot;)
(prompt_dir / &quot;greeting_template.j2&quot;).write_text(
    &#39;[{&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: &quot;You are {{ bot_name }}.&quot;},\n&#39;
    &#39; {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Hello! My name is {{ user_name }}.&quot;}]&#39;
)
(sandbox_dir / &quot;testfile.txt&quot;).write_text(&quot;This is a test file for metadata.&quot;)
(prompt_dir / &quot;react_agent_system_prompt_v1.j2&quot;).write_text(
    &quot;You are ReActBot. Your goal is: {{ goal }}.\n&quot;
    &quot;Available tools:\n{{ tool_definitions }}\n&quot;
    &quot;Scratchpad (Thought/Action/Observation cycles):\n{{ scratchpad }}\nThought:&quot;
)

app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;llama_cpp&quot;, # Target Llama.cpp server
        llm_llama_cpp_base_url=LLAMA_CPP_BASE_URL,
        llm_llama_cpp_model_name=LLAMA_CPP_MODEL_ALIAS,
        llm_llama_cpp_api_key_name=LLAMA_CPP_API_KEY_NAME if os.getenv(LLAMA_CPP_API_KEY_NAME) else None,

        command_processor=&quot;llm_assisted&quot;,
        command_processor_formatter_id_alias=&quot;compact_text_formatter&quot;,
        tool_lookup=&quot;embedding&quot;,
        tool_lookup_embedder_id_alias=&quot;st_embedder&quot;,
        tool_lookup_formatter_id_alias=&quot;compact_text_formatter&quot;,
        rag_loader=&quot;file_system&quot;,
        rag_embedder=&quot;sentence_transformer&quot;,
        rag_vector_store=&quot;faiss&quot;,
        cache=&quot;in-memory&quot;,
        observability_tracer=&quot;console_tracer&quot;,
        hitl_approver=&quot;cli_hitl_approver&quot;,
        token_usage_recorder=&quot;in_memory_token_recorder&quot;,
        input_guardrails=[&quot;keyword_blocklist_guardrail&quot;],
        prompt_registry=&quot;file_system_prompt_registry&quot;,
        prompt_template_engine=&quot;jinja2_chat_formatter&quot;,
        conversation_state_provider=&quot;in_memory_convo_provider&quot;,
        default_llm_output_parser=&quot;pydantic_output_parser&quot;
    ),
    # The @tool decorated `get_file_metadata` is auto-enabled by default.
    # Class-based tools like calculator and sandboxed_fs still need to be enabled.
    tool_configurations={
        &quot;calculator_tool&quot;: {},
        &quot;sandboxed_fs_tool_v1&quot;: {&quot;sandbox_base_path&quot;: str(sandbox_dir.resolve())},
    },
    guardrail_configurations={
        &quot;keyword_blocklist_guardrail_v1&quot;: {
            &quot;blocklist&quot;: [&quot;super_secret_project_X&quot;, &quot;highly_classified_info&quot;],
            &quot;action_on_match&quot;: &quot;block&quot;
        }
    },
    prompt_registry_configurations={
        &quot;file_system_prompt_registry_v1&quot;: {
            &quot;base_path&quot;: str(prompt_dir.resolve()),
            &quot;template_suffix&quot;: &quot;.j2&quot;
        }
    },
    observability_tracer_configurations={
        &quot;console_tracer_plugin_v1&quot;: {&quot;log_level&quot;: &quot;INFO&quot;}
    }
)

genie: Optional[Genie] = None
try:
    print(&quot;\n[1] Initializing Genie facade...&quot;)
    genie = await Genie.create(config=app_config)
    await genie.register_tool_functions([get_file_metadata])
    print(&quot;Genie facade initialized and custom tool registered!&quot;)

    print(&quot;\n[2] Testing LLM Chat and Generate (with Pydantic parsing)...&quot;)
    try:
        chat_resp = await genie.llm.chat([{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Hello Llama.cpp server! Write a short, friendly greeting.&quot;}])
        print(f&quot;  LLM Chat Response: {chat_resp[&#39;message&#39;][&#39;content&#39;][:100]}...&quot;)

        gen_prompt = &quot;Extract details: Item is &#39;SuperWidget&#39;, quantity is 55, notes: &#39;Handle with care&#39;.&quot;
        gen_resp = await genie.llm.generate(
            prompt=f&quot;You must output ONLY a valid JSON object. {gen_prompt}&quot;,
            output_schema=ExtractedDetails, # For GBNF
            temperature=0.1,
            n_predict=256 # Llama.cpp server needs n_predict for GBNF with /v1/completions
        )
        print(f&quot;  LLM Generate (raw text for Pydantic): {gen_resp[&#39;text&#39;]}&quot;)
        parsed_details = await genie.llm.parse_output(gen_resp, schema=ExtractedDetails)
        if isinstance(parsed_details, ExtractedDetails):
            print(f&quot;  Parsed Pydantic: Name=&#39;{parsed_details.item_name}&#39;, Qty=&#39;{parsed_details.quantity}&#39;, Notes=&#39;{parsed_details.notes}&#39;&quot;)
            assert parsed_details.item_name == &quot;SuperWidget&quot;
            assert parsed_details.quantity == 55
        else:
            assert False, f&quot;Pydantic parsing failed, got type: {type(parsed_details)}&quot;
    except Exception as e_llm:
        print(f&quot;  LLM Error: {e_llm} (Is Llama.cpp server running with model &#39;{LLAMA_CPP_MODEL_ALIAS}&#39; at {LLAMA_CPP_BASE_URL} and GBNF enabled?)&quot;)
        raise

    print(&quot;\n[3] Testing RAG (indexing and search)...&quot;)
    try:
        rag_collection_name = &quot;e23_llama_docs&quot;
        index_result = await genie.rag.index_directory(str(rag_data_dir.resolve()), collection_name=rag_collection_name)
        print(f&quot;  Indexed documents from &#39;{rag_data_dir.resolve()}&#39;. Result: {index_result}&quot;)
        assert index_result.get(&quot;status&quot;) == &quot;success&quot;
        rag_results = await genie.rag.search(&quot;What is Llama.cpp?&quot;, collection_name=rag_collection_name, top_k=1)
        if rag_results:
            print(f&quot;  RAG Search Result: &#39;{rag_results[0].content[:100]}...&#39; (Score: {rag_results[0].score:.2f})&quot;)
            assert &quot;Llama.cpp&quot; in rag_results[0].content
        else:
            assert False, &quot;RAG search returned no results&quot;
    except Exception as e_rag:
        print(f&quot;  RAG Error: {e_rag}&quot;)
        raise

    print(&quot;\n[4] Testing direct custom tool execution (get_file_metadata)...&quot;)
    try:
        metadata_result = await genie.execute_tool(&quot;get_file_metadata&quot;, file_path=&quot;testfile.txt&quot;)
        print(f&quot;  Metadata for &#39;testfile.txt&#39;: {metadata_result}&quot;)
        assert metadata_result.get(&quot;file_name&quot;) == &quot;testfile.txt&quot;
        assert metadata_result.get(&quot;exists&quot;) is True
    except Exception as e_tool_direct:
        print(f&quot;  Direct tool execution error: {e_tool_direct}&quot;)
        raise

    print(&quot;\n[5] Testing `run_command` (LLM-assisted, HITL)...&quot;)
    try:
        command_text = &quot;What is the size of the file named testfile.txt in the sandbox?&quot;
        print(f&quot;  Sending command: &#39;{command_text}&#39; (Approval may be requested on CLI)&quot;)
        command_result = await genie.run_command(command_text)
        print(f&quot;  `run_command` result: {json.dumps(command_result, indent=2, default=str)}&quot;)
        assert command_result.get(&quot;tool_result&quot;, {}).get(&quot;size_bytes&quot;) is not None or \
               command_result.get(&quot;hitl_decision&quot;, {}).get(&quot;status&quot;) != &quot;approved&quot;, \
               f&quot;Tool did not run or HITL was not approved. Result: {command_result}&quot;
    except Exception as e_run_cmd:
        print(f&quot;  `run_command` error: {e_run_cmd}&quot;)
        raise

    print(&quot;\n[6] Testing Prompt Management...&quot;)
    try:
        prompt_data = {&quot;bot_name&quot;: &quot;E23-Bot&quot;, &quot;user_name&quot;: &quot;Tester&quot;}
        rendered_chat_prompt = await genie.prompts.render_chat_prompt(name=&quot;greeting_template&quot;, data=prompt_data)
        assert rendered_chat_prompt is not None and len(rendered_chat_prompt) == 2
        print(f&quot;  Rendered chat prompt: {rendered_chat_prompt}&quot;)
    except Exception as e_prompt:
        print(f&quot;  Prompt management error: {e_prompt}&quot;)
        raise

    print(&quot;\n[7] Testing Conversation State...&quot;)
    try:
        session_id = f&quot;e23_session_{uuid.uuid4().hex[:6]}&quot;
        await genie.conversation.add_message(session_id, {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;First turn in e23 test.&quot;})
        await genie.conversation.add_message(session_id, {&quot;role&quot;: &quot;assistant&quot;, &quot;content&quot;: &quot;Acknowledged first turn.&quot;})
        state = await genie.conversation.load_state(session_id)
        assert state is not None and len(state[&quot;history&quot;]) == 2
        print(f&quot;  Conversation history for {session_id} (last 2): {state[&#39;history&#39;][-2:]}&quot;)
    except Exception as e_convo:
        print(f&quot;  Conversation state error: {e_convo}&quot;)
        raise

    print(&quot;\n[8] Testing Input Guardrail...&quot;)
    try:
        blocked_input = &quot;Tell me about super_secret_project_X.&quot;
        print(f&quot;  Sending potentially blocked input: &#39;{blocked_input}&#39;&quot;)
        await genie.llm.chat([{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: blocked_input}])
        assert False, &quot;Input guardrail did not block as expected.&quot;
    except PermissionError as e_perm:
        print(f&quot;  Guardrail test: Input successfully blocked: {e_perm}&quot;)
    except Exception as e_guard:
        print(f&quot;  Guardrail test error (possibly unrelated to guardrail): {e_guard}&quot;)
        raise

    print(&quot;\n[9] Testing ReActAgent...&quot;)
    try:
        react_agent = ReActAgent(genie=genie, agent_config={&quot;max_iterations&quot;: 3})
        agent_goal = &quot;What is 15 plus 7 using the calculator?&quot;
        print(f&quot;  Agent Goal: &#39;{agent_goal}&#39; (Tool use by agent does not trigger interactive HITL here)&quot;)
        agent_result = await react_agent.run(goal=agent_goal)
        print(f&quot;  ReActAgent Result Status: {agent_result[&#39;status&#39;]}&quot;)
        print(f&quot;  ReActAgent Output: {str(agent_result[&#39;output&#39;])[:200]}...&quot;)
        assert agent_result[&quot;status&quot;] == &quot;success&quot;
        assert &quot;22&quot; in str(agent_result[&quot;output&quot;])
    except Exception as e_agent:
        print(f&quot;  ReActAgent Error: {e_agent}&quot;)
        raise

    print(&quot;\n[10] Testing Token Usage Summary...&quot;)
    try:
        usage_summary = await genie.usage.get_summary()
        print(f&quot;  Token Usage: {json.dumps(usage_summary, indent=2)}&quot;)
        recorder_id = &quot;in_memory_token_usage_recorder_v1&quot;
        assert recorder_id in usage_summary, f&quot;Recorder &#39;{recorder_id}&#39; not found in usage summary.&quot;
        assert usage_summary[recorder_id][&quot;total_records&quot;] &gt; 0
    except Exception as e_usage:
        print(f&quot;  Token usage error: {e_usage}&quot;)
        raise

    print(&quot;\n--- E2E Test PASSED ---&quot;)

except Exception as e_main:
    print(f&quot;\nE2E Test FAILED with critical error: {e_main}&quot;)
    logging.error(&quot;E2E Main Error&quot;, exc_info=True)
    raise
finally:
    if genie:
        print(&quot;\n[11] Tearing down Genie facade...&quot;)
        await genie.close()
        print(&quot;Genie facade torn down.&quot;)

    print(&quot;\n[12] Cleaning up test files/directories...&quot;)
    for p_cleanup in [sandbox_dir, prompt_dir]:
        if p_cleanup.exists(): shutil.rmtree(p_cleanup, ignore_errors=True)
    print(&quot;Cleanup complete.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    asyncio.run(run_local_e2e_llama_cpp_server())</p></section><section class="print-page" id="tutorials-e24_local_e2e_llama_cpp_internal" heading-number="4.24"><h1 id="tutorials-e24_local_e2e_llama_cpp_internal-tutorial-llamacpp-internal-e2e-e24">Tutorial: Llama.cpp Internal E2E (E24)<a class="headerlink" href="#tutorials-e24_local_e2e_llama_cpp_internal-tutorial-llamacpp-internal-e2e-e24" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E24_local_e2e_llama_cpp_internal.py</code>.</p>
<p>It provides a comprehensive end-to-end test using the Llama.cpp internal provider, which runs GGUF models directly without a separate server. It covers the same range of features as the Llama.cpp server E2E test, demonstrating a fully local and self-contained agent setup.</p>
<p><strong>Prerequisite</strong>: You must download a GGUF model file and update the path in the example script.</p>
<h2 id="tutorials-e24_local_e2e_llama_cpp_internal-example-code">Example Code<a class="headerlink" href="#tutorials-e24_local_e2e_llama_cpp_internal-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e24_local_e2e_llama_cpp_internal-examplese24_local_e2e_llama_cpp_internalpy">examples/E24_local_e2e_llama_cpp_internal.py<a class="headerlink" href="#tutorials-e24_local_e2e_llama_cpp_internal-examplese24_local_e2e_llama_cpp_internalpy" title="Permanent link">&para;</a></h1>
<p>"""
End-to-End Test for Genie Tooling with Llama.cpp Internal Provider</p>
<hr />
<p>This example demonstrates a comprehensive flow using the Genie facade,
specifically targeting the Llama.cpp internal provider for LLM operations.
It covers LLM chat/generate with Pydantic parsing, RAG, custom tool
execution, command processing with HITL, prompt management, conversation
state, guardrails, and a simple ReActAgent.</p>
<p>Prerequisites:
1. <code>genie-tooling</code> installed (<code>poetry install --all-extras --extras llama_cpp_internal</code>).
2. A GGUF-format LLM model file downloaded locally.
3. <strong>Update <code>LLAMA_CPP_INTERNAL_MODEL_PATH</code> below to point to your model file.</strong>
"""
import asyncio
import json
import logging
import os
import shutil
from pathlib import Path
from typing import Any, Dict, Optional</p>
<p>from genie_tooling import tool
from genie_tooling.agents.react_agent import ReActAgent
from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie
from pydantic import BaseModel
from pydantic import Field as PydanticField</p>
<h1 id="tutorials-e24_local_e2e_llama_cpp_internal--configuration-">--- Configuration ---<a class="headerlink" href="#tutorials-e24_local_e2e_llama_cpp_internal--configuration-" title="Permanent link">&para;</a></h1>
<h1 id="tutorials-e24_local_e2e_llama_cpp_internal-user-action-required-update-this-path-to-your-gguf-model-file">!!! USER ACTION REQUIRED: Update this path to your GGUF model file !!!<a class="headerlink" href="#tutorials-e24_local_e2e_llama_cpp_internal-user-action-required-update-this-path-to-your-gguf-model-file" title="Permanent link">&para;</a></h1>
<p>LLAMA_CPP_INTERNAL_MODEL_PATH = os.getenv("LLAMA_CPP_INTERNAL_MODEL_PATH", "/path/to/your/model.gguf")</p>
<h1 id="tutorials-e24_local_e2e_llama_cpp_internal-example-llama_cpp_internal_model_path-homeusermodelsmistral-7b-instruct-v02q4_k_mgguf">Example: LLAMA_CPP_INTERNAL_MODEL_PATH = "/home/user/models/mistral-7b-instruct-v0.2.Q4_K_M.gguf"<a class="headerlink" href="#tutorials-e24_local_e2e_llama_cpp_internal-example-llama_cpp_internal_model_path-homeusermodelsmistral-7b-instruct-v02q4_k_mgguf" title="Permanent link">&para;</a></h1>
<h1 id="tutorials-e24_local_e2e_llama_cpp_internal--pydantic-model-for-llm-output-parsing-">--- Pydantic Model for LLM Output Parsing ---<a class="headerlink" href="#tutorials-e24_local_e2e_llama_cpp_internal--pydantic-model-for-llm-output-parsing-" title="Permanent link">&para;</a></h1>
<p>class ExtractedDetailsInternal(BaseModel):
    item_name: str = PydanticField(description="The name of the item.")
    quantity: int = PydanticField(gt=0, description="The quantity of the item.")
    notes: Optional[str] = PydanticField(None, description="Optional notes about the item.")</p>
<h1 id="tutorials-e24_local_e2e_llama_cpp_internal--custom-tool-definition-">--- Custom Tool Definition ---<a class="headerlink" href="#tutorials-e24_local_e2e_llama_cpp_internal--custom-tool-definition-" title="Permanent link">&para;</a></h1>
<p>@tool
async def get_file_metadata_internal(file_path: str) -&gt; Dict[str, Any]:
    """
    Retrieves metadata for a specified file within the agent's sandbox.
    Args:
        file_path (str): The relative path to the file within the agent's sandbox.
    Returns:
        Dict[str, Any]: A dictionary containing file metadata (name, size, exists) or an error.
    """
    sandbox_base = Path("./e24_agent_sandbox")
    try:
        prospective_path = (sandbox_base / file_path).resolve()
        if not str(prospective_path).startswith(str(sandbox_base.resolve())):
            return {"error": "Path traversal attempt detected.", "path_resolved": str(prospective_path)}
        full_path = prospective_path
    except Exception as e:
        return {"error": f"Path resolution error: {e!s}"}</p>
<div class="highlight"><pre><span></span><code>if full_path.exists() and full_path.is_file():
    return {&quot;file_name&quot;: full_path.name, &quot;size_bytes&quot;: full_path.stat().st_size, &quot;exists&quot;: True}
else:
    return {&quot;error&quot;: &quot;File not found or is not a file.&quot;, &quot;path_checked&quot;: str(full_path), &quot;exists&quot;: False}
</code></pre></div>
<p>async def run_local_e2e_llama_cpp_internal():
    logging.basicConfig(level=logging.INFO)
    # logging.getLogger("genie_tooling").setLevel(logging.DEBUG)
    # logging.getLogger("genie_tooling.llm_providers.impl.llama_cpp_internal_provider").setLevel(logging.DEBUG)</p>
<div class="highlight"><pre><span></span><code>model_path_obj = Path(LLAMA_CPP_INTERNAL_MODEL_PATH)
if LLAMA_CPP_INTERNAL_MODEL_PATH == &quot;/path/to/your/model.gguf&quot; or not model_path_obj.exists():
    print(&quot;\nERROR: LLAMA_CPP_INTERNAL_MODEL_PATH is not correctly set or file does not exist.&quot;)
    print(f&quot;Please edit this script (&#39;{__file__}&#39;) and update LLAMA_CPP_INTERNAL_MODEL_PATH,&quot;)
    print(&quot;or set the LLAMA_CPP_INTERNAL_MODEL_PATH environment variable.&quot;)
    print(f&quot;Current path: &#39;{LLAMA_CPP_INTERNAL_MODEL_PATH}&#39; (Exists: {model_path_obj.exists()})\n&quot;)
    return

print(f&quot;--- Genie Tooling Local E2E Test (Llama.cpp Internal with model: {model_path_obj.name}) ---&quot;)

sandbox_dir = Path(&quot;./e24_agent_sandbox&quot;)
rag_data_dir = sandbox_dir / &quot;rag_docs&quot;
prompt_dir = Path(&quot;./e24_prompts&quot;)

for p in [sandbox_dir, rag_data_dir, prompt_dir]:
    if p.exists(): shutil.rmtree(p)
    p.mkdir(parents=True, exist_ok=True)

(rag_data_dir / &quot;doc1.txt&quot;).write_text(&quot;Internal Llama.cpp provides local GGUF model execution.&quot;)
(rag_data_dir / &quot;doc2.txt&quot;).write_text(&quot;Genie Tooling integrates llama-cpp-python for this.&quot;)
(prompt_dir / &quot;greeting_template_internal.j2&quot;).write_text(
    &#39;[{&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: &quot;You are {{ bot_name }} running on Llama.cpp internal.&quot;},\n&#39;
    &#39; {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Hello! My name is {{ user_name }}.&quot;}]&#39;
)
(sandbox_dir / &quot;testfile_internal.txt&quot;).write_text(&quot;This is a test file for internal metadata.&quot;)
(prompt_dir / &quot;react_agent_system_prompt_internal_v1.j2&quot;).write_text(
    &quot;You are ReActBot (Internal Llama). Your goal is: {{ goal }}.\n&quot;
    &quot;Available tools:\n{{ tool_definitions }}\n&quot;
    &quot;Scratchpad (Thought/Action/Observation cycles):\n{{ scratchpad }}\nThought:&quot;
)

app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;llama_cpp_internal&quot;,
        llm_llama_cpp_internal_model_path=str(model_path_obj.resolve()),
        llm_llama_cpp_internal_n_gpu_layers=-1, # Offload all to GPU if possible
        llm_llama_cpp_internal_n_ctx=2048,      # Context size
        llm_llama_cpp_internal_chat_format=&quot;mistral&quot;, # Example, adjust if your model needs a different one
        llm_llama_cpp_internal_model_name_for_logging=model_path_obj.stem, # Use model file stem for logging

        command_processor=&quot;llm_assisted&quot;,
        command_processor_formatter_id_alias=&quot;compact_text_formatter&quot;,
        tool_lookup=&quot;embedding&quot;,
        tool_lookup_embedder_id_alias=&quot;st_embedder&quot;,
        tool_lookup_formatter_id_alias=&quot;compact_text_formatter&quot;,
        rag_loader=&quot;file_system&quot;,
        rag_embedder=&quot;sentence_transformer&quot;,
        rag_vector_store=&quot;faiss&quot;,
        cache=&quot;in-memory&quot;,
        observability_tracer=&quot;console_tracer&quot;,
        hitl_approver=&quot;cli_hitl_approver&quot;,
        token_usage_recorder=&quot;in_memory_token_recorder&quot;,
        input_guardrails=[&quot;keyword_blocklist_guardrail&quot;],
        prompt_registry=&quot;file_system_prompt_registry&quot;,
        prompt_template_engine=&quot;jinja2_chat_formatter&quot;,
        conversation_state_provider=&quot;in_memory_convo_provider&quot;,
        default_llm_output_parser=&quot;pydantic_output_parser&quot;
    ),
    # The @tool decorated `get_file_metadata_internal` is auto-enabled by default.
    # Class-based tools like calculator and sandboxed_fs still need to be enabled.
    tool_configurations={
        &quot;calculator_tool&quot;: {},
        &quot;sandboxed_fs_tool_v1&quot;: {&quot;sandbox_base_path&quot;: str(sandbox_dir.resolve())},
    },
    guardrail_configurations={
        &quot;keyword_blocklist_guardrail_v1&quot;: {
            &quot;blocklist&quot;: [&quot;top_secret_internal&quot;, &quot;classified_gguf&quot;],
            &quot;action_on_match&quot;: &quot;block&quot;
        }
    },
    prompt_registry_configurations={
        &quot;file_system_prompt_registry_v1&quot;: {
            &quot;base_path&quot;: str(prompt_dir.resolve()),
            &quot;template_suffix&quot;: &quot;.j2&quot;
        }
    },
    observability_tracer_configurations={
        &quot;console_tracer_plugin_v1&quot;: {&quot;log_level&quot;: &quot;INFO&quot;}
    }
)

genie: Optional[Genie] = None
try:
    print(&quot;\n[1] Initializing Genie facade (Llama.cpp Internal)...&quot;)
    genie = await Genie.create(config=app_config)
    await genie.register_tool_functions([get_file_metadata_internal])
    print(&quot;Genie facade initialized and custom tool registered!&quot;)

    print(&quot;\n[2] Testing LLM Chat and Generate (with Pydantic parsing)...&quot;)
    try:
        chat_resp = await genie.llm.chat([{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Hello Llama.cpp internal! Write a short, friendly greeting.&quot;}])
        print(f&quot;  LLM Chat Response: {chat_resp[&#39;message&#39;][&#39;content&#39;][:100]}...&quot;)

        gen_prompt = &quot;Extract details: Item is &#39;LocalWidget&#39;, quantity is 77, notes: &#39;Needs local processing&#39;.&quot;
        gen_resp = await genie.llm.generate(
            prompt=f&quot;You must output ONLY a valid JSON object. {gen_prompt}&quot;,
            output_schema=ExtractedDetailsInternal, # For GBNF
            temperature=0.1,
            max_tokens=256 # Llama.cpp internal provider maps max_tokens to n_predict
        )
        print(f&quot;  LLM Generate (raw text for Pydantic): {gen_resp[&#39;text&#39;]}&quot;)
        parsed_details = await genie.llm.parse_output(gen_resp, schema=ExtractedDetailsInternal)
        if isinstance(parsed_details, ExtractedDetailsInternal):
            print(f&quot;  Parsed Pydantic: Name=&#39;{parsed_details.item_name}&#39;, Qty=&#39;{parsed_details.quantity}&#39;, Notes=&#39;{parsed_details.notes}&#39;&quot;)
            assert parsed_details.item_name == &quot;LocalWidget&quot;
            assert parsed_details.quantity == 77
        else:
            assert False, f&quot;Pydantic parsing failed, got type: {type(parsed_details)}&quot;
    except Exception as e_llm:
        print(f&quot;  LLM Error: {e_llm}&quot;)
        raise

    print(&quot;\n[3] Testing RAG (indexing and search)...&quot;)
    try:
        rag_collection_name = &quot;e24_internal_llama_docs&quot;
        index_result = await genie.rag.index_directory(str(rag_data_dir.resolve()), collection_name=rag_collection_name)
        print(f&quot;  Indexed documents from &#39;{rag_data_dir.resolve()}&#39;. Result: {index_result}&quot;)
        assert index_result.get(&quot;status&quot;) == &quot;success&quot;
        rag_results = await genie.rag.search(&quot;What is Llama.cpp internal?&quot;, collection_name=rag_collection_name, top_k=1)
        if rag_results:
            print(f&quot;  RAG Search Result: &#39;{rag_results[0].content[:100]}...&#39; (Score: {rag_results[0].score:.2f})&quot;)
            assert &quot;Llama.cpp&quot; in rag_results[0].content
        else:
            assert False, &quot;RAG search returned no results&quot;
    except Exception as e_rag:
        print(f&quot;  RAG Error: {e_rag}&quot;)
        raise

    print(&quot;\n[4] Testing direct custom tool execution (get_file_metadata_internal)...&quot;)
    try:
        metadata_result = await genie.execute_tool(&quot;get_file_metadata_internal&quot;, file_path=&quot;testfile_internal.txt&quot;)
        print(f&quot;  Metadata for &#39;testfile_internal.txt&#39;: {metadata_result}&quot;)
        assert metadata_result.get(&quot;file_name&quot;) == &quot;testfile_internal.txt&quot;
        assert metadata_result.get(&quot;exists&quot;) is True
    except Exception as e_tool_direct:
        print(f&quot;  Direct tool execution error: {e_tool_direct}&quot;)
        raise

    print(&quot;\n[5] Testing `run_command` (LLM-assisted, HITL)...&quot;)
    try:
        command_text = &quot;What is the size of the file named testfile_internal.txt in the sandbox?&quot;
        print(f&quot;  Sending command: &#39;{command_text}&#39; (Approval may be requested on CLI)&quot;)
        command_result = await genie.run_command(command_text)
        print(f&quot;  `run_command` result: {json.dumps(command_result, indent=2, default=str)}&quot;)
        assert command_result.get(&quot;tool_result&quot;, {}).get(&quot;size_bytes&quot;) is not None or \
               command_result.get(&quot;hitl_decision&quot;, {}).get(&quot;status&quot;) != &quot;approved&quot;, \
               f&quot;Tool did not run or HITL was not approved. Result: {command_result}&quot;
    except Exception as e_run_cmd:
        print(f&quot;  `run_command` error: {e_run_cmd}&quot;)
        raise

    print(&quot;\n[6] Testing ReActAgent with Llama.cpp Internal...&quot;)
    try:
        # Use the internal-specific prompt for the agent
        react_agent = ReActAgent(genie=genie, agent_config={&quot;max_iterations&quot;: 3, &quot;system_prompt_id&quot;: &quot;react_agent_system_prompt_internal_v1&quot;})
        agent_goal = &quot;What is 25 times 4 using the calculator?&quot;
        print(f&quot;  Agent Goal: &#39;{agent_goal}&#39;&quot;)
        agent_result = await react_agent.run(goal=agent_goal)
        print(f&quot;  ReActAgent Result Status: {agent_result[&#39;status&#39;]}&quot;)
        print(f&quot;  ReActAgent Output: {str(agent_result[&#39;output&#39;])[:200]}...&quot;)
        assert agent_result[&quot;status&quot;] == &quot;success&quot;
        assert &quot;100&quot; in str(agent_result[&quot;output&quot;])
    except Exception as e_agent:
        print(f&quot;  ReActAgent Error: {e_agent}&quot;)
        raise

    print(&quot;\n--- E2E Test with Llama.cpp Internal PASSED ---&quot;)

except Exception as e_main:
    print(f&quot;\nE2E Test FAILED with critical error: {e_main}&quot;)
    logging.error(&quot;E2E Llama.cpp Internal Main Error&quot;, exc_info=True)
    raise
finally:
    if genie:
        print(&quot;\n[X] Tearing down Genie facade...&quot;)
        await genie.close()
        print(&quot;Genie facade torn down.&quot;)

    print(&quot;\n[Y] Cleaning up test files/directories...&quot;)
    for p_cleanup in [sandbox_dir, prompt_dir]:
        if p_cleanup.exists(): shutil.rmtree(p_cleanup, ignore_errors=True)
    print(&quot;Cleanup complete.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    asyncio.run(run_local_e2e_llama_cpp_internal())</p></section><section class="print-page" id="tutorials-e25_llama_cpp_internal_gbnf_parsing" heading-number="4.25"><h1 id="tutorials-e25_llama_cpp_internal_gbnf_parsing-tutorial-llamacpp-internal-gbnf-e25">Tutorial: Llama.cpp Internal GBNF (E25)<a class="headerlink" href="#tutorials-e25_llama_cpp_internal_gbnf_parsing-tutorial-llamacpp-internal-gbnf-e25" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E25_llama_cpp_internal_gbnf_parsing.py</code>.</p>
<p>It demonstrates a key feature of the Llama.cpp providers: using GBNF grammar for constrained, structured output. It shows how to:
- Define a Pydantic model for the desired output structure.
- Pass this model to <code>genie.llm.chat()</code> via the <code>output_schema</code> parameter.
- Observe how the Llama.cpp internal provider generates a JSON string that perfectly matches the Pydantic model, which can then be parsed reliably.</p>
<h2 id="tutorials-e25_llama_cpp_internal_gbnf_parsing-example-code">Example Code<a class="headerlink" href="#tutorials-e25_llama_cpp_internal_gbnf_parsing-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e25_llama_cpp_internal_gbnf_parsing-examplese25_llama_cpp_internal_gbnf_parsingpy">examples/E25_llama_cpp_internal_gbnf_parsing.py<a class="headerlink" href="#tutorials-e25_llama_cpp_internal_gbnf_parsing-examplese25_llama_cpp_internal_gbnf_parsingpy" title="Permanent link">&para;</a></h1>
<h1 id="tutorials-e25_llama_cpp_internal_gbnf_parsing-originally-tstpy">(Originally tst.py)<a class="headerlink" href="#tutorials-e25_llama_cpp_internal_gbnf_parsing-originally-tstpy" title="Permanent link">&para;</a></h1>
<p>import asyncio
import json
import logging
import os  # Added os for getenv
from pathlib import Path
from typing import List, Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie
from genie_tooling.llm_providers.types import ChatMessage
from pydantic import BaseModel, Field</p>
<p>class ExtractedItemInfo(BaseModel):
    item_name: str = Field(description="The name of the item mentioned.")
    quantity: int = Field(description="The quantity of the item.", gt=0)
    color: Optional[str] = Field(None, description="The color of the item, if specified.")</p>
<p>async def run_llama_cpp_internal_gbnf_test():
    logging.basicConfig(level=logging.INFO)
    # logging.getLogger("genie_tooling").setLevel(logging.DEBUG)
    # logging.getLogger("genie_tooling.llm_providers.impl.llama_cpp_internal_provider").setLevel(logging.DEBUG)
    # logging.getLogger("genie_tooling.utils.gbnf").setLevel(logging.DEBUG)</p>
<div class="highlight"><pre><span></span><code>print(&quot;--- Llama.cpp Internal Provider GBNF Parsing Test ---&quot;)

# !!! USER ACTION REQUIRED: Update this path to your GGUF model file !!!
# You can also set the LLAMA_CPP_INTERNAL_MODEL_PATH environment variable.
default_model_path = &quot;/path/to/your/model.gguf&quot; # Placeholder
model_path_str = os.getenv(&quot;LLAMA_CPP_INTERNAL_MODEL_PATH&quot;, default_model_path)
# Example: model_path_str = &quot;/home/user/models/mistral-7b-instruct-v0.2.Q4_K_M.gguf&quot;

model_path = Path(model_path_str)
if model_path_str == default_model_path or not model_path.exists():
    print(&quot;\nERROR: Model path not configured or file does not exist.&quot;)
    print(f&quot;Please edit this script and set &#39;model_path_str&#39; (currently &#39;{model_path_str}&#39;)&quot;)
    print(&quot;or set the LLAMA_CPP_INTERNAL_MODEL_PATH environment variable.&quot;)
    print(f&quot;Current path check: &#39;{model_path.resolve()}&#39; (Exists: {model_path.exists()})\n&quot;)
    return

app_config = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;llama_cpp_internal&quot;,
        llm_llama_cpp_internal_model_path=str(model_path.resolve()),
        llm_llama_cpp_internal_n_gpu_layers=-1, # Offload all layers if possible
        llm_llama_cpp_internal_chat_format=&quot;mistral&quot;, # Adjust to your model if needed
        token_usage_recorder=&quot;in_memory_token_recorder&quot;,
        default_llm_output_parser=&quot;pydantic_output_parser&quot;
    )
)

genie: Optional[Genie] = None
try:
    print(f&quot;\nInitializing Genie with Llama.cpp internal provider for GBNF (Model: {model_path.name})...&quot;)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie facade initialized successfully!&quot;)

    print(&quot;\n--- LLM Chat with GBNF Example (Llama.cpp Internal) ---&quot;)
    user_prompt_for_gbnf = (
        &quot;From the sentence: &#39;I need 5 red apples for the pie.&#39;, &quot;
        &quot;extract the item name, quantity, and color. &quot;
        &quot;Please provide the output as a JSON object with keys: &#39;item_name&#39;, &#39;quantity&#39;, and &#39;color&#39;.&quot;
        &quot;Output ONLY the JSON object.&quot;
    )
    messages: List[ChatMessage] = [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: user_prompt_for_gbnf}]
    print(f&quot;Sending message to LLM for GBNF generation: &#39;{messages[0][&#39;content&#39;]}&#39;&quot;)

    chat_response = await genie.llm.chat(
        messages,
        output_schema=ExtractedItemInfo,
        temperature=0.1,
        max_tokens=256
    )
    response_content_str = chat_response.get(&quot;message&quot;, {}).get(&quot;content&quot;)
    print(f&quot;\nLLM (Llama.cpp Internal) raw JSON string output:\n{response_content_str}&quot;)

    if response_content_str:
        try:
            parsed_info: Optional[ExtractedItemInfo] = await genie.llm.parse_output(
                chat_response,
                schema=ExtractedItemInfo
            )
            if isinstance(parsed_info, ExtractedItemInfo):
                print(&quot;\nSuccessfully parsed into Pydantic model:&quot;)
                print(json.dumps(parsed_info.model_dump(), indent=2))
                assert parsed_info.item_name.lower() == &quot;apples&quot;
                assert parsed_info.quantity == 5
                assert parsed_info.color and parsed_info.color.lower() == &quot;red&quot;
                print(&quot;\nGBNF Test with Pydantic Model PASSED!&quot;)
            else:
                print(f&quot;\nERROR: Parsing did not return an ExtractedItemInfo instance. Got: {type(parsed_info)}&quot;)
        except ValueError as ve:
            print(f&quot;\nERROR: Failed to parse or validate LLM output against Pydantic model: {ve}&quot;)
            print(f&quot;LLM&#39;s raw JSON string was: {response_content_str}&quot;)
        except Exception as e_parse:
            print(f&quot;\nERROR: An unexpected error occurred during parsing: {e_parse}&quot;)
    else:
        print(&quot;\nERROR: LLM did not return any content for GBNF parsing.&quot;)

    usage_info = chat_response.get(&quot;usage&quot;)
    if usage_info:
        print(f&quot;\nToken usage: {usage_info}&quot;)
    elif genie and genie.usage:
        summary = await genie.usage.get_summary()
        print(f&quot;\nToken usage summary from recorder: {summary}&quot;)

except Exception as e:
    print(f&quot;\nAn error occurred: {e}&quot;)
    logging.exception(&quot;Llama.cpp internal GBNF test error details:&quot;)
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie facade torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    asyncio.run(run_llama_cpp_internal_gbnf_test())</p></section><section class="print-page" id="tutorials-e26_deep_research_agent_e2e" heading-number="4.26"><h1 id="tutorials-e26_deep_research_agent_e2e-tutorial-deep-research-agent-e2e-e26">Tutorial: Deep Research Agent E2E (E26)<a class="headerlink" href="#tutorials-e26_deep_research_agent_e2e-tutorial-deep-research-agent-e2e-e26" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E26_deep_research_agent_e2e.py</code>.</p>
<p>It demonstrates how to configure and run the <code>DeepResearchAgent</code>, a more advanced agent that uses a plan-and-execute strategy. It shows how to:
- Configure the agent to use specific tools for web search (DuckDuckGo) and academic paper search (ArXiv).
- Configure "deep retrieval" tools (<code>WebPageScraperTool</code>, <code>ArxivPDFTextExtractorTool</code>) that the agent can choose to use for in-depth analysis of promising search results.
- Observe the agent's planning, execution, and final report generation process.</p>
<h2 id="tutorials-e26_deep_research_agent_e2e-example-code">Example Code<a class="headerlink" href="#tutorials-e26_deep_research_agent_e2e-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e26_deep_research_agent_e2e-examplese26_deep_research_agent_e2epy">examples/E26_deep_research_agent_e2e.py<a class="headerlink" href="#tutorials-e26_deep_research_agent_e2e-examplese26_deep_research_agent_e2epy" title="Permanent link">&para;</a></h1>
<p>"""
Genie Tooling - DeepResearchAgent E2E Test with Deep Retrieval Tools
This script initializes the Genie facade, configures the DeepResearchAgent
to use DuckDuckGo for web searches, ArXiv search, and the deep retrieval tools
(WebPageScraperTool, ArxivPDFTextExtractorTool), and performs a research query.</p>
<p>This example uses the Llama.cpp server provider.</p>
<p>Prerequisites:
1. <code>genie-tooling</code> installed with relevant extras:
   <code>poetry install --all-extras</code>
   (Specifically needs: llama_cpp_server, ddg_search_tool, arxiv_tool, web_tools, pdf_tools)
2. A Llama.cpp server running (see E23 for example command), accessible via LLAMA_CPP_BASE_URL.
   Ensure the model alias (LLAMA_CPP_MODEL_ALIAS) matches your server setup.
"""
import asyncio
import json
import logging
import os
from typing import Optional</p>
<p>from dotenv import load_dotenv
from genie_tooling.agents.deep_research_agent import DeepResearchAgent
from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie</p>
<p>logging.basicConfig(level=logging.INFO)
logging.getLogger("genie_tooling.agents.deep_research_agent").setLevel(logging.DEBUG)</p>
<h1 id="tutorials-e26_deep_research_agent_e2e-logginggetloggergenie_toolingsetlevelloggingdebug">logging.getLogger("genie_tooling").setLevel(logging.DEBUG)<a class="headerlink" href="#tutorials-e26_deep_research_agent_e2e-logginggetloggergenie_toolingsetlevelloggingdebug" title="Permanent link">&para;</a></h1>
<p>LLAMA_CPP_BASE_URL = os.getenv("LLAMA_CPP_BASE_URL", "http://localhost:8080")
LLAMA_CPP_MODEL_ALIAS = os.getenv("LLAMA_CPP_MODEL_ALIAS", "mistral:latest")
LLAMA_CPP_API_KEY_NAME = "LLAMA_CPP_API_KEY"</p>
<p>async def run_deep_research_test_with_deep_dive():
    print("--- Genie Tooling: DeepResearchAgent E2E Test (Llama.cpp Server) ---")
    load_dotenv()</p>
<div class="highlight"><pre><span></span><code>print(f&quot;Using Llama.cpp server at: {LLAMA_CPP_BASE_URL} with model alias {LLAMA_CPP_MODEL_ALIAS}&quot;)
if os.getenv(LLAMA_CPP_API_KEY_NAME):
    print(f&quot;Using API Key from environment variable: {LLAMA_CPP_API_KEY_NAME}&quot;)

app_features = FeatureSettings(
    llm=&quot;llama_cpp&quot;, # Target Llama.cpp server
    llm_llama_cpp_base_url=LLAMA_CPP_BASE_URL,
    llm_llama_cpp_model_name=LLAMA_CPP_MODEL_ALIAS,
    llm_llama_cpp_api_key_name=LLAMA_CPP_API_KEY_NAME if os.getenv(LLAMA_CPP_API_KEY_NAME) else None,

    default_llm_output_parser=&quot;pydantic_output_parser&quot;,
    prompt_registry=&quot;file_system_prompt_registry&quot;,
    prompt_template_engine=&quot;jinja2_chat_formatter&quot;,
    tool_lookup=&quot;embedding&quot;,
    observability_tracer=&quot;console_tracer&quot;,
)

app_config = MiddlewareConfig(
    features=app_features,
    tool_configurations={
        &quot;duckduckgo_search_tool_v1&quot;: {},
        &quot;arxiv_search_tool&quot;: {},
        &quot;web_page_scraper_tool_v1&quot;: {},
        &quot;arxiv_pdf_extractor_tool_v1&quot;: {},
    }
)

genie: Optional[Genie] = None
try:
    print(&quot;\nInitializing Genie facade...&quot;)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie facade initialized successfully!&quot;)

    dra_agent_config = {
        &quot;web_search_tool_config&quot;: {
            &quot;tool_id&quot;: &quot;duckduckgo_search_tool_v1&quot;, &quot;num_results&quot;: 2,
            &quot;description_for_llm&quot;: &quot;Searches the web using DuckDuckGo for general information.&quot;
        },
        &quot;arxiv_search_tool_config&quot;: {
            &quot;tool_id&quot;: &quot;arxiv_search_tool&quot;, &quot;max_results&quot;: 1,
            &quot;description_for_llm&quot;: &quot;Searches ArXiv for academic papers.&quot;
        },
        &quot;web_page_scraper_tool_config&quot;: {
            &quot;tool_id&quot;: &quot;web_page_scraper_tool_v1&quot;,
            &quot;description_for_llm&quot;: &quot;Fetches and extracts text from a web URL.&quot;
        },
        &quot;arxiv_pdf_extractor_tool_config&quot;: {
            &quot;tool_id&quot;: &quot;arxiv_pdf_extractor_tool_v1&quot;,
            &quot;description_for_llm&quot;: &quot;Downloads and extracts text from an ArXiv PDF.&quot;
        },
        &quot;rag_search_tool_config&quot;: {
            &quot;collection_name&quot;: &quot;e26_research_docs&quot;, &quot;top_k&quot;: 1,
            &quot;tool_id&quot;: &quot;internal_rag_search_tool&quot;,
            &quot;description_for_llm&quot;: &quot;Searches an internal knowledge base.&quot;
        },
        &quot;max_total_gathering_cycles&quot;: 3,
        &quot;max_sub_questions_per_plan&quot;: 2,
        &quot;max_plan_refinement_cycles&quot;: 1,
        &quot;iterative_synthesis_interval&quot;: 2,
    }
    research_agent = DeepResearchAgent(genie=genie, agent_config=dra_agent_config)
    print(&quot;DeepResearchAgent initialized with deep retrieval capabilities.&quot;)

    query = &quot;Summarize the key contributions of the &#39;Transformer&#39; architecture as introduced in &#39;Attention Is All You Need&#39; (ArXiv:1706.03762) and find one recent (2023-2024) application of Transformers in natural language processing.&quot;

    print(f&quot;\nConducting research for query: &#39;{query}&#39;&quot;)
    agent_output = await research_agent.run(goal=query)

    print(&quot;\n\n--- Deep Research Agent Output ---&quot;)
    print(f&quot;Status: {agent_output[&#39;status&#39;]}&quot;)
    print(f&quot;\nFinal Report:\n{agent_output[&#39;output&#39;]}&quot;)

    print(&quot;\n--- Research Plan (Final) ---&quot;)
    if agent_output.get(&quot;plan&quot;):
        print(json.dumps(agent_output[&quot;plan&quot;], indent=2))
    else:
        print(&quot;No plan information available in output.&quot;)

    print(&quot;\n--- Research History (Snippets - first 2 if any) ---&quot;)
    if agent_output.get(&quot;history&quot;):
        snippet_count = 0
        for item in agent_output[&quot;history&quot;]:
            if item.get(&quot;type&quot;) == &quot;snippet_gathered&quot;:
                print(f&quot;  Source Type: {item.get(&#39;snippet_source_type&#39;, item.get(&#39;source_type&#39;))}, Identifier: {item.get(&#39;snippet_source&#39;, item.get(&#39;source_identifier&#39;))}&quot;)
                print(f&quot;  Sub-query: {item.get(&#39;sub_query&#39;)}&quot;)
                print(f&quot;  Extracted Info (first 150 chars): {str(item.get(&#39;extracted_info&#39;, &#39;&#39;))[:150]}...&quot;)
                snippet_count += 1
                if snippet_count &gt;= 2:
                    break
        if snippet_count == 0:
            print(&quot;  No snippets were gathered in this run (check agent DEBUG logs for details).&quot;)

except Exception as e:
    print(f&quot;\nE2E Test FAILED: An unexpected error occurred: {e}&quot;)
    import traceback
    traceback.print_exc()
finally:
    if genie:
        print(&quot;\nTearing down Genie facade...&quot;)
        await genie.close()
        print(&quot;Genie facade torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    asyncio.run(run_deep_research_test_with_deep_dive())</p></section><section class="print-page" id="tutorials-e27_pyvider_log_adapter_tracing_example" heading-number="4.27"><h1 id="tutorials-e27_pyvider_log_adapter_tracing_example-tutorial-pyvider-log-adapter-e27">Tutorial: Pyvider Log Adapter (E27)<a class="headerlink" href="#tutorials-e27_pyvider_log_adapter_tracing_example-tutorial-pyvider-log-adapter-e27" title="Permanent link">&para;</a></h1>
<p>This tutorial corresponds to the example file <code>examples/E27_pyvider_log_adapter_tracing_example.py</code>.</p>
<p>It demonstrates how to integrate Genie's eventing system with the <code>pyvider-telemetry</code> library for advanced structured logging. It shows how to:
- Configure Genie to use the <code>PyviderTelemetryLogAdapter</code>.
- Use the <code>ConsoleTracerPlugin</code>, which then delegates its output formatting to the configured Pyvider adapter.
- Observe how trace events are formatted by Pyvider (e.g., key-value or JSON, potentially with emojis).</p>
<h2 id="tutorials-e27_pyvider_log_adapter_tracing_example-example-code">Example Code<a class="headerlink" href="#tutorials-e27_pyvider_log_adapter_tracing_example-example-code" title="Permanent link">&para;</a></h2>
<h1 id="tutorials-e27_pyvider_log_adapter_tracing_example-examplese27_pyvider_log_adapter_tracing_examplepy">examples/E27_pyvider_log_adapter_tracing_example.py<a class="headerlink" href="#tutorials-e27_pyvider_log_adapter_tracing_example-examplese27_pyvider_log_adapter_tracing_examplepy" title="Permanent link">&para;</a></h1>
<p>"""
Example: Using PyviderTelemetryLogAdapter for Observability Tracing</p>
<hr />
<p>This example demonstrates how to configure Genie Tooling to use the
PyviderTelemetryLogAdapter for processing and outputting interaction traces.
It builds upon the concepts shown in E17 (Observability &amp; Tracing).</p>
<p>When PyviderTelemetryLogAdapter is active and ConsoleTracerPlugin is used,
the trace events will be formatted by Pyvider (e.g., key-value or JSON,
potentially with emojis) instead of the ConsoleTracerPlugin's default format.</p>
<p>To Run:
1. Ensure Genie Tooling is installed with Pyvider support:
   <code>poetry install --all-extras</code> or <code>poetry install --extras pyvider_adapter</code>
2. Ensure <code>pyvider-telemetry</code> library is installed (it's an optional dependency).
3. Run from the root of the project:
   <code>poetry run python examples/E27_pyvider_log_adapter_tracing_example.py</code>
   Observe the console output; it should be formatted by Pyvider.
"""
import asyncio
import logging
import traceback  # For stacktrace example
import uuid
from typing import Optional</p>
<p>from genie_tooling.config.features import FeatureSettings
from genie_tooling.config.models import MiddlewareConfig
from genie_tooling.genie import Genie</p>
<p>async def run_pyvider_observability_demo():
    print("--- Pyvider Log Adapter with Observability Tracing Example ---")</p>
<div class="highlight"><pre><span></span><code># Configure logging for the application itself (not Pyvider&#39;s internal config here)
# Pyvider will configure its own handlers based on its setup.
logging.basicConfig(level=logging.INFO)
# To see Genie&#39;s internal debug logs (not Pyvider formatted unless Pyvider is set to DEBUG for genie_tooling):
# logging.getLogger(&quot;genie_tooling&quot;).setLevel(logging.DEBUG)


# Configuration using PyviderTelemetryLogAdapter
app_config_pyvider = MiddlewareConfig(
    features=FeatureSettings(
        llm=&quot;ollama&quot;, # For an operation that generates traces
        llm_ollama_model_name=&quot;mistral:latest&quot;,

        logging_adapter=&quot;pyvider_log_adapter&quot;, # Select Pyvider
        logging_pyvider_service_name=&quot;GeniePyviderDemo&quot;, # Service name for Pyvider

        observability_tracer=&quot;console_tracer&quot; # ConsoleTracer will use the configured LogAdapter
    ),
    # Configuration for PyviderTelemetryLogAdapter
    log_adapter_configurations={
        &quot;pyvider_telemetry_log_adapter_v1&quot;: { # Canonical ID
            &quot;service_name&quot;: &quot;GeniePyviderServiceExplicit&quot;, # Overrides feature setting
            &quot;default_level&quot;: &quot;DEBUG&quot;, # Pyvider&#39;s default log level for its logger
            &quot;console_formatter&quot;: &quot;key_value&quot;, # &quot;key_value&quot; or &quot;json&quot;
            &quot;logger_name_emoji_prefix_enabled&quot;: True,
            &quot;das_emoji_prefix_enabled&quot;: True,
            &quot;omit_timestamp&quot;: False,
            # Example: Configure redactor for Pyvider adapter
            # &quot;redactor_plugin_id&quot;: &quot;schema_aware_redactor_v1&quot;,
            # &quot;redactor_config&quot;: {&quot;redact_matching_key_names&quot;: True}
        }
    },
    # ConsoleTracerPlugin itself doesn&#39;t need much config when delegating
    observability_tracer_configurations={
        &quot;console_tracer_plugin_v1&quot;: {}
    }
)

app_config = app_config_pyvider

genie: Optional[Genie] = None
try:
    print(f&quot;\nInitializing Genie with LogAdapter: {app_config.features.logging_adapter} and Tracer: {app_config.features.observability_tracer}...&quot;)
    genie = await Genie.create(config=app_config)
    print(&quot;Genie initialized! Automatic traces will now be generated and processed by PyviderTelemetryLogAdapter.&quot;)

    print(&quot;\n--- Performing operations that trigger automatic traces ---&quot;)
    try:
        # This LLM call will generate trace events (e.g., llm.chat.start, llm.chat.success)
        # which ConsoleTracerPlugin will pass to PyviderTelemetryLogAdapter.
        chat_response = await genie.llm.chat([{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Hello Pyvider Tracer! Tell me a short story.&quot;}])
        print(f&quot;LLM Response (first 60 chars): {chat_response[&#39;message&#39;][&#39;content&#39;][:60]}...&quot;)
    except Exception as e_llm:
        # This error will also be traced.
        print(f&quot;LLM call failed (expected if Ollama not running): {e_llm}&quot;)
        # Manually trace the error if needed, though Genie&#39;s LLMInterface might do it.
        await genie.observability.trace_event(
            &quot;app.llm_call.error&quot;,
            {&quot;error&quot;: str(e_llm), &quot;type&quot;: type(e_llm).__name__},
            &quot;PyviderDemoApp&quot;
        )


    print(&quot;\n--- Emitting a custom trace event (will also go through Pyvider) ---&quot;)
    custom_correlation_id = str(uuid.uuid4())
    custom_event_data = {
        &quot;user_id&quot;: &quot;pyvider_user&quot;,
        &quot;input_param&quot;: &quot;example_value_for_pyvider&quot;,
        &quot;status_override&quot;: &quot;attempt&quot; # For DAS mapping in Pyvider adapter
    }
    await genie.observability.trace_event(
        event_name=&quot;my_app.custom_pyvider_op.start&quot;,
        data=custom_event_data,
        component=&quot;MyApplicationLogic&quot;, # This might become &#39;domain&#39; in Pyvider
        correlation_id=custom_correlation_id
    )
    await asyncio.sleep(0.1) # Simulate work
    try:
        raise ValueError(&quot;Something went wrong in custom Pyvider op!&quot;)
    except ValueError as e_custom:
        await genie.observability.trace_event(
            event_name=&quot;my_app.custom_pyvider_op.error&quot;,
            data={
                &quot;status&quot;: &quot;failed&quot;, # Will be picked up by Pyvider adapter for DAS
                &quot;error_message&quot;: str(e_custom),
                &quot;error_type&quot;: type(e_custom).__name__,
                &quot;error_stacktrace&quot;: traceback.format_exc()
                },
            component=&quot;MyApplicationLogic&quot;,
            correlation_id=custom_correlation_id
        )
    print(&quot;Custom trace events (including an error) emitted and processed by Pyvider.&quot;)

except Exception as e:
    print(f&quot;\nAn error occurred in the demo: {e}&quot;)
    logging.exception(&quot;Pyvider observability demo error details:&quot;)
finally:
    if genie:
        await genie.close()
        print(&quot;\nGenie torn down.&quot;)
</code></pre></div>
<p>if <strong>name</strong> == "<strong>main</strong>":
    # Note: Pyvider's setup_telemetry might configure the root logger.
    # If you want to control formatting for non-Genie logs, configure Python's
    # root logger before Genie/Pyvider setup, or adjust Pyvider's config.
    asyncio.run(run_pyvider_observability_demo())</p></section></section><section class="print-page" id="changelog" heading-number="5"><h1 id="changelog-changelog">Changelog<a class="headerlink" href="#changelog-changelog" title="Permanent link">&para;</a></h1>
<p>All notable changes to this project will be documented in this file.</p>
<h2 id="changelog-010-yyyy-mm-dd">[0.1.0] - YYYY-MM-DD<a class="headerlink" href="#changelog-010-yyyy-mm-dd" title="Permanent link">&para;</a></h2>
<h3 id="changelog-added">Added<a class="headerlink" href="#changelog-added" title="Permanent link">&para;</a></h3>
<ul>
<li>Initial release of Genie Tooling.</li>
<li>Core components: PluginManager, Genie Facade, ToolManager, RAGManager.</li>
<li>Support for various plugins: LLM Providers (Ollama, OpenAI, Gemini, Llama.cpp), Tools, RAG components, etc.</li>
<li>Agent implementations: ReActAgent, PlanAndExecuteAgent.</li>
<li>New features including Hybrid Search, Pyvider logging, and Distributed Task Queues.</li>
</ul></section></div><style>.print-site-enumerate-headings #section-1 > h1:before { content: '1 ' }
.print-site-enumerate-headings #index > h1:before { content: '1.1 ' }

                .print-site-enumerate-headings #index h2:before { content: '1.1.' counter(counter-index-2) ' ' }
                .print-site-enumerate-headings #index h2 {  counter-increment: counter-index-2 }
            
.print-site-enumerate-headings #guides-installation > h1:before { content: '1.2 ' }

                .print-site-enumerate-headings #guides-installation h2:before { content: '1.2.' counter(counter-guides-installation-2) ' ' }
                .print-site-enumerate-headings #guides-installation h2 {  counter-increment: counter-guides-installation-2 }
            
.print-site-enumerate-headings #guides-configuration > h1:before { content: '1.3 ' }

                .print-site-enumerate-headings #guides-configuration h2:before { content: '1.3.' counter(counter-guides-configuration-2) ' ' }
                .print-site-enumerate-headings #guides-configuration h2 {  counter-increment: counter-guides-configuration-2 }
            
.print-site-enumerate-headings #guides-simplified_configuration > h1:before { content: '1.4 ' }

                .print-site-enumerate-headings #guides-simplified_configuration h2:before { content: '1.4.' counter(counter-guides-simplified_configuration-2) ' ' }
                .print-site-enumerate-headings #guides-simplified_configuration h2 {  counter-increment: counter-guides-simplified_configuration-2 }
            
.print-site-enumerate-headings #guides-using_llm_providers > h1:before { content: '1.5 ' }

                .print-site-enumerate-headings #guides-using_llm_providers h2:before { content: '1.5.' counter(counter-guides-using_llm_providers-2) ' ' }
                .print-site-enumerate-headings #guides-using_llm_providers h2 {  counter-increment: counter-guides-using_llm_providers-2 }
            
.print-site-enumerate-headings #guides-using_tools > h1:before { content: '1.6 ' }

                .print-site-enumerate-headings #guides-using_tools h2:before { content: '1.6.' counter(counter-guides-using_tools-2) ' ' }
                .print-site-enumerate-headings #guides-using_tools h2 {  counter-increment: counter-guides-using_tools-2 }
            
.print-site-enumerate-headings #guides-using_rag > h1:before { content: '1.7 ' }

                .print-site-enumerate-headings #guides-using_rag h2:before { content: '1.7.' counter(counter-guides-using_rag-2) ' ' }
                .print-site-enumerate-headings #guides-using_rag h2 {  counter-increment: counter-guides-using_rag-2 }
            
.print-site-enumerate-headings #guides-using_command_processors > h1:before { content: '1.8 ' }

                .print-site-enumerate-headings #guides-using_command_processors h2:before { content: '1.8.' counter(counter-guides-using_command_processors-2) ' ' }
                .print-site-enumerate-headings #guides-using_command_processors h2 {  counter-increment: counter-guides-using_command_processors-2 }
            
.print-site-enumerate-headings #guides-tool_lookup > h1:before { content: '1.9 ' }

                .print-site-enumerate-headings #guides-tool_lookup h2:before { content: '1.9.' counter(counter-guides-tool_lookup-2) ' ' }
                .print-site-enumerate-headings #guides-tool_lookup h2 {  counter-increment: counter-guides-tool_lookup-2 }
            
.print-site-enumerate-headings #guides-logging > h1:before { content: '1.10 ' }

                .print-site-enumerate-headings #guides-logging h2:before { content: '1.10.' counter(counter-guides-logging-2) ' ' }
                .print-site-enumerate-headings #guides-logging h2 {  counter-increment: counter-guides-logging-2 }
            
.print-site-enumerate-headings #guides-using_prompts > h1:before { content: '1.11 ' }

                .print-site-enumerate-headings #guides-using_prompts h2:before { content: '1.11.' counter(counter-guides-using_prompts-2) ' ' }
                .print-site-enumerate-headings #guides-using_prompts h2 {  counter-increment: counter-guides-using_prompts-2 }
            
.print-site-enumerate-headings #guides-using_conversation_state > h1:before { content: '1.12 ' }

                .print-site-enumerate-headings #guides-using_conversation_state h2:before { content: '1.12.' counter(counter-guides-using_conversation_state-2) ' ' }
                .print-site-enumerate-headings #guides-using_conversation_state h2 {  counter-increment: counter-guides-using_conversation_state-2 }
            
.print-site-enumerate-headings #guides-observability_tracing > h1:before { content: '1.13 ' }

                .print-site-enumerate-headings #guides-observability_tracing h2:before { content: '1.13.' counter(counter-guides-observability_tracing-2) ' ' }
                .print-site-enumerate-headings #guides-observability_tracing h2 {  counter-increment: counter-guides-observability_tracing-2 }
            
.print-site-enumerate-headings #guides-using_human_in_loop > h1:before { content: '1.14 ' }

                .print-site-enumerate-headings #guides-using_human_in_loop h2:before { content: '1.14.' counter(counter-guides-using_human_in_loop-2) ' ' }
                .print-site-enumerate-headings #guides-using_human_in_loop h2 {  counter-increment: counter-guides-using_human_in_loop-2 }
            
.print-site-enumerate-headings #guides-token_usage_tracking > h1:before { content: '1.15 ' }

                .print-site-enumerate-headings #guides-token_usage_tracking h2:before { content: '1.15.' counter(counter-guides-token_usage_tracking-2) ' ' }
                .print-site-enumerate-headings #guides-token_usage_tracking h2 {  counter-increment: counter-guides-token_usage_tracking-2 }
            
.print-site-enumerate-headings #guides-using_guardrails > h1:before { content: '1.16 ' }

                .print-site-enumerate-headings #guides-using_guardrails h2:before { content: '1.16.' counter(counter-guides-using_guardrails-2) ' ' }
                .print-site-enumerate-headings #guides-using_guardrails h2 {  counter-increment: counter-guides-using_guardrails-2 }
            
.print-site-enumerate-headings #guides-distributed_tasks > h1:before { content: '1.17 ' }

                .print-site-enumerate-headings #guides-distributed_tasks h2:before { content: '1.17.' counter(counter-guides-distributed_tasks-2) ' ' }
                .print-site-enumerate-headings #guides-distributed_tasks h2 {  counter-increment: counter-guides-distributed_tasks-2 }
            
.print-site-enumerate-headings #section-2 > h1:before { content: '2 ' }
.print-site-enumerate-headings #guides-plugin_architecture > h1:before { content: '2.1 ' }

                .print-site-enumerate-headings #guides-plugin_architecture h2:before { content: '2.1.' counter(counter-guides-plugin_architecture-2) ' ' }
                .print-site-enumerate-headings #guides-plugin_architecture h2 {  counter-increment: counter-guides-plugin_architecture-2 }
            
.print-site-enumerate-headings #guides-creating_plugins > h1:before { content: '2.2 ' }

                .print-site-enumerate-headings #guides-creating_plugins h2:before { content: '2.2.' counter(counter-guides-creating_plugins-2) ' ' }
                .print-site-enumerate-headings #guides-creating_plugins h2 {  counter-increment: counter-guides-creating_plugins-2 }
            
.print-site-enumerate-headings #guides-creating_tool_plugins > h1:before { content: '2.3 ' }

                .print-site-enumerate-headings #guides-creating_tool_plugins h2:before { content: '2.3.' counter(counter-guides-creating_tool_plugins-2) ' ' }
                .print-site-enumerate-headings #guides-creating_tool_plugins h2 {  counter-increment: counter-guides-creating_tool_plugins-2 }
            
.print-site-enumerate-headings #guides-creating_rag_plugins > h1:before { content: '2.4 ' }

                .print-site-enumerate-headings #guides-creating_rag_plugins h2:before { content: '2.4.' counter(counter-guides-creating_rag_plugins-2) ' ' }
                .print-site-enumerate-headings #guides-creating_rag_plugins h2 {  counter-increment: counter-guides-creating_rag_plugins-2 }
            
.print-site-enumerate-headings #guides-creating_other_plugins > h1:before { content: '2.5 ' }

                .print-site-enumerate-headings #guides-creating_other_plugins h2:before { content: '2.5.' counter(counter-guides-creating_other_plugins-2) ' ' }
                .print-site-enumerate-headings #guides-creating_other_plugins h2 {  counter-increment: counter-guides-creating_other_plugins-2 }
            
.print-site-enumerate-headings #section-3 > h1:before { content: '3 ' }
.print-site-enumerate-headings #api > h1:before { content: '3.1 ' }

                .print-site-enumerate-headings #api h2:before { content: '3.1.' counter(counter-api-2) ' ' }
                .print-site-enumerate-headings #api h2 {  counter-increment: counter-api-2 }
            
.print-site-enumerate-headings #api-genie_facade > h1:before { content: '3.2 ' }

                .print-site-enumerate-headings #api-genie_facade h2:before { content: '3.2.' counter(counter-api-genie_facade-2) ' ' }
                .print-site-enumerate-headings #api-genie_facade h2 {  counter-increment: counter-api-genie_facade-2 }
            
.print-site-enumerate-headings #api-decorators > h1:before { content: '3.3 ' }

                .print-site-enumerate-headings #api-decorators h2:before { content: '3.3.' counter(counter-api-decorators-2) ' ' }
                .print-site-enumerate-headings #api-decorators h2 {  counter-increment: counter-api-decorators-2 }
            
.print-site-enumerate-headings #api-core_types > h1:before { content: '3.4 ' }

                .print-site-enumerate-headings #api-core_types h2:before { content: '3.4.' counter(counter-api-core_types-2) ' ' }
                .print-site-enumerate-headings #api-core_types h2 {  counter-increment: counter-api-core_types-2 }
            
.print-site-enumerate-headings #api-plugin_manager > h1:before { content: '3.5 ' }

                .print-site-enumerate-headings #api-plugin_manager h2:before { content: '3.5.' counter(counter-api-plugin_manager-2) ' ' }
                .print-site-enumerate-headings #api-plugin_manager h2 {  counter-increment: counter-api-plugin_manager-2 }
            
.print-site-enumerate-headings #api-config_models > h1:before { content: '3.6 ' }

                .print-site-enumerate-headings #api-config_models h2:before { content: '3.6.' counter(counter-api-config_models-2) ' ' }
                .print-site-enumerate-headings #api-config_models h2 {  counter-increment: counter-api-config_models-2 }
            
.print-site-enumerate-headings #api-config_features > h1:before { content: '3.7 ' }

                .print-site-enumerate-headings #api-config_features h2:before { content: '3.7.' counter(counter-api-config_features-2) ' ' }
                .print-site-enumerate-headings #api-config_features h2 {  counter-increment: counter-api-config_features-2 }
            
.print-site-enumerate-headings #section-4 > h1:before { content: '4 ' }
.print-site-enumerate-headings #tutorials-e01_simple_agent_cli > h1:before { content: '4.1 ' }

                .print-site-enumerate-headings #tutorials-e01_simple_agent_cli h2:before { content: '4.1.' counter(counter-tutorials-e01_simple_agent_cli-2) ' ' }
                .print-site-enumerate-headings #tutorials-e01_simple_agent_cli h2 {  counter-increment: counter-tutorials-e01_simple_agent_cli-2 }
            
.print-site-enumerate-headings #tutorials-e02_ollama_chat_example > h1:before { content: '4.2 ' }

                .print-site-enumerate-headings #tutorials-e02_ollama_chat_example h2:before { content: '4.2.' counter(counter-tutorials-e02_ollama_chat_example-2) ' ' }
                .print-site-enumerate-headings #tutorials-e02_ollama_chat_example h2 {  counter-increment: counter-tutorials-e02_ollama_chat_example-2 }
            
.print-site-enumerate-headings #tutorials-e03_openai_chat_example > h1:before { content: '4.3 ' }

                .print-site-enumerate-headings #tutorials-e03_openai_chat_example h2:before { content: '4.3.' counter(counter-tutorials-e03_openai_chat_example-2) ' ' }
                .print-site-enumerate-headings #tutorials-e03_openai_chat_example h2 {  counter-increment: counter-tutorials-e03_openai_chat_example-2 }
            
.print-site-enumerate-headings #tutorials-e04_gemini_chat_example > h1:before { content: '4.4 ' }

                .print-site-enumerate-headings #tutorials-e04_gemini_chat_example h2:before { content: '4.4.' counter(counter-tutorials-e04_gemini_chat_example-2) ' ' }
                .print-site-enumerate-headings #tutorials-e04_gemini_chat_example h2 {  counter-increment: counter-tutorials-e04_gemini_chat_example-2 }
            
.print-site-enumerate-headings #tutorials-e05_rag_pipeline_demo > h1:before { content: '4.5 ' }

                .print-site-enumerate-headings #tutorials-e05_rag_pipeline_demo h2:before { content: '4.5.' counter(counter-tutorials-e05_rag_pipeline_demo-2) ' ' }
                .print-site-enumerate-headings #tutorials-e05_rag_pipeline_demo h2 {  counter-increment: counter-tutorials-e05_rag_pipeline_demo-2 }
            
.print-site-enumerate-headings #tutorials-e06_run_command_simple_keyword_example > h1:before { content: '4.6 ' }

                .print-site-enumerate-headings #tutorials-e06_run_command_simple_keyword_example h2:before { content: '4.6.' counter(counter-tutorials-e06_run_command_simple_keyword_example-2) ' ' }
                .print-site-enumerate-headings #tutorials-e06_run_command_simple_keyword_example h2 {  counter-increment: counter-tutorials-e06_run_command_simple_keyword_example-2 }
            
.print-site-enumerate-headings #tutorials-e07_run_command_llm_assisted_example > h1:before { content: '4.7 ' }

                .print-site-enumerate-headings #tutorials-e07_run_command_llm_assisted_example h2:before { content: '4.7.' counter(counter-tutorials-e07_run_command_llm_assisted_example-2) ' ' }
                .print-site-enumerate-headings #tutorials-e07_run_command_llm_assisted_example h2 {  counter-increment: counter-tutorials-e07_run_command_llm_assisted_example-2 }
            
.print-site-enumerate-headings #tutorials-e08_decorator_tool_example > h1:before { content: '4.8 ' }

                .print-site-enumerate-headings #tutorials-e08_decorator_tool_example h2:before { content: '4.8.' counter(counter-tutorials-e08_decorator_tool_example-2) ' ' }
                .print-site-enumerate-headings #tutorials-e08_decorator_tool_example h2 {  counter-increment: counter-tutorials-e08_decorator_tool_example-2 }
            
.print-site-enumerate-headings #tutorials-e09_web_rag_example > h1:before { content: '4.9 ' }

                .print-site-enumerate-headings #tutorials-e09_web_rag_example h2:before { content: '4.9.' counter(counter-tutorials-e09_web_rag_example-2) ' ' }
                .print-site-enumerate-headings #tutorials-e09_web_rag_example h2 {  counter-increment: counter-tutorials-e09_web_rag_example-2 }
            
.print-site-enumerate-headings #tutorials-e10_chroma_tool_lookup_showcase > h1:before { content: '4.10 ' }

                .print-site-enumerate-headings #tutorials-e10_chroma_tool_lookup_showcase h2:before { content: '4.10.' counter(counter-tutorials-e10_chroma_tool_lookup_showcase-2) ' ' }
                .print-site-enumerate-headings #tutorials-e10_chroma_tool_lookup_showcase h2 {  counter-increment: counter-tutorials-e10_chroma_tool_lookup_showcase-2 }
            
.print-site-enumerate-headings #tutorials-e11_advanced_showcase_agent > h1:before { content: '4.11 ' }

                .print-site-enumerate-headings #tutorials-e11_advanced_showcase_agent h2:before { content: '4.11.' counter(counter-tutorials-e11_advanced_showcase_agent-2) ' ' }
                .print-site-enumerate-headings #tutorials-e11_advanced_showcase_agent h2 {  counter-increment: counter-tutorials-e11_advanced_showcase_agent-2 }
            
.print-site-enumerate-headings #tutorials-e12_custom_key_provider_example > h1:before { content: '4.12 ' }

                .print-site-enumerate-headings #tutorials-e12_custom_key_provider_example h2:before { content: '4.12.' counter(counter-tutorials-e12_custom_key_provider_example-2) ' ' }
                .print-site-enumerate-headings #tutorials-e12_custom_key_provider_example h2 {  counter-increment: counter-tutorials-e12_custom_key_provider_example-2 }
            
.print-site-enumerate-headings #tutorials-e13_google_search_demo > h1:before { content: '4.13 ' }

                .print-site-enumerate-headings #tutorials-e13_google_search_demo h2:before { content: '4.13.' counter(counter-tutorials-e13_google_search_demo-2) ' ' }
                .print-site-enumerate-headings #tutorials-e13_google_search_demo h2 {  counter-increment: counter-tutorials-e13_google_search_demo-2 }
            
.print-site-enumerate-headings #tutorials-e14_filesystem_tool_demo > h1:before { content: '4.14 ' }

                .print-site-enumerate-headings #tutorials-e14_filesystem_tool_demo h2:before { content: '4.14.' counter(counter-tutorials-e14_filesystem_tool_demo-2) ' ' }
                .print-site-enumerate-headings #tutorials-e14_filesystem_tool_demo h2 {  counter-increment: counter-tutorials-e14_filesystem_tool_demo-2 }
            
.print-site-enumerate-headings #tutorials-e15_prompt_management_example > h1:before { content: '4.15 ' }

                .print-site-enumerate-headings #tutorials-e15_prompt_management_example h2:before { content: '4.15.' counter(counter-tutorials-e15_prompt_management_example-2) ' ' }
                .print-site-enumerate-headings #tutorials-e15_prompt_management_example h2 {  counter-increment: counter-tutorials-e15_prompt_management_example-2 }
            
.print-site-enumerate-headings #tutorials-e16_conversation_state_example > h1:before { content: '4.16 ' }

                .print-site-enumerate-headings #tutorials-e16_conversation_state_example h2:before { content: '4.16.' counter(counter-tutorials-e16_conversation_state_example-2) ' ' }
                .print-site-enumerate-headings #tutorials-e16_conversation_state_example h2 {  counter-increment: counter-tutorials-e16_conversation_state_example-2 }
            
.print-site-enumerate-headings #tutorials-e17_observability_tracing_example > h1:before { content: '4.17 ' }

                .print-site-enumerate-headings #tutorials-e17_observability_tracing_example h2:before { content: '4.17.' counter(counter-tutorials-e17_observability_tracing_example-2) ' ' }
                .print-site-enumerate-headings #tutorials-e17_observability_tracing_example h2 {  counter-increment: counter-tutorials-e17_observability_tracing_example-2 }
            
.print-site-enumerate-headings #tutorials-e18_human_in_loop_example > h1:before { content: '4.18 ' }

                .print-site-enumerate-headings #tutorials-e18_human_in_loop_example h2:before { content: '4.18.' counter(counter-tutorials-e18_human_in_loop_example-2) ' ' }
                .print-site-enumerate-headings #tutorials-e18_human_in_loop_example h2 {  counter-increment: counter-tutorials-e18_human_in_loop_example-2 }
            
.print-site-enumerate-headings #tutorials-e19_llm_output_parsing_example > h1:before { content: '4.19 ' }

                .print-site-enumerate-headings #tutorials-e19_llm_output_parsing_example h2:before { content: '4.19.' counter(counter-tutorials-e19_llm_output_parsing_example-2) ' ' }
                .print-site-enumerate-headings #tutorials-e19_llm_output_parsing_example h2 {  counter-increment: counter-tutorials-e19_llm_output_parsing_example-2 }
            
.print-site-enumerate-headings #tutorials-e20_token_usage_example > h1:before { content: '4.20 ' }

                .print-site-enumerate-headings #tutorials-e20_token_usage_example h2:before { content: '4.20.' counter(counter-tutorials-e20_token_usage_example-2) ' ' }
                .print-site-enumerate-headings #tutorials-e20_token_usage_example h2 {  counter-increment: counter-tutorials-e20_token_usage_example-2 }
            
.print-site-enumerate-headings #tutorials-e21_guardrails_example > h1:before { content: '4.21 ' }

                .print-site-enumerate-headings #tutorials-e21_guardrails_example h2:before { content: '4.21.' counter(counter-tutorials-e21_guardrails_example-2) ' ' }
                .print-site-enumerate-headings #tutorials-e21_guardrails_example h2 {  counter-increment: counter-tutorials-e21_guardrails_example-2 }
            
.print-site-enumerate-headings #tutorials-e22_distributed_task_example > h1:before { content: '4.22 ' }

                .print-site-enumerate-headings #tutorials-e22_distributed_task_example h2:before { content: '4.22.' counter(counter-tutorials-e22_distributed_task_example-2) ' ' }
                .print-site-enumerate-headings #tutorials-e22_distributed_task_example h2 {  counter-increment: counter-tutorials-e22_distributed_task_example-2 }
            
.print-site-enumerate-headings #tutorials-e23_local_e2e_llama_cpp_server > h1:before { content: '4.23 ' }

                .print-site-enumerate-headings #tutorials-e23_local_e2e_llama_cpp_server h2:before { content: '4.23.' counter(counter-tutorials-e23_local_e2e_llama_cpp_server-2) ' ' }
                .print-site-enumerate-headings #tutorials-e23_local_e2e_llama_cpp_server h2 {  counter-increment: counter-tutorials-e23_local_e2e_llama_cpp_server-2 }
            
.print-site-enumerate-headings #tutorials-e24_local_e2e_llama_cpp_internal > h1:before { content: '4.24 ' }

                .print-site-enumerate-headings #tutorials-e24_local_e2e_llama_cpp_internal h2:before { content: '4.24.' counter(counter-tutorials-e24_local_e2e_llama_cpp_internal-2) ' ' }
                .print-site-enumerate-headings #tutorials-e24_local_e2e_llama_cpp_internal h2 {  counter-increment: counter-tutorials-e24_local_e2e_llama_cpp_internal-2 }
            
.print-site-enumerate-headings #tutorials-e25_llama_cpp_internal_gbnf_parsing > h1:before { content: '4.25 ' }

                .print-site-enumerate-headings #tutorials-e25_llama_cpp_internal_gbnf_parsing h2:before { content: '4.25.' counter(counter-tutorials-e25_llama_cpp_internal_gbnf_parsing-2) ' ' }
                .print-site-enumerate-headings #tutorials-e25_llama_cpp_internal_gbnf_parsing h2 {  counter-increment: counter-tutorials-e25_llama_cpp_internal_gbnf_parsing-2 }
            
.print-site-enumerate-headings #tutorials-e26_deep_research_agent_e2e > h1:before { content: '4.26 ' }

                .print-site-enumerate-headings #tutorials-e26_deep_research_agent_e2e h2:before { content: '4.26.' counter(counter-tutorials-e26_deep_research_agent_e2e-2) ' ' }
                .print-site-enumerate-headings #tutorials-e26_deep_research_agent_e2e h2 {  counter-increment: counter-tutorials-e26_deep_research_agent_e2e-2 }
            
.print-site-enumerate-headings #tutorials-e27_pyvider_log_adapter_tracing_example > h1:before { content: '4.27 ' }

                .print-site-enumerate-headings #tutorials-e27_pyvider_log_adapter_tracing_example h2:before { content: '4.27.' counter(counter-tutorials-e27_pyvider_log_adapter_tracing_example-2) ' ' }
                .print-site-enumerate-headings #tutorials-e27_pyvider_log_adapter_tracing_example h2 {  counter-increment: counter-tutorials-e27_pyvider_log_adapter_tracing_example-2 }
            
.print-site-enumerate-headings #changelog > h1:before { content: '5 ' }

                .print-site-enumerate-headings #changelog h2:before { content: '5.' counter(counter-changelog-2) ' ' }
                .print-site-enumerate-headings #changelog h2 {  counter-reset: counter-changelog-3 ;  counter-increment: counter-changelog-2 }
            
                .print-site-enumerate-headings #changelog h3:before { content: '5.' counter(counter-changelog-2) '.' counter(counter-changelog-3) ' ' }
                .print-site-enumerate-headings #changelog h3 {  counter-increment: counter-changelog-3 }
            </style>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "/", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
    
  </body>
</html>